<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 750 650" width="750" height="650">
  <defs>
    <style>
      .component { fill: #dbeafe; stroke: #1e40af; stroke-width: 2; }
      .memory { fill: #dcfce7; stroke: #16a34a; stroke-width: 2; }
      .control { fill: #fef3c7; stroke: #d97706; stroke-width: 2; }
      .mux { fill: #fce7f3; stroke: #be185d; stroke-width: 1.5; }
      .wire { stroke: #374151; stroke-width: 2; fill: none; }
      .bus { stroke: #1e40af; stroke-width: 3; fill: none; }
      .control-wire { stroke: #d97706; stroke-width: 1.5; fill: none; stroke-dasharray: 4,2; }
      .label { font-family: sans-serif; font-size: 11px; fill: #1f2937; }
      .component-label { font-family: sans-serif; font-size: 10px; font-weight: bold; fill: #1e40af; }
      .title { font-family: sans-serif; font-size: 14px; font-weight: bold; fill: #1e3a8a; }
    </style>
    <marker id="arrow" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <polygon points="0 0, 8 3, 0 6" fill="#374151"/>
    </marker>
    <marker id="arrow-blue" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <polygon points="0 0, 8 3, 0 6" fill="#1e40af"/>
    </marker>
  </defs>

  <!-- Title -->
  <text class="title" x="375" y="25" text-anchor="middle">Architecture du CPU (Data Path)</text>

  <!-- Control Unit -->
  <rect class="control" x="250" y="40" width="250" height="50" rx="4"/>
  <text class="component-label" x="375" y="60" text-anchor="middle" fill="#92400e">UNITE DE CONTROLE</text>
  <text class="label" x="375" y="75" text-anchor="middle" font-size="9">(genere les signaux de controle)</text>

  <!-- Control signals line -->
  <line class="control-wire" x1="375" y1="90" x2="375" y2="115"/>
  <text class="label" x="380" y="108" font-size="8">reg_write, mem_read, alu_op...</text>

  <!-- Main CPU box -->
  <rect x="30" y="120" width="690" height="510" rx="6" fill="none" stroke="#9ca3af" stroke-width="1" stroke-dasharray="5,5"/>

  <!-- PC -->
  <rect class="component" x="50" y="150" width="70" height="50" rx="4"/>
  <text class="component-label" x="85" y="180" text-anchor="middle">PC</text>

  <!-- PC+4 -->
  <rect class="component" x="50" y="230" width="70" height="35" rx="4"/>
  <text class="component-label" x="85" y="252" text-anchor="middle">+4</text>

  <!-- Instruction Memory -->
  <rect class="memory" x="160" y="140" width="100" height="70" rx="4"/>
  <text class="component-label" x="210" y="170" text-anchor="middle" fill="#166534">MEMOIRE</text>
  <text class="component-label" x="210" y="185" text-anchor="middle" fill="#166534">INSTRUCTIONS</text>

  <!-- Decoder -->
  <rect class="component" x="300" y="140" width="100" height="70" rx="4"/>
  <text class="component-label" x="350" y="170" text-anchor="middle">DECODEUR</text>
  <text class="label" x="350" y="185" text-anchor="middle" font-size="9">(analyse bits)</text>

  <!-- Register File -->
  <rect class="component" x="430" y="140" width="110" height="90" rx="4"/>
  <text class="component-label" x="485" y="170" text-anchor="middle">REGISTRES</text>
  <text class="component-label" x="485" y="185" text-anchor="middle">(R0-R15)</text>
  <text class="label" x="485" y="215" text-anchor="middle" font-size="9">Rn | Rm | Rd</text>

  <!-- MUX for Rm/Imm -->
  <path class="mux" d="M 500 260 L 530 275 L 530 305 L 500 320 Z"/>
  <text class="component-label" x="512" y="295" text-anchor="middle" fill="#9d174d" font-size="9">MUX</text>
  <text class="label" x="540" y="295" font-size="8">Rm/Imm</text>

  <!-- ALU -->
  <rect class="component" x="460" y="350" width="100" height="70" rx="4"/>
  <text class="component-label" x="510" y="385" text-anchor="middle">ALU</text>
  <text class="label" x="510" y="400" text-anchor="middle" font-size="9">ADD, SUB...</text>

  <!-- Data Memory -->
  <rect class="memory" x="460" y="450" width="100" height="60" rx="4"/>
  <text class="component-label" x="510" y="475" text-anchor="middle" fill="#166534">MEMOIRE</text>
  <text class="component-label" x="510" y="490" text-anchor="middle" fill="#166534">DONNEES</text>

  <!-- MUX for ALU/MEM result -->
  <path class="mux" d="M 500 535 L 530 550 L 530 580 L 500 595 Z"/>
  <text class="component-label" x="512" y="570" text-anchor="middle" fill="#9d174d" font-size="9">MUX</text>
  <text class="label" x="540" y="565" font-size="8">ALU/MEM</text>

  <!-- Branch MUX -->
  <path class="mux" d="M 70 295 L 100 310 L 100 340 L 70 355 Z"/>
  <text class="component-label" x="82" y="330" text-anchor="middle" fill="#9d174d" font-size="9">MUX</text>
  <text class="label" x="45" y="330" font-size="8">Branch</text>

  <!-- Wires -->
  <!-- PC to Instruction Memory -->
  <line class="bus" x1="120" y1="175" x2="160" y2="175" marker-end="url(#arrow-blue)"/>

  <!-- PC to +4 -->
  <line class="wire" x1="85" y1="200" x2="85" y2="230"/>

  <!-- +4 to Branch MUX -->
  <line class="wire" x1="85" y1="265" x2="85" y2="295" marker-end="url(#arrow)"/>

  <!-- Branch MUX to PC -->
  <polyline class="wire" points="85,355 85,380 30,380 30,175 50,175" marker-end="url(#arrow)"/>
  <text class="label" x="35" y="280" font-size="8">PC</text>

  <!-- Instruction Memory to Decoder -->
  <line class="bus" x1="260" y1="175" x2="300" y2="175" marker-end="url(#arrow-blue)"/>
  <text class="label" x="275" y="165" font-size="8">32 bits</text>

  <!-- Decoder to Register File -->
  <line class="wire" x1="400" y1="175" x2="430" y2="175" marker-end="url(#arrow)"/>
  <text class="label" x="400" y="145" font-size="8">Rd, Rn, Rm, Imm</text>

  <!-- Register File to MUX -->
  <line class="wire" x1="485" y1="230" x2="485" y2="260"/>
  <line class="wire" x1="500" y1="230" x2="515" y2="260" marker-end="url(#arrow)"/>
  <text class="label" x="455" y="245" font-size="8">Rn</text>
  <text class="label" x="520" y="245" font-size="8">Rm</text>

  <!-- MUX to ALU -->
  <line class="wire" x1="515" y1="320" x2="515" y2="350"/>
  <line class="wire" x1="485" y1="260" x2="485" y2="350" marker-end="url(#arrow)"/>

  <!-- ALU to Data Memory -->
  <line class="bus" x1="510" y1="420" x2="510" y2="450" marker-end="url(#arrow-blue)"/>
  <text class="label" x="515" y="438" font-size="8">Resultat</text>

  <!-- ALU flags output -->
  <line class="wire" x1="560" y1="385" x2="600" y2="385"/>
  <text class="label" x="565" y="378" font-size="8">Flags N,Z,C,V</text>

  <!-- Data Memory to MUX -->
  <line class="wire" x1="510" y1="510" x2="510" y2="535" marker-end="url(#arrow)"/>

  <!-- ALU result bypass to MUX -->
  <polyline class="wire" points="560,400 580,400 580,555 530,555"/>

  <!-- MUX output to Writeback -->
  <polyline class="bus" points="515,595 515,620 650,620 650,200 540,200" marker-end="url(#arrow-blue)"/>
  <text class="label" x="600" y="610" font-size="8">Writeback Rd</text>

  <!-- Control signals to components -->
  <line class="control-wire" x1="375" y1="115" x2="375" y2="140"/>
  <line class="control-wire" x1="375" y1="115" x2="510" y2="350"/>
  <line class="control-wire" x1="375" y1="115" x2="510" y2="450"/>
  <line class="control-wire" x1="375" y1="115" x2="85" y2="295"/>

  <!-- Legend -->
  <rect x="590" y="250" width="120" height="100" fill="#f9fafb" stroke="#e5e7eb" rx="4"/>
  <text class="label" x="650" y="268" text-anchor="middle" font-weight="bold">Legende</text>
  <line x1="600" y1="280" x2="630" y2="280" stroke="#1e40af" stroke-width="3"/>
  <text class="label" x="635" y="284" font-size="9">Bus donnees</text>
  <line x1="600" y1="300" x2="630" y2="300" stroke="#374151" stroke-width="2"/>
  <text class="label" x="635" y="304" font-size="9">Signal</text>
  <line x1="600" y1="320" x2="630" y2="320" stroke="#d97706" stroke-width="1.5" stroke-dasharray="4,2"/>
  <text class="label" x="635" y="324" font-size="9">Controle</text>
  <rect x="600" y="332" width="20" height="12" fill="#dcfce7" stroke="#16a34a"/>
  <text class="label" x="625" y="342" font-size="9">Memoire</text>
</svg>
