<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang xml:lang>
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Seed - Livre des Solutions</title>
  <style>
html {
color: #1a1a1a;
background-color: #fdfdfd;
}
body {
margin: 0 auto;
max-width: 36em;
padding-left: 50px;
padding-right: 50px;
padding-top: 50px;
padding-bottom: 50px;
hyphens: auto;
overflow-wrap: break-word;
text-rendering: optimizeLegibility;
font-kerning: normal;
}
@media (max-width: 600px) {
body {
font-size: 0.9em;
padding: 12px;
}
h1 {
font-size: 1.8em;
}
}
@media print {
html {
background-color: white;
}
body {
background-color: transparent;
color: black;
font-size: 12pt;
}
p, h2, h3 {
orphans: 3;
widows: 3;
}
h2, h3, h4 {
page-break-after: avoid;
}
}
p {
margin: 1em 0;
}
a {
color: #1a1a1a;
}
a:visited {
color: #1a1a1a;
}
img {
max-width: 100%;
}
svg {
height: auto;
max-width: 100%;
}
h1, h2, h3, h4, h5, h6 {
margin-top: 1.4em;
}
h5, h6 {
font-size: 1em;
font-style: italic;
}
h6 {
font-weight: normal;
}
ol, ul {
padding-left: 1.7em;
margin-top: 1em;
}
li > ol, li > ul {
margin-top: 0;
}
blockquote {
margin: 1em 0 1em 1.7em;
padding-left: 1em;
border-left: 2px solid #e6e6e6;
color: #606060;
}
code {
font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
font-size: 85%;
margin: 0;
hyphens: manual;
}
pre {
margin: 1em 0;
overflow: auto;
}
pre code {
padding: 0;
overflow: visible;
overflow-wrap: normal;
}
.sourceCode {
background-color: transparent;
overflow: visible;
}
hr {
background-color: #1a1a1a;
border: none;
height: 1px;
margin: 1em 0;
}
table {
margin: 1em 0;
border-collapse: collapse;
width: 100%;
overflow-x: auto;
display: block;
font-variant-numeric: lining-nums tabular-nums;
}
table caption {
margin-bottom: 0.75em;
}
tbody {
margin-top: 0.5em;
border-top: 1px solid #1a1a1a;
border-bottom: 1px solid #1a1a1a;
}
th {
border-top: 1px solid #1a1a1a;
padding: 0.25em 0.5em 0.25em 0.5em;
}
td {
padding: 0.125em 0.5em 0.25em 0.5em;
}
header {
margin-bottom: 4em;
text-align: center;
}
#TOC li {
list-style: none;
}
#TOC ul {
padding-left: 1.3em;
}
#TOC > ul {
padding-left: 0;
}
#TOC a:not(:hover) {
text-decoration: none;
}
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}

ul.task-list[class]{list-style: none;}
ul.task-list li input[type="checkbox"] {
font-size: inherit;
width: 0.8em;
margin: 0 0.8em 0.2em -1.6em;
vertical-align: middle;
}
.display.math{display: block; text-align: center; margin: 0.5rem auto;}

pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
background-color: #232629;
color: #7a7c7d;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #7a7c7d; padding-left: 4px; }
div.sourceCode
{ color: #cfcfc2; background-color: #232629; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #cfcfc2; } 
code span.al { color: #95da4c; background-color: #4d1f24; font-weight: bold; } 
code span.an { color: #3f8058; } 
code span.at { color: #2980b9; } 
code span.bn { color: #f67400; } 
code span.bu { color: #7f8c8d; } 
code span.cf { color: #fdbc4b; font-weight: bold; } 
code span.ch { color: #3daee9; } 
code span.cn { color: #27aeae; font-weight: bold; } 
code span.co { color: #7a7c7d; } 
code span.cv { color: #7f8c8d; } 
code span.do { color: #a43340; } 
code span.dt { color: #2980b9; } 
code span.dv { color: #f67400; } 
code span.er { color: #da4453; text-decoration: underline; } 
code span.ex { color: #0099ff; font-weight: bold; } 
code span.fl { color: #f67400; } 
code span.fu { color: #8e44ad; } 
code span.im { color: #27ae60; } 
code span.in { color: #c45b00; } 
code span.kw { color: #cfcfc2; font-weight: bold; } 
code span.op { color: #cfcfc2; } 
code span.ot { color: #27ae60; } 
code span.pp { color: #27ae60; } 
code span.re { color: #2980b9; background-color: #153042; } 
code span.sc { color: #3daee9; } 
code span.ss { color: #da4453; } 
code span.st { color: #f44f4f; } 
code span.va { color: #27aeae; } 
code span.vs { color: #da4453; } 
code span.wa { color: #da4453; } 
</style>
</head>
<body>
<header id="title-block-header">
<h1 class="title">Seed - Livre des Solutions</h1>
</header>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#solutions-des-quiz-dauto-évaluation" id="toc-solutions-des-quiz-dauto-évaluation"><span class="toc-section-number">1</span> Solutions des Quiz
d’Auto-évaluation</a>
<ul>
<li><a href="#chapitre-1-logique-booléenne" id="toc-chapitre-1-logique-booléenne"><span class="toc-section-number">1.1</span> Chapitre 1 : Logique
Booléenne</a></li>
<li><a href="#chapitre-2-arithmétique-binaire" id="toc-chapitre-2-arithmétique-binaire"><span class="toc-section-number">1.2</span> Chapitre 2 : Arithmétique
Binaire</a></li>
<li><a href="#chapitre-3-mémoire" id="toc-chapitre-3-mémoire"><span class="toc-section-number">1.3</span> Chapitre 3 : Mémoire</a></li>
<li><a href="#chapitre-4-architecture" id="toc-chapitre-4-architecture"><span class="toc-section-number">1.4</span> Chapitre 4 : Architecture</a></li>
<li><a href="#chapitre-5-cpu" id="toc-chapitre-5-cpu"><span class="toc-section-number">1.5</span> Chapitre 5 : CPU</a></li>
<li><a href="#chapitre-6-assembleur" id="toc-chapitre-6-assembleur"><span class="toc-section-number">1.6</span> Chapitre 6 : Assembleur</a></li>
<li><a href="#chapitre-7-compilateur" id="toc-chapitre-7-compilateur"><span class="toc-section-number">1.7</span> Chapitre 7 : Compilateur</a></li>
<li><a href="#chapitre-8-le-langage-c32" id="toc-chapitre-8-le-langage-c32"><span class="toc-section-number">1.8</span> Chapitre 8 : Le Langage
C32</a></li>
<li><a href="#chapitre-9-système-dexploitation" id="toc-chapitre-9-système-dexploitation"><span class="toc-section-number">1.9</span> Chapitre 9 : Système
d’Exploitation</a></li>
<li><a href="#chapitre-11-mémoire-cache" id="toc-chapitre-11-mémoire-cache"><span class="toc-section-number">1.10</span> Chapitre 11 : Mémoire
Cache</a></li>
<li><a href="#chapitre-10bis-débogage" id="toc-chapitre-10bis-débogage"><span class="toc-section-number">1.11</span> Chapitre 10bis :
Débogage</a></li>
<li><a href="#chapitre-12-interruptions" id="toc-chapitre-12-interruptions"><span class="toc-section-number">1.12</span> Chapitre 12 :
Interruptions</a></li>
<li><a href="#chapitre-13-concepts-avancés" id="toc-chapitre-13-concepts-avancés"><span class="toc-section-number">1.13</span> Chapitre 13 : Concepts
Avancés</a></li>
</ul></li>
<li><a href="#livre-des-solutions" id="toc-livre-des-solutions"><span class="toc-section-number">2</span> Livre des Solutions</a>
<ul>
<li><a href="#a.-solutions-hdl-portes-logiques" id="toc-a.-solutions-hdl-portes-logiques"><span class="toc-section-number">2.1</span> A. Solutions HDL (Portes
Logiques)</a></li>
<li><a href="#b.-solutions-assembleur-a32" id="toc-b.-solutions-assembleur-a32"><span class="toc-section-number">2.2</span> B. Solutions Assembleur
A32</a></li>
<li><a href="#c.-solutions-c32" id="toc-c.-solutions-c32"><span class="toc-section-number">2.3</span> C. Solutions C32</a></li>
<li><a href="#d.-solutions-construction-du-compilateur" id="toc-d.-solutions-construction-du-compilateur"><span class="toc-section-number">2.4</span> D. Solutions Construction du
Compilateur</a></li>
<li><a href="#e.-solutions-systeme-dexploitation" id="toc-e.-solutions-systeme-dexploitation"><span class="toc-section-number">2.5</span> E. Solutions Systeme
d’Exploitation</a></li>
</ul></li>
</ul>
</nav>
<h1 data-number="1" id="solutions-des-quiz-dauto-évaluation"><span class="header-section-number">1</span> Solutions des Quiz
d’Auto-évaluation</h1>
<p>Ce document contient les réponses aux questions d’auto-évaluation de
chaque chapitre. Essayez de répondre par vous-même avant de consulter
les solutions !</p>
<blockquote>
<p><strong>Note</strong> : Pour les solutions des exercices pratiques
HDL, assembleur et C32 du simulateur web, consultez le document
<strong>Solutions.md</strong>.</p>
</blockquote>
<hr />
<h2 data-number="1.1" id="chapitre-1-logique-booléenne"><span class="header-section-number">1.1</span> Chapitre 1 : Logique
Booléenne</h2>
<h3 data-number="1.1.1" id="q1.-pourquoi-les-ordinateurs-utilisent-ils-le-binaire-plutôt-que-le-décimal"><span class="header-section-number">1.1.1</span> Q1. Pourquoi les ordinateurs
utilisent-ils le binaire plutôt que le décimal ?</h3>
<p>Trois raisons principales : 1. <strong>Fiabilité</strong> :
Distinguer 2 états (haut/bas) est plus robuste que 10 niveaux 2.
<strong>Simplicité</strong> : Les transistors fonctionnent naturellement
comme des interrupteurs on/off 3. <strong>Universalité</strong> : Toute
logique peut s’exprimer avec Vrai/Faux (algèbre de Boole)</p>
<h3 data-number="1.1.2" id="q2.-pourquoi-dit-on-que-nand-est-une-porte-universelle"><span class="header-section-number">1.1.2</span> Q2. Pourquoi dit-on que NAND
est une porte “universelle” ?</h3>
<p>Parce que <strong>toutes les autres portes</strong> (NOT, AND, OR,
XOR, MUX, etc.) peuvent être construites uniquement à partir de portes
NAND. C’est notre “axiome” de départ — tout le reste en découle.</p>
<h3 data-number="1.1.3" id="q3.-quelle-est-la-sortie-de-xor1-1-et-de-xor0-1"><span class="header-section-number">1.1.3</span> Q3. Quelle est la sortie de
<code>XOR(1, 1)</code> ? Et de <code>XOR(0, 1)</code> ?</h3>
<ul>
<li><code>XOR(1, 1) = 0</code> (les entrées sont identiques)</li>
<li><code>XOR(0, 1) = 1</code> (les entrées sont différentes)</li>
</ul>
<p>XOR vaut 1 <strong>si et seulement si</strong> les entrées sont
différentes.</p>
<h3 data-number="1.1.4" id="q4.-un-multiplexeur-mux-a-2-entrées-de-données-a-et-b-et-un-signal-de-sélection-sel.-si-sel-1-quelle-entrée-est-transmise-en-sortie"><span class="header-section-number">1.1.4</span> Q4. Un multiplexeur (MUX) a 2
entrées de données <code>a</code> et <code>b</code>, et un signal de
sélection <code>sel</code>. Si <code>sel = 1</code>, quelle entrée est
transmise en sortie ?</h3>
<p>Si <code>sel = 1</code>, la sortie est <code>b</code>. Si
<code>sel = 0</code>, la sortie est <code>a</code>.</p>
<p>Le MUX “choisit” entre ses entrées selon le signal de sélection.</p>
<h3 data-number="1.1.5" id="q5.-combien-de-portes-nand-faut-il-au-minimum-pour-construire-un-inverseur-not"><span class="header-section-number">1.1.5</span> Q5. Combien de portes NAND
faut-il au minimum pour construire un inverseur (NOT) ?</h3>
<p><strong>Une seule</strong> porte NAND suffit :
<code>NOT(a) = NAND(a, a)</code></p>
<p>Quand les deux entrées du NAND sont identiques, on obtient
l’inverse.</p>
<h3 data-number="1.1.6" id="mini-défi-table-de-vérité-de-fa-b-andora-b-nota"><span class="header-section-number">1.1.6</span> Mini-défi : Table de vérité
de F(a, b) = AND(OR(a, b), NOT(a))</h3>
<table>
<thead>
<tr class="header">
<th>a</th>
<th>b</th>
<th>OR(a,b)</th>
<th>NOT(a)</th>
<th>F</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="even">
<td>0</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="odd">
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>
<p>Cette fonction est équivalente à <code>AND(NOT(a), b)</code>, soit “b
ET NON a”.</p>
<hr />
<h2 data-number="1.2" id="chapitre-2-arithmétique-binaire"><span class="header-section-number">1.2</span> Chapitre 2 : Arithmétique
Binaire</h2>
<h3 data-number="1.2.1" id="q1.-en-complément-à-deux-sur-8-bits-quelle-est-la-représentation-de--1"><span class="header-section-number">1.2.1</span> Q1. En complément à deux sur
8 bits, quelle est la représentation de -1 ?</h3>
<p><strong>0xFF</strong> (ou 11111111 en binaire).</p>
<p>En complément à deux, -1 est représenté par tous les bits à 1, quelle
que soit la largeur.</p>
<h3 data-number="1.2.2" id="q2.-pourquoi-le-complément-à-deux-est-il-préféré-au-signe-magnitude"><span class="header-section-number">1.2.2</span> Q2. Pourquoi le complément à
deux est-il préféré au “signe + magnitude” ?</h3>
<p>Trois avantages majeurs : 1. <strong>Un seul zéro</strong> (pas de +0
et -0) 2. <strong>L’addition fonctionne identiquement</strong> pour les
nombres signés et non-signés 3. <strong>La soustraction devient une
addition</strong> : A - B = A + (~B + 1)</p>
<h3 data-number="1.2.3" id="q3.-quel-est-le-rôle-de-la-retenue-entrante-cin-dans-un-additionneur-complet"><span class="header-section-number">1.2.3</span> Q3. Quel est le rôle de la
retenue entrante (Cin) dans un additionneur complet ?</h3>
<p>Elle permet de <strong>propager la retenue</strong> de la colonne
précédente. C’est essentiel pour chaîner plusieurs additionneurs et
créer un additionneur multi-bits. Sans Cin, on ne pourrait additionner
que des bits individuels.</p>
<h3 data-number="1.2.4" id="q4.-une-alu-reçoit-les-opérandes-a5-et-b3-avec-lopération-sub.-quel-est-le-résultat-et-quels-flags-sont-activés"><span class="header-section-number">1.2.4</span> Q4. Une ALU reçoit les
opérandes A=5 et B=3, avec l’opération SUB. Quel est le résultat et
quels flags sont activés ?</h3>
<ul>
<li><strong>Résultat</strong> : 5 - 3 = 2</li>
<li><strong>Flags</strong> : Aucun flag actif
<ul>
<li>Z = 0 (résultat non nul)</li>
<li>N = 0 (résultat positif)</li>
<li>C = 1 (pas d’emprunt en soustraction non-signée)</li>
<li>V = 0 (pas de débordement signé)</li>
</ul></li>
</ul>
<h3 data-number="1.2.5" id="q5.-quelle-opération-alu-permet-de-mettre-à-zéro-les-bits-4-7-dun-registre-tout-en-préservant-les-autres"><span class="header-section-number">1.2.5</span> Q5. Quelle opération ALU
permet de mettre à zéro les bits 4-7 d’un registre tout en préservant
les autres ?</h3>
<p><strong>AND avec un masque</strong> : <code>R = R AND 0x0F</code></p>
<p>Le masque 0x0F (00001111 en binaire) préserve les bits 0-3 et force
les bits 4-7 à zéro.</p>
<h3 data-number="1.2.6" id="mini-défi-0x7f-0x01-en-8-bits-signés"><span class="header-section-number">1.2.6</span> Mini-défi : 0x7F + 0x01 en 8
bits signés</h3>
<ul>
<li>0x7F = 127 (le plus grand positif en 8 bits signés)</li>
<li>0x7F + 0x01 = 0x80 = 128 en non-signé, mais <strong>-128 en
signé</strong></li>
</ul>
<p>C’est un <strong>débordement (overflow)</strong> ! Le flag V serait
activé car on passe de positif à négatif.</p>
<hr />
<h2 data-number="1.3" id="chapitre-3-mémoire"><span class="header-section-number">1.3</span> Chapitre 3 : Mémoire</h2>
<h3 data-number="1.3.1" id="q1.-quelle-est-la-différence-fondamentale-entre-un-circuit-combinatoire-et-un-circuit-séquentiel"><span class="header-section-number">1.3.1</span> Q1. Quelle est la différence
fondamentale entre un circuit combinatoire et un circuit séquentiel
?</h3>
<p>Un circuit <strong>combinatoire</strong> : la sortie dépend
uniquement des entrées actuelles. Un circuit <strong>séquentiel</strong>
: la sortie dépend des entrées ET de l’état précédent (il a une
“mémoire”).</p>
<p>La bascule D (DFF) est l’élément qui introduit la notion de temps et
de mémoire.</p>
<h3 data-number="1.3.2" id="q2.-pourquoi-le-signal-dhorloge-clk-est-il-essentiel-dans-les-circuits-séquentiels"><span class="header-section-number">1.3.2</span> Q2. Pourquoi le signal
d’horloge (clk) est-il essentiel dans les circuits séquentiels ?</h3>
<p>L’horloge <strong>synchronise</strong> toutes les mises à jour de
l’état. Sans elle : - Les données se propageraient de manière chaotique
- Des “courses” (race conditions) créeraient des résultats imprévisibles
- On ne pourrait pas garantir un comportement déterministe</p>
<h3 data-number="1.3.3" id="q3.-un-registre-32-bits-est-construit-à-partir-de-combien-de-bascules-d"><span class="header-section-number">1.3.3</span> Q3. Un registre 32 bits est
construit à partir de combien de bascules D ?</h3>
<p><strong>32 bascules D</strong>, une par bit. Chaque DFF mémorise un
bit, donc un registre de N bits nécessite N DFF.</p>
<h3 data-number="1.3.4" id="q4.-quelle-est-la-capacité-totale-dune-ram-de-1024-mots-de-32-bits-en-kilooctets"><span class="header-section-number">1.3.4</span> Q4. Quelle est la capacité
totale d’une RAM de 1024 mots de 32 bits, en kilooctets ?</h3>
<ul>
<li>1024 mots × 32 bits/mot = 32768 bits</li>
<li>32768 bits ÷ 8 = 4096 octets</li>
<li>4096 octets ÷ 1024 = <strong>4 Ko</strong></li>
</ul>
<h3 data-number="1.3.5" id="q5.-dans-une-ram8-combien-de-bits-dadresse-sont-nécessaires-et-pourquoi"><span class="header-section-number">1.3.5</span> Q5. Dans une RAM8, combien de
bits d’adresse sont nécessaires et pourquoi ?</h3>
<p><strong>3 bits</strong> d’adresse, car 2³ = 8.</p>
<p>Avec 3 bits, on peut adresser 8 emplacements distincts (000 à
111).</p>
<h3 data-number="1.3.6" id="mini-défi-registre-avec-enable"><span class="header-section-number">1.3.6</span> Mini-défi : Registre avec
Enable</h3>
<p>Pour ajouter un signal <code>enable</code> à une DFF :</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Solution : MUX devant la DFF</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="ot">signal</span> d_mux <span class="ot">:</span> <span class="dt">bit</span>;</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>d_mux <span class="ot">&lt;=</span> d <span class="kw">when</span> enable <span class="ot">=</span> <span class="bn">&#39;1&#39;</span> <span class="kw">else</span> q;  <span class="co">-- Si enable=0, reboucler la sortie</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>u_dff<span class="ot">:</span> DFF <span class="kw">port</span> <span class="kw">map</span> (d <span class="ot">=&gt;</span> d_mux<span class="ot">,</span> clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> q <span class="ot">=&gt;</span> q);</span></code></pre></div>
<p>Le MUX choisit entre la nouvelle donnée (si enable=1) ou la valeur
actuelle (si enable=0).</p>
<hr />
<h2 data-number="1.4" id="chapitre-4-architecture"><span class="header-section-number">1.4</span> Chapitre 4 : Architecture</h2>
<h3 data-number="1.4.1" id="q1.-quelle-est-la-différence-entre-larchitecture-von-neumann-et-harvard"><span class="header-section-number">1.4.1</span> Q1. Quelle est la différence
entre l’architecture von Neumann et Harvard ?</h3>
<ul>
<li><strong>Von Neumann</strong> : Une seule mémoire pour les
instructions et les données. Plus simple, mais un seul accès mémoire par
cycle (goulot d’étranglement).</li>
<li><strong>Harvard</strong> : Mémoires séparées pour instructions et
données. Permet de charger une instruction pendant qu’on accède aux
données (plus rapide).</li>
</ul>
<h3 data-number="1.4.2" id="q2.-pourquoi-utilise-t-on-des-registres-plutôt-que-daccéder-directement-à-la-ram"><span class="header-section-number">1.4.2</span> Q2. Pourquoi utilise-t-on des
registres plutôt que d’accéder directement à la RAM ?</h3>
<p>Les registres sont <strong>beaucoup plus rapides</strong> que la RAM
: - Accès en 1 cycle vs plusieurs cycles pour la RAM - Intégrés dans le
CPU, pas de bus externe - Nombre limité (16-32) mais suffisant pour les
calculs immédiats</p>
<p>Les registres sont le “bureau de travail” du CPU, la RAM est
“l’armoire de rangement”.</p>
<h3 data-number="1.4.3" id="q3.-à-quoi-sert-le-registre-pc-program-counter"><span class="header-section-number">1.4.3</span> Q3. À quoi sert le registre
PC (Program Counter) ?</h3>
<p>Le PC contient l’<strong>adresse de la prochaine instruction</strong>
à exécuter. Après chaque instruction : - Il est incrémenté
automatiquement (PC = PC + 4 pour des instructions 32 bits) - Ou modifié
par un branchement (saut, appel de fonction)</p>
<h3 data-number="1.4.4" id="q4.-quest-ce-que-le-mmio-memory-mapped-io"><span class="header-section-number">1.4.4</span> Q4. Qu’est-ce que le MMIO
(Memory-Mapped I/O) ?</h3>
<p>Le MMIO permet d’accéder aux <strong>périphériques</strong> (écran,
clavier, etc.) comme s’ils étaient de la mémoire. Chaque périphérique a
une adresse réservée : - Écrire à 0xFFFF0000 → envoie un caractère à la
sortie - Lire à 0xFFFF0004 → récupère un caractère du clavier</p>
<p>Avantage : pas besoin d’instructions spéciales, les mêmes LDR/STR
fonctionnent.</p>
<h3 data-number="1.4.5" id="q5.-dans-le-cycle-fetch-decode-execute-que-se-passe-t-il-pendant-la-phase-decode"><span class="header-section-number">1.4.5</span> Q5. Dans le cycle
fetch-decode-execute, que se passe-t-il pendant la phase “decode” ?</h3>
<p>Pendant le <strong>décodage</strong> : 1. L’instruction est analysée
pour identifier son type (ALU, mémoire, branchement) 2. Les registres
sources sont identifiés et lus 3. L’unité de contrôle génère les signaux
appropriés pour l’exécution</p>
<h3 data-number="1.4.6" id="mini-défi-pourquoi-16-registres-avec-4-bits"><span class="header-section-number">1.4.6</span> Mini-défi : Pourquoi 16
registres avec 4 bits ?</h3>
<p>Avec 4 bits, on peut encoder 2⁴ = <strong>16 valeurs</strong>
différentes (0000 à 1111), donc 16 registres (R0 à R15).</p>
<p>Pour 32 registres, il faudrait 5 bits (2⁵ = 32).</p>
<hr />
<h2 data-number="1.5" id="chapitre-5-cpu"><span class="header-section-number">1.5</span> Chapitre 5 : CPU</h2>
<h3 data-number="1.5.1" id="q1.-quelles-sont-les-5-étapes-du-cycle-dinstruction-dans-un-pipeline-classique"><span class="header-section-number">1.5.1</span> Q1. Quelles sont les 5 étapes
du cycle d’instruction dans un pipeline classique ?</h3>
<ol type="1">
<li><strong>IF</strong> (Instruction Fetch) : Charger l’instruction
depuis la mémoire</li>
<li><strong>ID</strong> (Instruction Decode) : Décoder et lire les
registres</li>
<li><strong>EX</strong> (Execute) : Effectuer le calcul dans l’ALU</li>
<li><strong>MEM</strong> (Memory Access) : Accéder à la mémoire si
nécessaire</li>
<li><strong>WB</strong> (Write Back) : Écrire le résultat dans le
registre destination</li>
</ol>
<h3 data-number="1.5.2" id="q2.-quest-ce-quun-aléa-de-données-data-hazard-et-comment-le-résoudre"><span class="header-section-number">1.5.2</span> Q2. Qu’est-ce qu’un aléa de
données (data hazard) et comment le résoudre ?</h3>
<p>Un <strong>aléa de données</strong> se produit quand une instruction
a besoin du résultat d’une instruction précédente qui n’est pas encore
terminée.</p>
<p>Solutions : - <strong>Forwarding</strong> : Transmettre le résultat
directement depuis EX/MEM vers l’instruction suivante -
<strong>Stall</strong> : Insérer des bulles (attendre) si le forwarding
n’est pas possible - <strong>Réordonnancement</strong> : Le compilateur
réorganise le code pour éviter les dépendances</p>
<h3 data-number="1.5.3" id="q3.-pourquoi-le-program-counter-est-il-incrémenté-de-4-et-non-de-1-sur-une-architecture-32-bits"><span class="header-section-number">1.5.3</span> Q3. Pourquoi le Program
Counter est-il incrémenté de 4 (et non de 1) sur une architecture 32
bits ?</h3>
<p>Parce que chaque instruction occupe <strong>4 octets</strong> (32
bits). La mémoire est adressée par octet, donc passer à l’instruction
suivante nécessite d’avancer de 4 adresses.</p>
<h3 data-number="1.5.4" id="q4.-quel-composant-décide-si-un-branchement-conditionnel-doit-être-pris"><span class="header-section-number">1.5.4</span> Q4. Quel composant décide si
un branchement conditionnel doit être pris ?</h3>
<p>L’<strong>unité de contrôle</strong> utilise les <strong>flags de
l’ALU</strong> (Z, N, C, V) pour décider. Par exemple : - B.EQ (Branch
if Equal) vérifie si Z = 1 - B.NE (Branch if Not Equal) vérifie si Z = 0
- B.GT (Branch if Greater Than) vérifie si Z = 0 ET N = V</p>
<h3 data-number="1.5.5" id="q5.-quelle-est-la-différence-entre-les-instructions-ldr-et-str"><span class="header-section-number">1.5.5</span> Q5. Quelle est la différence
entre les instructions LDR et STR ?</h3>
<ul>
<li><strong>LDR</strong> (Load Register) : Lit une valeur <strong>de la
mémoire vers un registre</strong>
<ul>
<li><code>LDR R0, [R1]</code> → R0 = Mem[R1]</li>
</ul></li>
<li><strong>STR</strong> (Store Register) : Écrit une valeur
<strong>d’un registre vers la mémoire</strong>
<ul>
<li><code>STR R0, [R1]</code> → Mem[R1] = R0</li>
</ul></li>
</ul>
<h3 data-number="1.5.6" id="mini-défi-temps-dexécution-avec-pipeline"><span class="header-section-number">1.5.6</span> Mini-défi : Temps d’exécution
avec pipeline</h3>
<p>Sans pipeline : 5 × 10 = <strong>50 cycles</strong></p>
<p>Avec pipeline (après remplissage initial) : - Remplissage : 4 cycles
- Puis 1 instruction complétée par cycle : 10 cycles - Total :
<strong>14 cycles</strong> (ou 10 + 4 = 14)</p>
<p>Gain : 50/14 ≈ <strong>3.6× plus rapide</strong></p>
<hr />
<h2 data-number="1.6" id="chapitre-6-assembleur"><span class="header-section-number">1.6</span> Chapitre 6 : Assembleur</h2>
<h3 data-number="1.6.1" id="q1.-quelle-est-la-différence-entre-une-instruction-et-une-directive-en-assembleur"><span class="header-section-number">1.6.1</span> Q1. Quelle est la différence
entre une instruction et une directive en assembleur ?</h3>
<ul>
<li><strong>Instruction</strong> : Traduite en code machine, exécutée
par le CPU (ex: <code>ADD R0, R1, R2</code>)</li>
<li><strong>Directive</strong> : Commande pour l’assembleur lui-même,
pas de code généré (ex: <code>.data</code>, <code>.word 42</code>,
<code>.global main</code>)</li>
</ul>
<p>Les directives contrôlent l’organisation du programme, pas son
exécution.</p>
<h3 data-number="1.6.2" id="q2.-pourquoi-doit-on-sauvegarder-lr-avant-dappeler-une-sous-fonction-avec-bl"><span class="header-section-number">1.6.2</span> Q2. Pourquoi doit-on
sauvegarder LR avant d’appeler une sous-fonction avec BL ?</h3>
<p>Parce que <code>BL</code> (Branch and Link) <strong>écrase
LR</strong> avec l’adresse de retour. Si on appelle une autre fonction
sans sauvegarder, l’adresse de retour originale est perdue.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">func:</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">PUSH</span> <span class="op">{</span>LR<span class="op">}</span>      <span class="co">; Sauvegarder AVANT le BL</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    BL autre_func  <span class="co">; LR est écrasé ici</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">POP</span> <span class="op">{</span>LR<span class="op">}</span>       <span class="co">; Restaurer</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    BX LR          <span class="co">; Retour correct</span></span></code></pre></div>
<h3 data-number="1.6.3" id="q3.-comment-charger-une-valeur-32-bits-arbitraire-ex-0x12345678-dans-un-registre"><span class="header-section-number">1.6.3</span> Q3. Comment charger une
valeur 32 bits arbitraire (ex: 0x12345678) dans un registre ?</h3>
<p>Utiliser <code>LDR Rd, =value</code> qui utilise le <strong>literal
pool</strong> :</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>LDR R0<span class="op">,</span> <span class="op">=</span><span class="bn">0x12345678</span>  <span class="co">; L&#39;assembleur place la constante en mémoire</span></span></code></pre></div>
<p>L’instruction <code>MOV</code> ne peut charger que des immédiats sur
12 bits (0-4095 ou valeurs rotées).</p>
<h3 data-number="1.6.4" id="q4.-à-quoi-sert-la-directive-.ltorg"><span class="header-section-number">1.6.4</span> Q4. À quoi sert la directive
<code>.ltorg</code> ?</h3>
<p><code>.ltorg</code> force l’assembleur à <strong>placer le literal
pool</strong> (les constantes utilisées par <code>LDR Rd, =value</code>)
à cet endroit.</p>
<p>C’est nécessaire car le PC-relative offset est limité (±4KB). Si les
constantes sont trop loin, l’assembleur génère une erreur E1008.</p>
<h3 data-number="1.6.5" id="q5.-quelle-est-la-convention-pour-les-registres-callee-saved-vs-caller-saved"><span class="header-section-number">1.6.5</span> Q5. Quelle est la convention
pour les registres “callee-saved” vs “caller-saved” ?</h3>
<ul>
<li><strong>Caller-saved</strong> (R0-R3) : L’appelant doit les
sauvegarder s’il veut les préserver. La fonction appelée peut les
modifier librement.</li>
<li><strong>Callee-saved</strong> (R4-R11) : La fonction appelée doit
les restaurer avant de retourner. L’appelant peut compter sur leur
préservation.</li>
</ul>
<h3 data-number="1.6.6" id="mini-défi-valeur-finale-de-r0"><span class="header-section-number">1.6.6</span> Mini-défi : Valeur finale de
R0</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">10</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">3</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">loop:</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    SUBS R0<span class="op">,</span> R0<span class="op">,</span> R1</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    B<span class="op">.</span>PL loop</span></code></pre></div>
<p>Trace : - R0 = 10, R0 - 3 = 7 (positif, N=0) → boucle - R0 = 7, R0 -
3 = 4 (positif, N=0) → boucle - R0 = 4, R0 - 3 = 1 (positif, N=0) →
boucle - R0 = 1, R0 - 3 = -2 (négatif, N=1) → sort</p>
<p><strong>R0 = -2</strong> (ou 0xFFFFFFFE en non-signé)</p>
<hr />
<h2 data-number="1.7" id="chapitre-7-compilateur"><span class="header-section-number">1.7</span> Chapitre 7 : Compilateur</h2>
<h3 data-number="1.7.1" id="q1.-quelles-sont-les-principales-phases-dun-compilateur"><span class="header-section-number">1.7.1</span> Q1. Quelles sont les
principales phases d’un compilateur ?</h3>
<ol type="1">
<li><strong>Analyse lexicale</strong> : Transforme le texte en tokens
(mots-clés, identifiants, opérateurs)</li>
<li><strong>Analyse syntaxique</strong> : Construit l’arbre syntaxique
(AST) selon la grammaire</li>
<li><strong>Analyse sémantique</strong> : Vérifie les types, la portée
des variables</li>
<li><strong>Génération de code</strong> : Produit le code
assembleur/machine</li>
</ol>
<h3 data-number="1.7.2" id="q2.-quest-ce-quun-ast-et-à-quoi-sert-il"><span class="header-section-number">1.7.2</span> Q2. Qu’est-ce qu’un AST et à
quoi sert-il ?</h3>
<p>L’<strong>AST</strong> (Abstract Syntax Tree) est une représentation
arborescente du programme qui capture sa structure logique sans les
détails syntaxiques (parenthèses, points-virgules).</p>
<p>Il sert de représentation intermédiaire entre le code source et le
code généré, facilitant l’analyse et les transformations.</p>
<h3 data-number="1.7.3" id="q3.-comment-le-compilateur-gère-t-il-les-variables-locales-dune-fonction"><span class="header-section-number">1.7.3</span> Q3. Comment le compilateur
gère-t-il les variables locales d’une fonction ?</h3>
<p>Les variables locales sont stockées sur la <strong>pile</strong>
(stack) : - À l’entrée de la fonction, l’espace est réservé
(<code>SUB SP, SP, #n</code>) - Chaque variable a un offset par rapport
à SP ou FP - À la sortie, l’espace est libéré
(<code>ADD SP, SP, #n</code>)</p>
<h3 data-number="1.7.4" id="q4.-quelle-est-la-différence-entre-une-erreur-syntaxique-et-sémantique"><span class="header-section-number">1.7.4</span> Q4. Quelle est la différence
entre une erreur syntaxique et sémantique ?</h3>
<ul>
<li><strong>Erreur syntaxique</strong> : Le code ne respecte pas la
grammaire (ex: parenthèse manquante, point-virgule oublié)</li>
<li><strong>Erreur sémantique</strong> : Le code est syntaxiquement
correct mais n’a pas de sens (ex: <code>int x = &quot;hello&quot;</code>, variable
non déclarée)</li>
</ul>
<h3 data-number="1.7.5" id="q5.-pourquoi-le-compilateur-génère-t-il-parfois-du-code-qui-semble-inefficace"><span class="header-section-number">1.7.5</span> Q5. Pourquoi le compilateur
génère-t-il parfois du code qui semble inefficace ?</h3>
<p>Sans optimisation, le compilateur génère du code <strong>direct et
prévisible</strong> qui suit fidèlement la structure du source. Par
exemple : - Chaque variable a son emplacement mémoire - Chaque opération
génère ses instructions</p>
<p>Les optimisations (niveau -O2, -O3) réduisent ces inefficacités mais
compliquent le débogage.</p>
<h3 data-number="1.7.6" id="mini-défi-code-assembleur-généré"><span class="header-section-number">1.7.6</span> Mini-défi : Code assembleur
généré</h3>
<p>Pour <code>int x = a + b * c;</code> :</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">; Supposons a, b, c dans R0, R1, R2</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="bu">MUL</span> R3<span class="op">,</span> R1<span class="op">,</span> R2    <span class="co">; R3 = b * c (multiplication d&#39;abord)</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="bu">ADD</span> R4<span class="op">,</span> R0<span class="op">,</span> R3    <span class="co">; R4 = a + (b * c)</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">; R4 contient x</span></span></code></pre></div>
<p>Le compilateur respecte la <strong>priorité des opérateurs</strong> :
multiplication avant addition.</p>
<hr />
<h2 data-number="1.8" id="chapitre-8-le-langage-c32"><span class="header-section-number">1.8</span> Chapitre 8 : Le Langage
C32</h2>
<h3 data-number="1.8.1" id="q1.-quelles-sont-les-principales-différences-entre-c32-et-c-standard"><span class="header-section-number">1.8.1</span> Q1. Quelles sont les
principales différences entre C32 et C standard ?</h3>
<ul>
<li>Pas d’opérateurs <code>++</code> et <code>--</code> (utiliser
<code>x = x + 1</code>)</li>
<li>Pas de <code>float</code>/<code>double</code> (entiers
uniquement)</li>
<li>Pas d’<code>enum</code></li>
<li>Préprocesseur minimal</li>
<li>Pas de bibliothèque standard (juste <code>putc</code>,
<code>getc</code>, <code>exit</code>)</li>
</ul>
<h3 data-number="1.8.2" id="q2.-comment-passer-un-tableau-à-une-fonction-en-c32"><span class="header-section-number">1.8.2</span> Q2. Comment passer un tableau
à une fonction en C32 ?</h3>
<p>Les tableaux sont passés par <strong>pointeur</strong> (l’adresse du
premier élément) :</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> process<span class="op">(</span><span class="dt">int</span> <span class="op">*</span>arr<span class="op">,</span> <span class="dt">int</span> len<span class="op">)</span> <span class="op">{</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> len<span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>        arr<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> arr<span class="op">[</span>i<span class="op">]</span> <span class="op">*</span> <span class="dv">2</span><span class="op">;</span>  <span class="co">// Modifie le tableau original</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> data<span class="op">[</span><span class="dv">5</span><span class="op">];</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    process<span class="op">(</span>data<span class="op">,</span> <span class="dv">5</span><span class="op">);</span>  <span class="co">// &#39;data&#39; est converti en &amp;data[0]</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 data-number="1.8.3" id="q3.-quelle-est-la-différence-entre-p-et-x"><span class="header-section-number">1.8.3</span> Q3. Quelle est la différence
entre <code>*p</code> et <code>&amp;x</code> ?</h3>
<ul>
<li><code>&amp;x</code> : L’<strong>adresse</strong> de la variable x
(opérateur “adresse de”)</li>
<li><code>*p</code> : La <strong>valeur</strong> pointée par p
(opérateur de déréférencement)</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> x <span class="op">=</span> <span class="dv">42</span><span class="op">;</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> <span class="op">*</span>p <span class="op">=</span> <span class="op">&amp;</span>x<span class="op">;</span>  <span class="co">// p contient l&#39;adresse de x</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> y <span class="op">=</span> <span class="op">*</span>p<span class="op">;</span>   <span class="co">// y = 42 (valeur lue à l&#39;adresse p)</span></span></code></pre></div>
<h3 data-number="1.8.4" id="q4.-comment-accéder-au-framebuffer-pour-dessiner-un-pixel"><span class="header-section-number">1.8.4</span> Q4. Comment accéder au
framebuffer pour dessiner un pixel ?</h3>
<p>Via <strong>MMIO</strong> (Memory-Mapped I/O) :</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>uint <span class="op">*</span>screen <span class="op">=</span> <span class="op">(</span>uint<span class="op">*)</span><span class="bn">0x00400000</span><span class="op">;</span>  <span class="co">// Adresse du framebuffer</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>screen<span class="op">[</span>y <span class="op">*</span> <span class="dv">320</span> <span class="op">+</span> x<span class="op">]</span> <span class="op">=</span> <span class="bn">0xFFFFFFFF</span><span class="op">;</span>  <span class="co">// Pixel blanc à (x, y)</span></span></code></pre></div>
<p>Chaque mot de 32 bits représente les couleurs de 32 pixels (1 bit par
pixel en monochrome).</p>
<h3 data-number="1.8.5" id="q5.-pourquoi-faut-il-toujours-terminer-une-chaîne-par-0"><span class="header-section-number">1.8.5</span> Q5. Pourquoi faut-il toujours
terminer une chaîne par <code>&#39;\0&#39;</code> ?</h3>
<p>Le caractère <code>&#39;\0&#39;</code> (valeur 0) marque la <strong>fin de la
chaîne</strong>. Sans lui, les fonctions de traitement de chaînes
(affichage, copie, comparaison) ne sauraient pas où s’arrêter et
liraient au-delà de la chaîne.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="dt">char</span> <span class="op">*</span>msg <span class="op">=</span> <span class="st">&quot;Hello&quot;</span><span class="op">;</span>  <span class="co">// Le compilateur ajoute &#39;\0&#39; automatiquement</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co">// En mémoire : &#39;H&#39; &#39;e&#39; &#39;l&#39; &#39;l&#39; &#39;o&#39; &#39;\0&#39;</span></span></code></pre></div>
<h3 data-number="1.8.6" id="mini-défi-fonction-de-longueur-de-chaîne"><span class="header-section-number">1.8.6</span> Mini-défi : Fonction de
longueur de chaîne</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> strlen<span class="op">(</span><span class="dt">char</span> <span class="op">*</span>s<span class="op">)</span> <span class="op">{</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> len <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(*</span>s <span class="op">!=</span> <span class="ch">&#39;</span><span class="sc">\0</span><span class="ch">&#39;</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>        len <span class="op">=</span> len <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>        s <span class="op">=</span> s <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> len<span class="op">;</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h2 data-number="1.9" id="chapitre-9-système-dexploitation"><span class="header-section-number">1.9</span> Chapitre 9 : Système
d’Exploitation</h2>
<h3 data-number="1.9.1" id="q1.-quels-sont-les-trois-rôles-principaux-dun-système-dexploitation"><span class="header-section-number">1.9.1</span> Q1. Quels sont les trois
rôles principaux d’un système d’exploitation ?</h3>
<ol type="1">
<li><strong>Abstraction du matériel</strong> : Fournir une interface
unifiée (fichiers, processus) au-dessus du matériel varié</li>
<li><strong>Gestion des ressources</strong> : Allouer CPU, mémoire,
périphériques entre les programmes</li>
<li><strong>Protection et isolation</strong> : Empêcher les programmes
de se perturber mutuellement</li>
</ol>
<h3 data-number="1.9.2" id="q2.-comment-fonctionne-un-appel-système-syscall"><span class="header-section-number">1.9.2</span> Q2. Comment fonctionne un
appel système (syscall) ?</h3>
<ol type="1">
<li>Le programme place le numéro de syscall et les arguments dans les
registres</li>
<li>L’instruction <code>SVC</code> (Supervisor Call) déclenche une
exception</li>
<li>Le CPU passe en mode privilégié et saute au gestionnaire de
syscall</li>
<li>L’OS exécute le service demandé</li>
<li>Le contrôle retourne au programme avec le résultat dans R0</li>
</ol>
<h3 data-number="1.9.3" id="q3.-quest-ce-que-le-memory-mapping-et-pourquoi-est-il-utile"><span class="header-section-number">1.9.3</span> Q3. Qu’est-ce que le memory
mapping et pourquoi est-il utile ?</h3>
<p>Le <strong>memory mapping</strong> associe des régions de l’espace
d’adressage à des ressources : - <strong>RAM physique</strong> : Pour le
code et les données du programme - <strong>Périphériques (MMIO)</strong>
: Pour communiquer avec le matériel - <strong>Fichiers</strong> : Pour
accéder aux fichiers comme de la mémoire</p>
<p>Avantage : Une interface uniforme (load/store) pour tout accès.</p>
<h3 data-number="1.9.4" id="q4.-pourquoi-los-a-t-il-besoin-dun-mode-privilégié-séparé"><span class="header-section-number">1.9.4</span> Q4. Pourquoi l’OS a-t-il
besoin d’un mode privilégié séparé ?</h3>
<p>Pour <strong>protéger le système</strong> : - Seul l’OS peut accéder
au matériel directement - Seul l’OS peut modifier les tables de pages
mémoire - Les programmes utilisateur ne peuvent pas crasher le système
entier</p>
<p>Sans cette séparation, un bug dans un programme pourrait corrompre
tout le système.</p>
<h3 data-number="1.9.5" id="q5.-comment-los-gère-t-il-plusieurs-programmes-en-même-temps"><span class="header-section-number">1.9.5</span> Q5. Comment l’OS gère-t-il
plusieurs programmes en même temps ?</h3>
<p>Par le <strong>multitâche préemptif</strong> : 1. Un timer génère des
interruptions régulières 2. À chaque interruption, l’OS peut changer de
processus 3. L’état (registres, PC) du processus courant est sauvegardé
4. L’état d’un autre processus est restauré 5. L’exécution reprend dans
le nouveau processus</p>
<p>Chaque processus croit avoir le CPU pour lui seul.</p>
<h3 data-number="1.9.6" id="mini-défi-allocation-mémoire-simple"><span class="header-section-number">1.9.6</span> Mini-défi : Allocation
mémoire simple</h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Allocateur &quot;bump pointer&quot; minimal</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> heap_ptr <span class="op">=</span> <span class="bn">0x200000</span><span class="op">;</span>  <span class="co">// Début du tas</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span><span class="op">*</span> malloc<span class="op">(</span><span class="dt">int</span> size<span class="op">)</span> <span class="op">{</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> ptr <span class="op">=</span> heap_ptr<span class="op">;</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    heap_ptr <span class="op">=</span> heap_ptr <span class="op">+</span> size<span class="op">;</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Aligner sur 4 octets</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    heap_ptr <span class="op">=</span> <span class="op">(</span>heap_ptr <span class="op">+</span> <span class="dv">3</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">~</span><span class="dv">3</span><span class="op">;</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">(</span><span class="dt">void</span><span class="op">*)</span>ptr<span class="op">;</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="co">// Note : pas de free() dans cette version simple !</span></span></code></pre></div>
<hr />
<h2 data-number="1.10" id="chapitre-11-mémoire-cache"><span class="header-section-number">1.10</span> Chapitre 11 : Mémoire
Cache</h2>
<h3 data-number="1.10.1" id="q1.-pourquoi-a-t-on-besoin-dune-mémoire-cache"><span class="header-section-number">1.10.1</span> Q1. Pourquoi a-t-on besoin
d’une mémoire cache ?</h3>
<p>Pour combler l’<strong>écart de vitesse</strong> entre le CPU et la
RAM : - CPU : peut traiter une opération par cycle (&lt; 1 ns) - RAM :
temps d’accès de 50-100 ns (50-100 cycles perdus !)</p>
<p>Le cache stocke les données récemment utilisées dans une mémoire très
rapide (SRAM) proche du CPU.</p>
<h3 data-number="1.10.2" id="q2.-quest-ce-que-la-localité-spatiale-et-temporelle"><span class="header-section-number">1.10.2</span> Q2. Qu’est-ce que la
localité spatiale et temporelle ?</h3>
<ul>
<li><strong>Localité temporelle</strong> : Une donnée accédée récemment
sera probablement réaccédée bientôt (ex: variables de boucle)</li>
<li><strong>Localité spatiale</strong> : Les données proches en mémoire
sont souvent accédées ensemble (ex: éléments consécutifs d’un
tableau)</li>
</ul>
<p>Le cache exploite ces deux principes pour prédire quelles données
garder.</p>
<h3 data-number="1.10.3" id="q3.-quelle-est-la-différence-entre-un-cache-direct-mapped-et-associatif"><span class="header-section-number">1.10.3</span> Q3. Quelle est la différence
entre un cache direct-mapped et associatif ?</h3>
<ul>
<li><strong>Direct-mapped</strong> : Chaque adresse mémoire ne peut
aller qu’à <strong>un seul</strong> emplacement du cache. Simple mais
conflits fréquents.</li>
<li><strong>Associatif (N-way)</strong> : Chaque adresse peut aller dans
<strong>N emplacements</strong> différents. Moins de conflits mais plus
complexe.</li>
<li><strong>Totalement associatif</strong> : N’importe où dans le cache.
Optimal mais coûteux.</li>
</ul>
<h3 data-number="1.10.4" id="q4.-que-se-passe-t-il-lors-dun-cache-miss"><span class="header-section-number">1.10.4</span> Q4. Que se passe-t-il lors
d’un “cache miss” ?</h3>
<ol type="1">
<li>La donnée demandée n’est pas dans le cache</li>
<li>Le CPU est mis en attente (stall)</li>
<li>La ligne de cache complète est chargée depuis la mémoire
principale</li>
<li>Si le cache est plein, une ligne existante est évincée (et écrite en
RAM si modifiée)</li>
<li>L’accès est réessayé (cache hit cette fois)</li>
</ol>
<h3 data-number="1.10.5" id="q5.-quelle-est-la-différence-entre-write-through-et-write-back"><span class="header-section-number">1.10.5</span> Q5. Quelle est la différence
entre write-through et write-back ?</h3>
<ul>
<li><strong>Write-through</strong> : Chaque écriture va
<strong>immédiatement</strong> en cache ET en RAM. Simple mais
lent.</li>
<li><strong>Write-back</strong> : Les écritures vont
<strong>seulement</strong> au cache. La RAM est mise à jour seulement
quand la ligne est évincée. Plus rapide mais plus complexe.</li>
</ul>
<h3 data-number="1.10.6" id="mini-défi-optimisation-de-parcours-de-matrice"><span class="header-section-number">1.10.6</span> Mini-défi : Optimisation de
parcours de matrice</h3>
<div class="sourceCode" id="cb12"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Version optimisée (parcours par lignes)</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> N<span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> N<span class="op">;</span> j <span class="op">=</span> j <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>        sum <span class="op">=</span> sum <span class="op">+</span> matrix<span class="op">[</span>i<span class="op">][</span>j<span class="op">];</span>  <span class="co">// Accès séquentiels en mémoire</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>En C, les matrices sont stockées <strong>ligne par ligne</strong>
(row-major). Parcourir par lignes (i puis j) accède à des adresses
consécutives → excellent pour le cache (localité spatiale).</p>
<p>Parcourir par colonnes (j puis i) saute de N éléments à chaque accès
→ très mauvais pour le cache.</p>
<hr />
<h2 data-number="1.11" id="chapitre-10bis-débogage"><span class="header-section-number">1.11</span> Chapitre 10bis : Débogage</h2>
<p>Les solutions des exercices de débogage sont dans le chapitre
lui-même, car ils font partie intégrante de l’apprentissage du débogage.
Consultez les balises <code>&lt;details&gt;</code> dans le chapitre
10bis.</p>
<hr />
<h2 data-number="1.12" id="chapitre-12-interruptions"><span class="header-section-number">1.12</span> Chapitre 12 :
Interruptions</h2>
<h3 data-number="1.12.1" id="q1.-quelle-est-la-différence-entre-une-interruption-matérielle-et-une-exception"><span class="header-section-number">1.12.1</span> Q1. Quelle est la différence
entre une interruption matérielle et une exception ?</h3>
<ul>
<li><strong>Interruption matérielle (IRQ)</strong> : Déclenchée par un
<strong>périphérique externe</strong> (timer, clavier, réseau) de
manière asynchrone. Le CPU peut être interrompu à n’importe quel
moment.</li>
<li><strong>Exception</strong> : Déclenchée par le <strong>programme
lui-même</strong> lors d’une erreur ou condition spéciale (division par
zéro, adresse invalide, instruction invalide). Synchrone avec
l’exécution.</li>
</ul>
<p>Les deux utilisent un mécanisme similaire (sauvegarde du contexte,
saut à un handler), mais leur origine diffère.</p>
<h3 data-number="1.12.2" id="q2.-pourquoi-le-polling-est-il-inefficace-comparé-aux-interruptions"><span class="header-section-number">1.12.2</span> Q2. Pourquoi le polling
est-il inefficace comparé aux interruptions ?</h3>
<p>Le <strong>polling</strong> (attente active) gaspille des ressources
: 1. Le CPU vérifie constamment l’état des périphériques 2. Cycles
perdus même quand rien ne se passe 3. Latence variable (dépend de la
fréquence de vérification) 4. Ne scale pas avec le nombre de
périphériques</p>
<p>Les <strong>interruptions</strong> permettent au CPU de travailler
normalement et d’être notifié instantanément quand un événement se
produit.</p>
<h3 data-number="1.12.3" id="q3.-que-contient-la-table-des-vecteurs-dinterruption-ivt"><span class="header-section-number">1.12.3</span> Q3. Que contient la table
des vecteurs d’interruption (IVT) ?</h3>
<p>L’IVT contient les <strong>adresses des handlers</strong> pour chaque
type d’interruption : - Chaque entrée est un pointeur vers la routine de
service (ISR) - Indexée par le numéro d’interruption - Placée à une
adresse fixe en mémoire (souvent 0x00000000) - Permet au CPU de trouver
rapidement le code à exécuter</p>
<p>Exemple : IRQ #6 → IVT[6] → adresse 0x00001600 → keyboard_handler</p>
<h3 data-number="1.12.4" id="q4.-quest-ce-quune-race-condition-et-comment-léviter"><span class="header-section-number">1.12.4</span> Q4. Qu’est-ce qu’une race
condition et comment l’éviter ?</h3>
<p>Une <strong>race condition</strong> se produit quand deux
threads/contextes accèdent à une variable partagée sans synchronisation,
et le résultat dépend de l’ordre d’exécution.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Problème : interruption entre lecture et écriture</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>count <span class="op">=</span> count <span class="op">+</span> <span class="dv">1</span><span class="op">;</span>  <span class="co">// LOAD, ADD, STORE (non atomique)</span></span></code></pre></div>
<p><strong>Solutions</strong> : 1. Désactiver les interruptions pendant
l’accès critique 2. Utiliser des instructions atomiques (LDREX/STREX) 3.
Utiliser des mutex/spinlocks</p>
<h3 data-number="1.12.5" id="q5.-pourquoi-est-il-important-que-les-handlers-dinterruption-soient-courts"><span class="header-section-number">1.12.5</span> Q5. Pourquoi est-il
important que les handlers d’interruption soient courts ?</h3>
<p>Plusieurs raisons : 1. <strong>Latence</strong> : D’autres IRQ sont
bloquées pendant qu’un handler s’exécute 2. <strong>Réactivité</strong>
: Un long handler dégrade la réponse du système 3. <strong>Temps
réel</strong> : Les deadlines peuvent être manquées 4. <strong>Pile
IRQ</strong> : Généralement petite, risque de débordement</p>
<p><strong>Bonne pratique</strong> : Faire le minimum (flag,
acquittement) et déférer le travail lourd au thread principal ou à une
tâche dédiée.</p>
<h3 data-number="1.12.6" id="q6.-expliquez-le-rôle-de-linstruction-reti-ou-équivalent."><span class="header-section-number">1.12.6</span> Q6. Expliquez le rôle de
l’instruction RETI (ou équivalent).</h3>
<p>RETI (Return from Interrupt) effectue : 1. <strong>Restaure
PC</strong> : Depuis la valeur sauvegardée (LR_irq ou pile) 2.
<strong>Restaure les flags</strong> : CPSR depuis SPSR 3.
<strong>Réactive les interruptions</strong> : Clear le bit I si
nécessaire 4. <strong>Change de mode</strong> : Retourne au mode
utilisateur/système</p>
<p>C’est une instruction spéciale car elle modifie atomiquement PC et
les flags, ce qu’une séquence normale ne pourrait pas faire.</p>
<h3 data-number="1.12.7" id="q7.-quest-ce-que-le-fiq-et-pourquoi-est-il-plus-rapide-que-lirq"><span class="header-section-number">1.12.7</span> Q7. Qu’est-ce que le FIQ et
pourquoi est-il plus rapide que l’IRQ ?</h3>
<p>Le <strong>FIQ</strong> (Fast Interrupt Request) est une interruption
haute priorité avec des optimisations : 1. <strong>Registres
banqués</strong> : R8_fiq à R14_fiq sont séparés → pas besoin de
PUSH/POP 2. <strong>Vecteur en fin d’IVT</strong> : Le handler peut être
placé directement là (pas de saut) 3. <strong>Priorité maximale</strong>
: Ne peut pas être interrompu par IRQ</p>
<p>Gain typique : 20+ cycles économisés au début/fin du handler.</p>
<h3 data-number="1.12.8" id="exercice-de-réflexion"><span class="header-section-number">1.12.8</span> Exercice de réflexion</h3>
<p><strong>Question</strong> : Timer IRQ toutes les 1 ms, handler de 50
µs, latence réseau requise &lt; 100 µs. Possible ?</p>
<p><strong>Analyse</strong> : - Période timer : 1000 µs - Durée handler
: 50 µs - Temps entre handlers : 950 µs libres</p>
<p>Dans le <strong>pire cas</strong>, un événement réseau arrive juste
après le début d’un handler timer : - Attente : 50 µs (fin du handler
timer) - Latence totale : 50 µs &lt; 100 µs ✓</p>
<p><strong>Conclusion</strong> : Oui, c’est possible, mais de justesse.
Si le handler timer prenait 100 µs, ce ne serait plus garanti.</p>
<p>Pour plus de marge, on pourrait : - Rendre le timer handler
interruptible (nested IRQ) - Donner une priorité plus haute au réseau
(FIQ) - Réduire la durée du handler timer</p>
<h3 data-number="1.12.9" id="exercice-1-timer-handler"><span class="header-section-number">1.12.9</span> Exercice 1 : Timer
Handler</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>.<span class="bu">data</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ticks:</span>      .<span class="dt">word</span> <span class="dv">0</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">seconds:</span>    .<span class="dt">word</span> <span class="dv">0</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>.text</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="fu">timer_handler:</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">PUSH</span> <span class="op">{</span>R0<span class="op">-</span>R2<span class="op">,</span> LR<span class="op">}</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Incrémenter ticks</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    LDR R0<span class="op">,</span> <span class="op">=</span>ticks</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    LDR R1<span class="op">,</span> <span class="op">[</span>R0<span class="op">]</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R1<span class="op">,</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">1</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Vérifier si 1000 ticks</span></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    <span class="bu">CMP</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">1000</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>    B<span class="op">.</span>LT <span class="op">.</span>store_ticks</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Reset ticks et incrémenter seconds</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">0</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>    LDR R2<span class="op">,</span> <span class="op">=</span>seconds</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>    LDR R0<span class="op">,</span> <span class="op">[</span>R2<span class="op">]</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R0<span class="op">,</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">1</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>    <span class="bu">STR</span> R0<span class="op">,</span> <span class="op">[</span>R2<span class="op">]</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a><span class="fu">.store_ticks:</span></span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>    LDR R0<span class="op">,</span> <span class="op">=</span>ticks</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>    <span class="bu">STR</span> R1<span class="op">,</span> <span class="op">[</span>R0<span class="op">]</span></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Acquitter l&#39;interruption</span></span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>    LDR R0<span class="op">,</span> <span class="op">=</span>PIC_BASE</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R1<span class="op">,</span> <span class="op">#</span><span class="bn">0x20</span>           <span class="co">; EOI</span></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>    <span class="bu">STR</span> R1<span class="op">,</span> <span class="op">[</span>R0<span class="op">,</span> <span class="op">#</span>EOI_OFFSET<span class="op">]</span></span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>    <span class="bu">POP</span> <span class="op">{</span>R0<span class="op">-</span>R2<span class="op">,</span> LR<span class="op">}</span></span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>    SUBS PC<span class="op">,</span> LR<span class="op">,</span> <span class="op">#</span><span class="dv">4</span>         <span class="co">; RETI</span></span></code></pre></div>
<h3 data-number="1.12.10" id="exercice-4-calcul-de-latence"><span class="header-section-number">1.12.10</span> Exercice 4 : Calcul de
Latence</h3>
<ul>
<li>LDM 8 registres : ~10 cycles (2 + 8 accès mémoire)</li>
<li>Sauvegarde automatique : 3 cycles</li>
<li>Fetch vecteur : 2 cycles</li>
<li>PUSH 6 registres : ~8 cycles (2 + 6 accès)</li>
</ul>
<p><strong>Latence totale</strong> = 10 + 3 + 2 + 8 = <strong>23
cycles</strong></p>
<p>À 100 MHz : 23 × 10 ns = <strong>230 ns</strong></p>
<hr />
<h2 data-number="1.13" id="chapitre-13-concepts-avancés"><span class="header-section-number">1.13</span> Chapitre 13 : Concepts
Avancés</h2>
<h3 data-number="1.13.1" id="q1.-quelle-est-la-différence-entre-linking-statique-et-dynamique"><span class="header-section-number">1.13.1</span> Q1. Quelle est la différence
entre linking statique et dynamique ?</h3>
<p><strong>Linking statique</strong> : - Tout le code des bibliothèques
est copié dans l’exécutable - Fichier volumineux mais autonome - Pas de
dépendance externe au runtime</p>
<p><strong>Linking dynamique</strong> : - L’exécutable contient des
références aux bibliothèques (.so/.dll) - Résolution au chargement ou à
la première utilisation (lazy) - Fichier petit, bibliothèques partagées
entre programmes - Mises à jour possibles sans recompiler</p>
<h3 data-number="1.13.2" id="q2.-quest-ce-que-la-table-des-symboles-dans-un-fichier-objet"><span class="header-section-number">1.13.2</span> Q2. Qu’est-ce que la table
des symboles dans un fichier objet ?</h3>
<p>La table des symboles liste tous les <strong>noms</strong>
(fonctions, variables globales) du fichier : - <strong>Symboles
définis</strong> : Implémentés dans ce fichier (avec adresse) -
<strong>Symboles indéfinis</strong> : Référencés mais définis ailleurs
(à résoudre par le linker) - <strong>Attributs</strong> : Global/local,
taille, type (fonction, donnée)</p>
<p>Le linker utilise cette table pour résoudre les références entre
fichiers.</p>
<h3 data-number="1.13.3" id="q3.-que-fait-le-préprocesseur-avec-include-et-define"><span class="header-section-number">1.13.3</span> Q3. Que fait le
préprocesseur avec <code>#include</code> et <code>#define</code> ?</h3>
<p><strong><code>#include</code></strong> : Copie textuellement le
contenu du fichier inclus à cet endroit.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span><span class="pp">   </span><span class="co">// Cherche dans /usr/include/</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&quot;myfile.h&quot;</span><span class="pp">  </span><span class="co">// Cherche dans le répertoire courant</span></span></code></pre></div>
<p><strong><code>#define</code></strong> : Définit une macro de
substitution textuelle.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#define MAX </span><span class="dv">100</span><span class="pp">          </span><span class="co">// MAX → 100 partout</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="pp">#define SQUARE</span><span class="op">(</span><span class="pp">x</span><span class="op">)</span><span class="pp"> </span><span class="op">((</span><span class="pp">x</span><span class="op">)*(</span><span class="pp">x</span><span class="op">))</span><span class="pp">  </span><span class="co">// SQUARE(5) → ((5)*(5))</span></span></code></pre></div>
<p>Ces opérations sont purement textuelles, avant la compilation.</p>
<h3 data-number="1.13.4" id="q4.-expliquez-le-concept-de-stack-unwinding-lors-dune-exception."><span class="header-section-number">1.13.4</span> Q4. Expliquez le concept de
“stack unwinding” lors d’une exception.</h3>
<p>Le <strong>stack unwinding</strong> est le processus de recherche
d’un handler :</p>
<ol type="1">
<li>Une exception est levée (throw)</li>
<li>Le runtime remonte la pile d’appels</li>
<li>Pour chaque fonction :
<ul>
<li>Vérifie s’il y a un catch compatible</li>
<li>Si non, appelle les destructeurs des objets locaux</li>
<li>Continue à remonter</li>
</ul></li>
<li>Si un catch est trouvé, le contrôle y est transféré</li>
<li>Sinon, le programme termine (unhandled exception)</li>
</ol>
<p>Ce processus garantit que les ressources sont libérées même en cas
d’erreur.</p>
<h3 data-number="1.13.5" id="q5.-quelle-est-la-différence-entre-un-processus-et-un-thread"><span class="header-section-number">1.13.5</span> Q5. Quelle est la différence
entre un processus et un thread ?</h3>
<p><strong>Processus</strong> : - Espace mémoire isolé (protection MMU)
- Ressources propres (file descriptors, etc.) - Communication via IPC
(pipes, sockets, shared memory) - Création coûteuse (fork)</p>
<p><strong>Thread</strong> : - Partage l’espace mémoire du processus
parent - Pile et registres propres uniquement - Communication directe
(variables partagées) - Création légère - Nécessite synchronisation
(mutex)</p>
<h3 data-number="1.13.6" id="q6.-quest-ce-quune-race-condition-et-comment-léviter"><span class="header-section-number">1.13.6</span> Q6. Qu’est-ce qu’une race
condition et comment l’éviter ?</h3>
<p>Une <strong>race condition</strong> se produit quand le résultat d’un
programme dépend de l’ordre d’exécution de threads concurrents accédant
à des données partagées.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Thread A et B exécutent simultanément :</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>counter<span class="op">++;</span>  <span class="co">// LOAD → ADD → STORE (non atomique)</span></span></code></pre></div>
<p><strong>Solutions</strong> : 1. <strong>Mutex</strong> : Verrouiller
l’accès aux données partagées 2. <strong>Opérations atomiques</strong> :
Instructions indivisibles 3. <strong>Thread-local storage</strong> :
Chaque thread a sa copie 4. <strong>Immutabilité</strong> : Données qui
ne changent pas 5. <strong>Message passing</strong> : Pas de mémoire
partagée</p>
<h3 data-number="1.13.7" id="q7.-quest-ce-quun-deadlock-donnez-les-quatre-conditions-nécessaires."><span class="header-section-number">1.13.7</span> Q7. Qu’est-ce qu’un deadlock
? Donnez les quatre conditions nécessaires.</h3>
<p>Un <strong>deadlock</strong> est une situation où deux ou plusieurs
threads s’attendent mutuellement indéfiniment.</p>
<p>Les <strong>quatre conditions</strong> (Coffman) : 1.
<strong>Exclusion mutuelle</strong> : La ressource ne peut être utilisée
que par un thread à la fois 2. <strong>Hold and wait</strong> : Un
thread garde une ressource tout en attendant une autre 3. <strong>Pas de
préemption</strong> : Les ressources ne peuvent pas être retirées de
force 4. <strong>Attente circulaire</strong> : A attend B, B attend C, C
attend A</p>
<p>Pour éviter les deadlocks, éliminer l’une de ces conditions (souvent
l’attente circulaire via un ordre d’acquisition fixe).</p>
<h3 data-number="1.13.8" id="q8.-pourquoi-les-opérations-atomiques-sont-elles-nécessaires-pour-les-mutex"><span class="header-section-number">1.13.8</span> Q8. Pourquoi les opérations
atomiques sont-elles nécessaires pour les mutex ?</h3>
<p>L’acquisition d’un mutex doit être <strong>atomique</strong>
(indivisible) pour éviter que deux threads ne l’acquièrent simultanément
:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">// MAUVAIS (non atomique) :</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span>lock <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span>    <span class="co">// Thread A lit 0</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    lock <span class="op">=</span> <span class="dv">1</span><span class="op">;</span>       <span class="co">// Thread B lit aussi 0 avant A n&#39;écrive !</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co">// Les deux threads croient avoir le lock !</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co">// BON (atomique) :</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co">// Test-and-Set en une seule instruction</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span>atomic_exchange<span class="op">(&amp;</span>lock<span class="op">,</span> <span class="dv">1</span><span class="op">)</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Lock acquis</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>Les instructions comme <code>LDREX/STREX</code> (ARM) ou
<code>CMPXCHG</code> (x86) garantissent l’atomicité.</p>
<h3 data-number="1.13.9" id="exercice-2-linking-manuel"><span class="header-section-number">1.13.9</span> Exercice 2 : Linking
Manuel</h3>
<ol type="1">
<li><code>gcc -c main.c -c math.c</code> crée main.o et math.o</li>
<li><code>nm main.o</code> montre : <code>main (T)</code>,
<code>add (U)</code> (undefined)</li>
<li><code>nm math.o</code> montre : <code>add (T)</code>
(text/defined)</li>
<li><code>ld main.o math.o -o prog</code> échoue car :
<ul>
<li><code>_start</code> manque (point d’entrée standard)</li>
<li>Pas de code d’initialisation C (crt0)</li>
<li>Pas de libc (exit, etc.)</li>
</ul></li>
</ol>
<p><strong>Solution</strong> : Utiliser gcc pour le link final qui
ajoute automatiquement crt0.o et -lc.</p>
<h3 data-number="1.13.10" id="exercice-3-exceptions-en-c"><span class="header-section-number">1.13.10</span> Exercice 3 : Exceptions en
C</h3>
<div class="sourceCode" id="cb19"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;setjmp.h&gt;</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="dt">static</span> jmp_buf __exception_env<span class="op">;</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="dt">static</span> <span class="dt">int</span> __exception_code<span class="op">;</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="pp">#define TRY </span><span class="cf">if</span><span class="pp"> </span><span class="op">(</span><span class="pp">setjmp</span><span class="op">(</span><span class="pp">__exception_env</span><span class="op">)</span><span class="pp"> </span><span class="op">==</span><span class="pp"> </span><span class="dv">0</span><span class="op">)</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="pp">#define CATCH</span><span class="op">(</span><span class="pp">code</span><span class="op">)</span><span class="pp"> </span><span class="cf">else</span><span class="pp"> </span><span class="op">{</span><span class="pp"> </span><span class="dt">int</span><span class="pp"> code </span><span class="op">=</span><span class="pp"> __exception_code</span><span class="op">;</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="pp">#define END_TRY </span><span class="op">}</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="pp">#define THROW</span><span class="op">(</span><span class="pp">code</span><span class="op">)</span><span class="pp"> </span><span class="cf">do</span><span class="pp"> </span><span class="op">{</span><span class="pp"> __exception_code </span><span class="op">=</span><span class="pp"> </span><span class="op">(</span><span class="pp">code</span><span class="op">);</span><span class="pp"> longjmp</span><span class="op">(</span><span class="pp">__exception_env</span><span class="op">,</span><span class="pp"> </span><span class="dv">1</span><span class="op">);</span><span class="pp"> </span><span class="op">}</span><span class="pp"> </span><span class="cf">while</span><span class="op">(</span><span class="dv">0</span><span class="op">)</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="co">// Utilisation :</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>TRY <span class="op">{</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>error<span class="op">)</span> THROW<span class="op">(</span><span class="dv">42</span><span class="op">);</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>    do_work<span class="op">();</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> CATCH<span class="op">(</span>code<span class="op">)</span> <span class="op">{</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>    printf<span class="op">(</span><span class="st">&quot;Exception </span><span class="sc">%d\n</span><span class="st">&quot;</span><span class="op">,</span> code<span class="op">);</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> END_TRY<span class="op">;</span></span></code></pre></div>
<p><strong>Limitation</strong> : Ne gère qu’un niveau de try/catch. Pour
le nesting, utiliser une pile de jmp_buf.</p>
<h3 data-number="1.13.11" id="exercice-5-détection-de-deadlock"><span class="header-section-number">1.13.11</span> Exercice 5 : Détection de
Deadlock</h3>
<pre><code>Thread A : lock(m1) → lock(m2)
Thread B : lock(m2) → lock(m3)
Thread C : lock(m3) → lock(m1)</code></pre>
<p><strong>Graphe de dépendance</strong> :</p>
<pre><code>m1 ──→ m2 ──→ m3
 ↑            │
 └────────────┘</code></pre>
<p><strong>Oui, deadlock possible</strong> si : - A acquiert m1, attend
m2 - B acquiert m2, attend m3 - C acquiert m3, attend m1 (cycle !)</p>
<p><strong>Solution</strong> : Ordre fixe d’acquisition. Toujours
acquérir dans l’ordre m1 → m2 → m3.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span><span class="op">*</span> thread_c<span class="op">(</span><span class="dt">void</span><span class="op">*</span> arg<span class="op">)</span> <span class="op">{</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    lock<span class="op">(&amp;</span>m1<span class="op">);</span> lock<span class="op">(&amp;</span>m3<span class="op">);</span>  <span class="co">// m1 AVANT m3 maintenant</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    work<span class="op">();</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    unlock<span class="op">(&amp;</span>m3<span class="op">);</span> unlock<span class="op">(&amp;</span>m1<span class="op">);</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h1 data-number="2" id="livre-des-solutions"><span class="header-section-number">2</span> Livre des Solutions</h1>
<p>Ce document contient les solutions completes de tous les exercices du
simulateur web nand2c.</p>
<p><strong>Note:</strong> Ces solutions sont fournies pour reference
apres avoir tente les exercices.</p>
<hr />
<h2 data-number="2.1" id="a.-solutions-hdl-portes-logiques"><span class="header-section-number">2.1</span> A. Solutions HDL (Portes
Logiques)</h2>
<h3 data-number="2.1.1" id="inv"><span class="header-section-number">2.1.1</span> Inv</h3>
<div class="sourceCode" id="cb23"><pre class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Inverter (NOT gate)</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co">-- Inv(a) = Nand(a, a)</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="cf">entity</span> <span class="dv">Inv</span> <span class="kw">is</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">port</span>(</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="cf">end entity;</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">rtl</span> <span class="kw">of</span> <span class="fu">Inv</span> <span class="kw">is</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">nand2</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; b <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; y <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u0</span><span class="ot">:</span> <span class="fu">nand2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a<span class="ot">,</span> b <span class="ot">=&gt;</span> a<span class="ot">,</span> y <span class="ot">=&gt;</span> y);</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a><span class="cf">end architecture;</span></span></code></pre></div>
<hr />
<h3 data-number="2.1.2" id="and2"><span class="header-section-number">2.1.2</span> And2</h3>
<div class="sourceCode" id="cb24"><pre class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- AND gate</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co">-- And2(a,b) = Inv(Nand(a,b))</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="cf">entity</span> <span class="dv">And2</span> <span class="kw">is</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">port</span>(</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    b <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="cf">end entity;</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">rtl</span> <span class="kw">of</span> <span class="fu">And2</span> <span class="kw">is</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">nand2</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; b <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; y <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">Inv</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; y <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> t <span class="ot">:</span> <span class="dt">bit</span>;</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u0</span><span class="ot">:</span> <span class="fu">nand2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a<span class="ot">,</span> b <span class="ot">=&gt;</span> b<span class="ot">,</span> y <span class="ot">=&gt;</span> t);</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u1</span><span class="ot">:</span> <span class="fu">Inv</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> t<span class="ot">,</span> y <span class="ot">=&gt;</span> y);</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a><span class="cf">end architecture;</span></span></code></pre></div>
<hr />
<h3 data-number="2.1.3" id="or2"><span class="header-section-number">2.1.3</span> Or2</h3>
<div class="sourceCode" id="cb25"><pre class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- OR gate</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co">-- Or2(a,b) = Nand(Inv(a), Inv(b))</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="cf">entity</span> <span class="dv">Or2</span> <span class="kw">is</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">port</span>(</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    b <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="cf">end entity;</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">rtl</span> <span class="kw">of</span> <span class="fu">Or2</span> <span class="kw">is</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">nand2</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; b <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; y <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">Inv</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; y <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> na<span class="ot">,</span> nb <span class="ot">:</span> <span class="dt">bit</span>;</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u0</span><span class="ot">:</span> <span class="fu">Inv</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a<span class="ot">,</span> y <span class="ot">=&gt;</span> na);</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u1</span><span class="ot">:</span> <span class="fu">Inv</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> b<span class="ot">,</span> y <span class="ot">=&gt;</span> nb);</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u2</span><span class="ot">:</span> <span class="fu">nand2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> na<span class="ot">,</span> b <span class="ot">=&gt;</span> nb<span class="ot">,</span> y <span class="ot">=&gt;</span> y);</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a><span class="cf">end architecture;</span></span></code></pre></div>
<hr />
<h3 data-number="2.1.4" id="xor2"><span class="header-section-number">2.1.4</span> Xor2</h3>
<div class="sourceCode" id="cb26"><pre class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- XOR gate</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="co">-- Xor2(a,b) = Or2(And2(a, Inv(b)), And2(Inv(a), b))</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="cf">entity</span> <span class="dv">Xor2</span> <span class="kw">is</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">port</span>(</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    b <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="cf">end entity;</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">rtl</span> <span class="kw">of</span> <span class="fu">Xor2</span> <span class="kw">is</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">Inv</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; y <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">And2</span></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; b <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; y <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">Or2</span></span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; b <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; y <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> na<span class="ot">,</span> nb<span class="ot">,</span> t1<span class="ot">,</span> t2 <span class="ot">:</span> <span class="dt">bit</span>;</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u0</span><span class="ot">:</span> <span class="fu">Inv</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a<span class="ot">,</span> y <span class="ot">=&gt;</span> na);</span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u1</span><span class="ot">:</span> <span class="fu">Inv</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> b<span class="ot">,</span> y <span class="ot">=&gt;</span> nb);</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u2</span><span class="ot">:</span> <span class="fu">And2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a<span class="ot">,</span> b <span class="ot">=&gt;</span> nb<span class="ot">,</span> y <span class="ot">=&gt;</span> t1);</span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u3</span><span class="ot">:</span> <span class="fu">And2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> na<span class="ot">,</span> b <span class="ot">=&gt;</span> b<span class="ot">,</span> y <span class="ot">=&gt;</span> t2);</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u4</span><span class="ot">:</span> <span class="fu">Or2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> t1<span class="ot">,</span> b <span class="ot">=&gt;</span> t2<span class="ot">,</span> y <span class="ot">=&gt;</span> y);</span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a><span class="cf">end architecture;</span></span></code></pre></div>
<hr />
<h3 data-number="2.1.5" id="mux"><span class="header-section-number">2.1.5</span> Mux</h3>
<div class="sourceCode" id="cb27"><pre class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 2-way Multiplexer</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co">-- if sel=0 then y=a else y=b</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="cf">entity</span> <span class="dv">Mux</span> <span class="kw">is</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">port</span>(</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    a   <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    b   <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    sel <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    y   <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="cf">end entity;</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">rtl</span> <span class="kw">of</span> <span class="fu">Mux</span> <span class="kw">is</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">Inv</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; y <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">And2</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; b <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; y <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">Or2</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; b <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; y <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> nsel<span class="ot">,</span> t1<span class="ot">,</span> t2 <span class="ot">:</span> <span class="dt">bit</span>;</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u0</span><span class="ot">:</span> <span class="fu">Inv</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> sel<span class="ot">,</span> y <span class="ot">=&gt;</span> nsel);</span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u1</span><span class="ot">:</span> <span class="fu">And2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a<span class="ot">,</span> b <span class="ot">=&gt;</span> nsel<span class="ot">,</span> y <span class="ot">=&gt;</span> t1);</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u2</span><span class="ot">:</span> <span class="fu">And2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> b<span class="ot">,</span> b <span class="ot">=&gt;</span> sel<span class="ot">,</span> y <span class="ot">=&gt;</span> t2);</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u3</span><span class="ot">:</span> <span class="fu">Or2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> t1<span class="ot">,</span> b <span class="ot">=&gt;</span> t2<span class="ot">,</span> y <span class="ot">=&gt;</span> y);</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a><span class="cf">end architecture;</span></span></code></pre></div>
<hr />
<h3 data-number="2.1.6" id="dmux"><span class="header-section-number">2.1.6</span> DMux</h3>
<div class="sourceCode" id="cb28"><pre class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Demultiplexer</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="co">-- if sel=0 then {a,b}={x,0} else {a,b}={0,x}</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="cf">entity</span> <span class="dv">DMux</span> <span class="kw">is</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">port</span>(</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    x   <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    sel <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    a   <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>;</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    b   <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="cf">end entity;</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">rtl</span> <span class="kw">of</span> <span class="fu">DMux</span> <span class="kw">is</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">Inv</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; y <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">And2</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; b <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; y <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> nsel <span class="ot">:</span> <span class="dt">bit</span>;</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u0</span><span class="ot">:</span> <span class="fu">Inv</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> sel<span class="ot">,</span> y <span class="ot">=&gt;</span> nsel);</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u1</span><span class="ot">:</span> <span class="fu">And2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> x<span class="ot">,</span> b <span class="ot">=&gt;</span> nsel<span class="ot">,</span> y <span class="ot">=&gt;</span> a);</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u2</span><span class="ot">:</span> <span class="fu">And2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> x<span class="ot">,</span> b <span class="ot">=&gt;</span> sel<span class="ot">,</span> y <span class="ot">=&gt;</span> b);</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a><span class="cf">end architecture;</span></span></code></pre></div>
<hr />
<h3 data-number="2.1.7" id="inv16"><span class="header-section-number">2.1.7</span> Inv16</h3>
<div class="sourceCode" id="cb29"><pre class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 16-bit Inverter</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="cf">entity</span> <span class="dv">Inv16</span> <span class="kw">is</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">port</span>(</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="cf">end entity;</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">rtl</span> <span class="kw">of</span> <span class="fu">Inv16</span> <span class="kw">is</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">Inv</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; y <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u0</span><span class="ot">:</span> <span class="fu">Inv</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">0</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">0</span>));</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u1</span><span class="ot">:</span> <span class="fu">Inv</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">1</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">1</span>));</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u2</span><span class="ot">:</span> <span class="fu">Inv</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">2</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">2</span>));</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u3</span><span class="ot">:</span> <span class="fu">Inv</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">3</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">3</span>));</span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u4</span><span class="ot">:</span> <span class="fu">Inv</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">4</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">4</span>));</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u5</span><span class="ot">:</span> <span class="fu">Inv</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">5</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">5</span>));</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u6</span><span class="ot">:</span> <span class="fu">Inv</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">6</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">6</span>));</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u7</span><span class="ot">:</span> <span class="fu">Inv</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">7</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">7</span>));</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u8</span><span class="ot">:</span> <span class="fu">Inv</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">8</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">8</span>));</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u9</span><span class="ot">:</span> <span class="fu">Inv</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">9</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">9</span>));</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u10</span><span class="ot">:</span> <span class="fu">Inv</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">10</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">10</span>));</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u11</span><span class="ot">:</span> <span class="fu">Inv</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">11</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">11</span>));</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u12</span><span class="ot">:</span> <span class="fu">Inv</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">12</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">12</span>));</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u13</span><span class="ot">:</span> <span class="fu">Inv</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">13</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">13</span>));</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u14</span><span class="ot">:</span> <span class="fu">Inv</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">14</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">14</span>));</span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u15</span><span class="ot">:</span> <span class="fu">Inv</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">15</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">15</span>));</span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a><span class="cf">end architecture;</span></span></code></pre></div>
<hr />
<h3 data-number="2.1.8" id="and16"><span class="header-section-number">2.1.8</span> And16</h3>
<div class="sourceCode" id="cb30"><pre class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 16-bit AND</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="cf">entity</span> <span class="dv">And16</span> <span class="kw">is</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">port</span>(</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    b <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="cf">end entity;</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">rtl</span> <span class="kw">of</span> <span class="fu">And16</span> <span class="kw">is</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">And2</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; b <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; y <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u0</span><span class="ot">:</span> <span class="fu">And2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">0</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">0</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">0</span>));</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u1</span><span class="ot">:</span> <span class="fu">And2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">1</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">1</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">1</span>));</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u2</span><span class="ot">:</span> <span class="fu">And2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">2</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">2</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">2</span>));</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u3</span><span class="ot">:</span> <span class="fu">And2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">3</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">3</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">3</span>));</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u4</span><span class="ot">:</span> <span class="fu">And2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">4</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">4</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">4</span>));</span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u5</span><span class="ot">:</span> <span class="fu">And2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">5</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">5</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">5</span>));</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u6</span><span class="ot">:</span> <span class="fu">And2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">6</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">6</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">6</span>));</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u7</span><span class="ot">:</span> <span class="fu">And2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">7</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">7</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">7</span>));</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u8</span><span class="ot">:</span> <span class="fu">And2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">8</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">8</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">8</span>));</span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u9</span><span class="ot">:</span> <span class="fu">And2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">9</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">9</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">9</span>));</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u10</span><span class="ot">:</span> <span class="fu">And2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">10</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">10</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">10</span>));</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u11</span><span class="ot">:</span> <span class="fu">And2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">11</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">11</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">11</span>));</span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u12</span><span class="ot">:</span> <span class="fu">And2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">12</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">12</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">12</span>));</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u13</span><span class="ot">:</span> <span class="fu">And2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">13</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">13</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">13</span>));</span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u14</span><span class="ot">:</span> <span class="fu">And2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">14</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">14</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">14</span>));</span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u15</span><span class="ot">:</span> <span class="fu">And2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">15</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">15</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">15</span>));</span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a><span class="cf">end architecture;</span></span></code></pre></div>
<hr />
<h3 data-number="2.1.9" id="or16"><span class="header-section-number">2.1.9</span> Or16</h3>
<div class="sourceCode" id="cb31"><pre class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 16-bit OR</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="cf">entity</span> <span class="dv">Or16</span> <span class="kw">is</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">port</span>(</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    b <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="cf">end entity;</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">rtl</span> <span class="kw">of</span> <span class="fu">Or16</span> <span class="kw">is</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">Or2</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; b <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; y <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u0</span><span class="ot">:</span> <span class="fu">Or2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">0</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">0</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">0</span>));</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u1</span><span class="ot">:</span> <span class="fu">Or2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">1</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">1</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">1</span>));</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u2</span><span class="ot">:</span> <span class="fu">Or2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">2</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">2</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">2</span>));</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u3</span><span class="ot">:</span> <span class="fu">Or2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">3</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">3</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">3</span>));</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u4</span><span class="ot">:</span> <span class="fu">Or2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">4</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">4</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">4</span>));</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u5</span><span class="ot">:</span> <span class="fu">Or2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">5</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">5</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">5</span>));</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u6</span><span class="ot">:</span> <span class="fu">Or2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">6</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">6</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">6</span>));</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u7</span><span class="ot">:</span> <span class="fu">Or2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">7</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">7</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">7</span>));</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u8</span><span class="ot">:</span> <span class="fu">Or2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">8</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">8</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">8</span>));</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u9</span><span class="ot">:</span> <span class="fu">Or2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">9</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">9</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">9</span>));</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u10</span><span class="ot">:</span> <span class="fu">Or2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">10</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">10</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">10</span>));</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u11</span><span class="ot">:</span> <span class="fu">Or2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">11</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">11</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">11</span>));</span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u12</span><span class="ot">:</span> <span class="fu">Or2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">12</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">12</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">12</span>));</span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u13</span><span class="ot">:</span> <span class="fu">Or2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">13</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">13</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">13</span>));</span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u14</span><span class="ot">:</span> <span class="fu">Or2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">14</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">14</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">14</span>));</span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u15</span><span class="ot">:</span> <span class="fu">Or2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">15</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">15</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">15</span>));</span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a><span class="cf">end architecture;</span></span></code></pre></div>
<hr />
<h3 data-number="2.1.10" id="mux16"><span class="header-section-number">2.1.10</span> Mux16</h3>
<div class="sourceCode" id="cb32"><pre class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 16-bit 2-way Multiplexer</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="cf">entity</span> <span class="dv">Mux16</span> <span class="kw">is</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">port</span>(</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    a   <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>    b   <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    sel <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    y   <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="cf">end entity;</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">rtl</span> <span class="kw">of</span> <span class="fu">Mux16</span> <span class="kw">is</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">Mux</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; b <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; sel <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; y <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u0</span><span class="ot">:</span> <span class="fu">Mux</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">0</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">0</span>)<span class="ot">,</span> sel <span class="ot">=&gt;</span> sel<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">0</span>));</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u1</span><span class="ot">:</span> <span class="fu">Mux</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">1</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">1</span>)<span class="ot">,</span> sel <span class="ot">=&gt;</span> sel<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">1</span>));</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u2</span><span class="ot">:</span> <span class="fu">Mux</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">2</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">2</span>)<span class="ot">,</span> sel <span class="ot">=&gt;</span> sel<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">2</span>));</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u3</span><span class="ot">:</span> <span class="fu">Mux</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">3</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">3</span>)<span class="ot">,</span> sel <span class="ot">=&gt;</span> sel<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">3</span>));</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u4</span><span class="ot">:</span> <span class="fu">Mux</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">4</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">4</span>)<span class="ot">,</span> sel <span class="ot">=&gt;</span> sel<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">4</span>));</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u5</span><span class="ot">:</span> <span class="fu">Mux</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">5</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">5</span>)<span class="ot">,</span> sel <span class="ot">=&gt;</span> sel<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">5</span>));</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u6</span><span class="ot">:</span> <span class="fu">Mux</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">6</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">6</span>)<span class="ot">,</span> sel <span class="ot">=&gt;</span> sel<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">6</span>));</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u7</span><span class="ot">:</span> <span class="fu">Mux</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">7</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">7</span>)<span class="ot">,</span> sel <span class="ot">=&gt;</span> sel<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">7</span>));</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u8</span><span class="ot">:</span> <span class="fu">Mux</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">8</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">8</span>)<span class="ot">,</span> sel <span class="ot">=&gt;</span> sel<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">8</span>));</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u9</span><span class="ot">:</span> <span class="fu">Mux</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">9</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">9</span>)<span class="ot">,</span> sel <span class="ot">=&gt;</span> sel<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">9</span>));</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u10</span><span class="ot">:</span> <span class="fu">Mux</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">10</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">10</span>)<span class="ot">,</span> sel <span class="ot">=&gt;</span> sel<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">10</span>));</span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u11</span><span class="ot">:</span> <span class="fu">Mux</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">11</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">11</span>)<span class="ot">,</span> sel <span class="ot">=&gt;</span> sel<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">11</span>));</span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u12</span><span class="ot">:</span> <span class="fu">Mux</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">12</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">12</span>)<span class="ot">,</span> sel <span class="ot">=&gt;</span> sel<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">12</span>));</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u13</span><span class="ot">:</span> <span class="fu">Mux</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">13</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">13</span>)<span class="ot">,</span> sel <span class="ot">=&gt;</span> sel<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">13</span>));</span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u14</span><span class="ot">:</span> <span class="fu">Mux</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">14</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">14</span>)<span class="ot">,</span> sel <span class="ot">=&gt;</span> sel<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">14</span>));</span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u15</span><span class="ot">:</span> <span class="fu">Mux</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">15</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">15</span>)<span class="ot">,</span> sel <span class="ot">=&gt;</span> sel<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">15</span>));</span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a><span class="cf">end architecture;</span></span></code></pre></div>
<hr />
<h3 data-number="2.1.11" id="or8way"><span class="header-section-number">2.1.11</span> Or8Way</h3>
<div class="sourceCode" id="cb33"><pre class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 8-way OR</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="cf">entity</span> <span class="dv">Or8Way</span> <span class="kw">is</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">port</span>(</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">7</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="cf">end entity;</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">rtl</span> <span class="kw">of</span> <span class="fu">Or8Way</span> <span class="kw">is</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">Or2</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; b <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; y <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> t1<span class="ot">,</span> t2<span class="ot">,</span> t3<span class="ot">,</span> t4<span class="ot">,</span> t5<span class="ot">,</span> t6 <span class="ot">:</span> <span class="dt">bit</span>;</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u0</span><span class="ot">:</span> <span class="fu">Or2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">0</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> a(<span class="dv">1</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> t1);</span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u1</span><span class="ot">:</span> <span class="fu">Or2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">2</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> a(<span class="dv">3</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> t2);</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u2</span><span class="ot">:</span> <span class="fu">Or2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">4</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> a(<span class="dv">5</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> t3);</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u3</span><span class="ot">:</span> <span class="fu">Or2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">6</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> a(<span class="dv">7</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> t4);</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u4</span><span class="ot">:</span> <span class="fu">Or2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> t1<span class="ot">,</span> b <span class="ot">=&gt;</span> t2<span class="ot">,</span> y <span class="ot">=&gt;</span> t5);</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u5</span><span class="ot">:</span> <span class="fu">Or2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> t3<span class="ot">,</span> b <span class="ot">=&gt;</span> t4<span class="ot">,</span> y <span class="ot">=&gt;</span> t6);</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u6</span><span class="ot">:</span> <span class="fu">Or2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> t5<span class="ot">,</span> b <span class="ot">=&gt;</span> t6<span class="ot">,</span> y <span class="ot">=&gt;</span> y);</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a><span class="cf">end architecture;</span></span></code></pre></div>
<hr />
<h3 data-number="2.1.12" id="mux4way16"><span class="header-section-number">2.1.12</span> Mux4Way16</h3>
<div class="sourceCode" id="cb34"><pre class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 4-way 16-bit Multiplexer</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="cf">entity</span> <span class="dv">Mux4Way16</span> <span class="kw">is</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">port</span>(</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    a   <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    b   <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>    c   <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>    d   <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>    sel <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">1</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>    y   <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>)</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="cf">end entity;</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">rtl</span> <span class="kw">of</span> <span class="fu">Mux4Way16</span> <span class="kw">is</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">Mux16</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>); b <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>); sel <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; y <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>));</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> ab<span class="ot">,</span> cd <span class="ot">:</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u0</span><span class="ot">:</span> <span class="fu">Mux16</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a<span class="ot">,</span> b <span class="ot">=&gt;</span> b<span class="ot">,</span> sel <span class="ot">=&gt;</span> sel(<span class="dv">0</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> ab);</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u1</span><span class="ot">:</span> <span class="fu">Mux16</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> c<span class="ot">,</span> b <span class="ot">=&gt;</span> d<span class="ot">,</span> sel <span class="ot">=&gt;</span> sel(<span class="dv">0</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> cd);</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u2</span><span class="ot">:</span> <span class="fu">Mux16</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> ab<span class="ot">,</span> b <span class="ot">=&gt;</span> cd<span class="ot">,</span> sel <span class="ot">=&gt;</span> sel(<span class="dv">1</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> y);</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a><span class="cf">end architecture;</span></span></code></pre></div>
<hr />
<h3 data-number="2.1.13" id="mux8way16"><span class="header-section-number">2.1.13</span> Mux8Way16</h3>
<div class="sourceCode" id="cb35"><pre class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 8-way 16-bit Multiplexer</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="cf">entity</span> <span class="dv">Mux8Way16</span> <span class="kw">is</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">port</span>(</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    a   <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    b   <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    c   <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>    d   <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    e   <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>    f   <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>    g   <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>    h   <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>    sel <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">2</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>    y   <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>)</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a><span class="cf">end entity;</span></span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">rtl</span> <span class="kw">of</span> <span class="fu">Mux8Way16</span> <span class="kw">is</span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">Mux4Way16</span></span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a<span class="ot">,</span>b<span class="ot">,</span>c<span class="ot">,</span>d <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>); sel <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">1</span> <span class="ot">downto</span> <span class="dv">0</span>); y <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>));</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">Mux16</span></span>
<span id="cb35-22"><a href="#cb35-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>); b <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>); sel <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; y <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>));</span>
<span id="cb35-23"><a href="#cb35-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb35-24"><a href="#cb35-24" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> lo<span class="ot">,</span> hi <span class="ot">:</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb35-25"><a href="#cb35-25" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb35-26"><a href="#cb35-26" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u0</span><span class="ot">:</span> <span class="fu">Mux4Way16</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a<span class="ot">,</span> b <span class="ot">=&gt;</span> b<span class="ot">,</span> c <span class="ot">=&gt;</span> c<span class="ot">,</span> d <span class="ot">=&gt;</span> d<span class="ot">,</span> sel <span class="ot">=&gt;</span> sel(<span class="dv">1</span> <span class="ot">downto</span> <span class="dv">0</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> lo);</span>
<span id="cb35-27"><a href="#cb35-27" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u1</span><span class="ot">:</span> <span class="fu">Mux4Way16</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> e<span class="ot">,</span> b <span class="ot">=&gt;</span> f<span class="ot">,</span> c <span class="ot">=&gt;</span> g<span class="ot">,</span> d <span class="ot">=&gt;</span> h<span class="ot">,</span> sel <span class="ot">=&gt;</span> sel(<span class="dv">1</span> <span class="ot">downto</span> <span class="dv">0</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> hi);</span>
<span id="cb35-28"><a href="#cb35-28" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u2</span><span class="ot">:</span> <span class="fu">Mux16</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> lo<span class="ot">,</span> b <span class="ot">=&gt;</span> hi<span class="ot">,</span> sel <span class="ot">=&gt;</span> sel(<span class="dv">2</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> y);</span>
<span id="cb35-29"><a href="#cb35-29" aria-hidden="true" tabindex="-1"></a><span class="cf">end architecture;</span></span></code></pre></div>
<hr />
<h3 data-number="2.1.14" id="dmux4way"><span class="header-section-number">2.1.14</span> DMux4Way</h3>
<div class="sourceCode" id="cb36"><pre class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 4-way Demultiplexer</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="cf">entity</span> <span class="dv">DMux4Way</span> <span class="kw">is</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">port</span>(</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    x   <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    sel <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">1</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    a   <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>;</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>    b   <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>;</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>    c   <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>;</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>    d   <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a><span class="cf">end entity;</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">rtl</span> <span class="kw">of</span> <span class="fu">DMux4Way</span> <span class="kw">is</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">DMux</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(x <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; sel <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; a <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>; b <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> lo<span class="ot">,</span> hi <span class="ot">:</span> <span class="dt">bit</span>;</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u0</span><span class="ot">:</span> <span class="fu">DMux</span> <span class="kw">port map </span>(x <span class="ot">=&gt;</span> x<span class="ot">,</span> sel <span class="ot">=&gt;</span> sel(<span class="dv">1</span>)<span class="ot">,</span> a <span class="ot">=&gt;</span> lo<span class="ot">,</span> b <span class="ot">=&gt;</span> hi);</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u1</span><span class="ot">:</span> <span class="fu">DMux</span> <span class="kw">port map </span>(x <span class="ot">=&gt;</span> lo<span class="ot">,</span> sel <span class="ot">=&gt;</span> sel(<span class="dv">0</span>)<span class="ot">,</span> a <span class="ot">=&gt;</span> a<span class="ot">,</span> b <span class="ot">=&gt;</span> b);</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u2</span><span class="ot">:</span> <span class="fu">DMux</span> <span class="kw">port map </span>(x <span class="ot">=&gt;</span> hi<span class="ot">,</span> sel <span class="ot">=&gt;</span> sel(<span class="dv">0</span>)<span class="ot">,</span> a <span class="ot">=&gt;</span> c<span class="ot">,</span> b <span class="ot">=&gt;</span> d);</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a><span class="cf">end architecture;</span></span></code></pre></div>
<hr />
<h3 data-number="2.1.15" id="dmux8way"><span class="header-section-number">2.1.15</span> DMux8Way</h3>
<div class="sourceCode" id="cb37"><pre class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 8-way Demultiplexer</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="cf">entity</span> <span class="dv">DMux8Way</span> <span class="kw">is</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">port</span>(</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    x   <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    sel <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">2</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    a<span class="ot">,</span> b<span class="ot">,</span> c<span class="ot">,</span> d<span class="ot">,</span> e<span class="ot">,</span> f<span class="ot">,</span> g<span class="ot">,</span> h <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="cf">end entity;</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">rtl</span> <span class="kw">of</span> <span class="fu">DMux8Way</span> <span class="kw">is</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">DMux</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(x <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; sel <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; a <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>; b <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">DMux4Way</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(x <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; sel <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">1</span> <span class="ot">downto</span> <span class="dv">0</span>); a<span class="ot">,</span>b<span class="ot">,</span>c<span class="ot">,</span>d <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> lo<span class="ot">,</span> hi <span class="ot">:</span> <span class="dt">bit</span>;</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u0</span><span class="ot">:</span> <span class="fu">DMux</span> <span class="kw">port map </span>(x <span class="ot">=&gt;</span> x<span class="ot">,</span> sel <span class="ot">=&gt;</span> sel(<span class="dv">2</span>)<span class="ot">,</span> a <span class="ot">=&gt;</span> lo<span class="ot">,</span> b <span class="ot">=&gt;</span> hi);</span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u1</span><span class="ot">:</span> <span class="fu">DMux4Way</span> <span class="kw">port map </span>(x <span class="ot">=&gt;</span> lo<span class="ot">,</span> sel <span class="ot">=&gt;</span> sel(<span class="dv">1</span> <span class="ot">downto</span> <span class="dv">0</span>)<span class="ot">,</span> a <span class="ot">=&gt;</span> a<span class="ot">,</span> b <span class="ot">=&gt;</span> b<span class="ot">,</span> c <span class="ot">=&gt;</span> c<span class="ot">,</span> d <span class="ot">=&gt;</span> d);</span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u2</span><span class="ot">:</span> <span class="fu">DMux4Way</span> <span class="kw">port map </span>(x <span class="ot">=&gt;</span> hi<span class="ot">,</span> sel <span class="ot">=&gt;</span> sel(<span class="dv">1</span> <span class="ot">downto</span> <span class="dv">0</span>)<span class="ot">,</span> a <span class="ot">=&gt;</span> e<span class="ot">,</span> b <span class="ot">=&gt;</span> f<span class="ot">,</span> c <span class="ot">=&gt;</span> g<span class="ot">,</span> d <span class="ot">=&gt;</span> h);</span>
<span id="cb37-22"><a href="#cb37-22" aria-hidden="true" tabindex="-1"></a><span class="cf">end architecture;</span></span></code></pre></div>
<hr />
<h3 data-number="2.1.16" id="halfadder"><span class="header-section-number">2.1.16</span> HalfAdder</h3>
<div class="sourceCode" id="cb38"><pre class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Half Adder</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="cf">entity</span> <span class="dv">HalfAdder</span> <span class="kw">is</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">port</span>(</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    a     <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    b     <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    sum   <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>;</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>    carry <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="cf">end entity;</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">rtl</span> <span class="kw">of</span> <span class="fu">HalfAdder</span> <span class="kw">is</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">Xor2</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; b <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; y <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">And2</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; b <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; y <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u0</span><span class="ot">:</span> <span class="fu">Xor2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a<span class="ot">,</span> b <span class="ot">=&gt;</span> b<span class="ot">,</span> y <span class="ot">=&gt;</span> sum);</span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u1</span><span class="ot">:</span> <span class="fu">And2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a<span class="ot">,</span> b <span class="ot">=&gt;</span> b<span class="ot">,</span> y <span class="ot">=&gt;</span> carry);</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a><span class="cf">end architecture;</span></span></code></pre></div>
<hr />
<h3 data-number="2.1.17" id="fulladder"><span class="header-section-number">2.1.17</span> FullAdder</h3>
<div class="sourceCode" id="cb39"><pre class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Full Adder</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="cf">entity</span> <span class="dv">FullAdder</span> <span class="kw">is</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">port</span>(</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    a     <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    b     <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>    cin   <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>    sum   <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>;</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>    cout  <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="cf">end entity;</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">rtl</span> <span class="kw">of</span> <span class="fu">FullAdder</span> <span class="kw">is</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">HalfAdder</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; b <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; sum <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>; carry <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">Or2</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; b <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; y <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> s1<span class="ot">,</span> c1<span class="ot">,</span> c2 <span class="ot">:</span> <span class="dt">bit</span>;</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u0</span><span class="ot">:</span> <span class="fu">HalfAdder</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a<span class="ot">,</span> b <span class="ot">=&gt;</span> b<span class="ot">,</span> sum <span class="ot">=&gt;</span> s1<span class="ot">,</span> carry <span class="ot">=&gt;</span> c1);</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u1</span><span class="ot">:</span> <span class="fu">HalfAdder</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> s1<span class="ot">,</span> b <span class="ot">=&gt;</span> cin<span class="ot">,</span> sum <span class="ot">=&gt;</span> sum<span class="ot">,</span> carry <span class="ot">=&gt;</span> c2);</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u2</span><span class="ot">:</span> <span class="fu">Or2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> c1<span class="ot">,</span> b <span class="ot">=&gt;</span> c2<span class="ot">,</span> y <span class="ot">=&gt;</span> cout);</span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a><span class="cf">end architecture;</span></span></code></pre></div>
<hr />
<h3 data-number="2.1.18" id="add16"><span class="header-section-number">2.1.18</span> Add16</h3>
<div class="sourceCode" id="cb40"><pre class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 16-bit Adder</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="cf">entity</span> <span class="dv">Add16</span> <span class="kw">is</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">port</span>(</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    a    <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    b    <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    cin  <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    sum  <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>    cout <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="cf">end entity;</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">rtl</span> <span class="kw">of</span> <span class="fu">Add16</span> <span class="kw">is</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">FullAdder</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a<span class="ot">,</span>b<span class="ot">,</span>cin <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; sum<span class="ot">,</span>cout <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> c <span class="ot">:</span> bits(<span class="dv">16</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u0</span><span class="ot">:</span> <span class="fu">FullAdder</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">0</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">0</span>)<span class="ot">,</span> cin <span class="ot">=&gt;</span> cin<span class="ot">,</span> sum <span class="ot">=&gt;</span> sum(<span class="dv">0</span>)<span class="ot">,</span> cout <span class="ot">=&gt;</span> c(<span class="dv">1</span>));</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u1</span><span class="ot">:</span> <span class="fu">FullAdder</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">1</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">1</span>)<span class="ot">,</span> cin <span class="ot">=&gt;</span> c(<span class="dv">1</span>)<span class="ot">,</span> sum <span class="ot">=&gt;</span> sum(<span class="dv">1</span>)<span class="ot">,</span> cout <span class="ot">=&gt;</span> c(<span class="dv">2</span>));</span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u2</span><span class="ot">:</span> <span class="fu">FullAdder</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">2</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">2</span>)<span class="ot">,</span> cin <span class="ot">=&gt;</span> c(<span class="dv">2</span>)<span class="ot">,</span> sum <span class="ot">=&gt;</span> sum(<span class="dv">2</span>)<span class="ot">,</span> cout <span class="ot">=&gt;</span> c(<span class="dv">3</span>));</span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u3</span><span class="ot">:</span> <span class="fu">FullAdder</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">3</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">3</span>)<span class="ot">,</span> cin <span class="ot">=&gt;</span> c(<span class="dv">3</span>)<span class="ot">,</span> sum <span class="ot">=&gt;</span> sum(<span class="dv">3</span>)<span class="ot">,</span> cout <span class="ot">=&gt;</span> c(<span class="dv">4</span>));</span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u4</span><span class="ot">:</span> <span class="fu">FullAdder</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">4</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">4</span>)<span class="ot">,</span> cin <span class="ot">=&gt;</span> c(<span class="dv">4</span>)<span class="ot">,</span> sum <span class="ot">=&gt;</span> sum(<span class="dv">4</span>)<span class="ot">,</span> cout <span class="ot">=&gt;</span> c(<span class="dv">5</span>));</span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u5</span><span class="ot">:</span> <span class="fu">FullAdder</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">5</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">5</span>)<span class="ot">,</span> cin <span class="ot">=&gt;</span> c(<span class="dv">5</span>)<span class="ot">,</span> sum <span class="ot">=&gt;</span> sum(<span class="dv">5</span>)<span class="ot">,</span> cout <span class="ot">=&gt;</span> c(<span class="dv">6</span>));</span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u6</span><span class="ot">:</span> <span class="fu">FullAdder</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">6</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">6</span>)<span class="ot">,</span> cin <span class="ot">=&gt;</span> c(<span class="dv">6</span>)<span class="ot">,</span> sum <span class="ot">=&gt;</span> sum(<span class="dv">6</span>)<span class="ot">,</span> cout <span class="ot">=&gt;</span> c(<span class="dv">7</span>));</span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u7</span><span class="ot">:</span> <span class="fu">FullAdder</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">7</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">7</span>)<span class="ot">,</span> cin <span class="ot">=&gt;</span> c(<span class="dv">7</span>)<span class="ot">,</span> sum <span class="ot">=&gt;</span> sum(<span class="dv">7</span>)<span class="ot">,</span> cout <span class="ot">=&gt;</span> c(<span class="dv">8</span>));</span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u8</span><span class="ot">:</span> <span class="fu">FullAdder</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">8</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">8</span>)<span class="ot">,</span> cin <span class="ot">=&gt;</span> c(<span class="dv">8</span>)<span class="ot">,</span> sum <span class="ot">=&gt;</span> sum(<span class="dv">8</span>)<span class="ot">,</span> cout <span class="ot">=&gt;</span> c(<span class="dv">9</span>));</span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u9</span><span class="ot">:</span> <span class="fu">FullAdder</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">9</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">9</span>)<span class="ot">,</span> cin <span class="ot">=&gt;</span> c(<span class="dv">9</span>)<span class="ot">,</span> sum <span class="ot">=&gt;</span> sum(<span class="dv">9</span>)<span class="ot">,</span> cout <span class="ot">=&gt;</span> c(<span class="dv">10</span>));</span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u10</span><span class="ot">:</span> <span class="fu">FullAdder</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">10</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">10</span>)<span class="ot">,</span> cin <span class="ot">=&gt;</span> c(<span class="dv">10</span>)<span class="ot">,</span> sum <span class="ot">=&gt;</span> sum(<span class="dv">10</span>)<span class="ot">,</span> cout <span class="ot">=&gt;</span> c(<span class="dv">11</span>));</span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u11</span><span class="ot">:</span> <span class="fu">FullAdder</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">11</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">11</span>)<span class="ot">,</span> cin <span class="ot">=&gt;</span> c(<span class="dv">11</span>)<span class="ot">,</span> sum <span class="ot">=&gt;</span> sum(<span class="dv">11</span>)<span class="ot">,</span> cout <span class="ot">=&gt;</span> c(<span class="dv">12</span>));</span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u12</span><span class="ot">:</span> <span class="fu">FullAdder</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">12</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">12</span>)<span class="ot">,</span> cin <span class="ot">=&gt;</span> c(<span class="dv">12</span>)<span class="ot">,</span> sum <span class="ot">=&gt;</span> sum(<span class="dv">12</span>)<span class="ot">,</span> cout <span class="ot">=&gt;</span> c(<span class="dv">13</span>));</span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u13</span><span class="ot">:</span> <span class="fu">FullAdder</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">13</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">13</span>)<span class="ot">,</span> cin <span class="ot">=&gt;</span> c(<span class="dv">13</span>)<span class="ot">,</span> sum <span class="ot">=&gt;</span> sum(<span class="dv">13</span>)<span class="ot">,</span> cout <span class="ot">=&gt;</span> c(<span class="dv">14</span>));</span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u14</span><span class="ot">:</span> <span class="fu">FullAdder</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">14</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">14</span>)<span class="ot">,</span> cin <span class="ot">=&gt;</span> c(<span class="dv">14</span>)<span class="ot">,</span> sum <span class="ot">=&gt;</span> sum(<span class="dv">14</span>)<span class="ot">,</span> cout <span class="ot">=&gt;</span> c(<span class="dv">15</span>));</span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u15</span><span class="ot">:</span> <span class="fu">FullAdder</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">15</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">15</span>)<span class="ot">,</span> cin <span class="ot">=&gt;</span> c(<span class="dv">15</span>)<span class="ot">,</span> sum <span class="ot">=&gt;</span> sum(<span class="dv">15</span>)<span class="ot">,</span> cout <span class="ot">=&gt;</span> cout);</span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a><span class="cf">end architecture;</span></span></code></pre></div>
<hr />
<h3 data-number="2.1.19" id="inc16"><span class="header-section-number">2.1.19</span> Inc16</h3>
<div class="sourceCode" id="cb41"><pre class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 16-bit Incrementer</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="cf">entity</span> <span class="dv">Inc16</span> <span class="kw">is</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">port</span>(</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="cf">end entity;</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">rtl</span> <span class="kw">of</span> <span class="fu">Inc16</span> <span class="kw">is</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">Add16</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a<span class="ot">,</span>b <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>); cin <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; sum <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>); cout <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> zero16 <span class="ot">:</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> unused_cout <span class="ot">:</span> <span class="dt">bit</span>;</span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>  zero16 <span class="ot">&lt;=</span> X<span class="st">&quot;0000&quot;</span>;</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u0</span><span class="ot">:</span> <span class="fu">Add16</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a<span class="ot">,</span> b <span class="ot">=&gt;</span> zero16<span class="ot">,</span> cin <span class="ot">=&gt;</span> <span class="bn">&#39;1&#39;</span><span class="ot">,</span> sum <span class="ot">=&gt;</span> y<span class="ot">,</span> cout <span class="ot">=&gt;</span> unused_cout);</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a><span class="cf">end architecture;</span></span></code></pre></div>
<hr />
<h3 data-number="2.1.20" id="sub16"><span class="header-section-number">2.1.20</span> Sub16</h3>
<div class="sourceCode" id="cb42"><pre class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 16-bit Subtractor</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="cf">entity</span> <span class="dv">Sub16</span> <span class="kw">is</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">port</span>(</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    a    <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    b    <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>    diff <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="cf">end entity;</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">rtl</span> <span class="kw">of</span> <span class="fu">Sub16</span> <span class="kw">is</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">Add16</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a<span class="ot">,</span>b <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>); cin <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; sum <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>); cout <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">Inv16</span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>); y <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>));</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> nb <span class="ot">:</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> unused_cout <span class="ot">:</span> <span class="dt">bit</span>;</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u0</span><span class="ot">:</span> <span class="fu">Inv16</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> b<span class="ot">,</span> y <span class="ot">=&gt;</span> nb);</span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u1</span><span class="ot">:</span> <span class="fu">Add16</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a<span class="ot">,</span> b <span class="ot">=&gt;</span> nb<span class="ot">,</span> cin <span class="ot">=&gt;</span> <span class="bn">&#39;1&#39;</span><span class="ot">,</span> sum <span class="ot">=&gt;</span> diff<span class="ot">,</span> cout <span class="ot">=&gt;</span> unused_cout);</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a><span class="cf">end architecture;</span></span></code></pre></div>
<hr />
<h3 data-number="2.1.21" id="alu"><span class="header-section-number">2.1.21</span> ALU</h3>
<div class="sourceCode" id="cb43"><pre class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 16-bit ALU</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="co">-- op: 0=AND, 1=OR, 2=ADD, 3=SUB</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="cf">entity</span> <span class="dv">ALU</span> <span class="kw">is</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">port</span>(</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>    a    <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>    b    <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>    op   <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">1</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>    y    <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>    zero <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>;</span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>    neg  <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a><span class="cf">end entity;</span></span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">rtl</span> <span class="kw">of</span> <span class="fu">ALU</span> <span class="kw">is</span></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">Add16</span></span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a<span class="ot">,</span>b <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>); cin <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; sum <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>); cout <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">And16</span></span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a<span class="ot">,</span>b <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>); y <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>));</span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">Or16</span></span>
<span id="cb43-23"><a href="#cb43-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a<span class="ot">,</span>b <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>); y <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>));</span>
<span id="cb43-24"><a href="#cb43-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb43-25"><a href="#cb43-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">Inv16</span></span>
<span id="cb43-26"><a href="#cb43-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>); y <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>));</span>
<span id="cb43-27"><a href="#cb43-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb43-28"><a href="#cb43-28" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">Mux4Way16</span></span>
<span id="cb43-29"><a href="#cb43-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a<span class="ot">,</span>b<span class="ot">,</span>c<span class="ot">,</span>d <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>); sel <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">1</span> <span class="ot">downto</span> <span class="dv">0</span>); y <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>));</span>
<span id="cb43-30"><a href="#cb43-30" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb43-31"><a href="#cb43-31" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">Or8Way</span></span>
<span id="cb43-32"><a href="#cb43-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">7</span> <span class="ot">downto</span> <span class="dv">0</span>); y <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb43-33"><a href="#cb43-33" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb43-34"><a href="#cb43-34" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> r_and<span class="ot">,</span> r_or<span class="ot">,</span> r_add<span class="ot">,</span> r_sub<span class="ot">,</span> nb<span class="ot">,</span> result <span class="ot">:</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb43-35"><a href="#cb43-35" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> unused_cout1<span class="ot">,</span> unused_cout2 <span class="ot">:</span> <span class="dt">bit</span>;</span>
<span id="cb43-36"><a href="#cb43-36" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> or_lo<span class="ot">,</span> or_hi <span class="ot">:</span> <span class="dt">bit</span>;</span>
<span id="cb43-37"><a href="#cb43-37" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb43-38"><a href="#cb43-38" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Compute all operations</span></span>
<span id="cb43-39"><a href="#cb43-39" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_and</span><span class="ot">:</span> <span class="fu">And16</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a<span class="ot">,</span> b <span class="ot">=&gt;</span> b<span class="ot">,</span> y <span class="ot">=&gt;</span> r_and);</span>
<span id="cb43-40"><a href="#cb43-40" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_or</span><span class="ot">:</span> <span class="fu">Or16</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a<span class="ot">,</span> b <span class="ot">=&gt;</span> b<span class="ot">,</span> y <span class="ot">=&gt;</span> r_or);</span>
<span id="cb43-41"><a href="#cb43-41" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_add</span><span class="ot">:</span> <span class="fu">Add16</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a<span class="ot">,</span> b <span class="ot">=&gt;</span> b<span class="ot">,</span> cin <span class="ot">=&gt;</span> <span class="bn">&#39;0&#39;</span><span class="ot">,</span> sum <span class="ot">=&gt;</span> r_add<span class="ot">,</span> cout <span class="ot">=&gt;</span> unused_cout1);</span>
<span id="cb43-42"><a href="#cb43-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-43"><a href="#cb43-43" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- SUB: a - b = a + (~b) + 1</span></span>
<span id="cb43-44"><a href="#cb43-44" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_inv</span><span class="ot">:</span> <span class="fu">Inv16</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> b<span class="ot">,</span> y <span class="ot">=&gt;</span> nb);</span>
<span id="cb43-45"><a href="#cb43-45" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_sub</span><span class="ot">:</span> <span class="fu">Add16</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a<span class="ot">,</span> b <span class="ot">=&gt;</span> nb<span class="ot">,</span> cin <span class="ot">=&gt;</span> <span class="bn">&#39;1&#39;</span><span class="ot">,</span> sum <span class="ot">=&gt;</span> r_sub<span class="ot">,</span> cout <span class="ot">=&gt;</span> unused_cout2);</span>
<span id="cb43-46"><a href="#cb43-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-47"><a href="#cb43-47" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Select result based on op</span></span>
<span id="cb43-48"><a href="#cb43-48" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_mux</span><span class="ot">:</span> <span class="fu">Mux4Way16</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> r_and<span class="ot">,</span> b <span class="ot">=&gt;</span> r_or<span class="ot">,</span> c <span class="ot">=&gt;</span> r_add<span class="ot">,</span> d <span class="ot">=&gt;</span> r_sub<span class="ot">,</span> sel <span class="ot">=&gt;</span> op<span class="ot">,</span> y <span class="ot">=&gt;</span> result);</span>
<span id="cb43-49"><a href="#cb43-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-50"><a href="#cb43-50" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Output result</span></span>
<span id="cb43-51"><a href="#cb43-51" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;=</span> result;</span>
<span id="cb43-52"><a href="#cb43-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-53"><a href="#cb43-53" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Zero flag: result == 0</span></span>
<span id="cb43-54"><a href="#cb43-54" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_or_lo</span><span class="ot">:</span> <span class="fu">Or8Way</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> result(<span class="dv">7</span> <span class="ot">downto</span> <span class="dv">0</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> or_lo);</span>
<span id="cb43-55"><a href="#cb43-55" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_or_hi</span><span class="ot">:</span> <span class="fu">Or8Way</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> result(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">8</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> or_hi);</span>
<span id="cb43-56"><a href="#cb43-56" aria-hidden="true" tabindex="-1"></a>  zero <span class="ot">&lt;=</span> <span class="kw">not</span> (or_lo <span class="kw">or</span> or_hi);</span>
<span id="cb43-57"><a href="#cb43-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-58"><a href="#cb43-58" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Negative flag: MSB of result</span></span>
<span id="cb43-59"><a href="#cb43-59" aria-hidden="true" tabindex="-1"></a>  neg <span class="ot">&lt;=</span> result(<span class="dv">15</span>);</span>
<span id="cb43-60"><a href="#cb43-60" aria-hidden="true" tabindex="-1"></a><span class="cf">end architecture;</span></span></code></pre></div>
<hr />
<h3 data-number="2.1.22" id="and8"><span class="header-section-number">2.1.22</span> And8</h3>
<div class="sourceCode" id="cb44"><pre class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- AND 8-bit avec masque</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="co">-- Chaque bit de a est ANDé avec le même bit b</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="co">-- Utile pour générer des produits partiels dans un multiplicateur</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="cf">entity</span> <span class="dv">And8</span> <span class="kw">is</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">port</span>(</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">7</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>    b <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">7</span> <span class="ot">downto</span> <span class="dv">0</span>)</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="cf">end entity;</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">rtl</span> <span class="kw">of</span> <span class="fu">And8</span> <span class="kw">is</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">And2</span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; b <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; y <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u0</span><span class="ot">:</span> <span class="fu">And2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">0</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">0</span>));</span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u1</span><span class="ot">:</span> <span class="fu">And2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">1</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">1</span>));</span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u2</span><span class="ot">:</span> <span class="fu">And2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">2</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">2</span>));</span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u3</span><span class="ot">:</span> <span class="fu">And2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">3</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">3</span>));</span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u4</span><span class="ot">:</span> <span class="fu">And2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">4</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">4</span>));</span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u5</span><span class="ot">:</span> <span class="fu">And2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">5</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">5</span>));</span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u6</span><span class="ot">:</span> <span class="fu">And2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">6</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">6</span>));</span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u7</span><span class="ot">:</span> <span class="fu">And2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a(<span class="dv">7</span>)<span class="ot">,</span> b <span class="ot">=&gt;</span> b<span class="ot">,</span> y <span class="ot">=&gt;</span> y(<span class="dv">7</span>));</span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a><span class="cf">end architecture;</span></span></code></pre></div>
<hr />
<h3 data-number="2.1.23" id="mul8"><span class="header-section-number">2.1.23</span> Mul8</h3>
<div class="sourceCode" id="cb45"><pre class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Multiplicateur 8-bit non signé</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="co">-- y = a * b (8-bit × 8-bit = 16-bit)</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="co">--</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="co">-- Algorithme par produits partiels:</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="co">-- Pour chaque bit b[i], on génère pp_i = a AND b[i]</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="co">-- Puis on décale pp_i de i positions vers la gauche</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="co">-- Enfin on additionne tous les produits partiels</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="cf">entity</span> <span class="dv">Mul8</span> <span class="kw">is</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">port</span>(</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">7</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>    b <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">7</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>)</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a><span class="cf">end entity;</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">rtl</span> <span class="kw">of</span> <span class="fu">Mul8</span> <span class="kw">is</span></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">And8</span></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">7</span> <span class="ot">downto</span> <span class="dv">0</span>); b <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; y <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">7</span> <span class="ot">downto</span> <span class="dv">0</span>));</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">Add16</span></span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>); b <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>); cin <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>         sum <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>); cout <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> pp0<span class="ot">,</span> pp1<span class="ot">,</span> pp2<span class="ot">,</span> pp3<span class="ot">,</span> pp4<span class="ot">,</span> pp5<span class="ot">,</span> pp6<span class="ot">,</span> pp7 <span class="ot">:</span> bits(<span class="dv">7</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> ext0<span class="ot">,</span> ext1<span class="ot">,</span> ext2<span class="ot">,</span> ext3<span class="ot">,</span> ext4<span class="ot">,</span> ext5<span class="ot">,</span> ext6<span class="ot">,</span> ext7 <span class="ot">:</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> s01<span class="ot">,</span> s23<span class="ot">,</span> s45<span class="ot">,</span> s67 <span class="ot">:</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> s0123<span class="ot">,</span> s4567 <span class="ot">:</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> c1<span class="ot">,</span> c2<span class="ot">,</span> c3<span class="ot">,</span> c4<span class="ot">,</span> c5<span class="ot">,</span> c6<span class="ot">,</span> c7 <span class="ot">:</span> <span class="dt">bit</span>;</span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Generate partial products</span></span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a>  <span class="dv">and0</span><span class="ot">:</span> <span class="fu">And8</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">0</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> pp0);</span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a>  <span class="dv">and1</span><span class="ot">:</span> <span class="fu">And8</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">1</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> pp1);</span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a>  <span class="dv">and2</span><span class="ot">:</span> <span class="fu">And8</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">2</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> pp2);</span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a>  <span class="dv">and3</span><span class="ot">:</span> <span class="fu">And8</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">3</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> pp3);</span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a>  <span class="dv">and4</span><span class="ot">:</span> <span class="fu">And8</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">4</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> pp4);</span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a>  <span class="dv">and5</span><span class="ot">:</span> <span class="fu">And8</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">5</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> pp5);</span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a>  <span class="dv">and6</span><span class="ot">:</span> <span class="fu">And8</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">6</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> pp6);</span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a>  <span class="dv">and7</span><span class="ot">:</span> <span class="fu">And8</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a<span class="ot">,</span> b <span class="ot">=&gt;</span> b(<span class="dv">7</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> pp7);</span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Extend and shift partial products using concatenation</span></span>
<span id="cb45-45"><a href="#cb45-45" aria-hidden="true" tabindex="-1"></a>  ext0 <span class="ot">&lt;=</span> x<span class="st">&quot;00&quot;</span> <span class="ot">&amp;</span> pp0;</span>
<span id="cb45-46"><a href="#cb45-46" aria-hidden="true" tabindex="-1"></a>  ext1 <span class="ot">&lt;=</span> b<span class="st">&quot;0000000&quot;</span> <span class="ot">&amp;</span> pp1 <span class="ot">&amp;</span> <span class="bn">&#39;0&#39;</span>;</span>
<span id="cb45-47"><a href="#cb45-47" aria-hidden="true" tabindex="-1"></a>  ext2 <span class="ot">&lt;=</span> b<span class="st">&quot;000000&quot;</span> <span class="ot">&amp;</span> pp2 <span class="ot">&amp;</span> b<span class="st">&quot;00&quot;</span>;</span>
<span id="cb45-48"><a href="#cb45-48" aria-hidden="true" tabindex="-1"></a>  ext3 <span class="ot">&lt;=</span> b<span class="st">&quot;00000&quot;</span> <span class="ot">&amp;</span> pp3 <span class="ot">&amp;</span> b<span class="st">&quot;000&quot;</span>;</span>
<span id="cb45-49"><a href="#cb45-49" aria-hidden="true" tabindex="-1"></a>  ext4 <span class="ot">&lt;=</span> x<span class="st">&quot;0&quot;</span> <span class="ot">&amp;</span> pp4 <span class="ot">&amp;</span> x<span class="st">&quot;0&quot;</span>;</span>
<span id="cb45-50"><a href="#cb45-50" aria-hidden="true" tabindex="-1"></a>  ext5 <span class="ot">&lt;=</span> b<span class="st">&quot;000&quot;</span> <span class="ot">&amp;</span> pp5 <span class="ot">&amp;</span> b<span class="st">&quot;00000&quot;</span>;</span>
<span id="cb45-51"><a href="#cb45-51" aria-hidden="true" tabindex="-1"></a>  ext6 <span class="ot">&lt;=</span> b<span class="st">&quot;00&quot;</span> <span class="ot">&amp;</span> pp6 <span class="ot">&amp;</span> b<span class="st">&quot;000000&quot;</span>;</span>
<span id="cb45-52"><a href="#cb45-52" aria-hidden="true" tabindex="-1"></a>  ext7 <span class="ot">&lt;=</span> <span class="bn">&#39;0&#39;</span> <span class="ot">&amp;</span> pp7 <span class="ot">&amp;</span> b<span class="st">&quot;0000000&quot;</span>;</span>
<span id="cb45-53"><a href="#cb45-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-54"><a href="#cb45-54" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Addition en arbre (3 niveaux)</span></span>
<span id="cb45-55"><a href="#cb45-55" aria-hidden="true" tabindex="-1"></a>  <span class="dv">add01</span><span class="ot">:</span> <span class="fu">Add16</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> ext0<span class="ot">,</span> b <span class="ot">=&gt;</span> ext1<span class="ot">,</span> cin <span class="ot">=&gt;</span> <span class="bn">&#39;0&#39;</span><span class="ot">,</span> sum <span class="ot">=&gt;</span> s01<span class="ot">,</span> cout <span class="ot">=&gt;</span> c1);</span>
<span id="cb45-56"><a href="#cb45-56" aria-hidden="true" tabindex="-1"></a>  <span class="dv">add23</span><span class="ot">:</span> <span class="fu">Add16</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> ext2<span class="ot">,</span> b <span class="ot">=&gt;</span> ext3<span class="ot">,</span> cin <span class="ot">=&gt;</span> <span class="bn">&#39;0&#39;</span><span class="ot">,</span> sum <span class="ot">=&gt;</span> s23<span class="ot">,</span> cout <span class="ot">=&gt;</span> c2);</span>
<span id="cb45-57"><a href="#cb45-57" aria-hidden="true" tabindex="-1"></a>  <span class="dv">add45</span><span class="ot">:</span> <span class="fu">Add16</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> ext4<span class="ot">,</span> b <span class="ot">=&gt;</span> ext5<span class="ot">,</span> cin <span class="ot">=&gt;</span> <span class="bn">&#39;0&#39;</span><span class="ot">,</span> sum <span class="ot">=&gt;</span> s45<span class="ot">,</span> cout <span class="ot">=&gt;</span> c3);</span>
<span id="cb45-58"><a href="#cb45-58" aria-hidden="true" tabindex="-1"></a>  <span class="dv">add67</span><span class="ot">:</span> <span class="fu">Add16</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> ext6<span class="ot">,</span> b <span class="ot">=&gt;</span> ext7<span class="ot">,</span> cin <span class="ot">=&gt;</span> <span class="bn">&#39;0&#39;</span><span class="ot">,</span> sum <span class="ot">=&gt;</span> s67<span class="ot">,</span> cout <span class="ot">=&gt;</span> c4);</span>
<span id="cb45-59"><a href="#cb45-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-60"><a href="#cb45-60" aria-hidden="true" tabindex="-1"></a>  <span class="dv">add0123</span><span class="ot">:</span> <span class="fu">Add16</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> s01<span class="ot">,</span> b <span class="ot">=&gt;</span> s23<span class="ot">,</span> cin <span class="ot">=&gt;</span> <span class="bn">&#39;0&#39;</span><span class="ot">,</span> sum <span class="ot">=&gt;</span> s0123<span class="ot">,</span> cout <span class="ot">=&gt;</span> c5);</span>
<span id="cb45-61"><a href="#cb45-61" aria-hidden="true" tabindex="-1"></a>  <span class="dv">add4567</span><span class="ot">:</span> <span class="fu">Add16</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> s45<span class="ot">,</span> b <span class="ot">=&gt;</span> s67<span class="ot">,</span> cin <span class="ot">=&gt;</span> <span class="bn">&#39;0&#39;</span><span class="ot">,</span> sum <span class="ot">=&gt;</span> s4567<span class="ot">,</span> cout <span class="ot">=&gt;</span> c6);</span>
<span id="cb45-62"><a href="#cb45-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-63"><a href="#cb45-63" aria-hidden="true" tabindex="-1"></a>  <span class="dv">add_final</span><span class="ot">:</span> <span class="fu">Add16</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> s0123<span class="ot">,</span> b <span class="ot">=&gt;</span> s4567<span class="ot">,</span> cin <span class="ot">=&gt;</span> <span class="bn">&#39;0&#39;</span><span class="ot">,</span> sum <span class="ot">=&gt;</span> y<span class="ot">,</span> cout <span class="ot">=&gt;</span> c7);</span>
<span id="cb45-64"><a href="#cb45-64" aria-hidden="true" tabindex="-1"></a><span class="cf">end architecture;</span></span></code></pre></div>
<hr />
<h3 data-number="2.1.24" id="dff1"><span class="header-section-number">2.1.24</span> DFF1</h3>
<div class="sourceCode" id="cb46"><pre class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- D Flip-Flop</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="co">-- Uses the built-in dff primitive</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="cf">entity</span> <span class="dv">DFF1</span> <span class="kw">is</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">port</span>(</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>    clk <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>    d   <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>    q   <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a><span class="cf">end entity;</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">rtl</span> <span class="kw">of</span> <span class="fu">DFF1</span> <span class="kw">is</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">dff</span></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(clk <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; d <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; q <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u0</span><span class="ot">:</span> <span class="fu">dff</span> <span class="kw">port map </span>(clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> d <span class="ot">=&gt;</span> d<span class="ot">,</span> q <span class="ot">=&gt;</span> q);</span>
<span id="cb46-18"><a href="#cb46-18" aria-hidden="true" tabindex="-1"></a><span class="cf">end architecture;</span></span></code></pre></div>
<hr />
<h3 data-number="2.1.25" id="bitreg"><span class="header-section-number">2.1.25</span> BitReg</h3>
<div class="sourceCode" id="cb47"><pre class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 1-bit Register</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="cf">entity</span> <span class="dv">BitReg</span> <span class="kw">is</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">port</span>(</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>    clk  <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>    d    <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>    load <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>    q    <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="cf">end entity;</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">rtl</span> <span class="kw">of</span> <span class="fu">BitReg</span> <span class="kw">is</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">dff</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(clk <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; d <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; q <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">Mux</span></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a<span class="ot">,</span>b <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; sel <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; y <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> mux_out<span class="ot">,</span> q_int <span class="ot">:</span> <span class="dt">bit</span>;</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_mux</span><span class="ot">:</span> <span class="fu">Mux</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> q_int<span class="ot">,</span> b <span class="ot">=&gt;</span> d<span class="ot">,</span> sel <span class="ot">=&gt;</span> load<span class="ot">,</span> y <span class="ot">=&gt;</span> mux_out);</span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_dff</span><span class="ot">:</span> <span class="fu">dff</span> <span class="kw">port map </span>(clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> d <span class="ot">=&gt;</span> mux_out<span class="ot">,</span> q <span class="ot">=&gt;</span> q_int);</span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>  q <span class="ot">&lt;=</span> q_int;</span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a><span class="cf">end architecture;</span></span></code></pre></div>
<hr />
<h3 data-number="2.1.26" id="register16"><span class="header-section-number">2.1.26</span> Register16</h3>
<div class="sourceCode" id="cb48"><pre class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 16-bit Register</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="cf">entity</span> <span class="dv">Register16</span> <span class="kw">is</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">port</span>(</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    clk  <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    d    <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>    load <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>    q    <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>)</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="cf">end entity;</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">rtl</span> <span class="kw">of</span> <span class="fu">Register16</span> <span class="kw">is</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">BitReg</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(clk <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; d <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; load <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; q <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u0</span><span class="ot">:</span> <span class="fu">BitReg</span> <span class="kw">port map </span>(clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> d <span class="ot">=&gt;</span> d(<span class="dv">0</span>)<span class="ot">,</span> load <span class="ot">=&gt;</span> load<span class="ot">,</span> q <span class="ot">=&gt;</span> q(<span class="dv">0</span>));</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u1</span><span class="ot">:</span> <span class="fu">BitReg</span> <span class="kw">port map </span>(clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> d <span class="ot">=&gt;</span> d(<span class="dv">1</span>)<span class="ot">,</span> load <span class="ot">=&gt;</span> load<span class="ot">,</span> q <span class="ot">=&gt;</span> q(<span class="dv">1</span>));</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u2</span><span class="ot">:</span> <span class="fu">BitReg</span> <span class="kw">port map </span>(clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> d <span class="ot">=&gt;</span> d(<span class="dv">2</span>)<span class="ot">,</span> load <span class="ot">=&gt;</span> load<span class="ot">,</span> q <span class="ot">=&gt;</span> q(<span class="dv">2</span>));</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u3</span><span class="ot">:</span> <span class="fu">BitReg</span> <span class="kw">port map </span>(clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> d <span class="ot">=&gt;</span> d(<span class="dv">3</span>)<span class="ot">,</span> load <span class="ot">=&gt;</span> load<span class="ot">,</span> q <span class="ot">=&gt;</span> q(<span class="dv">3</span>));</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u4</span><span class="ot">:</span> <span class="fu">BitReg</span> <span class="kw">port map </span>(clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> d <span class="ot">=&gt;</span> d(<span class="dv">4</span>)<span class="ot">,</span> load <span class="ot">=&gt;</span> load<span class="ot">,</span> q <span class="ot">=&gt;</span> q(<span class="dv">4</span>));</span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u5</span><span class="ot">:</span> <span class="fu">BitReg</span> <span class="kw">port map </span>(clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> d <span class="ot">=&gt;</span> d(<span class="dv">5</span>)<span class="ot">,</span> load <span class="ot">=&gt;</span> load<span class="ot">,</span> q <span class="ot">=&gt;</span> q(<span class="dv">5</span>));</span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u6</span><span class="ot">:</span> <span class="fu">BitReg</span> <span class="kw">port map </span>(clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> d <span class="ot">=&gt;</span> d(<span class="dv">6</span>)<span class="ot">,</span> load <span class="ot">=&gt;</span> load<span class="ot">,</span> q <span class="ot">=&gt;</span> q(<span class="dv">6</span>));</span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u7</span><span class="ot">:</span> <span class="fu">BitReg</span> <span class="kw">port map </span>(clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> d <span class="ot">=&gt;</span> d(<span class="dv">7</span>)<span class="ot">,</span> load <span class="ot">=&gt;</span> load<span class="ot">,</span> q <span class="ot">=&gt;</span> q(<span class="dv">7</span>));</span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u8</span><span class="ot">:</span> <span class="fu">BitReg</span> <span class="kw">port map </span>(clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> d <span class="ot">=&gt;</span> d(<span class="dv">8</span>)<span class="ot">,</span> load <span class="ot">=&gt;</span> load<span class="ot">,</span> q <span class="ot">=&gt;</span> q(<span class="dv">8</span>));</span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u9</span><span class="ot">:</span> <span class="fu">BitReg</span> <span class="kw">port map </span>(clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> d <span class="ot">=&gt;</span> d(<span class="dv">9</span>)<span class="ot">,</span> load <span class="ot">=&gt;</span> load<span class="ot">,</span> q <span class="ot">=&gt;</span> q(<span class="dv">9</span>));</span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u10</span><span class="ot">:</span> <span class="fu">BitReg</span> <span class="kw">port map </span>(clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> d <span class="ot">=&gt;</span> d(<span class="dv">10</span>)<span class="ot">,</span> load <span class="ot">=&gt;</span> load<span class="ot">,</span> q <span class="ot">=&gt;</span> q(<span class="dv">10</span>));</span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u11</span><span class="ot">:</span> <span class="fu">BitReg</span> <span class="kw">port map </span>(clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> d <span class="ot">=&gt;</span> d(<span class="dv">11</span>)<span class="ot">,</span> load <span class="ot">=&gt;</span> load<span class="ot">,</span> q <span class="ot">=&gt;</span> q(<span class="dv">11</span>));</span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u12</span><span class="ot">:</span> <span class="fu">BitReg</span> <span class="kw">port map </span>(clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> d <span class="ot">=&gt;</span> d(<span class="dv">12</span>)<span class="ot">,</span> load <span class="ot">=&gt;</span> load<span class="ot">,</span> q <span class="ot">=&gt;</span> q(<span class="dv">12</span>));</span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u13</span><span class="ot">:</span> <span class="fu">BitReg</span> <span class="kw">port map </span>(clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> d <span class="ot">=&gt;</span> d(<span class="dv">13</span>)<span class="ot">,</span> load <span class="ot">=&gt;</span> load<span class="ot">,</span> q <span class="ot">=&gt;</span> q(<span class="dv">13</span>));</span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u14</span><span class="ot">:</span> <span class="fu">BitReg</span> <span class="kw">port map </span>(clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> d <span class="ot">=&gt;</span> d(<span class="dv">14</span>)<span class="ot">,</span> load <span class="ot">=&gt;</span> load<span class="ot">,</span> q <span class="ot">=&gt;</span> q(<span class="dv">14</span>));</span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u15</span><span class="ot">:</span> <span class="fu">BitReg</span> <span class="kw">port map </span>(clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> d <span class="ot">=&gt;</span> d(<span class="dv">15</span>)<span class="ot">,</span> load <span class="ot">=&gt;</span> load<span class="ot">,</span> q <span class="ot">=&gt;</span> q(<span class="dv">15</span>));</span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a><span class="cf">end architecture;</span></span></code></pre></div>
<hr />
<h3 data-number="2.1.27" id="pc"><span class="header-section-number">2.1.27</span> PC</h3>
<div class="sourceCode" id="cb49"><pre class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Program Counter</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="cf">entity</span> <span class="dv">PC</span> <span class="kw">is</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">port</span>(</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    clk   <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    d     <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    inc   <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>    load  <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>    reset <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>    q     <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>)</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a><span class="cf">end entity;</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">rtl</span> <span class="kw">of</span> <span class="fu">PC</span> <span class="kw">is</span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">Register16</span></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(clk <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; d <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>); load <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; q <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>));</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">Inc16</span></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>); y <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>));</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">Mux16</span></span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a<span class="ot">,</span>b <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>); sel <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; y <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>));</span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> q_int<span class="ot">,</span> inc_out<span class="ot">,</span> mux1_out<span class="ot">,</span> mux2_out<span class="ot">,</span> mux3_out <span class="ot">:</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> zero16 <span class="ot">:</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> do_load <span class="ot">:</span> <span class="dt">bit</span>;</span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a>  zero16 <span class="ot">&lt;=</span> X<span class="st">&quot;0000&quot;</span>;</span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Increment current value</span></span>
<span id="cb49-30"><a href="#cb49-30" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_inc</span><span class="ot">:</span> <span class="fu">Inc16</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> q_int<span class="ot">,</span> y <span class="ot">=&gt;</span> inc_out);</span>
<span id="cb49-31"><a href="#cb49-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-32"><a href="#cb49-32" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Priority: reset &gt; load &gt; inc</span></span>
<span id="cb49-33"><a href="#cb49-33" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- First mux: inc or hold</span></span>
<span id="cb49-34"><a href="#cb49-34" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_mux1</span><span class="ot">:</span> <span class="fu">Mux16</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> q_int<span class="ot">,</span> b <span class="ot">=&gt;</span> inc_out<span class="ot">,</span> sel <span class="ot">=&gt;</span> inc<span class="ot">,</span> y <span class="ot">=&gt;</span> mux1_out);</span>
<span id="cb49-35"><a href="#cb49-35" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Second mux: load overrides</span></span>
<span id="cb49-36"><a href="#cb49-36" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_mux2</span><span class="ot">:</span> <span class="fu">Mux16</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> mux1_out<span class="ot">,</span> b <span class="ot">=&gt;</span> d<span class="ot">,</span> sel <span class="ot">=&gt;</span> load<span class="ot">,</span> y <span class="ot">=&gt;</span> mux2_out);</span>
<span id="cb49-37"><a href="#cb49-37" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Third mux: reset overrides all</span></span>
<span id="cb49-38"><a href="#cb49-38" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_mux3</span><span class="ot">:</span> <span class="fu">Mux16</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> mux2_out<span class="ot">,</span> b <span class="ot">=&gt;</span> zero16<span class="ot">,</span> sel <span class="ot">=&gt;</span> reset<span class="ot">,</span> y <span class="ot">=&gt;</span> mux3_out);</span>
<span id="cb49-39"><a href="#cb49-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-40"><a href="#cb49-40" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Always load the register</span></span>
<span id="cb49-41"><a href="#cb49-41" aria-hidden="true" tabindex="-1"></a>  do_load <span class="ot">&lt;=</span> inc <span class="kw">or</span> load <span class="kw">or</span> reset;</span>
<span id="cb49-42"><a href="#cb49-42" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_reg</span><span class="ot">:</span> <span class="fu">Register16</span> <span class="kw">port map </span>(clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> d <span class="ot">=&gt;</span> mux3_out<span class="ot">,</span> load <span class="ot">=&gt;</span> do_load<span class="ot">,</span> q <span class="ot">=&gt;</span> q_int);</span>
<span id="cb49-43"><a href="#cb49-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-44"><a href="#cb49-44" aria-hidden="true" tabindex="-1"></a>  q <span class="ot">&lt;=</span> q_int;</span>
<span id="cb49-45"><a href="#cb49-45" aria-hidden="true" tabindex="-1"></a><span class="cf">end architecture;</span></span></code></pre></div>
<hr />
<h3 data-number="2.1.28" id="ram8"><span class="header-section-number">2.1.28</span> RAM8</h3>
<div class="sourceCode" id="cb50"><pre class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 8-word RAM</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="cf">entity</span> <span class="dv">RAM8</span> <span class="kw">is</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">port</span>(</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    clk  <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>    din  <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>    addr <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">2</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>    we   <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>    dout <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>)</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a><span class="cf">end entity;</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">rtl</span> <span class="kw">of</span> <span class="fu">RAM8</span> <span class="kw">is</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">Register16</span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(clk <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; d <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>); load <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; q <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>));</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">DMux8Way</span></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(x <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; sel <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">2</span> <span class="ot">downto</span> <span class="dv">0</span>); a<span class="ot">,</span>b<span class="ot">,</span>c<span class="ot">,</span>d<span class="ot">,</span>e<span class="ot">,</span>f<span class="ot">,</span>g<span class="ot">,</span>h <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">Mux8Way16</span></span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a<span class="ot">,</span>b<span class="ot">,</span>c<span class="ot">,</span>d<span class="ot">,</span>e<span class="ot">,</span>f<span class="ot">,</span>g<span class="ot">,</span>h <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>); sel <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">2</span> <span class="ot">downto</span> <span class="dv">0</span>); y <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>));</span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> load0<span class="ot">,</span>load1<span class="ot">,</span>load2<span class="ot">,</span>load3<span class="ot">,</span>load4<span class="ot">,</span>load5<span class="ot">,</span>load6<span class="ot">,</span>load7 <span class="ot">:</span> <span class="dt">bit</span>;</span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> r0<span class="ot">,</span>r1<span class="ot">,</span>r2<span class="ot">,</span>r3<span class="ot">,</span>r4<span class="ot">,</span>r5<span class="ot">,</span>r6<span class="ot">,</span>r7 <span class="ot">:</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_dmux</span><span class="ot">:</span> <span class="fu">DMux8Way</span> <span class="kw">port map </span>(x <span class="ot">=&gt;</span> we<span class="ot">,</span> sel <span class="ot">=&gt;</span> addr<span class="ot">,</span> a <span class="ot">=&gt;</span> load0<span class="ot">,</span> b <span class="ot">=&gt;</span> load1<span class="ot">,</span> c <span class="ot">=&gt;</span> load2<span class="ot">,</span> d <span class="ot">=&gt;</span> load3<span class="ot">,</span> e <span class="ot">=&gt;</span> load4<span class="ot">,</span> f <span class="ot">=&gt;</span> load5<span class="ot">,</span> g <span class="ot">=&gt;</span> load6<span class="ot">,</span> h <span class="ot">=&gt;</span> load7);</span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_r0</span><span class="ot">:</span> <span class="fu">Register16</span> <span class="kw">port map </span>(clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> d <span class="ot">=&gt;</span> din<span class="ot">,</span> load <span class="ot">=&gt;</span> load0<span class="ot">,</span> q <span class="ot">=&gt;</span> r0);</span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_r1</span><span class="ot">:</span> <span class="fu">Register16</span> <span class="kw">port map </span>(clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> d <span class="ot">=&gt;</span> din<span class="ot">,</span> load <span class="ot">=&gt;</span> load1<span class="ot">,</span> q <span class="ot">=&gt;</span> r1);</span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_r2</span><span class="ot">:</span> <span class="fu">Register16</span> <span class="kw">port map </span>(clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> d <span class="ot">=&gt;</span> din<span class="ot">,</span> load <span class="ot">=&gt;</span> load2<span class="ot">,</span> q <span class="ot">=&gt;</span> r2);</span>
<span id="cb50-30"><a href="#cb50-30" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_r3</span><span class="ot">:</span> <span class="fu">Register16</span> <span class="kw">port map </span>(clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> d <span class="ot">=&gt;</span> din<span class="ot">,</span> load <span class="ot">=&gt;</span> load3<span class="ot">,</span> q <span class="ot">=&gt;</span> r3);</span>
<span id="cb50-31"><a href="#cb50-31" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_r4</span><span class="ot">:</span> <span class="fu">Register16</span> <span class="kw">port map </span>(clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> d <span class="ot">=&gt;</span> din<span class="ot">,</span> load <span class="ot">=&gt;</span> load4<span class="ot">,</span> q <span class="ot">=&gt;</span> r4);</span>
<span id="cb50-32"><a href="#cb50-32" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_r5</span><span class="ot">:</span> <span class="fu">Register16</span> <span class="kw">port map </span>(clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> d <span class="ot">=&gt;</span> din<span class="ot">,</span> load <span class="ot">=&gt;</span> load5<span class="ot">,</span> q <span class="ot">=&gt;</span> r5);</span>
<span id="cb50-33"><a href="#cb50-33" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_r6</span><span class="ot">:</span> <span class="fu">Register16</span> <span class="kw">port map </span>(clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> d <span class="ot">=&gt;</span> din<span class="ot">,</span> load <span class="ot">=&gt;</span> load6<span class="ot">,</span> q <span class="ot">=&gt;</span> r6);</span>
<span id="cb50-34"><a href="#cb50-34" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_r7</span><span class="ot">:</span> <span class="fu">Register16</span> <span class="kw">port map </span>(clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> d <span class="ot">=&gt;</span> din<span class="ot">,</span> load <span class="ot">=&gt;</span> load7<span class="ot">,</span> q <span class="ot">=&gt;</span> r7);</span>
<span id="cb50-35"><a href="#cb50-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-36"><a href="#cb50-36" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_mux</span><span class="ot">:</span> <span class="fu">Mux8Way16</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> r0<span class="ot">,</span> b <span class="ot">=&gt;</span> r1<span class="ot">,</span> c <span class="ot">=&gt;</span> r2<span class="ot">,</span> d <span class="ot">=&gt;</span> r3<span class="ot">,</span> e <span class="ot">=&gt;</span> r4<span class="ot">,</span> f <span class="ot">=&gt;</span> r5<span class="ot">,</span> g <span class="ot">=&gt;</span> r6<span class="ot">,</span> h <span class="ot">=&gt;</span> r7<span class="ot">,</span> sel <span class="ot">=&gt;</span> addr<span class="ot">,</span> y <span class="ot">=&gt;</span> dout);</span>
<span id="cb50-37"><a href="#cb50-37" aria-hidden="true" tabindex="-1"></a><span class="cf">end architecture;</span></span></code></pre></div>
<hr />
<h3 data-number="2.1.29" id="ram64"><span class="header-section-number">2.1.29</span> RAM64</h3>
<div class="sourceCode" id="cb51"><pre class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 64-word RAM</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="cf">entity</span> <span class="dv">RAM64</span> <span class="kw">is</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">port</span>(</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    clk  <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>    din  <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>    addr <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">5</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>    we   <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>    dout <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>)</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="cf">end entity;</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">rtl</span> <span class="kw">of</span> <span class="fu">RAM64</span> <span class="kw">is</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">RAM8</span></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(clk <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; din <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>); addr <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">2</span> <span class="ot">downto</span> <span class="dv">0</span>); we <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; dout <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>));</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">DMux8Way</span></span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(x <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; sel <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">2</span> <span class="ot">downto</span> <span class="dv">0</span>); a<span class="ot">,</span>b<span class="ot">,</span>c<span class="ot">,</span>d<span class="ot">,</span>e<span class="ot">,</span>f<span class="ot">,</span>g<span class="ot">,</span>h <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">Mux8Way16</span></span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a<span class="ot">,</span>b<span class="ot">,</span>c<span class="ot">,</span>d<span class="ot">,</span>e<span class="ot">,</span>f<span class="ot">,</span>g<span class="ot">,</span>h <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>); sel <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">2</span> <span class="ot">downto</span> <span class="dv">0</span>); y <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>));</span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> we0<span class="ot">,</span>we1<span class="ot">,</span>we2<span class="ot">,</span>we3<span class="ot">,</span>we4<span class="ot">,</span>we5<span class="ot">,</span>we6<span class="ot">,</span>we7 <span class="ot">:</span> <span class="dt">bit</span>;</span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> r0<span class="ot">,</span>r1<span class="ot">,</span>r2<span class="ot">,</span>r3<span class="ot">,</span>r4<span class="ot">,</span>r5<span class="ot">,</span>r6<span class="ot">,</span>r7 <span class="ot">:</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_dmux</span><span class="ot">:</span> <span class="fu">DMux8Way</span> <span class="kw">port map </span>(x <span class="ot">=&gt;</span> we<span class="ot">,</span> sel <span class="ot">=&gt;</span> addr(<span class="dv">5</span> <span class="ot">downto</span> <span class="dv">3</span>)<span class="ot">,</span> a <span class="ot">=&gt;</span> we0<span class="ot">,</span> b <span class="ot">=&gt;</span> we1<span class="ot">,</span> c <span class="ot">=&gt;</span> we2<span class="ot">,</span> d <span class="ot">=&gt;</span> we3<span class="ot">,</span> e <span class="ot">=&gt;</span> we4<span class="ot">,</span> f <span class="ot">=&gt;</span> we5<span class="ot">,</span> g <span class="ot">=&gt;</span> we6<span class="ot">,</span> h <span class="ot">=&gt;</span> we7);</span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_ram0</span><span class="ot">:</span> <span class="fu">RAM8</span> <span class="kw">port map </span>(clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> din <span class="ot">=&gt;</span> din<span class="ot">,</span> addr <span class="ot">=&gt;</span> addr(<span class="dv">2</span> <span class="ot">downto</span> <span class="dv">0</span>)<span class="ot">,</span> we <span class="ot">=&gt;</span> we0<span class="ot">,</span> dout <span class="ot">=&gt;</span> r0);</span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_ram1</span><span class="ot">:</span> <span class="fu">RAM8</span> <span class="kw">port map </span>(clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> din <span class="ot">=&gt;</span> din<span class="ot">,</span> addr <span class="ot">=&gt;</span> addr(<span class="dv">2</span> <span class="ot">downto</span> <span class="dv">0</span>)<span class="ot">,</span> we <span class="ot">=&gt;</span> we1<span class="ot">,</span> dout <span class="ot">=&gt;</span> r1);</span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_ram2</span><span class="ot">:</span> <span class="fu">RAM8</span> <span class="kw">port map </span>(clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> din <span class="ot">=&gt;</span> din<span class="ot">,</span> addr <span class="ot">=&gt;</span> addr(<span class="dv">2</span> <span class="ot">downto</span> <span class="dv">0</span>)<span class="ot">,</span> we <span class="ot">=&gt;</span> we2<span class="ot">,</span> dout <span class="ot">=&gt;</span> r2);</span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_ram3</span><span class="ot">:</span> <span class="fu">RAM8</span> <span class="kw">port map </span>(clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> din <span class="ot">=&gt;</span> din<span class="ot">,</span> addr <span class="ot">=&gt;</span> addr(<span class="dv">2</span> <span class="ot">downto</span> <span class="dv">0</span>)<span class="ot">,</span> we <span class="ot">=&gt;</span> we3<span class="ot">,</span> dout <span class="ot">=&gt;</span> r3);</span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_ram4</span><span class="ot">:</span> <span class="fu">RAM8</span> <span class="kw">port map </span>(clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> din <span class="ot">=&gt;</span> din<span class="ot">,</span> addr <span class="ot">=&gt;</span> addr(<span class="dv">2</span> <span class="ot">downto</span> <span class="dv">0</span>)<span class="ot">,</span> we <span class="ot">=&gt;</span> we4<span class="ot">,</span> dout <span class="ot">=&gt;</span> r4);</span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_ram5</span><span class="ot">:</span> <span class="fu">RAM8</span> <span class="kw">port map </span>(clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> din <span class="ot">=&gt;</span> din<span class="ot">,</span> addr <span class="ot">=&gt;</span> addr(<span class="dv">2</span> <span class="ot">downto</span> <span class="dv">0</span>)<span class="ot">,</span> we <span class="ot">=&gt;</span> we5<span class="ot">,</span> dout <span class="ot">=&gt;</span> r5);</span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_ram6</span><span class="ot">:</span> <span class="fu">RAM8</span> <span class="kw">port map </span>(clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> din <span class="ot">=&gt;</span> din<span class="ot">,</span> addr <span class="ot">=&gt;</span> addr(<span class="dv">2</span> <span class="ot">downto</span> <span class="dv">0</span>)<span class="ot">,</span> we <span class="ot">=&gt;</span> we6<span class="ot">,</span> dout <span class="ot">=&gt;</span> r6);</span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_ram7</span><span class="ot">:</span> <span class="fu">RAM8</span> <span class="kw">port map </span>(clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> din <span class="ot">=&gt;</span> din<span class="ot">,</span> addr <span class="ot">=&gt;</span> addr(<span class="dv">2</span> <span class="ot">downto</span> <span class="dv">0</span>)<span class="ot">,</span> we <span class="ot">=&gt;</span> we7<span class="ot">,</span> dout <span class="ot">=&gt;</span> r7);</span>
<span id="cb51-35"><a href="#cb51-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-36"><a href="#cb51-36" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_mux</span><span class="ot">:</span> <span class="fu">Mux8Way16</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> r0<span class="ot">,</span> b <span class="ot">=&gt;</span> r1<span class="ot">,</span> c <span class="ot">=&gt;</span> r2<span class="ot">,</span> d <span class="ot">=&gt;</span> r3<span class="ot">,</span> e <span class="ot">=&gt;</span> r4<span class="ot">,</span> f <span class="ot">=&gt;</span> r5<span class="ot">,</span> g <span class="ot">=&gt;</span> r6<span class="ot">,</span> h <span class="ot">=&gt;</span> r7<span class="ot">,</span> sel <span class="ot">=&gt;</span> addr(<span class="dv">5</span> <span class="ot">downto</span> <span class="dv">3</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> dout);</span>
<span id="cb51-37"><a href="#cb51-37" aria-hidden="true" tabindex="-1"></a><span class="cf">end architecture;</span></span></code></pre></div>
<hr />
<h3 data-number="2.1.30" id="regfile"><span class="header-section-number">2.1.30</span> RegFile</h3>
<div class="sourceCode" id="cb52"><pre class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 16-Register File with 2 independent read ports</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="cf">entity</span> <span class="dv">RegFile</span> <span class="kw">is</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">port</span>(</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>    clk   <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>    we    <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>    waddr <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">3</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>    wdata <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>    raddr1<span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">3</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>    raddr2<span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">3</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>    rdata1<span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>    rdata2<span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>)</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a><span class="cf">end entity;</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">rtl</span> <span class="kw">of</span> <span class="fu">RegFile</span> <span class="kw">is</span></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">Register16</span></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(clk <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; d <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>); load <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; q <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>));</span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">DMux8Way</span></span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(x <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; sel <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">2</span> <span class="ot">downto</span> <span class="dv">0</span>); a<span class="ot">,</span>b<span class="ot">,</span>c<span class="ot">,</span>d<span class="ot">,</span>e<span class="ot">,</span>f<span class="ot">,</span>g<span class="ot">,</span>h <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">Mux8Way16</span></span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a<span class="ot">,</span>b<span class="ot">,</span>c<span class="ot">,</span>d<span class="ot">,</span>e<span class="ot">,</span>f<span class="ot">,</span>g<span class="ot">,</span>h <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>); sel <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">2</span> <span class="ot">downto</span> <span class="dv">0</span>); y <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>));</span>
<span id="cb52-24"><a href="#cb52-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb52-25"><a href="#cb52-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">Mux16</span></span>
<span id="cb52-26"><a href="#cb52-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a<span class="ot">,</span>b <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>); sel <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; y <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>));</span>
<span id="cb52-27"><a href="#cb52-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb52-28"><a href="#cb52-28" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">DMux</span></span>
<span id="cb52-29"><a href="#cb52-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(x <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; sel <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; a<span class="ot">,</span>b <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb52-30"><a href="#cb52-30" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb52-31"><a href="#cb52-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-32"><a href="#cb52-32" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Write enable signals for each register</span></span>
<span id="cb52-33"><a href="#cb52-33" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> we_lo<span class="ot">,</span> we_hi <span class="ot">:</span> <span class="dt">bit</span>;</span>
<span id="cb52-34"><a href="#cb52-34" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> we0<span class="ot">,</span>we1<span class="ot">,</span>we2<span class="ot">,</span>we3<span class="ot">,</span>we4<span class="ot">,</span>we5<span class="ot">,</span>we6<span class="ot">,</span>we7 <span class="ot">:</span> <span class="dt">bit</span>;</span>
<span id="cb52-35"><a href="#cb52-35" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> we8<span class="ot">,</span>we9<span class="ot">,</span>we10<span class="ot">,</span>we11<span class="ot">,</span>we12<span class="ot">,</span>we13<span class="ot">,</span>we14<span class="ot">,</span>we15 <span class="ot">:</span> <span class="dt">bit</span>;</span>
<span id="cb52-36"><a href="#cb52-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-37"><a href="#cb52-37" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Register outputs</span></span>
<span id="cb52-38"><a href="#cb52-38" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> r0<span class="ot">,</span>r1<span class="ot">,</span>r2<span class="ot">,</span>r3<span class="ot">,</span>r4<span class="ot">,</span>r5<span class="ot">,</span>r6<span class="ot">,</span>r7 <span class="ot">:</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb52-39"><a href="#cb52-39" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> r8<span class="ot">,</span>r9<span class="ot">,</span>r10<span class="ot">,</span>r11<span class="ot">,</span>r12<span class="ot">,</span>r13<span class="ot">,</span>r14<span class="ot">,</span>r15 <span class="ot">:</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb52-40"><a href="#cb52-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-41"><a href="#cb52-41" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Intermediate mux outputs for read ports</span></span>
<span id="cb52-42"><a href="#cb52-42" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> rd1_lo<span class="ot">,</span> rd1_hi<span class="ot">,</span> rd2_lo<span class="ot">,</span> rd2_hi <span class="ot">:</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb52-43"><a href="#cb52-43" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb52-44"><a href="#cb52-44" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Demux write enable: split by waddr(3), then by waddr(2:0)</span></span>
<span id="cb52-45"><a href="#cb52-45" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_we_split</span><span class="ot">:</span> <span class="fu">DMux</span> <span class="kw">port map </span>(x <span class="ot">=&gt;</span> we<span class="ot">,</span> sel <span class="ot">=&gt;</span> waddr(<span class="dv">3</span>)<span class="ot">,</span> a <span class="ot">=&gt;</span> we_lo<span class="ot">,</span> b <span class="ot">=&gt;</span> we_hi);</span>
<span id="cb52-46"><a href="#cb52-46" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_we_lo</span><span class="ot">:</span> <span class="fu">DMux8Way</span> <span class="kw">port map </span>(x <span class="ot">=&gt;</span> we_lo<span class="ot">,</span> sel <span class="ot">=&gt;</span> waddr(<span class="dv">2</span> <span class="ot">downto</span> <span class="dv">0</span>)<span class="ot">,</span></span>
<span id="cb52-47"><a href="#cb52-47" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">=&gt;</span> we0<span class="ot">,</span> b <span class="ot">=&gt;</span> we1<span class="ot">,</span> c <span class="ot">=&gt;</span> we2<span class="ot">,</span> d <span class="ot">=&gt;</span> we3<span class="ot">,</span> e <span class="ot">=&gt;</span> we4<span class="ot">,</span> f <span class="ot">=&gt;</span> we5<span class="ot">,</span> g <span class="ot">=&gt;</span> we6<span class="ot">,</span> h <span class="ot">=&gt;</span> we7);</span>
<span id="cb52-48"><a href="#cb52-48" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_we_hi</span><span class="ot">:</span> <span class="fu">DMux8Way</span> <span class="kw">port map </span>(x <span class="ot">=&gt;</span> we_hi<span class="ot">,</span> sel <span class="ot">=&gt;</span> waddr(<span class="dv">2</span> <span class="ot">downto</span> <span class="dv">0</span>)<span class="ot">,</span></span>
<span id="cb52-49"><a href="#cb52-49" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">=&gt;</span> we8<span class="ot">,</span> b <span class="ot">=&gt;</span> we9<span class="ot">,</span> c <span class="ot">=&gt;</span> we10<span class="ot">,</span> d <span class="ot">=&gt;</span> we11<span class="ot">,</span> e <span class="ot">=&gt;</span> we12<span class="ot">,</span> f <span class="ot">=&gt;</span> we13<span class="ot">,</span> g <span class="ot">=&gt;</span> we14<span class="ot">,</span> h <span class="ot">=&gt;</span> we15);</span>
<span id="cb52-50"><a href="#cb52-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-51"><a href="#cb52-51" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- 16 registers</span></span>
<span id="cb52-52"><a href="#cb52-52" aria-hidden="true" tabindex="-1"></a>  <span class="dv">reg0</span><span class="ot">:</span>  <span class="fu">Register16</span> <span class="kw">port map </span>(clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> d <span class="ot">=&gt;</span> wdata<span class="ot">,</span> load <span class="ot">=&gt;</span> we0<span class="ot">,</span> q <span class="ot">=&gt;</span> r0);</span>
<span id="cb52-53"><a href="#cb52-53" aria-hidden="true" tabindex="-1"></a>  <span class="dv">reg1</span><span class="ot">:</span>  <span class="fu">Register16</span> <span class="kw">port map </span>(clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> d <span class="ot">=&gt;</span> wdata<span class="ot">,</span> load <span class="ot">=&gt;</span> we1<span class="ot">,</span> q <span class="ot">=&gt;</span> r1);</span>
<span id="cb52-54"><a href="#cb52-54" aria-hidden="true" tabindex="-1"></a>  <span class="dv">reg2</span><span class="ot">:</span>  <span class="fu">Register16</span> <span class="kw">port map </span>(clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> d <span class="ot">=&gt;</span> wdata<span class="ot">,</span> load <span class="ot">=&gt;</span> we2<span class="ot">,</span> q <span class="ot">=&gt;</span> r2);</span>
<span id="cb52-55"><a href="#cb52-55" aria-hidden="true" tabindex="-1"></a>  <span class="dv">reg3</span><span class="ot">:</span>  <span class="fu">Register16</span> <span class="kw">port map </span>(clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> d <span class="ot">=&gt;</span> wdata<span class="ot">,</span> load <span class="ot">=&gt;</span> we3<span class="ot">,</span> q <span class="ot">=&gt;</span> r3);</span>
<span id="cb52-56"><a href="#cb52-56" aria-hidden="true" tabindex="-1"></a>  <span class="dv">reg4</span><span class="ot">:</span>  <span class="fu">Register16</span> <span class="kw">port map </span>(clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> d <span class="ot">=&gt;</span> wdata<span class="ot">,</span> load <span class="ot">=&gt;</span> we4<span class="ot">,</span> q <span class="ot">=&gt;</span> r4);</span>
<span id="cb52-57"><a href="#cb52-57" aria-hidden="true" tabindex="-1"></a>  <span class="dv">reg5</span><span class="ot">:</span>  <span class="fu">Register16</span> <span class="kw">port map </span>(clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> d <span class="ot">=&gt;</span> wdata<span class="ot">,</span> load <span class="ot">=&gt;</span> we5<span class="ot">,</span> q <span class="ot">=&gt;</span> r5);</span>
<span id="cb52-58"><a href="#cb52-58" aria-hidden="true" tabindex="-1"></a>  <span class="dv">reg6</span><span class="ot">:</span>  <span class="fu">Register16</span> <span class="kw">port map </span>(clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> d <span class="ot">=&gt;</span> wdata<span class="ot">,</span> load <span class="ot">=&gt;</span> we6<span class="ot">,</span> q <span class="ot">=&gt;</span> r6);</span>
<span id="cb52-59"><a href="#cb52-59" aria-hidden="true" tabindex="-1"></a>  <span class="dv">reg7</span><span class="ot">:</span>  <span class="fu">Register16</span> <span class="kw">port map </span>(clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> d <span class="ot">=&gt;</span> wdata<span class="ot">,</span> load <span class="ot">=&gt;</span> we7<span class="ot">,</span> q <span class="ot">=&gt;</span> r7);</span>
<span id="cb52-60"><a href="#cb52-60" aria-hidden="true" tabindex="-1"></a>  <span class="dv">reg8</span><span class="ot">:</span>  <span class="fu">Register16</span> <span class="kw">port map </span>(clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> d <span class="ot">=&gt;</span> wdata<span class="ot">,</span> load <span class="ot">=&gt;</span> we8<span class="ot">,</span> q <span class="ot">=&gt;</span> r8);</span>
<span id="cb52-61"><a href="#cb52-61" aria-hidden="true" tabindex="-1"></a>  <span class="dv">reg9</span><span class="ot">:</span>  <span class="fu">Register16</span> <span class="kw">port map </span>(clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> d <span class="ot">=&gt;</span> wdata<span class="ot">,</span> load <span class="ot">=&gt;</span> we9<span class="ot">,</span> q <span class="ot">=&gt;</span> r9);</span>
<span id="cb52-62"><a href="#cb52-62" aria-hidden="true" tabindex="-1"></a>  <span class="dv">reg10</span><span class="ot">:</span> <span class="fu">Register16</span> <span class="kw">port map </span>(clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> d <span class="ot">=&gt;</span> wdata<span class="ot">,</span> load <span class="ot">=&gt;</span> we10<span class="ot">,</span> q <span class="ot">=&gt;</span> r10);</span>
<span id="cb52-63"><a href="#cb52-63" aria-hidden="true" tabindex="-1"></a>  <span class="dv">reg11</span><span class="ot">:</span> <span class="fu">Register16</span> <span class="kw">port map </span>(clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> d <span class="ot">=&gt;</span> wdata<span class="ot">,</span> load <span class="ot">=&gt;</span> we11<span class="ot">,</span> q <span class="ot">=&gt;</span> r11);</span>
<span id="cb52-64"><a href="#cb52-64" aria-hidden="true" tabindex="-1"></a>  <span class="dv">reg12</span><span class="ot">:</span> <span class="fu">Register16</span> <span class="kw">port map </span>(clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> d <span class="ot">=&gt;</span> wdata<span class="ot">,</span> load <span class="ot">=&gt;</span> we12<span class="ot">,</span> q <span class="ot">=&gt;</span> r12);</span>
<span id="cb52-65"><a href="#cb52-65" aria-hidden="true" tabindex="-1"></a>  <span class="dv">reg13</span><span class="ot">:</span> <span class="fu">Register16</span> <span class="kw">port map </span>(clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> d <span class="ot">=&gt;</span> wdata<span class="ot">,</span> load <span class="ot">=&gt;</span> we13<span class="ot">,</span> q <span class="ot">=&gt;</span> r13);</span>
<span id="cb52-66"><a href="#cb52-66" aria-hidden="true" tabindex="-1"></a>  <span class="dv">reg14</span><span class="ot">:</span> <span class="fu">Register16</span> <span class="kw">port map </span>(clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> d <span class="ot">=&gt;</span> wdata<span class="ot">,</span> load <span class="ot">=&gt;</span> we14<span class="ot">,</span> q <span class="ot">=&gt;</span> r14);</span>
<span id="cb52-67"><a href="#cb52-67" aria-hidden="true" tabindex="-1"></a>  <span class="dv">reg15</span><span class="ot">:</span> <span class="fu">Register16</span> <span class="kw">port map </span>(clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> d <span class="ot">=&gt;</span> wdata<span class="ot">,</span> load <span class="ot">=&gt;</span> we15<span class="ot">,</span> q <span class="ot">=&gt;</span> r15);</span>
<span id="cb52-68"><a href="#cb52-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-69"><a href="#cb52-69" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Read port 1: 16:1 mux using two 8:1 muxes + 2:1 mux</span></span>
<span id="cb52-70"><a href="#cb52-70" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_rd1_lo</span><span class="ot">:</span> <span class="fu">Mux8Way16</span> <span class="kw">port map </span>(a<span class="ot">=&gt;</span>r0<span class="ot">,</span>b<span class="ot">=&gt;</span>r1<span class="ot">,</span>c<span class="ot">=&gt;</span>r2<span class="ot">,</span>d<span class="ot">=&gt;</span>r3<span class="ot">,</span>e<span class="ot">=&gt;</span>r4<span class="ot">,</span>f<span class="ot">=&gt;</span>r5<span class="ot">,</span>g<span class="ot">=&gt;</span>r6<span class="ot">,</span>h<span class="ot">=&gt;</span>r7<span class="ot">,</span></span>
<span id="cb52-71"><a href="#cb52-71" aria-hidden="true" tabindex="-1"></a>    sel <span class="ot">=&gt;</span> raddr1(<span class="dv">2</span> <span class="ot">downto</span> <span class="dv">0</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> rd1_lo);</span>
<span id="cb52-72"><a href="#cb52-72" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_rd1_hi</span><span class="ot">:</span> <span class="fu">Mux8Way16</span> <span class="kw">port map </span>(a<span class="ot">=&gt;</span>r8<span class="ot">,</span>b<span class="ot">=&gt;</span>r9<span class="ot">,</span>c<span class="ot">=&gt;</span>r10<span class="ot">,</span>d<span class="ot">=&gt;</span>r11<span class="ot">,</span>e<span class="ot">=&gt;</span>r12<span class="ot">,</span>f<span class="ot">=&gt;</span>r13<span class="ot">,</span>g<span class="ot">=&gt;</span>r14<span class="ot">,</span>h<span class="ot">=&gt;</span>r15<span class="ot">,</span></span>
<span id="cb52-73"><a href="#cb52-73" aria-hidden="true" tabindex="-1"></a>    sel <span class="ot">=&gt;</span> raddr1(<span class="dv">2</span> <span class="ot">downto</span> <span class="dv">0</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> rd1_hi);</span>
<span id="cb52-74"><a href="#cb52-74" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_rd1</span><span class="ot">:</span> <span class="fu">Mux16</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> rd1_lo<span class="ot">,</span> b <span class="ot">=&gt;</span> rd1_hi<span class="ot">,</span> sel <span class="ot">=&gt;</span> raddr1(<span class="dv">3</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> rdata1);</span>
<span id="cb52-75"><a href="#cb52-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-76"><a href="#cb52-76" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Read port 2: same structure</span></span>
<span id="cb52-77"><a href="#cb52-77" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_rd2_lo</span><span class="ot">:</span> <span class="fu">Mux8Way16</span> <span class="kw">port map </span>(a<span class="ot">=&gt;</span>r0<span class="ot">,</span>b<span class="ot">=&gt;</span>r1<span class="ot">,</span>c<span class="ot">=&gt;</span>r2<span class="ot">,</span>d<span class="ot">=&gt;</span>r3<span class="ot">,</span>e<span class="ot">=&gt;</span>r4<span class="ot">,</span>f<span class="ot">=&gt;</span>r5<span class="ot">,</span>g<span class="ot">=&gt;</span>r6<span class="ot">,</span>h<span class="ot">=&gt;</span>r7<span class="ot">,</span></span>
<span id="cb52-78"><a href="#cb52-78" aria-hidden="true" tabindex="-1"></a>    sel <span class="ot">=&gt;</span> raddr2(<span class="dv">2</span> <span class="ot">downto</span> <span class="dv">0</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> rd2_lo);</span>
<span id="cb52-79"><a href="#cb52-79" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_rd2_hi</span><span class="ot">:</span> <span class="fu">Mux8Way16</span> <span class="kw">port map </span>(a<span class="ot">=&gt;</span>r8<span class="ot">,</span>b<span class="ot">=&gt;</span>r9<span class="ot">,</span>c<span class="ot">=&gt;</span>r10<span class="ot">,</span>d<span class="ot">=&gt;</span>r11<span class="ot">,</span>e<span class="ot">=&gt;</span>r12<span class="ot">,</span>f<span class="ot">=&gt;</span>r13<span class="ot">,</span>g<span class="ot">=&gt;</span>r14<span class="ot">,</span>h<span class="ot">=&gt;</span>r15<span class="ot">,</span></span>
<span id="cb52-80"><a href="#cb52-80" aria-hidden="true" tabindex="-1"></a>    sel <span class="ot">=&gt;</span> raddr2(<span class="dv">2</span> <span class="ot">downto</span> <span class="dv">0</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> rd2_hi);</span>
<span id="cb52-81"><a href="#cb52-81" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_rd2</span><span class="ot">:</span> <span class="fu">Mux16</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> rd2_lo<span class="ot">,</span> b <span class="ot">=&gt;</span> rd2_hi<span class="ot">,</span> sel <span class="ot">=&gt;</span> raddr2(<span class="dv">3</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> rdata2);</span>
<span id="cb52-82"><a href="#cb52-82" aria-hidden="true" tabindex="-1"></a><span class="cf">end architecture;</span></span></code></pre></div>
<hr />
<h3 data-number="2.1.31" id="decoder"><span class="header-section-number">2.1.31</span> Decoder</h3>
<div class="sourceCode" id="cb53"><pre class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Instruction Decoder</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="co">-- Decodes opcode into control signals</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="co">-- Opcodes: 0000=ALU, 0100=LOAD, 0101=STORE, 1000=BRANCH</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="cf">entity</span> <span class="dv">Decoder</span> <span class="kw">is</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">port</span>(</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>    opcode    <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">3</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>    alu_op    <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">1</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>    reg_write <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>;</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>    mem_read  <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>;</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>    mem_write <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>;</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>    branch    <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a><span class="cf">end entity;</span></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">rtl</span> <span class="kw">of</span> <span class="fu">Decoder</span> <span class="kw">is</span></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">Inv</span></span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; y <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">And2</span></span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a<span class="ot">,</span> b <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; y <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> not_op3<span class="ot">,</span> not_op2<span class="ot">,</span> not_op1<span class="ot">,</span> not_op0 <span class="ot">:</span> <span class="dt">bit</span>;</span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> is_alu<span class="ot">,</span> is_load<span class="ot">,</span> is_store<span class="ot">,</span> is_branch <span class="ot">:</span> <span class="dt">bit</span>;</span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Invert opcode bits</span></span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a>  <span class="dv">inv3</span><span class="ot">:</span> <span class="fu">Inv</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> opcode(<span class="dv">3</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> not_op3);</span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a>  <span class="dv">inv2</span><span class="ot">:</span> <span class="fu">Inv</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> opcode(<span class="dv">2</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> not_op2);</span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a>  <span class="dv">inv1</span><span class="ot">:</span> <span class="fu">Inv</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> opcode(<span class="dv">1</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> not_op1);</span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a>  <span class="dv">inv0</span><span class="ot">:</span> <span class="fu">Inv</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> opcode(<span class="dv">0</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> not_op0);</span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-32"><a href="#cb53-32" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Decode: ALU = 0000</span></span>
<span id="cb53-33"><a href="#cb53-33" aria-hidden="true" tabindex="-1"></a>  <span class="dv">alu_a</span><span class="ot">:</span> <span class="fu">And2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> not_op3<span class="ot">,</span> b <span class="ot">=&gt;</span> not_op2<span class="ot">,</span> y <span class="ot">=&gt;</span> is_alu);</span>
<span id="cb53-34"><a href="#cb53-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-35"><a href="#cb53-35" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Decode: LOAD = 0100</span></span>
<span id="cb53-36"><a href="#cb53-36" aria-hidden="true" tabindex="-1"></a>  <span class="dv">ld_a</span><span class="ot">:</span> <span class="fu">And2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> not_op3<span class="ot">,</span> b <span class="ot">=&gt;</span> opcode(<span class="dv">2</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> is_load);</span>
<span id="cb53-37"><a href="#cb53-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-38"><a href="#cb53-38" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Decode: STORE = 0101</span></span>
<span id="cb53-39"><a href="#cb53-39" aria-hidden="true" tabindex="-1"></a>  <span class="dv">st_a</span><span class="ot">:</span> <span class="fu">And2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> is_load<span class="ot">,</span> b <span class="ot">=&gt;</span> opcode(<span class="dv">0</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> is_store);</span>
<span id="cb53-40"><a href="#cb53-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-41"><a href="#cb53-41" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Decode: BRANCH = 1xxx</span></span>
<span id="cb53-42"><a href="#cb53-42" aria-hidden="true" tabindex="-1"></a>  <span class="dv">br_a</span><span class="ot">:</span> <span class="fu">Inv</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> not_op3<span class="ot">,</span> y <span class="ot">=&gt;</span> is_branch);</span>
<span id="cb53-43"><a href="#cb53-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-44"><a href="#cb53-44" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Control signals - pass through lower opcode bits for ALU operation</span></span>
<span id="cb53-45"><a href="#cb53-45" aria-hidden="true" tabindex="-1"></a>  alu_op <span class="ot">&lt;=</span> opcode(<span class="dv">1</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb53-46"><a href="#cb53-46" aria-hidden="true" tabindex="-1"></a>  reg_write <span class="ot">&lt;=</span> is_alu;</span>
<span id="cb53-47"><a href="#cb53-47" aria-hidden="true" tabindex="-1"></a>  mem_read <span class="ot">&lt;=</span> is_load;</span>
<span id="cb53-48"><a href="#cb53-48" aria-hidden="true" tabindex="-1"></a>  mem_write <span class="ot">&lt;=</span> is_store;</span>
<span id="cb53-49"><a href="#cb53-49" aria-hidden="true" tabindex="-1"></a>  branch <span class="ot">&lt;=</span> is_branch;</span>
<span id="cb53-50"><a href="#cb53-50" aria-hidden="true" tabindex="-1"></a><span class="cf">end architecture;</span></span></code></pre></div>
<hr />
<h3 data-number="2.1.32" id="condcheck"><span class="header-section-number">2.1.32</span> CondCheck</h3>
<div class="sourceCode" id="cb54"><pre class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Condition Checker</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="co">-- Checks ALU flags against condition code</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="co">-- cond: 0000=EQ (zero), 0001=NE (!zero), 0010=LT (neg), 0011=GE (!neg)</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="cf">entity</span> <span class="dv">CondCheck</span> <span class="kw">is</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">port</span>(</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>    cond <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">3</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>    zero <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>    neg  <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>    carry<span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>    ovf  <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>    take <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a><span class="cf">end entity;</span></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">rtl</span> <span class="kw">of</span> <span class="fu">CondCheck</span> <span class="kw">is</span></span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">Inv</span></span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; y <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">Mux</span></span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a<span class="ot">,</span> b <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; sel <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; y <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> not_zero<span class="ot">,</span> not_neg <span class="ot">:</span> <span class="dt">bit</span>;</span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> eq_result<span class="ot">,</span> ne_result<span class="ot">,</span> lt_result<span class="ot">,</span> ge_result <span class="ot">:</span> <span class="dt">bit</span>;</span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> sel0<span class="ot">,</span> sel1 <span class="ot">:</span> <span class="dt">bit</span>;</span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Invert flags for NE and GE conditions</span></span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a>  <span class="dv">inv_z</span><span class="ot">:</span> <span class="fu">Inv</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> zero<span class="ot">,</span> y <span class="ot">=&gt;</span> not_zero);</span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a>  <span class="dv">inv_n</span><span class="ot">:</span> <span class="fu">Inv</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> neg<span class="ot">,</span> y <span class="ot">=&gt;</span> not_neg);</span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Condition results</span></span>
<span id="cb54-32"><a href="#cb54-32" aria-hidden="true" tabindex="-1"></a>  eq_result <span class="ot">&lt;=</span> zero;       <span class="co">-- EQ: zero=1</span></span>
<span id="cb54-33"><a href="#cb54-33" aria-hidden="true" tabindex="-1"></a>  ne_result <span class="ot">&lt;=</span> not_zero;   <span class="co">-- NE: zero=0</span></span>
<span id="cb54-34"><a href="#cb54-34" aria-hidden="true" tabindex="-1"></a>  lt_result <span class="ot">&lt;=</span> neg;        <span class="co">-- LT: neg=1</span></span>
<span id="cb54-35"><a href="#cb54-35" aria-hidden="true" tabindex="-1"></a>  ge_result <span class="ot">&lt;=</span> not_neg;    <span class="co">-- GE: neg=0</span></span>
<span id="cb54-36"><a href="#cb54-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-37"><a href="#cb54-37" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- 4-way mux using cond(1:0)</span></span>
<span id="cb54-38"><a href="#cb54-38" aria-hidden="true" tabindex="-1"></a>  <span class="dv">mux0</span><span class="ot">:</span> <span class="fu">Mux</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> eq_result<span class="ot">,</span> b <span class="ot">=&gt;</span> ne_result<span class="ot">,</span> sel <span class="ot">=&gt;</span> cond(<span class="dv">0</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> sel0);</span>
<span id="cb54-39"><a href="#cb54-39" aria-hidden="true" tabindex="-1"></a>  <span class="dv">mux1</span><span class="ot">:</span> <span class="fu">Mux</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> lt_result<span class="ot">,</span> b <span class="ot">=&gt;</span> ge_result<span class="ot">,</span> sel <span class="ot">=&gt;</span> cond(<span class="dv">0</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> sel1);</span>
<span id="cb54-40"><a href="#cb54-40" aria-hidden="true" tabindex="-1"></a>  <span class="dv">mux2</span><span class="ot">:</span> <span class="fu">Mux</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> sel0<span class="ot">,</span> b <span class="ot">=&gt;</span> sel1<span class="ot">,</span> sel <span class="ot">=&gt;</span> cond(<span class="dv">1</span>)<span class="ot">,</span> y <span class="ot">=&gt;</span> take);</span>
<span id="cb54-41"><a href="#cb54-41" aria-hidden="true" tabindex="-1"></a><span class="cf">end architecture;</span></span></code></pre></div>
<hr />
<h3 data-number="2.1.33" id="control"><span class="header-section-number">2.1.33</span> Control</h3>
<div class="sourceCode" id="cb55"><pre class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Control Unit</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="co">-- Generates all control signals</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="cf">entity</span> <span class="dv">Control</span> <span class="kw">is</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">port</span>(</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>    clk       <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>    opcode    <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">3</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>    cond      <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">3</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>    zero      <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>    neg       <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>    alu_op    <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">1</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>    reg_write <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>;</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>    mem_read  <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>;</span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>    mem_write <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>;</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>    pc_src    <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span></span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a><span class="cf">end entity;</span></span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">rtl</span> <span class="kw">of</span> <span class="fu">Control</span> <span class="kw">is</span></span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">Decoder</span></span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(opcode <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">3</span> <span class="ot">downto</span> <span class="dv">0</span>); alu_op <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">1</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>         reg_write<span class="ot">,</span> mem_read<span class="ot">,</span> mem_write<span class="ot">,</span> branch <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">CondCheck</span></span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(cond <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">3</span> <span class="ot">downto</span> <span class="dv">0</span>); zero<span class="ot">,</span>neg<span class="ot">,</span>carry<span class="ot">,</span>ovf <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; take <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">And2</span></span>
<span id="cb55-28"><a href="#cb55-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a<span class="ot">,</span> b <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; y <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb55-29"><a href="#cb55-29" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb55-30"><a href="#cb55-30" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> branch_sig<span class="ot">,</span> cond_take <span class="ot">:</span> <span class="dt">bit</span>;</span>
<span id="cb55-31"><a href="#cb55-31" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb55-32"><a href="#cb55-32" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Decoder generates base control signals</span></span>
<span id="cb55-33"><a href="#cb55-33" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_dec</span><span class="ot">:</span> <span class="fu">Decoder</span> <span class="kw">port map </span>(</span>
<span id="cb55-34"><a href="#cb55-34" aria-hidden="true" tabindex="-1"></a>    opcode <span class="ot">=&gt;</span> opcode<span class="ot">,</span></span>
<span id="cb55-35"><a href="#cb55-35" aria-hidden="true" tabindex="-1"></a>    alu_op <span class="ot">=&gt;</span> alu_op<span class="ot">,</span></span>
<span id="cb55-36"><a href="#cb55-36" aria-hidden="true" tabindex="-1"></a>    reg_write <span class="ot">=&gt;</span> reg_write<span class="ot">,</span></span>
<span id="cb55-37"><a href="#cb55-37" aria-hidden="true" tabindex="-1"></a>    mem_read <span class="ot">=&gt;</span> mem_read<span class="ot">,</span></span>
<span id="cb55-38"><a href="#cb55-38" aria-hidden="true" tabindex="-1"></a>    mem_write <span class="ot">=&gt;</span> mem_write<span class="ot">,</span></span>
<span id="cb55-39"><a href="#cb55-39" aria-hidden="true" tabindex="-1"></a>    branch <span class="ot">=&gt;</span> branch_sig</span>
<span id="cb55-40"><a href="#cb55-40" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb55-41"><a href="#cb55-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-42"><a href="#cb55-42" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- CondCheck evaluates branch condition</span></span>
<span id="cb55-43"><a href="#cb55-43" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_cond</span><span class="ot">:</span> <span class="fu">CondCheck</span> <span class="kw">port map </span>(</span>
<span id="cb55-44"><a href="#cb55-44" aria-hidden="true" tabindex="-1"></a>    cond <span class="ot">=&gt;</span> cond<span class="ot">,</span></span>
<span id="cb55-45"><a href="#cb55-45" aria-hidden="true" tabindex="-1"></a>    zero <span class="ot">=&gt;</span> zero<span class="ot">,</span></span>
<span id="cb55-46"><a href="#cb55-46" aria-hidden="true" tabindex="-1"></a>    neg <span class="ot">=&gt;</span> neg<span class="ot">,</span></span>
<span id="cb55-47"><a href="#cb55-47" aria-hidden="true" tabindex="-1"></a>    carry <span class="ot">=&gt;</span> <span class="bn">&#39;0&#39;</span><span class="ot">,</span></span>
<span id="cb55-48"><a href="#cb55-48" aria-hidden="true" tabindex="-1"></a>    ovf <span class="ot">=&gt;</span> <span class="bn">&#39;0&#39;</span><span class="ot">,</span></span>
<span id="cb55-49"><a href="#cb55-49" aria-hidden="true" tabindex="-1"></a>    take <span class="ot">=&gt;</span> cond_take</span>
<span id="cb55-50"><a href="#cb55-50" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb55-51"><a href="#cb55-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-52"><a href="#cb55-52" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- pc_src = branch AND condition_met</span></span>
<span id="cb55-53"><a href="#cb55-53" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_and</span><span class="ot">:</span> <span class="fu">And2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> branch_sig<span class="ot">,</span> b <span class="ot">=&gt;</span> cond_take<span class="ot">,</span> y <span class="ot">=&gt;</span> pc_src);</span>
<span id="cb55-54"><a href="#cb55-54" aria-hidden="true" tabindex="-1"></a><span class="cf">end architecture;</span></span></code></pre></div>
<hr />
<h3 data-number="2.1.34" id="cpu"><span class="header-section-number">2.1.34</span> CPU</h3>
<div class="sourceCode" id="cb56"><pre class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- A32-Lite CPU</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="co">-- Simple 16-bit RISC processor</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="co">-- Instruction format: [15:12]=opcode, [11:8]=rd, [7:4]=rs1, [3:0]=rs2/imm</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="cf">entity</span> <span class="dv">CPU</span> <span class="kw">is</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">port</span>(</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>    clk     <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>    reset   <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>    instr   <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>    mem_in  <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>    mem_out <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>    mem_addr<span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>    mem_we  <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>;</span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>    pc_out  <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>)</span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a><span class="cf">end entity;</span></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">rtl</span> <span class="kw">of</span> <span class="fu">CPU</span> <span class="kw">is</span></span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">RegFile</span></span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(clk<span class="ot">,</span>we <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; waddr<span class="ot">,</span>raddr1<span class="ot">,</span>raddr2 <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">3</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>         wdata <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>); rdata1<span class="ot">,</span>rdata2 <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>));</span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">ALU</span></span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a<span class="ot">,</span>b <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>); op <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">1</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a>         y <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>); zero<span class="ot">,</span>neg <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">PC</span></span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(clk <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; d <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>); inc<span class="ot">,</span>load<span class="ot">,</span>reset <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; q <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>));</span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb56-30"><a href="#cb56-30" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">Control</span></span>
<span id="cb56-31"><a href="#cb56-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(clk <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; opcode<span class="ot">,</span>cond <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">3</span> <span class="ot">downto</span> <span class="dv">0</span>); zero<span class="ot">,</span>neg <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb56-32"><a href="#cb56-32" aria-hidden="true" tabindex="-1"></a>         alu_op <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">1</span> <span class="ot">downto</span> <span class="dv">0</span>); reg_write<span class="ot">,</span>mem_read<span class="ot">,</span>mem_write<span class="ot">,</span>pc_src <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb56-33"><a href="#cb56-33" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb56-34"><a href="#cb56-34" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">Mux16</span></span>
<span id="cb56-35"><a href="#cb56-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a<span class="ot">,</span>b <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>); sel <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; y <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>));</span>
<span id="cb56-36"><a href="#cb56-36" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb56-37"><a href="#cb56-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-38"><a href="#cb56-38" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Instruction decode</span></span>
<span id="cb56-39"><a href="#cb56-39" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> opcode<span class="ot">,</span> rd<span class="ot">,</span> rs1<span class="ot">,</span> rs2 <span class="ot">:</span> bits(<span class="dv">3</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb56-40"><a href="#cb56-40" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Control signals</span></span>
<span id="cb56-41"><a href="#cb56-41" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> alu_op <span class="ot">:</span> bits(<span class="dv">1</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb56-42"><a href="#cb56-42" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> reg_write<span class="ot">,</span> mem_rd<span class="ot">,</span> mem_wr<span class="ot">,</span> pc_src <span class="ot">:</span> <span class="dt">bit</span>;</span>
<span id="cb56-43"><a href="#cb56-43" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Datapath signals</span></span>
<span id="cb56-44"><a href="#cb56-44" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> pc_val<span class="ot">,</span> branch_target <span class="ot">:</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb56-45"><a href="#cb56-45" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> reg_data1<span class="ot">,</span> reg_data2<span class="ot">,</span> alu_result <span class="ot">:</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb56-46"><a href="#cb56-46" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> write_data <span class="ot">:</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb56-47"><a href="#cb56-47" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> zero_flag<span class="ot">,</span> neg_flag <span class="ot">:</span> <span class="dt">bit</span>;</span>
<span id="cb56-48"><a href="#cb56-48" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> not_reset <span class="ot">:</span> <span class="dt">bit</span>;</span>
<span id="cb56-49"><a href="#cb56-49" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">Inv</span></span>
<span id="cb56-50"><a href="#cb56-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; y <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb56-51"><a href="#cb56-51" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb56-52"><a href="#cb56-52" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb56-53"><a href="#cb56-53" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Instruction decode using slices</span></span>
<span id="cb56-54"><a href="#cb56-54" aria-hidden="true" tabindex="-1"></a>  opcode <span class="ot">&lt;=</span> instr(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">12</span>);</span>
<span id="cb56-55"><a href="#cb56-55" aria-hidden="true" tabindex="-1"></a>  rd <span class="ot">&lt;=</span> instr(<span class="dv">11</span> <span class="ot">downto</span> <span class="dv">8</span>);</span>
<span id="cb56-56"><a href="#cb56-56" aria-hidden="true" tabindex="-1"></a>  rs1 <span class="ot">&lt;=</span> instr(<span class="dv">7</span> <span class="ot">downto</span> <span class="dv">4</span>);</span>
<span id="cb56-57"><a href="#cb56-57" aria-hidden="true" tabindex="-1"></a>  rs2 <span class="ot">&lt;=</span> instr(<span class="dv">3</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb56-58"><a href="#cb56-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-59"><a href="#cb56-59" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Control unit</span></span>
<span id="cb56-60"><a href="#cb56-60" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_ctrl</span><span class="ot">:</span> <span class="fu">Control</span> <span class="kw">port map </span>(</span>
<span id="cb56-61"><a href="#cb56-61" aria-hidden="true" tabindex="-1"></a>    clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> opcode <span class="ot">=&gt;</span> opcode<span class="ot">,</span> cond <span class="ot">=&gt;</span> rs2<span class="ot">,</span></span>
<span id="cb56-62"><a href="#cb56-62" aria-hidden="true" tabindex="-1"></a>    zero <span class="ot">=&gt;</span> zero_flag<span class="ot">,</span> neg <span class="ot">=&gt;</span> neg_flag<span class="ot">,</span></span>
<span id="cb56-63"><a href="#cb56-63" aria-hidden="true" tabindex="-1"></a>    alu_op <span class="ot">=&gt;</span> alu_op<span class="ot">,</span> reg_write <span class="ot">=&gt;</span> reg_write<span class="ot">,</span></span>
<span id="cb56-64"><a href="#cb56-64" aria-hidden="true" tabindex="-1"></a>    mem_read <span class="ot">=&gt;</span> mem_rd<span class="ot">,</span> mem_write <span class="ot">=&gt;</span> mem_wr<span class="ot">,</span> pc_src <span class="ot">=&gt;</span> pc_src</span>
<span id="cb56-65"><a href="#cb56-65" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb56-66"><a href="#cb56-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-67"><a href="#cb56-67" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Register file</span></span>
<span id="cb56-68"><a href="#cb56-68" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_regs</span><span class="ot">:</span> <span class="fu">RegFile</span> <span class="kw">port map </span>(</span>
<span id="cb56-69"><a href="#cb56-69" aria-hidden="true" tabindex="-1"></a>    clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> we <span class="ot">=&gt;</span> reg_write<span class="ot">,</span></span>
<span id="cb56-70"><a href="#cb56-70" aria-hidden="true" tabindex="-1"></a>    waddr <span class="ot">=&gt;</span> rd<span class="ot">,</span> raddr1 <span class="ot">=&gt;</span> rs1<span class="ot">,</span> raddr2 <span class="ot">=&gt;</span> rs2<span class="ot">,</span></span>
<span id="cb56-71"><a href="#cb56-71" aria-hidden="true" tabindex="-1"></a>    wdata <span class="ot">=&gt;</span> write_data<span class="ot">,</span> rdata1 <span class="ot">=&gt;</span> reg_data1<span class="ot">,</span> rdata2 <span class="ot">=&gt;</span> reg_data2</span>
<span id="cb56-72"><a href="#cb56-72" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb56-73"><a href="#cb56-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-74"><a href="#cb56-74" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- ALU</span></span>
<span id="cb56-75"><a href="#cb56-75" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_alu</span><span class="ot">:</span> <span class="fu">ALU</span> <span class="kw">port map </span>(</span>
<span id="cb56-76"><a href="#cb56-76" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">=&gt;</span> reg_data1<span class="ot">,</span> b <span class="ot">=&gt;</span> reg_data2<span class="ot">,</span> op <span class="ot">=&gt;</span> alu_op<span class="ot">,</span></span>
<span id="cb56-77"><a href="#cb56-77" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">=&gt;</span> alu_result<span class="ot">,</span> zero <span class="ot">=&gt;</span> zero_flag<span class="ot">,</span> neg <span class="ot">=&gt;</span> neg_flag</span>
<span id="cb56-78"><a href="#cb56-78" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb56-79"><a href="#cb56-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-80"><a href="#cb56-80" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Write back mux (ALU result or memory)</span></span>
<span id="cb56-81"><a href="#cb56-81" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_wb_mux</span><span class="ot">:</span> <span class="fu">Mux16</span> <span class="kw">port map </span>(</span>
<span id="cb56-82"><a href="#cb56-82" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">=&gt;</span> alu_result<span class="ot">,</span> b <span class="ot">=&gt;</span> mem_in<span class="ot">,</span> sel <span class="ot">=&gt;</span> mem_rd<span class="ot">,</span> y <span class="ot">=&gt;</span> write_data</span>
<span id="cb56-83"><a href="#cb56-83" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb56-84"><a href="#cb56-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-85"><a href="#cb56-85" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Program counter</span></span>
<span id="cb56-86"><a href="#cb56-86" aria-hidden="true" tabindex="-1"></a>  <span class="dv">inv_reset</span><span class="ot">:</span> <span class="fu">Inv</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> reset<span class="ot">,</span> y <span class="ot">=&gt;</span> not_reset);</span>
<span id="cb56-87"><a href="#cb56-87" aria-hidden="true" tabindex="-1"></a>  branch_target <span class="ot">&lt;=</span> reg_data1;</span>
<span id="cb56-88"><a href="#cb56-88" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_pc</span><span class="ot">:</span> <span class="fu">PC</span> <span class="kw">port map </span>(</span>
<span id="cb56-89"><a href="#cb56-89" aria-hidden="true" tabindex="-1"></a>    clk <span class="ot">=&gt;</span> clk<span class="ot">,</span> d <span class="ot">=&gt;</span> branch_target<span class="ot">,</span></span>
<span id="cb56-90"><a href="#cb56-90" aria-hidden="true" tabindex="-1"></a>    inc <span class="ot">=&gt;</span> not_reset<span class="ot">,</span> load <span class="ot">=&gt;</span> pc_src<span class="ot">,</span> reset <span class="ot">=&gt;</span> reset<span class="ot">,</span> q <span class="ot">=&gt;</span> pc_val</span>
<span id="cb56-91"><a href="#cb56-91" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb56-92"><a href="#cb56-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-93"><a href="#cb56-93" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Outputs</span></span>
<span id="cb56-94"><a href="#cb56-94" aria-hidden="true" tabindex="-1"></a>  pc_out <span class="ot">&lt;=</span> pc_val;</span>
<span id="cb56-95"><a href="#cb56-95" aria-hidden="true" tabindex="-1"></a>  mem_addr <span class="ot">&lt;=</span> alu_result;</span>
<span id="cb56-96"><a href="#cb56-96" aria-hidden="true" tabindex="-1"></a>  mem_out <span class="ot">&lt;=</span> reg_data2;</span>
<span id="cb56-97"><a href="#cb56-97" aria-hidden="true" tabindex="-1"></a>  mem_we <span class="ot">&lt;=</span> mem_wr;</span>
<span id="cb56-98"><a href="#cb56-98" aria-hidden="true" tabindex="-1"></a><span class="cf">end architecture;</span></span></code></pre></div>
<hr />
<h3 data-number="2.1.35" id="if_id_reg"><span class="header-section-number">2.1.35</span> IF_ID_Reg</h3>
<div class="sourceCode" id="cb57"><pre class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- IF/ID Pipeline Register</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="cf">entity</span> <span class="dv">IF_ID_Reg</span> <span class="kw">is</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">port</span>(</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>    clk <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>    reset <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>    stall <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>    flush <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>    if_instr <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">31</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>    if_pc_plus4 <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">31</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>    id_instr <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">31</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>    id_pc_plus4 <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">31</span> <span class="ot">downto</span> <span class="dv">0</span>)</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a><span class="cf">end entity;</span></span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">rtl</span> <span class="kw">of</span> <span class="fu">IF_ID_Reg</span> <span class="kw">is</span></span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> instr_reg <span class="ot">:</span> bits(<span class="dv">31</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> pc_plus4_reg <span class="ot">:</span> bits(<span class="dv">31</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a>  <span class="sc">process</span>(clk)</span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a>  <span class="sc">begin</span></span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">rising_edge</span>(clk) <span class="cf">then</span></span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (reset <span class="ot">=</span> <span class="bn">&#39;1&#39;</span>) <span class="kw">or</span> (flush <span class="ot">=</span> <span class="bn">&#39;1&#39;</span>) <span class="cf">then</span></span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a>        instr_reg <span class="ot">&lt;=</span> x<span class="st">&quot;E0000000&quot;</span>;  <span class="co">-- NOP</span></span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a>        pc_plus4_reg <span class="ot">&lt;=</span> x<span class="st">&quot;00000000&quot;</span>;</span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a>      <span class="cf">elsif</span> stall <span class="ot">=</span> <span class="bn">&#39;0&#39;</span> <span class="cf">then</span></span>
<span id="cb57-27"><a href="#cb57-27" aria-hidden="true" tabindex="-1"></a>        instr_reg <span class="ot">&lt;=</span> if_instr;</span>
<span id="cb57-28"><a href="#cb57-28" aria-hidden="true" tabindex="-1"></a>        pc_plus4_reg <span class="ot">&lt;=</span> if_pc_plus4;</span>
<span id="cb57-29"><a href="#cb57-29" aria-hidden="true" tabindex="-1"></a>      <span class="cf">end if;</span></span>
<span id="cb57-30"><a href="#cb57-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end if;</span></span>
<span id="cb57-31"><a href="#cb57-31" aria-hidden="true" tabindex="-1"></a>  <span class="sc">end process;</span></span>
<span id="cb57-32"><a href="#cb57-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-33"><a href="#cb57-33" aria-hidden="true" tabindex="-1"></a>  id_instr <span class="ot">&lt;=</span> instr_reg;</span>
<span id="cb57-34"><a href="#cb57-34" aria-hidden="true" tabindex="-1"></a>  id_pc_plus4 <span class="ot">&lt;=</span> pc_plus4_reg;</span>
<span id="cb57-35"><a href="#cb57-35" aria-hidden="true" tabindex="-1"></a><span class="cf">end architecture;</span></span></code></pre></div>
<hr />
<h3 data-number="2.1.36" id="hazarddetect"><span class="header-section-number">2.1.36</span> HazardDetect</h3>
<div class="sourceCode" id="cb58"><pre class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Hazard Detection Unit</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="cf">entity</span> <span class="dv">HazardDetect</span> <span class="kw">is</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">port</span>(</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>    id_rn <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">3</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>    id_rm <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">3</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>    id_rn_used <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>    id_rm_used <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>    ex_rd <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">3</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>    ex_mem_read <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>    stall <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a><span class="cf">end entity;</span></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">rtl</span> <span class="kw">of</span> <span class="fu">HazardDetect</span> <span class="kw">is</span></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> rn_hazard <span class="ot">:</span> <span class="dt">bit</span>;</span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> rm_hazard <span class="ot">:</span> <span class="dt">bit</span>;</span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Hazard if: load in EX AND register used in ID AND same register</span></span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a>  rn_hazard <span class="ot">&lt;=</span> ex_mem_read <span class="kw">and</span> id_rn_used <span class="kw">and</span> (id_rn <span class="ot">=</span> ex_rd);</span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a>  rm_hazard <span class="ot">&lt;=</span> ex_mem_read <span class="kw">and</span> id_rm_used <span class="kw">and</span> (id_rm <span class="ot">=</span> ex_rd);</span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a>  stall <span class="ot">&lt;=</span> rn_hazard <span class="kw">or</span> rm_hazard;</span>
<span id="cb58-23"><a href="#cb58-23" aria-hidden="true" tabindex="-1"></a><span class="cf">end architecture;</span></span></code></pre></div>
<hr />
<h3 data-number="2.1.37" id="forwardunit"><span class="header-section-number">2.1.37</span> ForwardUnit</h3>
<div class="sourceCode" id="cb59"><pre class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Forwarding Unit</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="cf">entity</span> <span class="dv">ForwardUnit</span> <span class="kw">is</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">port</span>(</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>    ex_rn <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">3</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>    ex_rm <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">3</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>    mem_rd <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">3</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>    mem_reg_write <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>    wb_rd <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">3</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>    wb_reg_write <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>    forward_a <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">1</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>    forward_b <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">1</span> <span class="ot">downto</span> <span class="dv">0</span>)</span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a><span class="cf">end entity;</span></span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">rtl</span> <span class="kw">of</span> <span class="fu">ForwardUnit</span> <span class="kw">is</span></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> mem_fwd_a <span class="ot">:</span> <span class="dt">bit</span>;</span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> wb_fwd_a <span class="ot">:</span> <span class="dt">bit</span>;</span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> mem_fwd_b <span class="ot">:</span> <span class="dt">bit</span>;</span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> wb_fwd_b <span class="ot">:</span> <span class="dt">bit</span>;</span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Detect forwarding conditions</span></span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a>  mem_fwd_a <span class="ot">&lt;=</span> mem_reg_write <span class="kw">and</span> (mem_rd <span class="ot">=</span> ex_rn);</span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a>  wb_fwd_a <span class="ot">&lt;=</span> wb_reg_write <span class="kw">and</span> (wb_rd <span class="ot">=</span> ex_rn) <span class="kw">and</span> (<span class="kw">not</span> mem_fwd_a);</span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a>  mem_fwd_b <span class="ot">&lt;=</span> mem_reg_write <span class="kw">and</span> (mem_rd <span class="ot">=</span> ex_rm);</span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a>  wb_fwd_b <span class="ot">&lt;=</span> wb_reg_write <span class="kw">and</span> (wb_rd <span class="ot">=</span> ex_rm) <span class="kw">and</span> (<span class="kw">not</span> mem_fwd_b);</span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Encode output: 00=none, 01=MEM, 10=WB</span></span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a>  forward_a <span class="ot">&lt;=</span> wb_fwd_a <span class="ot">&amp;</span> mem_fwd_a;</span>
<span id="cb59-30"><a href="#cb59-30" aria-hidden="true" tabindex="-1"></a>  forward_b <span class="ot">&lt;=</span> wb_fwd_b <span class="ot">&amp;</span> mem_fwd_b;</span>
<span id="cb59-31"><a href="#cb59-31" aria-hidden="true" tabindex="-1"></a><span class="cf">end architecture;</span></span></code></pre></div>
<hr />
<h3 data-number="2.1.38" id="cpu_pipeline"><span class="header-section-number">2.1.38</span> CPU_Pipeline</h3>
<div class="sourceCode" id="cb60"><pre class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- 5-Stage Pipelined CPU</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="co">-- See hdl_lib/05_cpu/CPU_Pipeline.hdl for full implementation</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="co">-- This exercise is a capstone project</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="cf">entity</span> <span class="dv">CPU_Pipeline</span> <span class="kw">is</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">port</span>(</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>    clk <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>    reset <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>    instr_addr <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">31</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>    instr_data <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">31</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>    mem_addr <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">31</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>    mem_wdata <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">31</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>    mem_rdata <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">31</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>    mem_read <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>;</span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>    mem_write <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>;</span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>    halted <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span></span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a><span class="cf">end entity;</span></span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">rtl</span> <span class="kw">of</span> <span class="fu">CPU_Pipeline</span> <span class="kw">is</span></span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Implementation uses IF_ID_Reg, HazardDetect, ForwardUnit</span></span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- and additional pipeline registers EX_MEM, MEM_WB</span></span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- See hdl_lib/05_cpu/CPU_Pipeline.hdl for complete code</span></span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a>  instr_addr <span class="ot">&lt;=</span> x<span class="st">&quot;00000000&quot;</span>;</span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a>  mem_addr <span class="ot">&lt;=</span> x<span class="st">&quot;00000000&quot;</span>;</span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true" tabindex="-1"></a>  mem_wdata <span class="ot">&lt;=</span> x<span class="st">&quot;00000000&quot;</span>;</span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true" tabindex="-1"></a>  mem_read <span class="ot">&lt;=</span> <span class="bn">&#39;0&#39;</span>;</span>
<span id="cb60-29"><a href="#cb60-29" aria-hidden="true" tabindex="-1"></a>  mem_write <span class="ot">&lt;=</span> <span class="bn">&#39;0&#39;</span>;</span>
<span id="cb60-30"><a href="#cb60-30" aria-hidden="true" tabindex="-1"></a>  halted <span class="ot">&lt;=</span> <span class="bn">&#39;0&#39;</span>;</span>
<span id="cb60-31"><a href="#cb60-31" aria-hidden="true" tabindex="-1"></a><span class="cf">end architecture;</span></span></code></pre></div>
<hr />
<h3 data-number="2.1.39" id="projet-7-cache-l1"><span class="header-section-number">2.1.39</span> Projet 7 : Cache L1</h3>
<h3 data-number="2.1.40" id="cacheline"><span class="header-section-number">2.1.40</span> CacheLine</h3>
<div class="sourceCode" id="cb61"><pre class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Cache Line</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="cf">entity</span> <span class="dv">CacheLine</span> <span class="kw">is</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">port</span>(</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>    clk <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>    write_enable <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>    write_tag <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">19</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>    write_data <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">127</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>    write_word <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">31</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>    write_word_sel <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">1</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>    write_word_en <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>    set_dirty <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>    clear_dirty <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>    invalidate <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>    valid <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>;</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a>    dirty <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>;</span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a>    tag <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">19</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">127</span> <span class="ot">downto</span> <span class="dv">0</span>)</span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a><span class="cf">end entity;</span></span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">rtl</span> <span class="kw">of</span> <span class="fu">CacheLine</span> <span class="kw">is</span></span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> valid_reg <span class="ot">:</span> <span class="dt">bit</span>;</span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> dirty_reg <span class="ot">:</span> <span class="dt">bit</span>;</span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> tag_reg <span class="ot">:</span> bits(<span class="dv">19</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> data_reg <span class="ot">:</span> bits(<span class="dv">127</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb61-28"><a href="#cb61-28" aria-hidden="true" tabindex="-1"></a>  <span class="sc">process</span>(clk)</span>
<span id="cb61-29"><a href="#cb61-29" aria-hidden="true" tabindex="-1"></a>  <span class="sc">begin</span></span>
<span id="cb61-30"><a href="#cb61-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">rising_edge</span>(clk) <span class="cf">then</span></span>
<span id="cb61-31"><a href="#cb61-31" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> invalidate <span class="ot">=</span> <span class="bn">&#39;1&#39;</span> <span class="cf">then</span></span>
<span id="cb61-32"><a href="#cb61-32" aria-hidden="true" tabindex="-1"></a>        valid_reg <span class="ot">&lt;=</span> <span class="bn">&#39;0&#39;</span>;</span>
<span id="cb61-33"><a href="#cb61-33" aria-hidden="true" tabindex="-1"></a>        dirty_reg <span class="ot">&lt;=</span> <span class="bn">&#39;0&#39;</span>;</span>
<span id="cb61-34"><a href="#cb61-34" aria-hidden="true" tabindex="-1"></a>      <span class="cf">elsif</span> write_enable <span class="ot">=</span> <span class="bn">&#39;1&#39;</span> <span class="cf">then</span></span>
<span id="cb61-35"><a href="#cb61-35" aria-hidden="true" tabindex="-1"></a>        valid_reg <span class="ot">&lt;=</span> <span class="bn">&#39;1&#39;</span>;</span>
<span id="cb61-36"><a href="#cb61-36" aria-hidden="true" tabindex="-1"></a>        tag_reg <span class="ot">&lt;=</span> write_tag;</span>
<span id="cb61-37"><a href="#cb61-37" aria-hidden="true" tabindex="-1"></a>        data_reg <span class="ot">&lt;=</span> write_data;</span>
<span id="cb61-38"><a href="#cb61-38" aria-hidden="true" tabindex="-1"></a>        dirty_reg <span class="ot">&lt;=</span> <span class="bn">&#39;0&#39;</span>;</span>
<span id="cb61-39"><a href="#cb61-39" aria-hidden="true" tabindex="-1"></a>      <span class="cf">elsif</span> write_word_en <span class="ot">=</span> <span class="bn">&#39;1&#39;</span> <span class="cf">then</span></span>
<span id="cb61-40"><a href="#cb61-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> write_word_sel <span class="ot">=</span> b<span class="st">&quot;00&quot;</span> <span class="cf">then</span></span>
<span id="cb61-41"><a href="#cb61-41" aria-hidden="true" tabindex="-1"></a>          data_reg(<span class="dv">31</span> <span class="ot">downto</span> <span class="dv">0</span>) <span class="ot">&lt;=</span> write_word;</span>
<span id="cb61-42"><a href="#cb61-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elsif</span> write_word_sel <span class="ot">=</span> b<span class="st">&quot;01&quot;</span> <span class="cf">then</span></span>
<span id="cb61-43"><a href="#cb61-43" aria-hidden="true" tabindex="-1"></a>          data_reg(<span class="dv">63</span> <span class="ot">downto</span> <span class="dv">32</span>) <span class="ot">&lt;=</span> write_word;</span>
<span id="cb61-44"><a href="#cb61-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elsif</span> write_word_sel <span class="ot">=</span> b<span class="st">&quot;10&quot;</span> <span class="cf">then</span></span>
<span id="cb61-45"><a href="#cb61-45" aria-hidden="true" tabindex="-1"></a>          data_reg(<span class="dv">95</span> <span class="ot">downto</span> <span class="dv">64</span>) <span class="ot">&lt;=</span> write_word;</span>
<span id="cb61-46"><a href="#cb61-46" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span></span>
<span id="cb61-47"><a href="#cb61-47" aria-hidden="true" tabindex="-1"></a>          data_reg(<span class="dv">127</span> <span class="ot">downto</span> <span class="dv">96</span>) <span class="ot">&lt;=</span> write_word;</span>
<span id="cb61-48"><a href="#cb61-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">end if;</span></span>
<span id="cb61-49"><a href="#cb61-49" aria-hidden="true" tabindex="-1"></a>      <span class="cf">end if;</span></span>
<span id="cb61-50"><a href="#cb61-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-51"><a href="#cb61-51" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> set_dirty <span class="ot">=</span> <span class="bn">&#39;1&#39;</span> <span class="cf">then</span></span>
<span id="cb61-52"><a href="#cb61-52" aria-hidden="true" tabindex="-1"></a>        dirty_reg <span class="ot">&lt;=</span> <span class="bn">&#39;1&#39;</span>;</span>
<span id="cb61-53"><a href="#cb61-53" aria-hidden="true" tabindex="-1"></a>      <span class="cf">elsif</span> clear_dirty <span class="ot">=</span> <span class="bn">&#39;1&#39;</span> <span class="cf">then</span></span>
<span id="cb61-54"><a href="#cb61-54" aria-hidden="true" tabindex="-1"></a>        dirty_reg <span class="ot">&lt;=</span> <span class="bn">&#39;0&#39;</span>;</span>
<span id="cb61-55"><a href="#cb61-55" aria-hidden="true" tabindex="-1"></a>      <span class="cf">end if;</span></span>
<span id="cb61-56"><a href="#cb61-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end if;</span></span>
<span id="cb61-57"><a href="#cb61-57" aria-hidden="true" tabindex="-1"></a>  <span class="sc">end process;</span></span>
<span id="cb61-58"><a href="#cb61-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-59"><a href="#cb61-59" aria-hidden="true" tabindex="-1"></a>  valid <span class="ot">&lt;=</span> valid_reg;</span>
<span id="cb61-60"><a href="#cb61-60" aria-hidden="true" tabindex="-1"></a>  dirty <span class="ot">&lt;=</span> dirty_reg;</span>
<span id="cb61-61"><a href="#cb61-61" aria-hidden="true" tabindex="-1"></a>  tag <span class="ot">&lt;=</span> tag_reg;</span>
<span id="cb61-62"><a href="#cb61-62" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;=</span> data_reg;</span>
<span id="cb61-63"><a href="#cb61-63" aria-hidden="true" tabindex="-1"></a><span class="cf">end architecture;</span></span></code></pre></div>
<hr />
<h3 data-number="2.1.41" id="tagcompare"><span class="header-section-number">2.1.41</span> TagCompare</h3>
<div class="sourceCode" id="cb62"><pre class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Tag Comparator</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="cf">entity</span> <span class="dv">TagCompare</span> <span class="kw">is</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">port</span>(</span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>    valid <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>    addr_tag <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">19</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>    stored_tag <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">19</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>    hit <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a><span class="cf">end entity;</span></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">rtl</span> <span class="kw">of</span> <span class="fu">TagCompare</span> <span class="kw">is</span></span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Hit when valid AND all 20 tag bits match</span></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>  hit <span class="ot">&lt;=</span> valid <span class="kw">and</span> (addr_tag <span class="ot">=</span> stored_tag);</span>
<span id="cb62-16"><a href="#cb62-16" aria-hidden="true" tabindex="-1"></a><span class="cf">end architecture;</span></span></code></pre></div>
<hr />
<h3 data-number="2.1.42" id="wordselect"><span class="header-section-number">2.1.42</span> WordSelect</h3>
<div class="sourceCode" id="cb63"><pre class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Word Selector</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="cf">entity</span> <span class="dv">WordSelect</span> <span class="kw">is</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">port</span>(</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>    line_data <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">127</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>    word_sel <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">1</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>    word_out <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">31</span> <span class="ot">downto</span> <span class="dv">0</span>)</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a><span class="cf">end entity;</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">rtl</span> <span class="kw">of</span> <span class="fu">WordSelect</span> <span class="kw">is</span></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">Mux4Way16</span></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a<span class="ot">,</span>b<span class="ot">,</span>c<span class="ot">,</span>d <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>); sel <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">1</span> <span class="ot">downto</span> <span class="dv">0</span>); y <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>));</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Use two 16-bit 4-way muxes for lower and upper halves</span></span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>  <span class="dv">lo</span><span class="ot">:</span> <span class="fu">Mux4Way16</span> <span class="kw">port map</span>(</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">=&gt;</span> line_data(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>)<span class="ot">,</span></span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>    b <span class="ot">=&gt;</span> line_data(<span class="dv">47</span> <span class="ot">downto</span> <span class="dv">32</span>)<span class="ot">,</span></span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>    c <span class="ot">=&gt;</span> line_data(<span class="dv">79</span> <span class="ot">downto</span> <span class="dv">64</span>)<span class="ot">,</span></span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>    d <span class="ot">=&gt;</span> line_data(<span class="dv">111</span> <span class="ot">downto</span> <span class="dv">96</span>)<span class="ot">,</span></span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>    sel <span class="ot">=&gt;</span> word_sel<span class="ot">,</span></span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">=&gt;</span> word_out(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>)</span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a>  <span class="dv">hi</span><span class="ot">:</span> <span class="fu">Mux4Way16</span> <span class="kw">port map</span>(</span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">=&gt;</span> line_data(<span class="dv">31</span> <span class="ot">downto</span> <span class="dv">16</span>)<span class="ot">,</span></span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a>    b <span class="ot">=&gt;</span> line_data(<span class="dv">63</span> <span class="ot">downto</span> <span class="dv">48</span>)<span class="ot">,</span></span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a>    c <span class="ot">=&gt;</span> line_data(<span class="dv">95</span> <span class="ot">downto</span> <span class="dv">80</span>)<span class="ot">,</span></span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a>    d <span class="ot">=&gt;</span> line_data(<span class="dv">127</span> <span class="ot">downto</span> <span class="dv">112</span>)<span class="ot">,</span></span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a>    sel <span class="ot">=&gt;</span> word_sel<span class="ot">,</span></span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">=&gt;</span> word_out(<span class="dv">31</span> <span class="ot">downto</span> <span class="dv">16</span>)</span>
<span id="cb63-32"><a href="#cb63-32" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb63-33"><a href="#cb63-33" aria-hidden="true" tabindex="-1"></a><span class="cf">end architecture;</span></span></code></pre></div>
<hr />
<h3 data-number="2.1.43" id="cachecontroller"><span class="header-section-number">2.1.43</span> CacheController</h3>
<div class="sourceCode" id="cb64"><pre class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Cache Controller FSM</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="cf">entity</span> <span class="dv">CacheController</span> <span class="kw">is</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">port</span>(</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>    clk <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>    reset <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>    cpu_read <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>    cpu_write <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>    cache_hit <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>    mem_ready <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>    state <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">1</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>    cpu_ready <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>;</span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>    mem_read <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>;</span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>    mem_write <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>;</span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>    fill_line <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span></span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a><span class="cf">end entity;</span></span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">rtl</span> <span class="kw">of</span> <span class="fu">CacheController</span> <span class="kw">is</span></span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> state_reg <span class="ot">:</span> bits(<span class="dv">1</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> pending_write <span class="ot">:</span> <span class="dt">bit</span>;</span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> fill_line_reg <span class="ot">:</span> <span class="dt">bit</span>;</span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> is_idle<span class="ot">,</span> is_fetch<span class="ot">,</span> is_wb <span class="ot">:</span> <span class="dt">bit</span>;</span>
<span id="cb64-24"><a href="#cb64-24" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> miss<span class="ot">,</span> req <span class="ot">:</span> <span class="dt">bit</span>;</span>
<span id="cb64-25"><a href="#cb64-25" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb64-26"><a href="#cb64-26" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Precompute conditions</span></span>
<span id="cb64-27"><a href="#cb64-27" aria-hidden="true" tabindex="-1"></a>  is_idle <span class="ot">&lt;=</span> (state_reg <span class="ot">=</span> <span class="dv">0</span>b00);</span>
<span id="cb64-28"><a href="#cb64-28" aria-hidden="true" tabindex="-1"></a>  is_fetch <span class="ot">&lt;=</span> (state_reg <span class="ot">=</span> <span class="dv">0</span>b01);</span>
<span id="cb64-29"><a href="#cb64-29" aria-hidden="true" tabindex="-1"></a>  is_wb <span class="ot">&lt;=</span> (state_reg <span class="ot">=</span> <span class="dv">0</span>b10);</span>
<span id="cb64-30"><a href="#cb64-30" aria-hidden="true" tabindex="-1"></a>  miss <span class="ot">&lt;=</span> <span class="kw">not</span> cache_hit;</span>
<span id="cb64-31"><a href="#cb64-31" aria-hidden="true" tabindex="-1"></a>  req <span class="ot">&lt;=</span> cpu_read <span class="kw">or</span> cpu_write;</span>
<span id="cb64-32"><a href="#cb64-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-33"><a href="#cb64-33" aria-hidden="true" tabindex="-1"></a>  <span class="sc">process</span>(clk)</span>
<span id="cb64-34"><a href="#cb64-34" aria-hidden="true" tabindex="-1"></a>  <span class="sc">begin</span></span>
<span id="cb64-35"><a href="#cb64-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">rising_edge</span>(clk) <span class="cf">then</span></span>
<span id="cb64-36"><a href="#cb64-36" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> reset <span class="ot">=</span> <span class="bn">&#39;1&#39;</span> <span class="cf">then</span></span>
<span id="cb64-37"><a href="#cb64-37" aria-hidden="true" tabindex="-1"></a>        state_reg <span class="ot">&lt;=</span> <span class="dv">0</span>b00;</span>
<span id="cb64-38"><a href="#cb64-38" aria-hidden="true" tabindex="-1"></a>        pending_write <span class="ot">&lt;=</span> <span class="bn">&#39;0&#39;</span>;</span>
<span id="cb64-39"><a href="#cb64-39" aria-hidden="true" tabindex="-1"></a>        fill_line_reg <span class="ot">&lt;=</span> <span class="bn">&#39;0&#39;</span>;</span>
<span id="cb64-40"><a href="#cb64-40" aria-hidden="true" tabindex="-1"></a>      <span class="cf">elsif</span> (is_idle <span class="ot">=</span> <span class="bn">&#39;1&#39;</span>) <span class="kw">and</span> (req <span class="ot">=</span> <span class="bn">&#39;1&#39;</span>) <span class="kw">and</span> (miss <span class="ot">=</span> <span class="bn">&#39;1&#39;</span>) <span class="cf">then</span></span>
<span id="cb64-41"><a href="#cb64-41" aria-hidden="true" tabindex="-1"></a>        state_reg <span class="ot">&lt;=</span> <span class="dv">0</span>b01;</span>
<span id="cb64-42"><a href="#cb64-42" aria-hidden="true" tabindex="-1"></a>        pending_write <span class="ot">&lt;=</span> cpu_write;</span>
<span id="cb64-43"><a href="#cb64-43" aria-hidden="true" tabindex="-1"></a>        fill_line_reg <span class="ot">&lt;=</span> <span class="bn">&#39;0&#39;</span>;</span>
<span id="cb64-44"><a href="#cb64-44" aria-hidden="true" tabindex="-1"></a>      <span class="cf">elsif</span> (is_idle <span class="ot">=</span> <span class="bn">&#39;1&#39;</span>) <span class="kw">and</span> (cpu_write <span class="ot">=</span> <span class="bn">&#39;1&#39;</span>) <span class="kw">and</span> (cache_hit <span class="ot">=</span> <span class="bn">&#39;1&#39;</span>) <span class="cf">then</span></span>
<span id="cb64-45"><a href="#cb64-45" aria-hidden="true" tabindex="-1"></a>        state_reg <span class="ot">&lt;=</span> <span class="dv">0</span>b10;</span>
<span id="cb64-46"><a href="#cb64-46" aria-hidden="true" tabindex="-1"></a>        fill_line_reg <span class="ot">&lt;=</span> <span class="bn">&#39;0&#39;</span>;</span>
<span id="cb64-47"><a href="#cb64-47" aria-hidden="true" tabindex="-1"></a>      <span class="cf">elsif</span> (is_fetch <span class="ot">=</span> <span class="bn">&#39;1&#39;</span>) <span class="kw">and</span> (mem_ready <span class="ot">=</span> <span class="bn">&#39;1&#39;</span>) <span class="kw">and</span> (pending_write <span class="ot">=</span> <span class="bn">&#39;1&#39;</span>) <span class="cf">then</span></span>
<span id="cb64-48"><a href="#cb64-48" aria-hidden="true" tabindex="-1"></a>        state_reg <span class="ot">&lt;=</span> <span class="dv">0</span>b10;</span>
<span id="cb64-49"><a href="#cb64-49" aria-hidden="true" tabindex="-1"></a>        fill_line_reg <span class="ot">&lt;=</span> <span class="bn">&#39;1&#39;</span>;</span>
<span id="cb64-50"><a href="#cb64-50" aria-hidden="true" tabindex="-1"></a>      <span class="cf">elsif</span> (is_fetch <span class="ot">=</span> <span class="bn">&#39;1&#39;</span>) <span class="kw">and</span> (mem_ready <span class="ot">=</span> <span class="bn">&#39;1&#39;</span>) <span class="kw">and</span> (pending_write <span class="ot">=</span> <span class="bn">&#39;0&#39;</span>) <span class="cf">then</span></span>
<span id="cb64-51"><a href="#cb64-51" aria-hidden="true" tabindex="-1"></a>        state_reg <span class="ot">&lt;=</span> <span class="dv">0</span>b00;</span>
<span id="cb64-52"><a href="#cb64-52" aria-hidden="true" tabindex="-1"></a>        fill_line_reg <span class="ot">&lt;=</span> <span class="bn">&#39;1&#39;</span>;</span>
<span id="cb64-53"><a href="#cb64-53" aria-hidden="true" tabindex="-1"></a>      <span class="cf">elsif</span> (is_wb <span class="ot">=</span> <span class="bn">&#39;1&#39;</span>) <span class="kw">and</span> (mem_ready <span class="ot">=</span> <span class="bn">&#39;1&#39;</span>) <span class="cf">then</span></span>
<span id="cb64-54"><a href="#cb64-54" aria-hidden="true" tabindex="-1"></a>        state_reg <span class="ot">&lt;=</span> <span class="dv">0</span>b00;</span>
<span id="cb64-55"><a href="#cb64-55" aria-hidden="true" tabindex="-1"></a>        pending_write <span class="ot">&lt;=</span> <span class="bn">&#39;0&#39;</span>;</span>
<span id="cb64-56"><a href="#cb64-56" aria-hidden="true" tabindex="-1"></a>        fill_line_reg <span class="ot">&lt;=</span> <span class="bn">&#39;0&#39;</span>;</span>
<span id="cb64-57"><a href="#cb64-57" aria-hidden="true" tabindex="-1"></a>      <span class="cf">else</span></span>
<span id="cb64-58"><a href="#cb64-58" aria-hidden="true" tabindex="-1"></a>        fill_line_reg <span class="ot">&lt;=</span> <span class="bn">&#39;0&#39;</span>;</span>
<span id="cb64-59"><a href="#cb64-59" aria-hidden="true" tabindex="-1"></a>      <span class="cf">end if;</span></span>
<span id="cb64-60"><a href="#cb64-60" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end if;</span></span>
<span id="cb64-61"><a href="#cb64-61" aria-hidden="true" tabindex="-1"></a>  <span class="sc">end process;</span></span>
<span id="cb64-62"><a href="#cb64-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-63"><a href="#cb64-63" aria-hidden="true" tabindex="-1"></a>  state <span class="ot">&lt;=</span> state_reg;</span>
<span id="cb64-64"><a href="#cb64-64" aria-hidden="true" tabindex="-1"></a>  cpu_ready <span class="ot">&lt;=</span> (is_idle <span class="kw">and</span> cache_hit) <span class="kw">or</span> (is_fetch <span class="kw">and</span> mem_ready <span class="kw">and</span> (<span class="kw">not</span> pending_write)) <span class="kw">or</span> (is_wb <span class="kw">and</span> mem_ready);</span>
<span id="cb64-65"><a href="#cb64-65" aria-hidden="true" tabindex="-1"></a>  mem_read <span class="ot">&lt;=</span> is_fetch;</span>
<span id="cb64-66"><a href="#cb64-66" aria-hidden="true" tabindex="-1"></a>  mem_write <span class="ot">&lt;=</span> is_wb;</span>
<span id="cb64-67"><a href="#cb64-67" aria-hidden="true" tabindex="-1"></a>  fill_line <span class="ot">&lt;=</span> fill_line_reg;</span>
<span id="cb64-68"><a href="#cb64-68" aria-hidden="true" tabindex="-1"></a><span class="cf">end architecture;</span></span></code></pre></div>
<hr />
<h3 data-number="2.1.44" id="projet-8-capstone---lordinateur-complet"><span class="header-section-number">2.1.44</span> Projet 8 : Capstone -
L’Ordinateur Complet 🎮</h3>
<h3 data-number="2.1.45" id="rom32k"><span class="header-section-number">2.1.45</span> ROM32K</h3>
<div class="sourceCode" id="cb65"><pre class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- ROM32K: Program Memory (32K x 16-bit)</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="co">-- 🎮 Think of it like a Game Boy cartridge:</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="co">-- - The cartridge contains your game (program)</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="co">-- - You insert it into the console (computer)</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="co">-- - The console reads instructions from the cartridge</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a><span class="co">-- - The game runs!</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a><span class="cf">entity</span> <span class="dv">ROM32K</span> <span class="kw">is</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">port</span>(</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>    addr <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">14</span> <span class="ot">downto</span> <span class="dv">0</span>);   <span class="co">-- 15 bits = 32K addresses</span></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>    dout <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>)   <span class="co">-- 16-bit instruction output</span></span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb65-13"><a href="#cb65-13" aria-hidden="true" tabindex="-1"></a><span class="cf">end entity;</span></span>
<span id="cb65-14"><a href="#cb65-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-15"><a href="#cb65-15" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">rtl</span> <span class="kw">of</span> <span class="fu">ROM32K</span> <span class="kw">is</span></span>
<span id="cb65-16"><a href="#cb65-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- rom is a simulator primitive (like nand2, dff, ram)</span></span>
<span id="cb65-17"><a href="#cb65-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">rom</span></span>
<span id="cb65-18"><a href="#cb65-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(addr <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">14</span> <span class="ot">downto</span> <span class="dv">0</span>); dout <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>));</span>
<span id="cb65-19"><a href="#cb65-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb65-20"><a href="#cb65-20" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb65-21"><a href="#cb65-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Instantiate the ROM primitive</span></span>
<span id="cb65-22"><a href="#cb65-22" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_rom</span><span class="ot">:</span> <span class="fu">rom</span> <span class="kw">port map </span>(addr <span class="ot">=&gt;</span> addr<span class="ot">,</span> dout <span class="ot">=&gt;</span> dout);</span>
<span id="cb65-23"><a href="#cb65-23" aria-hidden="true" tabindex="-1"></a><span class="cf">end architecture;</span></span></code></pre></div>
<hr />
<h3 data-number="2.1.46" id="computer"><span class="header-section-number">2.1.46</span> Computer</h3>
<div class="sourceCode" id="cb66"><pre class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Computer: The Complete Computer 🖥️</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="co">-- The culmination of Nand2Tetris!</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="co">--</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="co">-- 🎮 Like a Game Boy with its cartridge inserted:</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="co">-- - ROM32K = The game cartridge (your program)</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="co">-- - CPU = The processor (executes instructions)</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="co">-- - RAM64 = Working memory (game state, variables)</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a><span class="cf">entity</span> <span class="dv">Computer</span> <span class="kw">is</span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">port</span>(</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>    clk   <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>    reset <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a><span class="cf">end entity;</span></span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">rtl</span> <span class="kw">of</span> <span class="fu">Computer</span> <span class="kw">is</span></span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">ROM32K</span></span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(addr <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">14</span> <span class="ot">downto</span> <span class="dv">0</span>); dout <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>));</span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">CPU</span></span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(clk<span class="ot">,</span> reset <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a>         instr<span class="ot">,</span> mem_in <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a>         mem_out<span class="ot">,</span> mem_addr<span class="ot">,</span> pc_out <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a>         mem_we <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-28"><a href="#cb66-28" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">RAM64</span></span>
<span id="cb66-29"><a href="#cb66-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(clk <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; din <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb66-30"><a href="#cb66-30" aria-hidden="true" tabindex="-1"></a>         addr <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">5</span> <span class="ot">downto</span> <span class="dv">0</span>); we <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb66-31"><a href="#cb66-31" aria-hidden="true" tabindex="-1"></a>         dout <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>));</span>
<span id="cb66-32"><a href="#cb66-32" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb66-33"><a href="#cb66-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-34"><a href="#cb66-34" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> instruction <span class="ot">:</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb66-35"><a href="#cb66-35" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> pc <span class="ot">:</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb66-36"><a href="#cb66-36" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> mem_addr <span class="ot">:</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb66-37"><a href="#cb66-37" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> mem_out <span class="ot">:</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb66-38"><a href="#cb66-38" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> mem_in <span class="ot">:</span> bits(<span class="dv">15</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb66-39"><a href="#cb66-39" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> mem_we <span class="ot">:</span> <span class="dt">bit</span>;</span>
<span id="cb66-40"><a href="#cb66-40" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb66-41"><a href="#cb66-41" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Program Memory (The Cartridge!)</span></span>
<span id="cb66-42"><a href="#cb66-42" aria-hidden="true" tabindex="-1"></a>  <span class="dv">rom</span><span class="ot">:</span> <span class="fu">ROM32K</span> <span class="kw">port map</span>(</span>
<span id="cb66-43"><a href="#cb66-43" aria-hidden="true" tabindex="-1"></a>    addr <span class="ot">=&gt;</span> pc(<span class="dv">14</span> <span class="ot">downto</span> <span class="dv">0</span>)<span class="ot">,</span></span>
<span id="cb66-44"><a href="#cb66-44" aria-hidden="true" tabindex="-1"></a>    dout <span class="ot">=&gt;</span> instruction</span>
<span id="cb66-45"><a href="#cb66-45" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb66-46"><a href="#cb66-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-47"><a href="#cb66-47" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Central Processing Unit</span></span>
<span id="cb66-48"><a href="#cb66-48" aria-hidden="true" tabindex="-1"></a>  <span class="dv">cpu</span><span class="ot">:</span> <span class="fu">CPU</span> <span class="kw">port map</span>(</span>
<span id="cb66-49"><a href="#cb66-49" aria-hidden="true" tabindex="-1"></a>    clk <span class="ot">=&gt;</span> clk<span class="ot">,</span></span>
<span id="cb66-50"><a href="#cb66-50" aria-hidden="true" tabindex="-1"></a>    reset <span class="ot">=&gt;</span> reset<span class="ot">,</span></span>
<span id="cb66-51"><a href="#cb66-51" aria-hidden="true" tabindex="-1"></a>    instr <span class="ot">=&gt;</span> instruction<span class="ot">,</span></span>
<span id="cb66-52"><a href="#cb66-52" aria-hidden="true" tabindex="-1"></a>    mem_in <span class="ot">=&gt;</span> mem_in<span class="ot">,</span></span>
<span id="cb66-53"><a href="#cb66-53" aria-hidden="true" tabindex="-1"></a>    mem_out <span class="ot">=&gt;</span> mem_out<span class="ot">,</span></span>
<span id="cb66-54"><a href="#cb66-54" aria-hidden="true" tabindex="-1"></a>    mem_addr <span class="ot">=&gt;</span> mem_addr<span class="ot">,</span></span>
<span id="cb66-55"><a href="#cb66-55" aria-hidden="true" tabindex="-1"></a>    mem_we <span class="ot">=&gt;</span> mem_we<span class="ot">,</span></span>
<span id="cb66-56"><a href="#cb66-56" aria-hidden="true" tabindex="-1"></a>    pc_out <span class="ot">=&gt;</span> pc</span>
<span id="cb66-57"><a href="#cb66-57" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb66-58"><a href="#cb66-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-59"><a href="#cb66-59" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Data Memory</span></span>
<span id="cb66-60"><a href="#cb66-60" aria-hidden="true" tabindex="-1"></a>  <span class="dv">ram</span><span class="ot">:</span> <span class="fu">RAM64</span> <span class="kw">port map</span>(</span>
<span id="cb66-61"><a href="#cb66-61" aria-hidden="true" tabindex="-1"></a>    clk <span class="ot">=&gt;</span> clk<span class="ot">,</span></span>
<span id="cb66-62"><a href="#cb66-62" aria-hidden="true" tabindex="-1"></a>    din <span class="ot">=&gt;</span> mem_out<span class="ot">,</span></span>
<span id="cb66-63"><a href="#cb66-63" aria-hidden="true" tabindex="-1"></a>    addr <span class="ot">=&gt;</span> mem_addr(<span class="dv">5</span> <span class="ot">downto</span> <span class="dv">0</span>)<span class="ot">,</span></span>
<span id="cb66-64"><a href="#cb66-64" aria-hidden="true" tabindex="-1"></a>    we <span class="ot">=&gt;</span> mem_we<span class="ot">,</span></span>
<span id="cb66-65"><a href="#cb66-65" aria-hidden="true" tabindex="-1"></a>    dout <span class="ot">=&gt;</span> mem_in</span>
<span id="cb66-66"><a href="#cb66-66" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb66-67"><a href="#cb66-67" aria-hidden="true" tabindex="-1"></a><span class="cf">end architecture;</span></span></code></pre></div>
<p><strong>🎮 Le Flux Complet : Du Code C au Jeu qui Tourne</strong></p>
<p>C’est exactement comme une cartouche de Game Boy :</p>
<pre><code>┌─────────────────────────────────────────────────────────┐
│   Code C              Assembleur           ROM          │
│   snake.c    ───►    snake.a32    ───►   cartouche    │
│                                              │          │
│   while(alive) {     .Lloop:               0x4100      │
│     move_snake();      BL move_snake       0x0211      │
│   }                    B .Lloop            0x0322      │
│                                              │          │
│                                              ▼          │
│                                     ┌──────────────┐    │
│                                     │   Computer   │    │
│                                     │ ROM → CPU    │    │
│                                     │       ↓      │    │
│                                     │      RAM     │    │
│                                     └──────────────┘    │
└─────────────────────────────────────────────────────────┘</code></pre>
<p><strong>Outils de compilation :</strong></p>
<div class="sourceCode" id="cb68"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compiler le jeu Snake</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="ex">./c32_cli</span> demos/04_snake/snake.c <span class="at">-o</span> snake.a32</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="ex">./a32_cli</span> snake.a32 <span class="at">-o</span> snake.bin</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Ou directement l&#39;exécuter</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a><span class="ex">./c32_runner</span> demos/04_snake/snake.c</span></code></pre></div>
<p><strong>Dans l’interface web HDL :</strong></p>
<pre><code>load Computer
romload 0x0100 0x0211 0x0322 0x0433   // Programme en ROM
set reset 1
tick
tock
set reset 0
// Le CPU exécute automatiquement !
tick
tock  // Cycle 1: fetch + execute instruction 0
tick
tock  // Cycle 2: fetch + execute instruction 1
// ... etc</code></pre>
<p><strong>Note importante :</strong></p>
<p>Le CPU HDL (A32-Lite) utilise des instructions 16 bits simplifiées.
Le vrai jeu Snake (<code>demos/04_snake/snake.c</code>) utilise le
processeur A32 complet (32 bits) via <code>c32_runner</code>. Le
principe est identique : le programme est chargé en mémoire et le CPU
l’exécute instruction par instruction.</p>
<hr />
<h2 data-number="2.2" id="b.-solutions-assembleur-a32"><span class="header-section-number">2.2</span> B. Solutions Assembleur
A32</h2>
<h3 data-number="2.2.1" id="hello-world"><span class="header-section-number">2.2.1</span> Hello World</h3>
<div class="sourceCode" id="cb70"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co">; Hello World - Solution</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>.text</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>.global _start</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="fu">_start:</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">42</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>    HALT</span></code></pre></div>
<hr />
<h3 data-number="2.2.2" id="addition"><span class="header-section-number">2.2.2</span> Addition</h3>
<div class="sourceCode" id="cb71"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co">; Addition - Solution</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>.text</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>.global _start</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="fu">_start:</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">15</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R0<span class="op">,</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">27</span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>    HALT</span></code></pre></div>
<hr />
<h3 data-number="2.2.3" id="soustraction"><span class="header-section-number">2.2.3</span> Soustraction</h3>
<div class="sourceCode" id="cb72"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co">; Soustraction - Solution</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>.text</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>.global _start</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="fu">_start:</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">100</span></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">SUB</span> R0<span class="op">,</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">58</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>    HALT</span></code></pre></div>
<hr />
<h3 data-number="2.2.4" id="logique"><span class="header-section-number">2.2.4</span> Logique</h3>
<div class="sourceCode" id="cb73"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co">; Logique - Solution</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>.text</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>.global _start</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="fu">_start:</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R1<span class="op">,</span> <span class="op">#</span><span class="bn">0xFF</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R2<span class="op">,</span> <span class="op">#</span><span class="bn">0x0F</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">AND</span> R0<span class="op">,</span> R1<span class="op">,</span> R2</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>    HALT</span></code></pre></div>
<hr />
<h3 data-number="2.2.5" id="doubler"><span class="header-section-number">2.2.5</span> Doubler</h3>
<div class="sourceCode" id="cb74"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co">; Doubler - Solution</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>.text</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>.global _start</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a><span class="fu">_start:</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">21</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R0<span class="op">,</span> R0<span class="op">,</span> R0   <span class="co">; R0 = R0 + R0 = 2 * R0</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>    HALT</span></code></pre></div>
<hr />
<h3 data-number="2.2.6" id="conditions"><span class="header-section-number">2.2.6</span> Conditions</h3>
<div class="sourceCode" id="cb75"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co">; Conditions - Solution</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>.text</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>.global _start</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="fu">_start:</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">25</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R2<span class="op">,</span> <span class="op">#</span><span class="dv">17</span></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">CMP</span> R1<span class="op">,</span> R2</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>    B<span class="op">.</span>GT <span class="op">.</span>r1_bigger</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R0<span class="op">,</span> R2</span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>    B <span class="op">.</span>done</span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a><span class="fu">.r1_bigger:</span></span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R0<span class="op">,</span> R1</span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a><span class="fu">.done:</span></span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a>    HALT</span></code></pre></div>
<hr />
<h3 data-number="2.2.7" id="valeur-absolue"><span class="header-section-number">2.2.7</span> Valeur Absolue</h3>
<div class="sourceCode" id="cb76"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co">; Valeur Absolue - Solution</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>.text</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>.global _start</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a><span class="fu">_start:</span></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">0</span></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">SUB</span> R1<span class="op">,</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">42</span>  <span class="co">; R1 = -42</span></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">CMP</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">0</span></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>    B<span class="op">.</span>GE <span class="op">.</span>positive</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Négatif: R0 = 0 - R1</span></span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">0</span></span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">SUB</span> R0<span class="op">,</span> R0<span class="op">,</span> R1</span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>    B <span class="op">.</span>done</span>
<span id="cb76-15"><a href="#cb76-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-16"><a href="#cb76-16" aria-hidden="true" tabindex="-1"></a><span class="fu">.positive:</span></span>
<span id="cb76-17"><a href="#cb76-17" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R0<span class="op">,</span> R1</span>
<span id="cb76-18"><a href="#cb76-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-19"><a href="#cb76-19" aria-hidden="true" tabindex="-1"></a><span class="fu">.done:</span></span>
<span id="cb76-20"><a href="#cb76-20" aria-hidden="true" tabindex="-1"></a>    HALT</span></code></pre></div>
<hr />
<h3 data-number="2.2.8" id="boucles"><span class="header-section-number">2.2.8</span> Boucles</h3>
<div class="sourceCode" id="cb77"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co">; Boucles - Solution</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>.text</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>.global _start</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="fu">_start:</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">0</span>      <span class="co">; somme = 0</span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">1</span>      <span class="co">; compteur = 1</span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a><span class="fu">.loop:</span></span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R0<span class="op">,</span> R0<span class="op">,</span> R1  <span class="co">; somme += compteur</span></span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R1<span class="op">,</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">1</span>  <span class="co">; compteur++</span></span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">CMP</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">10</span></span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>    B<span class="op">.</span>LE <span class="op">.</span>loop</span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a>    HALT</span></code></pre></div>
<hr />
<h3 data-number="2.2.9" id="multiplication"><span class="header-section-number">2.2.9</span> Multiplication</h3>
<div class="sourceCode" id="cb78"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co">; Multiplication - Solution</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>.text</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>.global _start</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="fu">_start:</span></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">0</span>      <span class="co">; résultat = 0</span></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">6</span>      <span class="co">; multiplicande</span></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R2<span class="op">,</span> <span class="op">#</span><span class="dv">7</span>      <span class="co">; compteur (multiplicateur)</span></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a><span class="fu">.loop:</span></span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R0<span class="op">,</span> R0<span class="op">,</span> R1  <span class="co">; résultat += multiplicande</span></span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">SUB</span> R2<span class="op">,</span> R2<span class="op">,</span> <span class="op">#</span><span class="dv">1</span>  <span class="co">; compteur--</span></span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">CMP</span> R2<span class="op">,</span> <span class="op">#</span><span class="dv">0</span></span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>    B<span class="op">.</span>GT <span class="op">.</span>loop</span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a>    HALT</span></code></pre></div>
<hr />
<h3 data-number="2.2.10" id="fibonacci"><span class="header-section-number">2.2.10</span> Fibonacci</h3>
<div class="sourceCode" id="cb79"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co">; Fibonacci - Solution</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>.text</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>.global _start</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="fu">_start:</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">1</span>      <span class="co">; F(1) = 1</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">1</span>      <span class="co">; F(2) = 1</span></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R2<span class="op">,</span> <span class="op">#</span><span class="dv">2</span>      <span class="co">; compteur = 2</span></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a><span class="fu">.loop:</span></span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R3<span class="op">,</span> R0<span class="op">,</span> R1  <span class="co">; R3 = F(n-2) + F(n-1)</span></span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R0<span class="op">,</span> R1      <span class="co">; F(n-2) = ancien F(n-1)</span></span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R1<span class="op">,</span> R3      <span class="co">; F(n-1) = nouveau F(n)</span></span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R2<span class="op">,</span> R2<span class="op">,</span> <span class="op">#</span><span class="dv">1</span>  <span class="co">; compteur++</span></span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>    <span class="bu">CMP</span> R2<span class="op">,</span> <span class="op">#</span><span class="dv">10</span></span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>    B<span class="op">.</span>LT <span class="op">.</span>loop</span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R0<span class="op">,</span> R1      <span class="co">; résultat dans R0</span></span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a>    HALT</span></code></pre></div>
<hr />
<h3 data-number="2.2.11" id="tableaux"><span class="header-section-number">2.2.11</span> Tableaux</h3>
<div class="sourceCode" id="cb80"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co">; Tableaux - Solution</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>.<span class="bu">data</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data:</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">10</span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">20</span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">30</span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">40</span></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">50</span></span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>.text</span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>.global _start</span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a><span class="fu">_start:</span></span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">0</span>          <span class="co">; somme = 0</span></span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a>    LDR R1<span class="op">,</span> <span class="op">=</span>data       <span class="co">; adresse du tableau</span></span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R2<span class="op">,</span> <span class="op">#</span><span class="dv">5</span>          <span class="co">; compteur = 5</span></span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a><span class="fu">.loop:</span></span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a>    LDR R3<span class="op">,</span> <span class="op">[</span>R1<span class="op">]</span>        <span class="co">; charge élément</span></span>
<span id="cb80-20"><a href="#cb80-20" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R0<span class="op">,</span> R0<span class="op">,</span> R3      <span class="co">; somme += élément</span></span>
<span id="cb80-21"><a href="#cb80-21" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R1<span class="op">,</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">4</span>      <span class="co">; adresse suivante</span></span>
<span id="cb80-22"><a href="#cb80-22" aria-hidden="true" tabindex="-1"></a>    <span class="bu">SUB</span> R2<span class="op">,</span> R2<span class="op">,</span> <span class="op">#</span><span class="dv">1</span>      <span class="co">; compteur--</span></span>
<span id="cb80-23"><a href="#cb80-23" aria-hidden="true" tabindex="-1"></a>    <span class="bu">CMP</span> R2<span class="op">,</span> <span class="op">#</span><span class="dv">0</span></span>
<span id="cb80-24"><a href="#cb80-24" aria-hidden="true" tabindex="-1"></a>    B<span class="op">.</span>GT <span class="op">.</span>loop</span>
<span id="cb80-25"><a href="#cb80-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-26"><a href="#cb80-26" aria-hidden="true" tabindex="-1"></a>    HALT</span></code></pre></div>
<hr />
<h3 data-number="2.2.12" id="maximum-tableau"><span class="header-section-number">2.2.12</span> Maximum Tableau</h3>
<div class="sourceCode" id="cb81"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co">; Maximum Tableau - Solution</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>.<span class="bu">data</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data:</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">12</span></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">45</span></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">7</span></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">89</span></span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">23</span></span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>.text</span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>.global _start</span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a><span class="fu">_start:</span></span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a>    LDR R1<span class="op">,</span> <span class="op">=</span>data       <span class="co">; adresse du tableau</span></span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a>    LDR R0<span class="op">,</span> <span class="op">[</span>R1<span class="op">]</span>        <span class="co">; max = premier élément</span></span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R1<span class="op">,</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">4</span>      <span class="co">; passer au suivant</span></span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R2<span class="op">,</span> <span class="op">#</span><span class="dv">4</span>          <span class="co">; compteur = 4 (reste)</span></span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-19"><a href="#cb81-19" aria-hidden="true" tabindex="-1"></a><span class="fu">.loop:</span></span>
<span id="cb81-20"><a href="#cb81-20" aria-hidden="true" tabindex="-1"></a>    LDR R3<span class="op">,</span> <span class="op">[</span>R1<span class="op">]</span>        <span class="co">; charge élément</span></span>
<span id="cb81-21"><a href="#cb81-21" aria-hidden="true" tabindex="-1"></a>    <span class="bu">CMP</span> R3<span class="op">,</span> R0          <span class="co">; compare avec max</span></span>
<span id="cb81-22"><a href="#cb81-22" aria-hidden="true" tabindex="-1"></a>    B<span class="op">.</span>LE <span class="op">.</span>skip</span>
<span id="cb81-23"><a href="#cb81-23" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R0<span class="op">,</span> R3          <span class="co">; nouveau max</span></span>
<span id="cb81-24"><a href="#cb81-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-25"><a href="#cb81-25" aria-hidden="true" tabindex="-1"></a><span class="fu">.skip:</span></span>
<span id="cb81-26"><a href="#cb81-26" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R1<span class="op">,</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">4</span>      <span class="co">; adresse suivante</span></span>
<span id="cb81-27"><a href="#cb81-27" aria-hidden="true" tabindex="-1"></a>    <span class="bu">SUB</span> R2<span class="op">,</span> R2<span class="op">,</span> <span class="op">#</span><span class="dv">1</span>      <span class="co">; compteur--</span></span>
<span id="cb81-28"><a href="#cb81-28" aria-hidden="true" tabindex="-1"></a>    <span class="bu">CMP</span> R2<span class="op">,</span> <span class="op">#</span><span class="dv">0</span></span>
<span id="cb81-29"><a href="#cb81-29" aria-hidden="true" tabindex="-1"></a>    B<span class="op">.</span>GT <span class="op">.</span>loop</span>
<span id="cb81-30"><a href="#cb81-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-31"><a href="#cb81-31" aria-hidden="true" tabindex="-1"></a>    HALT</span></code></pre></div>
<hr />
<h3 data-number="2.2.13" id="mémoire"><span class="header-section-number">2.2.13</span> Mémoire</h3>
<div class="sourceCode" id="cb82"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co">; Mémoire - Solution</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>.<span class="bu">data</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data:</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">0</span></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">0</span></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>.text</span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>.global _start</span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a><span class="fu">_start:</span></span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">10</span></span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R2<span class="op">,</span> <span class="op">#</span><span class="dv">20</span></span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Sauvegarder</span></span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a>    LDR R4<span class="op">,</span> <span class="op">=</span>data</span>
<span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">STR</span> R1<span class="op">,</span> <span class="op">[</span>R4<span class="op">]</span>        <span class="co">; data[0] = R1</span></span>
<span id="cb82-17"><a href="#cb82-17" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R4<span class="op">,</span> R4<span class="op">,</span> <span class="op">#</span><span class="dv">4</span></span>
<span id="cb82-18"><a href="#cb82-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">STR</span> R2<span class="op">,</span> <span class="op">[</span>R4<span class="op">]</span>        <span class="co">; data[1] = R2</span></span>
<span id="cb82-19"><a href="#cb82-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-20"><a href="#cb82-20" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Effacer</span></span>
<span id="cb82-21"><a href="#cb82-21" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">0</span></span>
<span id="cb82-22"><a href="#cb82-22" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R2<span class="op">,</span> <span class="op">#</span><span class="dv">0</span></span>
<span id="cb82-23"><a href="#cb82-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-24"><a href="#cb82-24" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Recharger</span></span>
<span id="cb82-25"><a href="#cb82-25" aria-hidden="true" tabindex="-1"></a>    LDR R4<span class="op">,</span> <span class="op">=</span>data</span>
<span id="cb82-26"><a href="#cb82-26" aria-hidden="true" tabindex="-1"></a>    LDR R1<span class="op">,</span> <span class="op">[</span>R4<span class="op">]</span>        <span class="co">; R1 = data[0]</span></span>
<span id="cb82-27"><a href="#cb82-27" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R4<span class="op">,</span> R4<span class="op">,</span> <span class="op">#</span><span class="dv">4</span></span>
<span id="cb82-28"><a href="#cb82-28" aria-hidden="true" tabindex="-1"></a>    LDR R2<span class="op">,</span> <span class="op">[</span>R4<span class="op">]</span>        <span class="co">; R2 = data[1]</span></span>
<span id="cb82-29"><a href="#cb82-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-30"><a href="#cb82-30" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Calculer</span></span>
<span id="cb82-31"><a href="#cb82-31" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R0<span class="op">,</span> R1<span class="op">,</span> R2</span>
<span id="cb82-32"><a href="#cb82-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-33"><a href="#cb82-33" aria-hidden="true" tabindex="-1"></a>    HALT</span></code></pre></div>
<hr />
<h3 data-number="2.2.14" id="structure-simple"><span class="header-section-number">2.2.14</span> Structure Simple</h3>
<div class="sourceCode" id="cb83"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co">; Structure Simple - Solution</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>.<span class="bu">data</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="co">; Structure Point { int x; int y; }</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a><span class="fu">point:</span></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">10</span>    <span class="co">; x = 10 (offset 0)</span></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">32</span>    <span class="co">; y = 32 (offset 4)</span></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a>.text</span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a>.global _start</span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a><span class="fu">_start:</span></span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Charger l&#39;adresse de la structure</span></span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a>    LDR R1<span class="op">,</span> <span class="op">=</span>point</span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Charger p.x (offset 0)</span></span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a>    LDR R2<span class="op">,</span> <span class="op">[</span>R1<span class="op">]</span>        <span class="co">; R2 = p.x = 10</span></span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-18"><a href="#cb83-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Charger p.y (offset 4)</span></span>
<span id="cb83-19"><a href="#cb83-19" aria-hidden="true" tabindex="-1"></a>    LDR R3<span class="op">,</span> <span class="op">[</span>R1<span class="op">,</span> <span class="op">#</span><span class="dv">4</span><span class="op">]</span>    <span class="co">; R3 = p.y = 32</span></span>
<span id="cb83-20"><a href="#cb83-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-21"><a href="#cb83-21" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Calculer la somme</span></span>
<span id="cb83-22"><a href="#cb83-22" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R0<span class="op">,</span> R2<span class="op">,</span> R3      <span class="co">; R0 = 10 + 32 = 42</span></span>
<span id="cb83-23"><a href="#cb83-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-24"><a href="#cb83-24" aria-hidden="true" tabindex="-1"></a>    HALT</span></code></pre></div>
<hr />
<h3 data-number="2.2.15" id="initialiser-structure"><span class="header-section-number">2.2.15</span> Initialiser Structure</h3>
<div class="sourceCode" id="cb84"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co">; Initialiser Structure - Solution</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>.<span class="bu">data</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="co">; Structure Point (non initialisée)</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="fu">point:</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">0</span>     <span class="co">; x (offset 0)</span></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">0</span>     <span class="co">; y (offset 4)</span></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>.text</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>.global _start</span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a><span class="fu">_start:</span></span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>    LDR R4<span class="op">,</span> <span class="op">=</span>point  <span class="co">; adresse de la structure</span></span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Initialiser p.x = 20</span></span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">20</span></span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">STR</span> R1<span class="op">,</span> <span class="op">[</span>R4<span class="op">]</span>        <span class="co">; p.x = 20</span></span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Initialiser p.y = 22</span></span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R2<span class="op">,</span> <span class="op">#</span><span class="dv">22</span></span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a>    <span class="bu">STR</span> R2<span class="op">,</span> <span class="op">[</span>R4<span class="op">,</span> <span class="op">#</span><span class="dv">4</span><span class="op">]</span>    <span class="co">; p.y = 22</span></span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Relire et additionner</span></span>
<span id="cb84-23"><a href="#cb84-23" aria-hidden="true" tabindex="-1"></a>    LDR R1<span class="op">,</span> <span class="op">[</span>R4<span class="op">]</span>        <span class="co">; R1 = p.x</span></span>
<span id="cb84-24"><a href="#cb84-24" aria-hidden="true" tabindex="-1"></a>    LDR R2<span class="op">,</span> <span class="op">[</span>R4<span class="op">,</span> <span class="op">#</span><span class="dv">4</span><span class="op">]</span>    <span class="co">; R2 = p.y</span></span>
<span id="cb84-25"><a href="#cb84-25" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R0<span class="op">,</span> R1<span class="op">,</span> R2      <span class="co">; R0 = 42</span></span>
<span id="cb84-26"><a href="#cb84-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-27"><a href="#cb84-27" aria-hidden="true" tabindex="-1"></a>    HALT</span></code></pre></div>
<hr />
<h3 data-number="2.2.16" id="structure-rectangle"><span class="header-section-number">2.2.16</span> Structure Rectangle</h3>
<div class="sourceCode" id="cb85"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co">; Structure Rectangle - Solution</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>.<span class="bu">data</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="co">; Structure Rectangle</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rect:</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">5</span>     <span class="co">; x (offset 0)</span></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">10</span>    <span class="co">; y (offset 4)</span></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">6</span>     <span class="co">; width (offset 8)</span></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">7</span>     <span class="co">; height (offset 12)</span></span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>.text</span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a>.global _start</span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a><span class="fu">_start:</span></span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a>    LDR R4<span class="op">,</span> <span class="op">=</span>rect</span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Charger width et height</span></span>
<span id="cb85-17"><a href="#cb85-17" aria-hidden="true" tabindex="-1"></a>    LDR R1<span class="op">,</span> <span class="op">[</span>R4<span class="op">,</span> <span class="op">#</span><span class="dv">8</span><span class="op">]</span>    <span class="co">; R1 = width = 6</span></span>
<span id="cb85-18"><a href="#cb85-18" aria-hidden="true" tabindex="-1"></a>    LDR R2<span class="op">,</span> <span class="op">[</span>R4<span class="op">,</span> <span class="op">#</span><span class="dv">12</span><span class="op">]</span>   <span class="co">; R2 = height = 7</span></span>
<span id="cb85-19"><a href="#cb85-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-20"><a href="#cb85-20" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Multiplier par additions: 6 * 7</span></span>
<span id="cb85-21"><a href="#cb85-21" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">0</span>          <span class="co">; résultat = 0</span></span>
<span id="cb85-22"><a href="#cb85-22" aria-hidden="true" tabindex="-1"></a><span class="fu">.mult:</span></span>
<span id="cb85-23"><a href="#cb85-23" aria-hidden="true" tabindex="-1"></a>    <span class="bu">CMP</span> R2<span class="op">,</span> <span class="op">#</span><span class="dv">0</span></span>
<span id="cb85-24"><a href="#cb85-24" aria-hidden="true" tabindex="-1"></a>    B<span class="op">.</span>EQ <span class="op">.</span>done</span>
<span id="cb85-25"><a href="#cb85-25" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R0<span class="op">,</span> R0<span class="op">,</span> R1      <span class="co">; résultat += width</span></span>
<span id="cb85-26"><a href="#cb85-26" aria-hidden="true" tabindex="-1"></a>    <span class="bu">SUB</span> R2<span class="op">,</span> R2<span class="op">,</span> <span class="op">#</span><span class="dv">1</span>      <span class="co">; height--</span></span>
<span id="cb85-27"><a href="#cb85-27" aria-hidden="true" tabindex="-1"></a>    B <span class="op">.</span>mult</span>
<span id="cb85-28"><a href="#cb85-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-29"><a href="#cb85-29" aria-hidden="true" tabindex="-1"></a><span class="fu">.done:</span></span>
<span id="cb85-30"><a href="#cb85-30" aria-hidden="true" tabindex="-1"></a>    HALT</span></code></pre></div>
<hr />
<h3 data-number="2.2.17" id="tableau-de-structures"><span class="header-section-number">2.2.17</span> Tableau de Structures</h3>
<div class="sourceCode" id="cb86"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co">; Tableau de Structures - Solution</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>.<span class="bu">data</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="co">; Tableau de 3 Points (8 octets chacun)</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a><span class="fu">points:</span></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">; points[0]: x=10, y=2</span></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">10</span></span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">2</span></span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">; points[1]: x=15, y=5</span></span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">15</span></span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">5</span></span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">; points[2]: x=8, y=7</span></span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">8</span></span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">7</span></span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a>.text</span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true" tabindex="-1"></a>.global _start</span>
<span id="cb86-18"><a href="#cb86-18" aria-hidden="true" tabindex="-1"></a><span class="fu">_start:</span></span>
<span id="cb86-19"><a href="#cb86-19" aria-hidden="true" tabindex="-1"></a>    LDR R1<span class="op">,</span> <span class="op">=</span>points     <span class="co">; adresse du tableau</span></span>
<span id="cb86-20"><a href="#cb86-20" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">0</span>          <span class="co">; somme = 0</span></span>
<span id="cb86-21"><a href="#cb86-21" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R2<span class="op">,</span> <span class="op">#</span><span class="dv">3</span>          <span class="co">; compteur = 3</span></span>
<span id="cb86-22"><a href="#cb86-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-23"><a href="#cb86-23" aria-hidden="true" tabindex="-1"></a><span class="fu">.loop:</span></span>
<span id="cb86-24"><a href="#cb86-24" aria-hidden="true" tabindex="-1"></a>    <span class="bu">CMP</span> R2<span class="op">,</span> <span class="op">#</span><span class="dv">0</span></span>
<span id="cb86-25"><a href="#cb86-25" aria-hidden="true" tabindex="-1"></a>    B<span class="op">.</span>EQ <span class="op">.</span>done</span>
<span id="cb86-26"><a href="#cb86-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-27"><a href="#cb86-27" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Charger x du Point courant</span></span>
<span id="cb86-28"><a href="#cb86-28" aria-hidden="true" tabindex="-1"></a>    LDR R3<span class="op">,</span> <span class="op">[</span>R1<span class="op">]</span>        <span class="co">; R3 = points[i].x</span></span>
<span id="cb86-29"><a href="#cb86-29" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R0<span class="op">,</span> R0<span class="op">,</span> R3      <span class="co">; somme += x</span></span>
<span id="cb86-30"><a href="#cb86-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-31"><a href="#cb86-31" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Passer au Point suivant (8 octets)</span></span>
<span id="cb86-32"><a href="#cb86-32" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R1<span class="op">,</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">8</span></span>
<span id="cb86-33"><a href="#cb86-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-34"><a href="#cb86-34" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Décrémenter compteur</span></span>
<span id="cb86-35"><a href="#cb86-35" aria-hidden="true" tabindex="-1"></a>    <span class="bu">SUB</span> R2<span class="op">,</span> R2<span class="op">,</span> <span class="op">#</span><span class="dv">1</span></span>
<span id="cb86-36"><a href="#cb86-36" aria-hidden="true" tabindex="-1"></a>    B <span class="op">.</span>loop</span>
<span id="cb86-37"><a href="#cb86-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-38"><a href="#cb86-38" aria-hidden="true" tabindex="-1"></a><span class="fu">.done:</span></span>
<span id="cb86-39"><a href="#cb86-39" aria-hidden="true" tabindex="-1"></a>    HALT</span></code></pre></div>
<hr />
<h3 data-number="2.2.18" id="somme-xy-structures"><span class="header-section-number">2.2.18</span> Somme x+y Structures</h3>
<div class="sourceCode" id="cb87"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co">; Somme x+y de Structures - Solution</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>.<span class="bu">data</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="fu">points:</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">; points[0]: x=5, y=3</span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">5</span></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">3</span></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">; points[1]: x=10, y=4</span></span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">10</span></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">4</span></span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">; points[2]: x=12, y=8</span></span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">12</span></span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">8</span></span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a>.text</span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a>.global _start</span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a><span class="fu">_start:</span></span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a>    LDR R1<span class="op">,</span> <span class="op">=</span>points     <span class="co">; adresse du tableau</span></span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">0</span>          <span class="co">; somme totale = 0</span></span>
<span id="cb87-20"><a href="#cb87-20" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R4<span class="op">,</span> <span class="op">#</span><span class="dv">3</span>          <span class="co">; compteur = 3</span></span>
<span id="cb87-21"><a href="#cb87-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-22"><a href="#cb87-22" aria-hidden="true" tabindex="-1"></a><span class="fu">.loop:</span></span>
<span id="cb87-23"><a href="#cb87-23" aria-hidden="true" tabindex="-1"></a>    <span class="bu">CMP</span> R4<span class="op">,</span> <span class="op">#</span><span class="dv">0</span></span>
<span id="cb87-24"><a href="#cb87-24" aria-hidden="true" tabindex="-1"></a>    B<span class="op">.</span>EQ <span class="op">.</span>done</span>
<span id="cb87-25"><a href="#cb87-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-26"><a href="#cb87-26" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Charger x et y du Point courant</span></span>
<span id="cb87-27"><a href="#cb87-27" aria-hidden="true" tabindex="-1"></a>    LDR R2<span class="op">,</span> <span class="op">[</span>R1<span class="op">]</span>        <span class="co">; R2 = x</span></span>
<span id="cb87-28"><a href="#cb87-28" aria-hidden="true" tabindex="-1"></a>    LDR R3<span class="op">,</span> <span class="op">[</span>R1<span class="op">,</span> <span class="op">#</span><span class="dv">4</span><span class="op">]</span>    <span class="co">; R3 = y</span></span>
<span id="cb87-29"><a href="#cb87-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-30"><a href="#cb87-30" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Ajouter x+y à la somme</span></span>
<span id="cb87-31"><a href="#cb87-31" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R0<span class="op">,</span> R0<span class="op">,</span> R2      <span class="co">; somme += x</span></span>
<span id="cb87-32"><a href="#cb87-32" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R0<span class="op">,</span> R0<span class="op">,</span> R3      <span class="co">; somme += y</span></span>
<span id="cb87-33"><a href="#cb87-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-34"><a href="#cb87-34" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Point suivant (8 octets)</span></span>
<span id="cb87-35"><a href="#cb87-35" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R1<span class="op">,</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">8</span></span>
<span id="cb87-36"><a href="#cb87-36" aria-hidden="true" tabindex="-1"></a>    <span class="bu">SUB</span> R4<span class="op">,</span> R4<span class="op">,</span> <span class="op">#</span><span class="dv">1</span></span>
<span id="cb87-37"><a href="#cb87-37" aria-hidden="true" tabindex="-1"></a>    B <span class="op">.</span>loop</span>
<span id="cb87-38"><a href="#cb87-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-39"><a href="#cb87-39" aria-hidden="true" tabindex="-1"></a><span class="fu">.done:</span></span>
<span id="cb87-40"><a href="#cb87-40" aria-hidden="true" tabindex="-1"></a>    HALT</span></code></pre></div>
<hr />
<h3 data-number="2.2.19" id="fonctions"><span class="header-section-number">2.2.19</span> Fonctions</h3>
<div class="sourceCode" id="cb88"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co">; Fonctions - Solution</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>.text</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>.global _start</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a><span class="fu">_start:</span></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">21</span></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>    BL double</span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>    HALT</span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a><span class="fu">double:</span></span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R0<span class="op">,</span> R0<span class="op">,</span> R0  <span class="co">; R0 = R0 + R0 = 2 * R0</span></span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> PC<span class="op">,</span> LR      <span class="co">; retour</span></span></code></pre></div>
<hr />
<h3 data-number="2.2.20" id="fonction-add3"><span class="header-section-number">2.2.20</span> Fonction Add3</h3>
<div class="sourceCode" id="cb89"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co">; Fonction Add3 - Solution</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>.text</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>.global _start</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a><span class="fu">_start:</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">10</span></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">15</span></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R2<span class="op">,</span> <span class="op">#</span><span class="dv">17</span></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>    BL add3</span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>    HALT</span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a><span class="fu">add3:</span></span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R0<span class="op">,</span> R0<span class="op">,</span> R1</span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R0<span class="op">,</span> R0<span class="op">,</span> R2</span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> PC<span class="op">,</span> LR</span></code></pre></div>
<hr />
<h3 data-number="2.2.21" id="écrire-caractère"><span class="header-section-number">2.2.21</span> Écrire Caractère</h3>
<div class="sourceCode" id="cb90"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co">; Écrire Caractère - Solution</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>.text</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>.global _start</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a><span class="fu">_start:</span></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">65</span>         <span class="co">; &#39;A&#39; = 65</span></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>    LDR R1<span class="op">,</span> <span class="op">=</span><span class="bn">0xFFFF0000</span> <span class="co">; adresse PUTC</span></span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>    STRB R0<span class="op">,</span> <span class="op">[</span>R1<span class="op">]</span>       <span class="co">; écrire le caractère</span></span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>    HALT</span></code></pre></div>
<hr />
<h3 data-number="2.2.22" id="hello-string"><span class="header-section-number">2.2.22</span> Hello String</h3>
<div class="sourceCode" id="cb91"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co">; Hello String - Solution</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>.text</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>.global _start</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a><span class="fu">_start:</span></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>    LDR R1<span class="op">,</span> <span class="op">=</span><span class="bn">0xFFFF0000</span> <span class="co">; adresse PUTC</span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">0</span>          <span class="co">; compteur</span></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R2<span class="op">,</span> <span class="op">#</span><span class="dv">72</span>         <span class="co">; &#39;H&#39;</span></span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>    STRB R2<span class="op">,</span> <span class="op">[</span>R1<span class="op">]</span></span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R0<span class="op">,</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">1</span></span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R2<span class="op">,</span> <span class="op">#</span><span class="dv">105</span>        <span class="co">; &#39;i&#39;</span></span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a>    STRB R2<span class="op">,</span> <span class="op">[</span>R1<span class="op">]</span></span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R0<span class="op">,</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">1</span></span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a>    HALT</span></code></pre></div>
<hr />
<h3 data-number="2.2.23" id="print-loop"><span class="header-section-number">2.2.23</span> Print Loop</h3>
<div class="sourceCode" id="cb92"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co">; Print Loop - Solution</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>.text</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>.global _start</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a><span class="fu">_start:</span></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>    LDR R1<span class="op">,</span> <span class="op">=</span><span class="bn">0xFFFF0000</span> <span class="co">; adresse PUTC</span></span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">0</span>          <span class="co">; compteur</span></span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R2<span class="op">,</span> <span class="op">#</span><span class="dv">65</span>         <span class="co">; caractère courant = &#39;A&#39;</span></span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a><span class="fu">.loop:</span></span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>    STRB R2<span class="op">,</span> <span class="op">[</span>R1<span class="op">]</span>       <span class="co">; écrire caractère</span></span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R0<span class="op">,</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">1</span>      <span class="co">; compteur++</span></span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R2<span class="op">,</span> R2<span class="op">,</span> <span class="op">#</span><span class="dv">1</span>      <span class="co">; caractère suivant</span></span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a>    <span class="bu">CMP</span> R2<span class="op">,</span> <span class="op">#</span><span class="dv">69</span>         <span class="co">; &#39;E&#39; = 69</span></span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a>    B<span class="op">.</span>LT <span class="op">.</span>loop</span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-17"><a href="#cb92-17" aria-hidden="true" tabindex="-1"></a>    HALT</span></code></pre></div>
<hr />
<h3 data-number="2.2.24" id="pixel"><span class="header-section-number">2.2.24</span> Pixel</h3>
<div class="sourceCode" id="cb93"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co">; Pixel - Solution</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>.text</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>.global _start</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a><span class="fu">_start:</span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>    LDR R1<span class="op">,</span> <span class="op">=</span><span class="bn">0x00400000</span> <span class="co">; adresse écran</span></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R0<span class="op">,</span> <span class="op">#</span><span class="bn">0x80</span>       <span class="co">; bit 7 = pixel 0</span></span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>    STRB R0<span class="op">,</span> <span class="op">[</span>R1<span class="op">]</span>       <span class="co">; écrire le byte</span></span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>    HALT</span></code></pre></div>
<hr />
<h3 data-number="2.2.25" id="ligne-horizontale"><span class="header-section-number">2.2.25</span> Ligne Horizontale</h3>
<div class="sourceCode" id="cb94"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co">; Ligne Horizontale - Solution</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>.text</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>.global _start</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a><span class="fu">_start:</span></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>    LDR R1<span class="op">,</span> <span class="op">=</span><span class="bn">0x00400000</span> <span class="co">; adresse écran</span></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R0<span class="op">,</span> <span class="op">#</span><span class="bn">0xFF</span>       <span class="co">; 8 pixels allumés</span></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>    STRB R0<span class="op">,</span> <span class="op">[</span>R1<span class="op">]</span>       <span class="co">; écrire le byte</span></span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>    HALT</span></code></pre></div>
<hr />
<h3 data-number="2.2.26" id="ligne-verticale"><span class="header-section-number">2.2.26</span> Ligne Verticale</h3>
<div class="sourceCode" id="cb95"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co">; Ligne Verticale - Solution</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>.text</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>.global _start</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a><span class="fu">_start:</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>    LDR R1<span class="op">,</span> <span class="op">=</span><span class="bn">0x00400000</span> <span class="co">; adresse écran</span></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R2<span class="op">,</span> <span class="op">#</span><span class="bn">0x80</span>       <span class="co">; bit du pixel (colonne 0)</span></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">0</span>          <span class="co">; compteur</span></span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a><span class="fu">.loop:</span></span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a>    STRB R2<span class="op">,</span> <span class="op">[</span>R1<span class="op">]</span>       <span class="co">; dessiner pixel</span></span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R1<span class="op">,</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">40</span>     <span class="co">; ligne suivante (320/8 = 40)</span></span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R0<span class="op">,</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">1</span>      <span class="co">; compteur++</span></span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>    <span class="bu">CMP</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">8</span></span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a>    B<span class="op">.</span>LT <span class="op">.</span>loop</span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-17"><a href="#cb95-17" aria-hidden="true" tabindex="-1"></a>    HALT</span></code></pre></div>
<hr />
<h3 data-number="2.2.27" id="rectangle"><span class="header-section-number">2.2.27</span> Rectangle</h3>
<div class="sourceCode" id="cb96"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co">; Rectangle - Solution</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>.text</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>.global _start</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a><span class="fu">_start:</span></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>    LDR R1<span class="op">,</span> <span class="op">=</span><span class="bn">0x00400000</span> <span class="co">; adresse écran</span></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R2<span class="op">,</span> <span class="op">#</span><span class="bn">0xFF</span>       <span class="co">; ligne de 8 pixels</span></span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">0</span>          <span class="co">; compteur de lignes</span></span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a><span class="fu">.loop:</span></span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>    STRB R2<span class="op">,</span> <span class="op">[</span>R1<span class="op">]</span>       <span class="co">; dessiner ligne</span></span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R1<span class="op">,</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">40</span>     <span class="co">; ligne suivante</span></span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R0<span class="op">,</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">1</span>      <span class="co">; compteur++</span></span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a>    <span class="bu">CMP</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">8</span></span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a>    B<span class="op">.</span>LT <span class="op">.</span>loop</span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-17"><a href="#cb96-17" aria-hidden="true" tabindex="-1"></a>    HALT</span></code></pre></div>
<hr />
<h3 data-number="2.2.28" id="damier"><span class="header-section-number">2.2.28</span> Damier</h3>
<div class="sourceCode" id="cb97"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co">; Damier - Solution</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>.text</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>.global _start</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a><span class="fu">_start:</span></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>    LDR R1<span class="op">,</span> <span class="op">=</span><span class="bn">0x00400000</span> <span class="co">; adresse écran</span></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R2<span class="op">,</span> <span class="op">#</span><span class="bn">0xAA</span>       <span class="co">; motif courant</span></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">0</span>          <span class="co">; compteur de lignes</span></span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a><span class="fu">.loop:</span></span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a>    STRB R2<span class="op">,</span> <span class="op">[</span>R1<span class="op">]</span>       <span class="co">; colonne 0</span></span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R4<span class="op">,</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">1</span></span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a>    EOR R5<span class="op">,</span> R2<span class="op">,</span> <span class="op">#</span><span class="bn">0xFF</span>   <span class="co">; inverser pour colonne 1</span></span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a>    STRB R5<span class="op">,</span> <span class="op">[</span>R4<span class="op">]</span>       <span class="co">; colonne 1</span></span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-16"><a href="#cb97-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R1<span class="op">,</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">40</span>     <span class="co">; ligne suivante</span></span>
<span id="cb97-17"><a href="#cb97-17" aria-hidden="true" tabindex="-1"></a>    EOR R2<span class="op">,</span> R2<span class="op">,</span> <span class="op">#</span><span class="bn">0xFF</span>   <span class="co">; alterner le motif</span></span>
<span id="cb97-18"><a href="#cb97-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R0<span class="op">,</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">1</span></span>
<span id="cb97-19"><a href="#cb97-19" aria-hidden="true" tabindex="-1"></a>    <span class="bu">CMP</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">8</span></span>
<span id="cb97-20"><a href="#cb97-20" aria-hidden="true" tabindex="-1"></a>    B<span class="op">.</span>LT <span class="op">.</span>loop</span>
<span id="cb97-21"><a href="#cb97-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-22"><a href="#cb97-22" aria-hidden="true" tabindex="-1"></a>    HALT</span></code></pre></div>
<hr />
<h3 data-number="2.2.29" id="lire-un-caractère"><span class="header-section-number">2.2.29</span> Lire un Caractère</h3>
<div class="sourceCode" id="cb98"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co">; Lire un Caractère - Solution</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>.text</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>.global _start</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a><span class="fu">_start:</span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>    LDR R1<span class="op">,</span> <span class="op">=</span><span class="bn">0x00402600</span> <span class="co">; adresse KEYBOARD (temps réel)</span></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>    LDR R4<span class="op">,</span> <span class="op">=</span><span class="bn">0xFFFF0000</span> <span class="co">; adresse PUTC</span></span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Attendre une touche</span></span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a><span class="fu">.wait:</span></span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a>    LDR R2<span class="op">,</span> <span class="op">[</span>R1<span class="op">]</span>        <span class="co">; lire clavier</span></span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">CMP</span> R2<span class="op">,</span> <span class="op">#</span><span class="dv">0</span></span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a>    B<span class="op">.</span>EQ <span class="op">.</span>wait          <span class="co">; boucler si pas de touche</span></span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Convertir ASCII → nombre</span></span>
<span id="cb98-16"><a href="#cb98-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">SUB</span> R0<span class="op">,</span> R2<span class="op">,</span> <span class="op">#</span><span class="bn">0x30</span>   <span class="co">; R0 = chiffre (0-9)</span></span>
<span id="cb98-17"><a href="#cb98-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-18"><a href="#cb98-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Afficher le chiffre tapé (écho)</span></span>
<span id="cb98-19"><a href="#cb98-19" aria-hidden="true" tabindex="-1"></a>    <span class="bu">STR</span> R2<span class="op">,</span> <span class="op">[</span>R4<span class="op">]</span>        <span class="co">; afficher le caractère</span></span>
<span id="cb98-20"><a href="#cb98-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-21"><a href="#cb98-21" aria-hidden="true" tabindex="-1"></a>    HALT</span></code></pre></div>
<hr />
<h3 data-number="2.2.30" id="lire-un-nombre-à-2-chiffres"><span class="header-section-number">2.2.30</span> Lire un Nombre à 2
Chiffres</h3>
<div class="sourceCode" id="cb99"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co">; Lire un Nombre à 2 Chiffres - Solution</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>.text</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>.global _start</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a><span class="fu">_start:</span></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>    LDR R5<span class="op">,</span> <span class="op">=</span><span class="bn">0x00402600</span> <span class="co">; adresse KEYBOARD (temps réel)</span></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>    LDR R6<span class="op">,</span> <span class="op">=</span><span class="bn">0xFFFF0000</span> <span class="co">; adresse PUTC</span></span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Attendre premier chiffre</span></span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a><span class="fu">.wait1:</span></span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>    LDR R1<span class="op">,</span> <span class="op">[</span>R5<span class="op">]</span></span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">CMP</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">0</span></span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a>    B<span class="op">.</span>EQ <span class="op">.</span>wait1</span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Écho du premier chiffre</span></span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">STR</span> R1<span class="op">,</span> <span class="op">[</span>R6<span class="op">]</span></span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-18"><a href="#cb99-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Convertir en nombre</span></span>
<span id="cb99-19"><a href="#cb99-19" aria-hidden="true" tabindex="-1"></a>    <span class="bu">SUB</span> R1<span class="op">,</span> R1<span class="op">,</span> <span class="op">#</span><span class="bn">0x30</span>   <span class="co">; R1 = premier chiffre</span></span>
<span id="cb99-20"><a href="#cb99-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-21"><a href="#cb99-21" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Multiplier par 10: x → 2x → 4x → 5x → 10x</span></span>
<span id="cb99-22"><a href="#cb99-22" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R2<span class="op">,</span> R1<span class="op">,</span> R1      <span class="co">; R2 = 2x</span></span>
<span id="cb99-23"><a href="#cb99-23" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R2<span class="op">,</span> R2<span class="op">,</span> R2      <span class="co">; R2 = 4x</span></span>
<span id="cb99-24"><a href="#cb99-24" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R2<span class="op">,</span> R2<span class="op">,</span> R1      <span class="co">; R2 = 5x</span></span>
<span id="cb99-25"><a href="#cb99-25" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R1<span class="op">,</span> R2<span class="op">,</span> R2      <span class="co">; R1 = 10x</span></span>
<span id="cb99-26"><a href="#cb99-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-27"><a href="#cb99-27" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Attendre relâche de la touche</span></span>
<span id="cb99-28"><a href="#cb99-28" aria-hidden="true" tabindex="-1"></a><span class="fu">.release1:</span></span>
<span id="cb99-29"><a href="#cb99-29" aria-hidden="true" tabindex="-1"></a>    LDR R2<span class="op">,</span> <span class="op">[</span>R5<span class="op">]</span></span>
<span id="cb99-30"><a href="#cb99-30" aria-hidden="true" tabindex="-1"></a>    <span class="bu">CMP</span> R2<span class="op">,</span> <span class="op">#</span><span class="dv">0</span></span>
<span id="cb99-31"><a href="#cb99-31" aria-hidden="true" tabindex="-1"></a>    B<span class="op">.</span>NE <span class="op">.</span>release1</span>
<span id="cb99-32"><a href="#cb99-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-33"><a href="#cb99-33" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Attendre deuxième chiffre</span></span>
<span id="cb99-34"><a href="#cb99-34" aria-hidden="true" tabindex="-1"></a><span class="fu">.wait2:</span></span>
<span id="cb99-35"><a href="#cb99-35" aria-hidden="true" tabindex="-1"></a>    LDR R2<span class="op">,</span> <span class="op">[</span>R5<span class="op">]</span></span>
<span id="cb99-36"><a href="#cb99-36" aria-hidden="true" tabindex="-1"></a>    <span class="bu">CMP</span> R2<span class="op">,</span> <span class="op">#</span><span class="dv">0</span></span>
<span id="cb99-37"><a href="#cb99-37" aria-hidden="true" tabindex="-1"></a>    B<span class="op">.</span>EQ <span class="op">.</span>wait2</span>
<span id="cb99-38"><a href="#cb99-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-39"><a href="#cb99-39" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Écho du deuxième chiffre</span></span>
<span id="cb99-40"><a href="#cb99-40" aria-hidden="true" tabindex="-1"></a>    <span class="bu">STR</span> R2<span class="op">,</span> <span class="op">[</span>R6<span class="op">]</span></span>
<span id="cb99-41"><a href="#cb99-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-42"><a href="#cb99-42" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Convertir et ajouter</span></span>
<span id="cb99-43"><a href="#cb99-43" aria-hidden="true" tabindex="-1"></a>    <span class="bu">SUB</span> R2<span class="op">,</span> R2<span class="op">,</span> <span class="op">#</span><span class="bn">0x30</span>   <span class="co">; R2 = deuxième chiffre</span></span>
<span id="cb99-44"><a href="#cb99-44" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R0<span class="op">,</span> R1<span class="op">,</span> R2      <span class="co">; R0 = nombre complet</span></span>
<span id="cb99-45"><a href="#cb99-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-46"><a href="#cb99-46" aria-hidden="true" tabindex="-1"></a>    HALT</span></code></pre></div>
<hr />
<h3 data-number="2.2.31" id="deviner-le-nombre"><span class="header-section-number">2.2.31</span> Deviner le Nombre</h3>
<div class="sourceCode" id="cb100"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co">; Deviner le Nombre - Solution</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>.text</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>.global _start</span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a><span class="fu">_start:</span></span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R7<span class="op">,</span> <span class="op">#</span><span class="dv">55</span>         <span class="co">; nombre secret: &#39;7&#39; en ASCII (0x37)</span></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>    LDR R5<span class="op">,</span> <span class="op">=</span><span class="bn">0x00402600</span> <span class="co">; KEYBOARD</span></span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>    LDR R6<span class="op">,</span> <span class="op">=</span><span class="bn">0xFFFF0000</span> <span class="co">; PUTC</span></span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R4<span class="op">,</span> <span class="op">#</span><span class="dv">0</span>          <span class="co">; dernière touche vue</span></span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a><span class="fu">.game_loop:</span></span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Lire clavier</span></span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a>    LDR R0<span class="op">,</span> <span class="op">[</span>R5<span class="op">]</span></span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Ignorer si pas de touche ou même touche que avant</span></span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">CMP</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">0</span></span>
<span id="cb100-17"><a href="#cb100-17" aria-hidden="true" tabindex="-1"></a>    B<span class="op">.</span>EQ <span class="op">.</span>game_loop</span>
<span id="cb100-18"><a href="#cb100-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">CMP</span> R0<span class="op">,</span> R4</span>
<span id="cb100-19"><a href="#cb100-19" aria-hidden="true" tabindex="-1"></a>    B<span class="op">.</span>EQ <span class="op">.</span>game_loop</span>
<span id="cb100-20"><a href="#cb100-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-21"><a href="#cb100-21" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Nouvelle touche détectée</span></span>
<span id="cb100-22"><a href="#cb100-22" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R4<span class="op">,</span> R0          <span class="co">; sauvegarder</span></span>
<span id="cb100-23"><a href="#cb100-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-24"><a href="#cb100-24" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Écho de la touche</span></span>
<span id="cb100-25"><a href="#cb100-25" aria-hidden="true" tabindex="-1"></a>    <span class="bu">STR</span> R0<span class="op">,</span> <span class="op">[</span>R6<span class="op">]</span></span>
<span id="cb100-26"><a href="#cb100-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-27"><a href="#cb100-27" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Comparer au secret</span></span>
<span id="cb100-28"><a href="#cb100-28" aria-hidden="true" tabindex="-1"></a>    <span class="bu">CMP</span> R0<span class="op">,</span> R7</span>
<span id="cb100-29"><a href="#cb100-29" aria-hidden="true" tabindex="-1"></a>    B<span class="op">.</span>EQ <span class="op">.</span>win</span>
<span id="cb100-30"><a href="#cb100-30" aria-hidden="true" tabindex="-1"></a>    B<span class="op">.</span>LT <span class="op">.</span>too_small</span>
<span id="cb100-31"><a href="#cb100-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-32"><a href="#cb100-32" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Trop grand -&gt; afficher &#39;-&#39;</span></span>
<span id="cb100-33"><a href="#cb100-33" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">45</span>         <span class="co">; &#39;-&#39;</span></span>
<span id="cb100-34"><a href="#cb100-34" aria-hidden="true" tabindex="-1"></a>    <span class="bu">STR</span> R1<span class="op">,</span> <span class="op">[</span>R6<span class="op">]</span></span>
<span id="cb100-35"><a href="#cb100-35" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">10</span>         <span class="co">; newline</span></span>
<span id="cb100-36"><a href="#cb100-36" aria-hidden="true" tabindex="-1"></a>    <span class="bu">STR</span> R1<span class="op">,</span> <span class="op">[</span>R6<span class="op">]</span></span>
<span id="cb100-37"><a href="#cb100-37" aria-hidden="true" tabindex="-1"></a>    B <span class="op">.</span>wait_release</span>
<span id="cb100-38"><a href="#cb100-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-39"><a href="#cb100-39" aria-hidden="true" tabindex="-1"></a><span class="fu">.too_small:</span></span>
<span id="cb100-40"><a href="#cb100-40" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Trop petit -&gt; afficher &#39;+&#39;</span></span>
<span id="cb100-41"><a href="#cb100-41" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">43</span>         <span class="co">; &#39;+&#39;</span></span>
<span id="cb100-42"><a href="#cb100-42" aria-hidden="true" tabindex="-1"></a>    <span class="bu">STR</span> R1<span class="op">,</span> <span class="op">[</span>R6<span class="op">]</span></span>
<span id="cb100-43"><a href="#cb100-43" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">10</span>         <span class="co">; newline</span></span>
<span id="cb100-44"><a href="#cb100-44" aria-hidden="true" tabindex="-1"></a>    <span class="bu">STR</span> R1<span class="op">,</span> <span class="op">[</span>R6<span class="op">]</span></span>
<span id="cb100-45"><a href="#cb100-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-46"><a href="#cb100-46" aria-hidden="true" tabindex="-1"></a><span class="fu">.wait_release:</span></span>
<span id="cb100-47"><a href="#cb100-47" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Attendre relâche (R4 != 0, donc on attend que R0 change)</span></span>
<span id="cb100-48"><a href="#cb100-48" aria-hidden="true" tabindex="-1"></a>    LDR R0<span class="op">,</span> <span class="op">[</span>R5<span class="op">]</span></span>
<span id="cb100-49"><a href="#cb100-49" aria-hidden="true" tabindex="-1"></a>    <span class="bu">CMP</span> R0<span class="op">,</span> R4</span>
<span id="cb100-50"><a href="#cb100-50" aria-hidden="true" tabindex="-1"></a>    B<span class="op">.</span>EQ <span class="op">.</span>wait_release</span>
<span id="cb100-51"><a href="#cb100-51" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R4<span class="op">,</span> <span class="op">#</span><span class="dv">0</span>          <span class="co">; reset</span></span>
<span id="cb100-52"><a href="#cb100-52" aria-hidden="true" tabindex="-1"></a>    B <span class="op">.</span>game_loop</span>
<span id="cb100-53"><a href="#cb100-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-54"><a href="#cb100-54" aria-hidden="true" tabindex="-1"></a><span class="fu">.win:</span></span>
<span id="cb100-55"><a href="#cb100-55" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Gagné! Afficher &#39;*&#39;</span></span>
<span id="cb100-56"><a href="#cb100-56" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">42</span>         <span class="co">; &#39;*&#39;</span></span>
<span id="cb100-57"><a href="#cb100-57" aria-hidden="true" tabindex="-1"></a>    <span class="bu">STR</span> R1<span class="op">,</span> <span class="op">[</span>R6<span class="op">]</span></span>
<span id="cb100-58"><a href="#cb100-58" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">10</span></span>
<span id="cb100-59"><a href="#cb100-59" aria-hidden="true" tabindex="-1"></a>    <span class="bu">STR</span> R1<span class="op">,</span> <span class="op">[</span>R6<span class="op">]</span></span>
<span id="cb100-60"><a href="#cb100-60" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">7</span>          <span class="co">; résultat dans R0</span></span>
<span id="cb100-61"><a href="#cb100-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-62"><a href="#cb100-62" aria-hidden="true" tabindex="-1"></a>    HALT</span></code></pre></div>
<hr />
<h3 data-number="2.2.32" id="dégradé-dithering"><span class="header-section-number">2.2.32</span> Dégradé (Dithering)</h3>
<div class="sourceCode" id="cb101"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co">; Dégradé (Dithering) - Solution</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>.text</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>.global _start</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a><span class="fu">_start:</span></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>    LDR R1<span class="op">,</span> <span class="op">=</span><span class="bn">0x00400000</span> <span class="co">; adresse écran</span></span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">0</span>          <span class="co">; compteur lignes</span></span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a><span class="fu">.line_loop:</span></span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Écrire les 5 motifs de dégradé</span></span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R2<span class="op">,</span> <span class="op">#</span><span class="bn">0x00</span>       <span class="co">; noir</span></span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a>    STRB R2<span class="op">,</span> <span class="op">[</span>R1<span class="op">]</span></span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R2<span class="op">,</span> <span class="op">#</span><span class="bn">0x11</span>       <span class="co">; 12.5% blanc</span></span>
<span id="cb101-15"><a href="#cb101-15" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R3<span class="op">,</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">1</span></span>
<span id="cb101-16"><a href="#cb101-16" aria-hidden="true" tabindex="-1"></a>    STRB R2<span class="op">,</span> <span class="op">[</span>R3<span class="op">]</span></span>
<span id="cb101-17"><a href="#cb101-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-18"><a href="#cb101-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R2<span class="op">,</span> <span class="op">#</span><span class="bn">0x55</span>       <span class="co">; 50% blanc</span></span>
<span id="cb101-19"><a href="#cb101-19" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R3<span class="op">,</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">2</span></span>
<span id="cb101-20"><a href="#cb101-20" aria-hidden="true" tabindex="-1"></a>    STRB R2<span class="op">,</span> <span class="op">[</span>R3<span class="op">]</span></span>
<span id="cb101-21"><a href="#cb101-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-22"><a href="#cb101-22" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R2<span class="op">,</span> <span class="op">#</span><span class="bn">0xBB</span>       <span class="co">; 75% blanc</span></span>
<span id="cb101-23"><a href="#cb101-23" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R3<span class="op">,</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">3</span></span>
<span id="cb101-24"><a href="#cb101-24" aria-hidden="true" tabindex="-1"></a>    STRB R2<span class="op">,</span> <span class="op">[</span>R3<span class="op">]</span></span>
<span id="cb101-25"><a href="#cb101-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-26"><a href="#cb101-26" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R2<span class="op">,</span> <span class="op">#</span><span class="bn">0xFF</span>       <span class="co">; blanc</span></span>
<span id="cb101-27"><a href="#cb101-27" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R3<span class="op">,</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">4</span></span>
<span id="cb101-28"><a href="#cb101-28" aria-hidden="true" tabindex="-1"></a>    STRB R2<span class="op">,</span> <span class="op">[</span>R3<span class="op">]</span></span>
<span id="cb101-29"><a href="#cb101-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-30"><a href="#cb101-30" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Ligne suivante</span></span>
<span id="cb101-31"><a href="#cb101-31" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R1<span class="op">,</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">40</span>     <span class="co">; 40 bytes par ligne</span></span>
<span id="cb101-32"><a href="#cb101-32" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R0<span class="op">,</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">1</span></span>
<span id="cb101-33"><a href="#cb101-33" aria-hidden="true" tabindex="-1"></a>    <span class="bu">CMP</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">240</span></span>
<span id="cb101-34"><a href="#cb101-34" aria-hidden="true" tabindex="-1"></a>    B<span class="op">.</span>LT <span class="op">.</span>line_loop</span>
<span id="cb101-35"><a href="#cb101-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-36"><a href="#cb101-36" aria-hidden="true" tabindex="-1"></a>    HALT</span></code></pre></div>
<hr />
<h3 data-number="2.2.33" id="dégradé-plein-écran"><span class="header-section-number">2.2.33</span> Dégradé Plein Écran</h3>
<div class="sourceCode" id="cb102"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co">; Dégradé Plein Écran - Solution</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="co">; 8 bandes avec motifs croissants</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>.text</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>.global _start</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a><span class="fu">_start:</span></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>    LDR R1<span class="op">,</span> <span class="op">=</span><span class="bn">0x00400000</span> <span class="co">; adresse écran</span></span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">0</span>          <span class="co">; compteur bandes</span></span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R2<span class="op">,</span> <span class="op">#</span><span class="bn">0x00</span>       <span class="co">; motif initial (noir)</span></span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a><span class="fu">next_band:</span></span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a>    LDR R3<span class="op">,</span> <span class="op">=</span><span class="dv">1200</span>       <span class="co">; 30 lignes * 40 bytes</span></span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a><span class="fu">fill_band:</span></span>
<span id="cb102-15"><a href="#cb102-15" aria-hidden="true" tabindex="-1"></a>    STRB R2<span class="op">,</span> <span class="op">[</span>R1<span class="op">]</span></span>
<span id="cb102-16"><a href="#cb102-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R1<span class="op">,</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">1</span></span>
<span id="cb102-17"><a href="#cb102-17" aria-hidden="true" tabindex="-1"></a>    <span class="bu">SUB</span> R3<span class="op">,</span> R3<span class="op">,</span> <span class="op">#</span><span class="dv">1</span></span>
<span id="cb102-18"><a href="#cb102-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">CMP</span> R3<span class="op">,</span> <span class="op">#</span><span class="dv">0</span></span>
<span id="cb102-19"><a href="#cb102-19" aria-hidden="true" tabindex="-1"></a>    B<span class="op">.</span>GT fill_band</span>
<span id="cb102-20"><a href="#cb102-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-21"><a href="#cb102-21" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Passer au motif suivant (approximation)</span></span>
<span id="cb102-22"><a href="#cb102-22" aria-hidden="true" tabindex="-1"></a>    <span class="co">; 0x00 -&gt; 0x11 -&gt; 0x22 -&gt; 0x33 -&gt; ...</span></span>
<span id="cb102-23"><a href="#cb102-23" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R2<span class="op">,</span> R2<span class="op">,</span> <span class="op">#</span><span class="bn">0x11</span></span>
<span id="cb102-24"><a href="#cb102-24" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R0<span class="op">,</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">1</span></span>
<span id="cb102-25"><a href="#cb102-25" aria-hidden="true" tabindex="-1"></a>    <span class="bu">CMP</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">8</span></span>
<span id="cb102-26"><a href="#cb102-26" aria-hidden="true" tabindex="-1"></a>    B<span class="op">.</span>LT next_band</span>
<span id="cb102-27"><a href="#cb102-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-28"><a href="#cb102-28" aria-hidden="true" tabindex="-1"></a>    HALT</span></code></pre></div>
<hr />
<h3 data-number="2.2.34" id="recherche-dichotomique"><span class="header-section-number">2.2.34</span> Recherche Dichotomique</h3>
<div class="sourceCode" id="cb103"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co">; Recherche Dichotomique - Solution</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>.text</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>.global _start</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a><span class="fu">_start:</span></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R5<span class="op">,</span> <span class="op">#</span><span class="dv">42</span>         <span class="co">; nombre secret</span></span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">0</span>          <span class="co">; low</span></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R2<span class="op">,</span> <span class="op">#</span><span class="dv">100</span>        <span class="co">; high</span></span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">0</span>          <span class="co">; compteur d&#39;essais</span></span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a><span class="fu">.loop:</span></span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R0<span class="op">,</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">1</span>      <span class="co">; compteur++</span></span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-14"><a href="#cb103-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">; mid = (low + high) / 2</span></span>
<span id="cb103-15"><a href="#cb103-15" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R3<span class="op">,</span> R1<span class="op">,</span> R2</span>
<span id="cb103-16"><a href="#cb103-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R4<span class="op">,</span> R3</span>
<span id="cb103-17"><a href="#cb103-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Division par 2 avec shift (simulé par soustraction successive)</span></span>
<span id="cb103-18"><a href="#cb103-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R3<span class="op">,</span> <span class="op">#</span><span class="dv">0</span></span>
<span id="cb103-19"><a href="#cb103-19" aria-hidden="true" tabindex="-1"></a><span class="fu">.div2:</span></span>
<span id="cb103-20"><a href="#cb103-20" aria-hidden="true" tabindex="-1"></a>    <span class="bu">CMP</span> R4<span class="op">,</span> <span class="op">#</span><span class="dv">2</span></span>
<span id="cb103-21"><a href="#cb103-21" aria-hidden="true" tabindex="-1"></a>    B<span class="op">.</span>LT <span class="op">.</span>div_done</span>
<span id="cb103-22"><a href="#cb103-22" aria-hidden="true" tabindex="-1"></a>    <span class="bu">SUB</span> R4<span class="op">,</span> R4<span class="op">,</span> <span class="op">#</span><span class="dv">2</span></span>
<span id="cb103-23"><a href="#cb103-23" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R3<span class="op">,</span> R3<span class="op">,</span> <span class="op">#</span><span class="dv">1</span></span>
<span id="cb103-24"><a href="#cb103-24" aria-hidden="true" tabindex="-1"></a>    B <span class="op">.</span>div2</span>
<span id="cb103-25"><a href="#cb103-25" aria-hidden="true" tabindex="-1"></a><span class="fu">.div_done:</span></span>
<span id="cb103-26"><a href="#cb103-26" aria-hidden="true" tabindex="-1"></a>    <span class="co">; R3 = mid</span></span>
<span id="cb103-27"><a href="#cb103-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-28"><a href="#cb103-28" aria-hidden="true" tabindex="-1"></a>    <span class="bu">CMP</span> R3<span class="op">,</span> R5</span>
<span id="cb103-29"><a href="#cb103-29" aria-hidden="true" tabindex="-1"></a>    B<span class="op">.</span>EQ <span class="op">.</span>found</span>
<span id="cb103-30"><a href="#cb103-30" aria-hidden="true" tabindex="-1"></a>    B<span class="op">.</span>LT <span class="op">.</span>too_low</span>
<span id="cb103-31"><a href="#cb103-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-32"><a href="#cb103-32" aria-hidden="true" tabindex="-1"></a>    <span class="co">; mid &gt; secret: high = mid - 1</span></span>
<span id="cb103-33"><a href="#cb103-33" aria-hidden="true" tabindex="-1"></a>    <span class="bu">SUB</span> R2<span class="op">,</span> R3<span class="op">,</span> <span class="op">#</span><span class="dv">1</span></span>
<span id="cb103-34"><a href="#cb103-34" aria-hidden="true" tabindex="-1"></a>    B <span class="op">.</span>loop</span>
<span id="cb103-35"><a href="#cb103-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-36"><a href="#cb103-36" aria-hidden="true" tabindex="-1"></a><span class="fu">.too_low:</span></span>
<span id="cb103-37"><a href="#cb103-37" aria-hidden="true" tabindex="-1"></a>    <span class="co">; mid &lt; secret: low = mid + 1</span></span>
<span id="cb103-38"><a href="#cb103-38" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R1<span class="op">,</span> R3<span class="op">,</span> <span class="op">#</span><span class="dv">1</span></span>
<span id="cb103-39"><a href="#cb103-39" aria-hidden="true" tabindex="-1"></a>    B <span class="op">.</span>loop</span>
<span id="cb103-40"><a href="#cb103-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-41"><a href="#cb103-41" aria-hidden="true" tabindex="-1"></a><span class="fu">.found:</span></span>
<span id="cb103-42"><a href="#cb103-42" aria-hidden="true" tabindex="-1"></a>    HALT</span></code></pre></div>
<hr />
<h3 data-number="2.2.35" id="cache-acces-sequentiel"><span class="header-section-number">2.2.35</span> Cache: Acces Sequentiel</h3>
<div class="sourceCode" id="cb104"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co">; Accès Séquentiel - Solution</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="co">; Parcours cache-friendly d&#39;un tableau</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>.<span class="bu">data</span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a><span class="fu">arr:</span></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">10</span></span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">20</span></span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">30</span></span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">40</span></span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a>.text</span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a>.global _start</span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a><span class="fu">_start:</span></span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">0</span>          <span class="co">; somme = 0</span></span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a>    LDR R1<span class="op">,</span> <span class="op">=</span>arr        <span class="co">; adresse du tableau</span></span>
<span id="cb104-16"><a href="#cb104-16" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R2<span class="op">,</span> <span class="op">#</span><span class="dv">4</span>          <span class="co">; compteur</span></span>
<span id="cb104-17"><a href="#cb104-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-18"><a href="#cb104-18" aria-hidden="true" tabindex="-1"></a><span class="fu">.loop:</span></span>
<span id="cb104-19"><a href="#cb104-19" aria-hidden="true" tabindex="-1"></a>    <span class="bu">CMP</span> R2<span class="op">,</span> <span class="op">#</span><span class="dv">0</span></span>
<span id="cb104-20"><a href="#cb104-20" aria-hidden="true" tabindex="-1"></a>    B<span class="op">.</span>EQ <span class="op">.</span>done</span>
<span id="cb104-21"><a href="#cb104-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-22"><a href="#cb104-22" aria-hidden="true" tabindex="-1"></a>    LDR R3<span class="op">,</span> <span class="op">[</span>R1<span class="op">]</span>        <span class="co">; charger arr[i]</span></span>
<span id="cb104-23"><a href="#cb104-23" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R0<span class="op">,</span> R0<span class="op">,</span> R3      <span class="co">; somme += arr[i]</span></span>
<span id="cb104-24"><a href="#cb104-24" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R1<span class="op">,</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">4</span>      <span class="co">; adresse += 4 (accès séquentiel!)</span></span>
<span id="cb104-25"><a href="#cb104-25" aria-hidden="true" tabindex="-1"></a>    <span class="bu">SUB</span> R2<span class="op">,</span> R2<span class="op">,</span> <span class="op">#</span><span class="dv">1</span>      <span class="co">; compteur--</span></span>
<span id="cb104-26"><a href="#cb104-26" aria-hidden="true" tabindex="-1"></a>    B <span class="op">.</span>loop</span>
<span id="cb104-27"><a href="#cb104-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-28"><a href="#cb104-28" aria-hidden="true" tabindex="-1"></a><span class="fu">.done:</span></span>
<span id="cb104-29"><a href="#cb104-29" aria-hidden="true" tabindex="-1"></a>    HALT</span></code></pre></div>
<p><strong>Explication:</strong> L’accès séquentiel (adresses 0, 4, 8,
12…) est optimal pour le cache car il exploite la localité spatiale :
les données proches en mémoire sont chargées ensemble dans une ligne de
cache.</p>
<hr />
<h3 data-number="2.2.36" id="cache-acces-avec-stride"><span class="header-section-number">2.2.36</span> Cache: Acces avec
Stride</h3>
<div class="sourceCode" id="cb105"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co">; Accès avec Stride - Solution</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="co">; Parcours avec sauts de 16 bytes (4 mots)</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>.<span class="bu">data</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="fu">matrix:</span></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Ligne 0</span></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">1</span></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">2</span></span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">3</span></span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">4</span></span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Ligne 1</span></span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">5</span></span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">6</span></span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">7</span></span>
<span id="cb105-15"><a href="#cb105-15" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">8</span></span>
<span id="cb105-16"><a href="#cb105-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Ligne 2</span></span>
<span id="cb105-17"><a href="#cb105-17" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">9</span></span>
<span id="cb105-18"><a href="#cb105-18" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">10</span></span>
<span id="cb105-19"><a href="#cb105-19" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">11</span></span>
<span id="cb105-20"><a href="#cb105-20" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">12</span></span>
<span id="cb105-21"><a href="#cb105-21" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Ligne 3</span></span>
<span id="cb105-22"><a href="#cb105-22" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">13</span></span>
<span id="cb105-23"><a href="#cb105-23" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">14</span></span>
<span id="cb105-24"><a href="#cb105-24" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">15</span></span>
<span id="cb105-25"><a href="#cb105-25" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">16</span></span>
<span id="cb105-26"><a href="#cb105-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-27"><a href="#cb105-27" aria-hidden="true" tabindex="-1"></a>.text</span>
<span id="cb105-28"><a href="#cb105-28" aria-hidden="true" tabindex="-1"></a>.global _start</span>
<span id="cb105-29"><a href="#cb105-29" aria-hidden="true" tabindex="-1"></a><span class="fu">_start:</span></span>
<span id="cb105-30"><a href="#cb105-30" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">0</span>          <span class="co">; somme = 0</span></span>
<span id="cb105-31"><a href="#cb105-31" aria-hidden="true" tabindex="-1"></a>    LDR R1<span class="op">,</span> <span class="op">=</span>matrix     <span class="co">; adresse colonne 0</span></span>
<span id="cb105-32"><a href="#cb105-32" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R2<span class="op">,</span> <span class="op">#</span><span class="dv">4</span>          <span class="co">; compteur lignes</span></span>
<span id="cb105-33"><a href="#cb105-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-34"><a href="#cb105-34" aria-hidden="true" tabindex="-1"></a><span class="fu">.loop:</span></span>
<span id="cb105-35"><a href="#cb105-35" aria-hidden="true" tabindex="-1"></a>    <span class="bu">CMP</span> R2<span class="op">,</span> <span class="op">#</span><span class="dv">0</span></span>
<span id="cb105-36"><a href="#cb105-36" aria-hidden="true" tabindex="-1"></a>    B<span class="op">.</span>EQ <span class="op">.</span>done</span>
<span id="cb105-37"><a href="#cb105-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-38"><a href="#cb105-38" aria-hidden="true" tabindex="-1"></a>    LDR R3<span class="op">,</span> <span class="op">[</span>R1<span class="op">]</span>        <span class="co">; charger matrix[i][0]</span></span>
<span id="cb105-39"><a href="#cb105-39" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R0<span class="op">,</span> R0<span class="op">,</span> R3      <span class="co">; somme += valeur</span></span>
<span id="cb105-40"><a href="#cb105-40" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R1<span class="op">,</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">16</span>     <span class="co">; stride = 16 bytes (saute une ligne)</span></span>
<span id="cb105-41"><a href="#cb105-41" aria-hidden="true" tabindex="-1"></a>    <span class="bu">SUB</span> R2<span class="op">,</span> R2<span class="op">,</span> <span class="op">#</span><span class="dv">1</span></span>
<span id="cb105-42"><a href="#cb105-42" aria-hidden="true" tabindex="-1"></a>    B <span class="op">.</span>loop</span>
<span id="cb105-43"><a href="#cb105-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-44"><a href="#cb105-44" aria-hidden="true" tabindex="-1"></a><span class="fu">.done:</span></span>
<span id="cb105-45"><a href="#cb105-45" aria-hidden="true" tabindex="-1"></a>    HALT</span></code></pre></div>
<p><strong>Explication:</strong> Le stride de 16 bytes signifie qu’on
saute 4 éléments à chaque accès (1→5→9→13). C’est moins efficace pour le
cache car chaque accès peut nécessiter une nouvelle ligne de cache.</p>
<hr />
<h3 data-number="2.2.37" id="cache-reutilisation-registre"><span class="header-section-number">2.2.37</span> Cache: Reutilisation
Registre</h3>
<div class="sourceCode" id="cb106"><pre class="sourceCode asm"><code class="sourceCode fasm"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co">; Réutilisation des Registres - Solution</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="co">; Charger une fois, réutiliser plusieurs fois</span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>.<span class="bu">data</span></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a><span class="fu">a:</span></span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">10</span></span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a><span class="fu">b:</span></span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="dv">3</span></span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a>.text</span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a>.global _start</span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a><span class="fu">_start:</span></span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Charger une seule fois depuis la mémoire</span></span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true" tabindex="-1"></a>    LDR R6<span class="op">,</span> <span class="op">=</span>a</span>
<span id="cb106-15"><a href="#cb106-15" aria-hidden="true" tabindex="-1"></a>    LDR R1<span class="op">,</span> <span class="op">[</span>R6<span class="op">]</span>        <span class="co">; R1 = a = 10</span></span>
<span id="cb106-16"><a href="#cb106-16" aria-hidden="true" tabindex="-1"></a>    LDR R6<span class="op">,</span> <span class="op">=</span>b</span>
<span id="cb106-17"><a href="#cb106-17" aria-hidden="true" tabindex="-1"></a>    LDR R2<span class="op">,</span> <span class="op">[</span>R6<span class="op">]</span>        <span class="co">; R2 = b = 3</span></span>
<span id="cb106-18"><a href="#cb106-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-19"><a href="#cb106-19" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Calculer avec les registres (pas d&#39;accès mémoire!)</span></span>
<span id="cb106-20"><a href="#cb106-20" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R3<span class="op">,</span> R1<span class="op">,</span> R2      <span class="co">; sum = a + b = 13</span></span>
<span id="cb106-21"><a href="#cb106-21" aria-hidden="true" tabindex="-1"></a>    <span class="bu">SUB</span> R4<span class="op">,</span> R1<span class="op">,</span> R2      <span class="co">; diff = a - b = 7</span></span>
<span id="cb106-22"><a href="#cb106-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-23"><a href="#cb106-23" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Multiplier sum * diff par additions</span></span>
<span id="cb106-24"><a href="#cb106-24" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">0</span>          <span class="co">; résultat</span></span>
<span id="cb106-25"><a href="#cb106-25" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R5<span class="op">,</span> R4          <span class="co">; compteur = diff = 7</span></span>
<span id="cb106-26"><a href="#cb106-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-27"><a href="#cb106-27" aria-hidden="true" tabindex="-1"></a><span class="fu">.mult:</span></span>
<span id="cb106-28"><a href="#cb106-28" aria-hidden="true" tabindex="-1"></a>    <span class="bu">CMP</span> R5<span class="op">,</span> <span class="op">#</span><span class="dv">0</span></span>
<span id="cb106-29"><a href="#cb106-29" aria-hidden="true" tabindex="-1"></a>    B<span class="op">.</span>EQ <span class="op">.</span>done</span>
<span id="cb106-30"><a href="#cb106-30" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R0<span class="op">,</span> R0<span class="op">,</span> R3      <span class="co">; résultat += sum</span></span>
<span id="cb106-31"><a href="#cb106-31" aria-hidden="true" tabindex="-1"></a>    <span class="bu">SUB</span> R5<span class="op">,</span> R5<span class="op">,</span> <span class="op">#</span><span class="dv">1</span></span>
<span id="cb106-32"><a href="#cb106-32" aria-hidden="true" tabindex="-1"></a>    B <span class="op">.</span>mult</span>
<span id="cb106-33"><a href="#cb106-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-34"><a href="#cb106-34" aria-hidden="true" tabindex="-1"></a><span class="fu">.done:</span></span>
<span id="cb106-35"><a href="#cb106-35" aria-hidden="true" tabindex="-1"></a>    HALT</span></code></pre></div>
<p><strong>Explication:</strong> Les registres sont ~100x plus rapides
que la RAM. En chargeant <code>a</code> et <code>b</code> une seule fois
et en gardant les valeurs en registre pour tous les calculs, on évite
les accès mémoire coûteux.</p>
<hr />
<h2 data-number="2.3" id="c.-solutions-c32"><span class="header-section-number">2.3</span> C. Solutions C32</h2>
<h3 data-number="2.3.1" id="variables"><span class="header-section-number">2.3.1</span> Variables</h3>
<div class="sourceCode" id="cb107"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Variables - Solution</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> x <span class="op">=</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> y <span class="op">=</span> <span class="dv">32</span><span class="op">;</span></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> result <span class="op">=</span> x <span class="op">+</span> y<span class="op">;</span></span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result<span class="op">;</span></span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.3.2" id="expressions"><span class="header-section-number">2.3.2</span> Expressions</h3>
<div class="sourceCode" id="cb108"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Expressions - Solution</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> result <span class="op">=</span> <span class="op">(</span><span class="dv">5</span> <span class="op">+</span> <span class="dv">3</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="dv">10</span> <span class="op">-</span> <span class="dv">4</span><span class="op">)</span> <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result<span class="op">;</span></span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.3.3" id="modulo"><span class="header-section-number">2.3.3</span> Modulo</h3>
<div class="sourceCode" id="cb109"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Modulo - Solution</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> result <span class="op">=</span> <span class="op">(</span><span class="dv">100</span> <span class="op">%</span> <span class="dv">7</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="dv">45</span> <span class="op">%</span> <span class="dv">8</span><span class="op">);</span></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result<span class="op">;</span></span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.3.4" id="incrémentation"><span class="header-section-number">2.3.4</span> Incrémentation</h3>
<div class="sourceCode" id="cb110"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Incrémentation - Solution</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> x <span class="op">=</span> <span class="dv">5</span><span class="op">;</span></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> x <span class="op">+</span> <span class="dv">3</span><span class="op">;</span>   <span class="co">// x = 8</span></span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> x <span class="op">*</span> <span class="dv">2</span><span class="op">;</span>   <span class="co">// x = 16</span></span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> x <span class="op">-</span> <span class="dv">1</span><span class="op">;</span>   <span class="co">// x = 15</span></span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x<span class="op">;</span></span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.3.5" id="conditions-1"><span class="header-section-number">2.3.5</span> Conditions</h3>
<div class="sourceCode" id="cb111"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Conditions - Solution</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> a <span class="op">=</span> <span class="dv">25</span><span class="op">;</span></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> b <span class="op">=</span> <span class="dv">17</span><span class="op">;</span></span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> max<span class="op">;</span></span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>a <span class="op">&gt;</span> b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a>        max <span class="op">=</span> a<span class="op">;</span></span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a>        max <span class="op">=</span> b<span class="op">;</span></span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb111-13"><a href="#cb111-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-14"><a href="#cb111-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> max<span class="op">;</span></span>
<span id="cb111-15"><a href="#cb111-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.3.6" id="else-if"><span class="header-section-number">2.3.6</span> Else-If</h3>
<div class="sourceCode" id="cb112"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Else-If - Solution</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> score <span class="op">=</span> <span class="dv">75</span><span class="op">;</span></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> grade<span class="op">;</span></span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-7"><a href="#cb112-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>score <span class="op">&gt;=</span> <span class="dv">90</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb112-8"><a href="#cb112-8" aria-hidden="true" tabindex="-1"></a>        grade <span class="op">=</span> <span class="dv">5</span><span class="op">;</span></span>
<span id="cb112-9"><a href="#cb112-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>score <span class="op">&gt;=</span> <span class="dv">80</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb112-10"><a href="#cb112-10" aria-hidden="true" tabindex="-1"></a>        grade <span class="op">=</span> <span class="dv">4</span><span class="op">;</span></span>
<span id="cb112-11"><a href="#cb112-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>score <span class="op">&gt;=</span> <span class="dv">70</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb112-12"><a href="#cb112-12" aria-hidden="true" tabindex="-1"></a>        grade <span class="op">=</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb112-13"><a href="#cb112-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>score <span class="op">&gt;=</span> <span class="dv">60</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb112-14"><a href="#cb112-14" aria-hidden="true" tabindex="-1"></a>        grade <span class="op">=</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb112-15"><a href="#cb112-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb112-16"><a href="#cb112-16" aria-hidden="true" tabindex="-1"></a>        grade <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb112-17"><a href="#cb112-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb112-18"><a href="#cb112-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-19"><a href="#cb112-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> grade<span class="op">;</span></span>
<span id="cb112-20"><a href="#cb112-20" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.3.7" id="opérateurs-logiques"><span class="header-section-number">2.3.7</span> Opérateurs Logiques</h3>
<div class="sourceCode" id="cb113"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Opérateurs Logiques - Solution</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> x <span class="op">=</span> <span class="dv">15</span><span class="op">;</span></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> result<span class="op">;</span></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>x <span class="op">&gt;=</span> <span class="dv">10</span> <span class="op">&amp;&amp;</span> x <span class="op">&lt;=</span> <span class="dv">20</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-13"><a href="#cb113-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result<span class="op">;</span></span>
<span id="cb113-14"><a href="#cb113-14" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.3.8" id="maximum-de-3"><span class="header-section-number">2.3.8</span> Maximum de 3</h3>
<div class="sourceCode" id="cb114"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Maximum de 3 - Solution</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> a <span class="op">=</span> <span class="dv">15</span><span class="op">;</span></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> b <span class="op">=</span> <span class="dv">42</span><span class="op">;</span></span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> c <span class="op">=</span> <span class="dv">27</span><span class="op">;</span></span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> max<span class="op">;</span></span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>a <span class="op">&gt;=</span> b <span class="op">&amp;&amp;</span> a <span class="op">&gt;=</span> c<span class="op">)</span> <span class="op">{</span></span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a>        max <span class="op">=</span> a<span class="op">;</span></span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>b <span class="op">&gt;=</span> c<span class="op">)</span> <span class="op">{</span></span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a>        max <span class="op">=</span> b<span class="op">;</span></span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb114-14"><a href="#cb114-14" aria-hidden="true" tabindex="-1"></a>        max <span class="op">=</span> c<span class="op">;</span></span>
<span id="cb114-15"><a href="#cb114-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb114-16"><a href="#cb114-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-17"><a href="#cb114-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> max<span class="op">;</span></span>
<span id="cb114-18"><a href="#cb114-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.3.9" id="boucle-for"><span class="header-section-number">2.3.9</span> Boucle For</h3>
<div class="sourceCode" id="cb115"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Boucle For - Solution</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> sum <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> <span class="dv">10</span><span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a>        sum <span class="op">=</span> sum <span class="op">+</span> i<span class="op">;</span></span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sum<span class="op">;</span></span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.3.10" id="boucle-while"><span class="header-section-number">2.3.10</span> Boucle While</h3>
<div class="sourceCode" id="cb116"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Boucle While - Solution</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n <span class="op">=</span> <span class="dv">12345</span><span class="op">;</span></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> count <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>n <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a>        count <span class="op">=</span> count <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a>        n <span class="op">=</span> n <span class="op">/</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-12"><a href="#cb116-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> count<span class="op">;</span></span>
<span id="cb116-13"><a href="#cb116-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.3.11" id="boucles-imbriquées"><span class="header-section-number">2.3.11</span> Boucles Imbriquées</h3>
<div class="sourceCode" id="cb117"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Boucles Imbriquées - Solution</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> sum <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> <span class="dv">3</span><span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> j <span class="op">&lt;=</span> <span class="dv">4</span><span class="op">;</span> j <span class="op">=</span> j <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a>            sum <span class="op">=</span> sum <span class="op">+</span> i <span class="op">*</span> j<span class="op">;</span></span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb117-11"><a href="#cb117-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-12"><a href="#cb117-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sum<span class="op">;</span></span>
<span id="cb117-13"><a href="#cb117-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.3.12" id="multiplication-1"><span class="header-section-number">2.3.12</span> Multiplication</h3>
<div class="sourceCode" id="cb118"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Multiplication - Solution</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> a <span class="op">=</span> <span class="dv">7</span><span class="op">;</span></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> b <span class="op">=</span> <span class="dv">8</span><span class="op">;</span></span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> result <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> b<span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> result <span class="op">+</span> a<span class="op">;</span></span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-12"><a href="#cb118-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result<span class="op">;</span></span>
<span id="cb118-13"><a href="#cb118-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.3.13" id="fonctions-1"><span class="header-section-number">2.3.13</span> Fonctions</h3>
<div class="sourceCode" id="cb119"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Fonctions - Solution</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> square<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> n <span class="op">*</span> n<span class="op">;</span></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> square<span class="op">(</span><span class="dv">7</span><span class="op">);</span></span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.3.14" id="paramètres-multiples"><span class="header-section-number">2.3.14</span> Paramètres Multiples</h3>
<div class="sourceCode" id="cb120"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Paramètres Multiples - Solution</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> add3<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> b<span class="op">,</span> <span class="dt">int</span> c<span class="op">)</span> <span class="op">{</span></span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> a <span class="op">+</span> b <span class="op">+</span> c<span class="op">;</span></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> add3<span class="op">(</span><span class="dv">10</span><span class="op">,</span> <span class="dv">20</span><span class="op">,</span> <span class="dv">12</span><span class="op">);</span></span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.3.15" id="valeur-absolue-1"><span class="header-section-number">2.3.15</span> Valeur Absolue</h3>
<div class="sourceCode" id="cb121"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Valeur Absolue - Solution</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> abs<span class="op">(</span><span class="dt">int</span> x<span class="op">)</span> <span class="op">{</span></span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>x <span class="op">&lt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="op">-</span>x<span class="op">;</span></span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x<span class="op">;</span></span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb121-9"><a href="#cb121-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-10"><a href="#cb121-10" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb121-11"><a href="#cb121-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> abs<span class="op">(-</span><span class="dv">15</span><span class="op">)</span> <span class="op">+</span> abs<span class="op">(</span><span class="dv">10</span><span class="op">);</span></span>
<span id="cb121-12"><a href="#cb121-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.3.16" id="min-et-max"><span class="header-section-number">2.3.16</span> Min et Max</h3>
<div class="sourceCode" id="cb122"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Min et Max - Solution</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> min<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>a <span class="op">&lt;</span> b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> a<span class="op">;</span></span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> b<span class="op">;</span></span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> max<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>a <span class="op">&gt;</span> b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb122-12"><a href="#cb122-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> a<span class="op">;</span></span>
<span id="cb122-13"><a href="#cb122-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb122-14"><a href="#cb122-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> b<span class="op">;</span></span>
<span id="cb122-15"><a href="#cb122-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb122-16"><a href="#cb122-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-17"><a href="#cb122-17" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb122-18"><a href="#cb122-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> max<span class="op">(</span><span class="dv">10</span><span class="op">,</span> <span class="dv">25</span><span class="op">)</span> <span class="op">-</span> min<span class="op">(</span><span class="dv">10</span><span class="op">,</span> <span class="dv">25</span><span class="op">);</span></span>
<span id="cb122-19"><a href="#cb122-19" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.3.17" id="tableaux-1"><span class="header-section-number">2.3.17</span> Tableaux</h3>
<div class="sourceCode" id="cb123"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Tableaux - Solution</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> arr<span class="op">[</span><span class="dv">5</span><span class="op">];</span></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>    arr<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>    arr<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="dv">7</span><span class="op">;</span></span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>    arr<span class="op">[</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a>    arr<span class="op">[</span><span class="dv">3</span><span class="op">]</span> <span class="op">=</span> <span class="dv">9</span><span class="op">;</span></span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a>    arr<span class="op">[</span><span class="dv">4</span><span class="op">]</span> <span class="op">=</span> <span class="dv">5</span><span class="op">;</span></span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> sum <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb123-12"><a href="#cb123-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-13"><a href="#cb123-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">5</span><span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb123-14"><a href="#cb123-14" aria-hidden="true" tabindex="-1"></a>        sum <span class="op">=</span> sum <span class="op">+</span> arr<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb123-15"><a href="#cb123-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb123-16"><a href="#cb123-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-17"><a href="#cb123-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sum<span class="op">;</span></span>
<span id="cb123-18"><a href="#cb123-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.3.18" id="maximum-tableau-1"><span class="header-section-number">2.3.18</span> Maximum Tableau</h3>
<div class="sourceCode" id="cb124"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Maximum Tableau - Solution</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> arr<span class="op">[</span><span class="dv">6</span><span class="op">];</span></span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>    arr<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">12</span><span class="op">;</span></span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>    arr<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="dv">45</span><span class="op">;</span></span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a>    arr<span class="op">[</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> <span class="dv">7</span><span class="op">;</span></span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a>    arr<span class="op">[</span><span class="dv">3</span><span class="op">]</span> <span class="op">=</span> <span class="dv">23</span><span class="op">;</span></span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a>    arr<span class="op">[</span><span class="dv">4</span><span class="op">]</span> <span class="op">=</span> <span class="dv">56</span><span class="op">;</span></span>
<span id="cb124-10"><a href="#cb124-10" aria-hidden="true" tabindex="-1"></a>    arr<span class="op">[</span><span class="dv">5</span><span class="op">]</span> <span class="op">=</span> <span class="dv">34</span><span class="op">;</span></span>
<span id="cb124-11"><a href="#cb124-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-12"><a href="#cb124-12" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> max <span class="op">=</span> arr<span class="op">[</span><span class="dv">0</span><span class="op">];</span></span>
<span id="cb124-13"><a href="#cb124-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-14"><a href="#cb124-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">6</span><span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb124-15"><a href="#cb124-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>arr<span class="op">[</span>i<span class="op">]</span> <span class="op">&gt;</span> max<span class="op">)</span> <span class="op">{</span></span>
<span id="cb124-16"><a href="#cb124-16" aria-hidden="true" tabindex="-1"></a>            max <span class="op">=</span> arr<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb124-17"><a href="#cb124-17" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb124-18"><a href="#cb124-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb124-19"><a href="#cb124-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-20"><a href="#cb124-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> max<span class="op">;</span></span>
<span id="cb124-21"><a href="#cb124-21" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.3.19" id="compter-éléments"><span class="header-section-number">2.3.19</span> Compter Éléments</h3>
<div class="sourceCode" id="cb125"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Compter Éléments - Solution</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> arr<span class="op">[</span><span class="dv">8</span><span class="op">];</span></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>    arr<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>    arr<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="dv">8</span><span class="op">;</span></span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>    arr<span class="op">[</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>    arr<span class="op">[</span><span class="dv">3</span><span class="op">]</span> <span class="op">=</span> <span class="dv">7</span><span class="op">;</span></span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a>    arr<span class="op">[</span><span class="dv">4</span><span class="op">]</span> <span class="op">=</span> <span class="dv">4</span><span class="op">;</span></span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a>    arr<span class="op">[</span><span class="dv">5</span><span class="op">]</span> <span class="op">=</span> <span class="dv">9</span><span class="op">;</span></span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a>    arr<span class="op">[</span><span class="dv">6</span><span class="op">]</span> <span class="op">=</span> <span class="dv">6</span><span class="op">;</span></span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a>    arr<span class="op">[</span><span class="dv">7</span><span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb125-13"><a href="#cb125-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-14"><a href="#cb125-14" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> count <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb125-15"><a href="#cb125-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-16"><a href="#cb125-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">8</span><span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb125-17"><a href="#cb125-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>arr<span class="op">[</span>i<span class="op">]</span> <span class="op">%</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb125-18"><a href="#cb125-18" aria-hidden="true" tabindex="-1"></a>            count <span class="op">=</span> count <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb125-19"><a href="#cb125-19" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb125-20"><a href="#cb125-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb125-21"><a href="#cb125-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-22"><a href="#cb125-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> count<span class="op">;</span></span>
<span id="cb125-23"><a href="#cb125-23" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.3.20" id="pointeurs"><span class="header-section-number">2.3.20</span> Pointeurs</h3>
<div class="sourceCode" id="cb126"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Pointeurs - Solution</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> x <span class="op">=</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> <span class="op">*</span>p <span class="op">=</span> <span class="op">&amp;</span>x<span class="op">;</span></span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span>p <span class="op">=</span> <span class="dv">42</span><span class="op">;</span></span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x<span class="op">;</span></span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.3.21" id="swap"><span class="header-section-number">2.3.21</span> Swap</h3>
<div class="sourceCode" id="cb127"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Swap - Solution</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> swap<span class="op">(</span><span class="dt">int</span> <span class="op">*</span>a<span class="op">,</span> <span class="dt">int</span> <span class="op">*</span>b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> temp <span class="op">=</span> <span class="op">*</span>a<span class="op">;</span></span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span>a <span class="op">=</span> <span class="op">*</span>b<span class="op">;</span></span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span>b <span class="op">=</span> temp<span class="op">;</span></span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb127-10"><a href="#cb127-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> x <span class="op">=</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="cb127-11"><a href="#cb127-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> y <span class="op">=</span> <span class="dv">20</span><span class="op">;</span></span>
<span id="cb127-12"><a href="#cb127-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-13"><a href="#cb127-13" aria-hidden="true" tabindex="-1"></a>    swap<span class="op">(&amp;</span>x<span class="op">,</span> <span class="op">&amp;</span>y<span class="op">);</span></span>
<span id="cb127-14"><a href="#cb127-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-15"><a href="#cb127-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x<span class="op">;</span></span>
<span id="cb127-16"><a href="#cb127-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.3.22" id="pointeurs-et-tableaux"><span class="header-section-number">2.3.22</span> Pointeurs et Tableaux</h3>
<div class="sourceCode" id="cb128"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Pointeurs et Tableaux - Solution</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> arr<span class="op">[</span><span class="dv">4</span><span class="op">];</span></span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>    arr<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">5</span><span class="op">;</span></span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a>    arr<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a>    arr<span class="op">[</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> <span class="dv">15</span><span class="op">;</span></span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a>    arr<span class="op">[</span><span class="dv">3</span><span class="op">]</span> <span class="op">=</span> <span class="dv">20</span><span class="op">;</span></span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-10"><a href="#cb128-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> sum <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb128-11"><a href="#cb128-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> <span class="op">*</span>p <span class="op">=</span> arr<span class="op">;</span></span>
<span id="cb128-12"><a href="#cb128-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-13"><a href="#cb128-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">4</span><span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb128-14"><a href="#cb128-14" aria-hidden="true" tabindex="-1"></a>        sum <span class="op">=</span> sum <span class="op">+</span> <span class="op">*(</span>p <span class="op">+</span> i<span class="op">);</span></span>
<span id="cb128-15"><a href="#cb128-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb128-16"><a href="#cb128-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-17"><a href="#cb128-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sum<span class="op">;</span></span>
<span id="cb128-18"><a href="#cb128-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.3.23" id="opérations-binaires"><span class="header-section-number">2.3.23</span> Opérations Binaires</h3>
<div class="sourceCode" id="cb129"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Opérations Binaires - Solution</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> x <span class="op">=</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> y <span class="op">=</span> <span class="dv">12</span><span class="op">;</span></span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> result <span class="op">=</span> <span class="op">(</span>x <span class="op">&amp;</span> y<span class="op">)</span> <span class="op">|</span> <span class="op">(</span>x <span class="op">^</span> y<span class="op">);</span></span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result<span class="op">;</span></span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.3.24" id="puissance-de-2"><span class="header-section-number">2.3.24</span> Puissance de 2</h3>
<div class="sourceCode" id="cb130"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Puissance de 2 - Solution</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> is_pow2<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">&lt;=</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">(</span>n <span class="op">&amp;</span> <span class="op">(</span>n <span class="op">-</span> <span class="dv">1</span><span class="op">))</span> <span class="op">==</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb130-9"><a href="#cb130-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-10"><a href="#cb130-10" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb130-11"><a href="#cb130-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> is_pow2<span class="op">(</span><span class="dv">16</span><span class="op">)</span> <span class="op">+</span> is_pow2<span class="op">(</span><span class="dv">15</span><span class="op">)</span> <span class="op">+</span> is_pow2<span class="op">(</span><span class="dv">32</span><span class="op">);</span></span>
<span id="cb130-12"><a href="#cb130-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.3.25" id="factorielle"><span class="header-section-number">2.3.25</span> Factorielle</h3>
<div class="sourceCode" id="cb131"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Factorielle - Solution</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> fact<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">&lt;=</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> n <span class="op">*</span> fact<span class="op">(</span>n <span class="op">-</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb131-11"><a href="#cb131-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> fact<span class="op">(</span><span class="dv">5</span><span class="op">);</span></span>
<span id="cb131-12"><a href="#cb131-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.3.26" id="fibonacci-1"><span class="header-section-number">2.3.26</span> Fibonacci</h3>
<div class="sourceCode" id="cb132"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Fibonacci - Solution</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> fib<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">&lt;=</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> fib<span class="op">(</span>n <span class="op">-</span> <span class="dv">1</span><span class="op">)</span> <span class="op">+</span> fib<span class="op">(</span>n <span class="op">-</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb132-11"><a href="#cb132-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb132-12"><a href="#cb132-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-13"><a href="#cb132-13" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb132-14"><a href="#cb132-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> fib<span class="op">(</span><span class="dv">10</span><span class="op">);</span></span>
<span id="cb132-15"><a href="#cb132-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.3.27" id="somme-récursive"><span class="header-section-number">2.3.27</span> Somme Récursive</h3>
<div class="sourceCode" id="cb133"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Somme Récursive - Solution</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> sum<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">&lt;=</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> n <span class="op">+</span> sum<span class="op">(</span>n <span class="op">-</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sum<span class="op">(</span><span class="dv">10</span><span class="op">);</span></span>
<span id="cb133-12"><a href="#cb133-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.3.28" id="pgcd-euclide"><span class="header-section-number">2.3.28</span> PGCD (Euclide)</h3>
<div class="sourceCode" id="cb134"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co">// PGCD (Euclide) - Solution</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> gcd<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>b <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> a<span class="op">;</span></span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> gcd<span class="op">(</span>b<span class="op">,</span> a <span class="op">%</span> b<span class="op">);</span></span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb134-9"><a href="#cb134-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-10"><a href="#cb134-10" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb134-11"><a href="#cb134-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> gcd<span class="op">(</span><span class="dv">48</span><span class="op">,</span> <span class="dv">18</span><span class="op">);</span></span>
<span id="cb134-12"><a href="#cb134-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.3.29" id="puissance"><span class="header-section-number">2.3.29</span> Puissance</h3>
<div class="sourceCode" id="cb135"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Puissance - Solution</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> power<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">%</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> power<span class="op">(</span>x <span class="op">*</span> x<span class="op">,</span> n <span class="op">/</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x <span class="op">*</span> power<span class="op">(</span>x<span class="op">,</span> n <span class="op">-</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb135-11"><a href="#cb135-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb135-12"><a href="#cb135-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-13"><a href="#cb135-13" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb135-14"><a href="#cb135-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> power<span class="op">(</span><span class="dv">2</span><span class="op">,</span> <span class="dv">10</span><span class="op">);</span></span>
<span id="cb135-15"><a href="#cb135-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.3.30" id="test-primalité"><span class="header-section-number">2.3.30</span> Test Primalité</h3>
<div class="sourceCode" id="cb136"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Test Primalité - Solution</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> is_prime<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">&lt;</span> <span class="dv">2</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> i <span class="op">*</span> i <span class="op">&lt;=</span> n<span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>n <span class="op">%</span> i <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb136-9"><a href="#cb136-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb136-10"><a href="#cb136-10" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb136-11"><a href="#cb136-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb136-12"><a href="#cb136-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb136-13"><a href="#cb136-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb136-14"><a href="#cb136-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-15"><a href="#cb136-15" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb136-16"><a href="#cb136-16" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> count <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb136-17"><a href="#cb136-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> n <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> n <span class="op">&lt;=</span> <span class="dv">20</span><span class="op">;</span> n <span class="op">=</span> n <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb136-18"><a href="#cb136-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>is_prime<span class="op">(</span>n<span class="op">))</span> <span class="op">{</span></span>
<span id="cb136-19"><a href="#cb136-19" aria-hidden="true" tabindex="-1"></a>            count <span class="op">=</span> count <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb136-20"><a href="#cb136-20" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb136-21"><a href="#cb136-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb136-22"><a href="#cb136-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> count<span class="op">;</span></span>
<span id="cb136-23"><a href="#cb136-23" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.3.31" id="tri-à-bulles"><span class="header-section-number">2.3.31</span> Tri à Bulles</h3>
<div class="sourceCode" id="cb137"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Tri à Bulles - Solution</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> arr<span class="op">[</span><span class="dv">5</span><span class="op">];</span></span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>    arr<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">64</span><span class="op">;</span></span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a>    arr<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="dv">34</span><span class="op">;</span></span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a>    arr<span class="op">[</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> <span class="dv">25</span><span class="op">;</span></span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a>    arr<span class="op">[</span><span class="dv">3</span><span class="op">]</span> <span class="op">=</span> <span class="dv">12</span><span class="op">;</span></span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a>    arr<span class="op">[</span><span class="dv">4</span><span class="op">]</span> <span class="op">=</span> <span class="dv">22</span><span class="op">;</span></span>
<span id="cb137-10"><a href="#cb137-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-11"><a href="#cb137-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">5</span><span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb137-12"><a href="#cb137-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> <span class="dv">4</span> <span class="op">-</span> i<span class="op">;</span> j <span class="op">=</span> j <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb137-13"><a href="#cb137-13" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>arr<span class="op">[</span>j<span class="op">]</span> <span class="op">&gt;</span> arr<span class="op">[</span>j <span class="op">+</span> <span class="dv">1</span><span class="op">])</span> <span class="op">{</span></span>
<span id="cb137-14"><a href="#cb137-14" aria-hidden="true" tabindex="-1"></a>                <span class="dt">int</span> temp <span class="op">=</span> arr<span class="op">[</span>j<span class="op">];</span></span>
<span id="cb137-15"><a href="#cb137-15" aria-hidden="true" tabindex="-1"></a>                arr<span class="op">[</span>j<span class="op">]</span> <span class="op">=</span> arr<span class="op">[</span>j <span class="op">+</span> <span class="dv">1</span><span class="op">];</span></span>
<span id="cb137-16"><a href="#cb137-16" aria-hidden="true" tabindex="-1"></a>                arr<span class="op">[</span>j <span class="op">+</span> <span class="dv">1</span><span class="op">]</span> <span class="op">=</span> temp<span class="op">;</span></span>
<span id="cb137-17"><a href="#cb137-17" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb137-18"><a href="#cb137-18" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb137-19"><a href="#cb137-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb137-20"><a href="#cb137-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-21"><a href="#cb137-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> arr<span class="op">[</span><span class="dv">0</span><span class="op">];</span></span>
<span id="cb137-22"><a href="#cb137-22" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.3.32" id="recherche-binaire"><span class="header-section-number">2.3.32</span> Recherche Binaire</h3>
<div class="sourceCode" id="cb138"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Recherche Binaire - Solution</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> binary_search<span class="op">(</span><span class="dt">int</span> <span class="op">*</span>arr<span class="op">,</span> <span class="dt">int</span> size<span class="op">,</span> <span class="dt">int</span> target<span class="op">)</span> <span class="op">{</span></span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> left <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> right <span class="op">=</span> size <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>left <span class="op">&lt;=</span> right<span class="op">)</span> <span class="op">{</span></span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> mid <span class="op">=</span> <span class="op">(</span>left <span class="op">+</span> right<span class="op">)</span> <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb138-9"><a href="#cb138-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>arr<span class="op">[</span>mid<span class="op">]</span> <span class="op">==</span> target<span class="op">)</span> <span class="op">{</span></span>
<span id="cb138-10"><a href="#cb138-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> mid<span class="op">;</span></span>
<span id="cb138-11"><a href="#cb138-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb138-12"><a href="#cb138-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>arr<span class="op">[</span>mid<span class="op">]</span> <span class="op">&lt;</span> target<span class="op">)</span> <span class="op">{</span></span>
<span id="cb138-13"><a href="#cb138-13" aria-hidden="true" tabindex="-1"></a>            left <span class="op">=</span> mid <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb138-14"><a href="#cb138-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb138-15"><a href="#cb138-15" aria-hidden="true" tabindex="-1"></a>            right <span class="op">=</span> mid <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb138-16"><a href="#cb138-16" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb138-17"><a href="#cb138-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb138-18"><a href="#cb138-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-19"><a href="#cb138-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb138-20"><a href="#cb138-20" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb138-21"><a href="#cb138-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-22"><a href="#cb138-22" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb138-23"><a href="#cb138-23" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> arr<span class="op">[</span><span class="dv">10</span><span class="op">];</span></span>
<span id="cb138-24"><a href="#cb138-24" aria-hidden="true" tabindex="-1"></a>    arr<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb138-25"><a href="#cb138-25" aria-hidden="true" tabindex="-1"></a>    arr<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="dv">5</span><span class="op">;</span></span>
<span id="cb138-26"><a href="#cb138-26" aria-hidden="true" tabindex="-1"></a>    arr<span class="op">[</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> <span class="dv">8</span><span class="op">;</span></span>
<span id="cb138-27"><a href="#cb138-27" aria-hidden="true" tabindex="-1"></a>    arr<span class="op">[</span><span class="dv">3</span><span class="op">]</span> <span class="op">=</span> <span class="dv">12</span><span class="op">;</span></span>
<span id="cb138-28"><a href="#cb138-28" aria-hidden="true" tabindex="-1"></a>    arr<span class="op">[</span><span class="dv">4</span><span class="op">]</span> <span class="op">=</span> <span class="dv">16</span><span class="op">;</span></span>
<span id="cb138-29"><a href="#cb138-29" aria-hidden="true" tabindex="-1"></a>    arr<span class="op">[</span><span class="dv">5</span><span class="op">]</span> <span class="op">=</span> <span class="dv">23</span><span class="op">;</span></span>
<span id="cb138-30"><a href="#cb138-30" aria-hidden="true" tabindex="-1"></a>    arr<span class="op">[</span><span class="dv">6</span><span class="op">]</span> <span class="op">=</span> <span class="dv">38</span><span class="op">;</span></span>
<span id="cb138-31"><a href="#cb138-31" aria-hidden="true" tabindex="-1"></a>    arr<span class="op">[</span><span class="dv">7</span><span class="op">]</span> <span class="op">=</span> <span class="dv">56</span><span class="op">;</span></span>
<span id="cb138-32"><a href="#cb138-32" aria-hidden="true" tabindex="-1"></a>    arr<span class="op">[</span><span class="dv">8</span><span class="op">]</span> <span class="op">=</span> <span class="dv">72</span><span class="op">;</span></span>
<span id="cb138-33"><a href="#cb138-33" aria-hidden="true" tabindex="-1"></a>    arr<span class="op">[</span><span class="dv">9</span><span class="op">]</span> <span class="op">=</span> <span class="dv">91</span><span class="op">;</span></span>
<span id="cb138-34"><a href="#cb138-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-35"><a href="#cb138-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> binary_search<span class="op">(</span>arr<span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">23</span><span class="op">);</span></span>
<span id="cb138-36"><a href="#cb138-36" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.3.33" id="inverser-tableau"><span class="header-section-number">2.3.33</span> Inverser Tableau</h3>
<div class="sourceCode" id="cb139"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Inverser Tableau - Solution</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> arr<span class="op">[</span><span class="dv">5</span><span class="op">];</span></span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>    arr<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a>    arr<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a>    arr<span class="op">[</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a>    arr<span class="op">[</span><span class="dv">3</span><span class="op">]</span> <span class="op">=</span> <span class="dv">4</span><span class="op">;</span></span>
<span id="cb139-9"><a href="#cb139-9" aria-hidden="true" tabindex="-1"></a>    arr<span class="op">[</span><span class="dv">4</span><span class="op">]</span> <span class="op">=</span> <span class="dv">5</span><span class="op">;</span></span>
<span id="cb139-10"><a href="#cb139-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-11"><a href="#cb139-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> left <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb139-12"><a href="#cb139-12" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> right <span class="op">=</span> <span class="dv">4</span><span class="op">;</span></span>
<span id="cb139-13"><a href="#cb139-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>left <span class="op">&lt;</span> right<span class="op">)</span> <span class="op">{</span></span>
<span id="cb139-14"><a href="#cb139-14" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> temp <span class="op">=</span> arr<span class="op">[</span>left<span class="op">];</span></span>
<span id="cb139-15"><a href="#cb139-15" aria-hidden="true" tabindex="-1"></a>        arr<span class="op">[</span>left<span class="op">]</span> <span class="op">=</span> arr<span class="op">[</span>right<span class="op">];</span></span>
<span id="cb139-16"><a href="#cb139-16" aria-hidden="true" tabindex="-1"></a>        arr<span class="op">[</span>right<span class="op">]</span> <span class="op">=</span> temp<span class="op">;</span></span>
<span id="cb139-17"><a href="#cb139-17" aria-hidden="true" tabindex="-1"></a>        left <span class="op">=</span> left <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb139-18"><a href="#cb139-18" aria-hidden="true" tabindex="-1"></a>        right <span class="op">=</span> right <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb139-19"><a href="#cb139-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb139-20"><a href="#cb139-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-21"><a href="#cb139-21" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> sum <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb139-22"><a href="#cb139-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">5</span><span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb139-23"><a href="#cb139-23" aria-hidden="true" tabindex="-1"></a>        sum <span class="op">=</span> sum <span class="op">+</span> arr<span class="op">[</span>i<span class="op">]</span> <span class="op">*</span> <span class="op">(</span>i <span class="op">+</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb139-24"><a href="#cb139-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb139-25"><a href="#cb139-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sum<span class="op">;</span></span>
<span id="cb139-26"><a href="#cb139-26" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.3.34" id="somme-des-chiffres"><span class="header-section-number">2.3.34</span> Somme des Chiffres</h3>
<div class="sourceCode" id="cb140"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Somme des Chiffres - Solution</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> digit_sum<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> sum <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>n <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a>        sum <span class="op">=</span> sum <span class="op">+</span> <span class="op">(</span>n <span class="op">%</span> <span class="dv">10</span><span class="op">);</span></span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a>        n <span class="op">=</span> n <span class="op">/</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb140-9"><a href="#cb140-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sum<span class="op">;</span></span>
<span id="cb140-10"><a href="#cb140-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb140-11"><a href="#cb140-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-12"><a href="#cb140-12" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb140-13"><a href="#cb140-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> digit_sum<span class="op">(</span><span class="dv">12345</span><span class="op">);</span></span>
<span id="cb140-14"><a href="#cb140-14" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.3.35" id="nombre-palindrome"><span class="header-section-number">2.3.35</span> Nombre Palindrome</h3>
<div class="sourceCode" id="cb141"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Nombre Palindrome - Solution</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> is_palindrome<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> original <span class="op">=</span> n<span class="op">;</span></span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> reversed <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>n <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a>        reversed <span class="op">=</span> reversed <span class="op">*</span> <span class="dv">10</span> <span class="op">+</span> <span class="op">(</span>n <span class="op">%</span> <span class="dv">10</span><span class="op">);</span></span>
<span id="cb141-9"><a href="#cb141-9" aria-hidden="true" tabindex="-1"></a>        n <span class="op">=</span> n <span class="op">/</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="cb141-10"><a href="#cb141-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb141-11"><a href="#cb141-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-12"><a href="#cb141-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>reversed <span class="op">==</span> original<span class="op">)</span> <span class="op">{</span></span>
<span id="cb141-13"><a href="#cb141-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb141-14"><a href="#cb141-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb141-15"><a href="#cb141-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb141-16"><a href="#cb141-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb141-17"><a href="#cb141-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-18"><a href="#cb141-18" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb141-19"><a href="#cb141-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> is_palindrome<span class="op">(</span><span class="dv">12321</span><span class="op">)</span> <span class="op">+</span> is_palindrome<span class="op">(</span><span class="dv">1221</span><span class="op">)</span> <span class="op">+</span> is_palindrome<span class="op">(</span><span class="dv">123</span><span class="op">);</span></span>
<span id="cb141-20"><a href="#cb141-20" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.3.36" id="définition-struct"><span class="header-section-number">2.3.36</span> Définition Struct</h3>
<div class="sourceCode" id="cb142"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Définition Struct - Solution</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> Point <span class="op">{</span> <span class="dt">int</span> x<span class="op">;</span> <span class="dt">int</span> y<span class="op">;</span> <span class="op">};</span></span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> Point p<span class="op">;</span></span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a>    p<span class="op">.</span>x <span class="op">=</span> <span class="dv">17</span><span class="op">;</span></span>
<span id="cb142-8"><a href="#cb142-8" aria-hidden="true" tabindex="-1"></a>    p<span class="op">.</span>y <span class="op">=</span> <span class="dv">25</span><span class="op">;</span></span>
<span id="cb142-9"><a href="#cb142-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> p<span class="op">.</span>x <span class="op">+</span> p<span class="op">.</span>y<span class="op">;</span></span>
<span id="cb142-10"><a href="#cb142-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.3.37" id="pointeur-struct"><span class="header-section-number">2.3.37</span> Pointeur Struct</h3>
<div class="sourceCode" id="cb143"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Pointeur Struct - Solution</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> Point <span class="op">{</span> <span class="dt">int</span> x<span class="op">;</span> <span class="dt">int</span> y<span class="op">;</span> <span class="op">};</span></span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> Point p<span class="op">;</span></span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>    p<span class="op">.</span>x <span class="op">=</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a>    p<span class="op">.</span>y <span class="op">=</span> <span class="dv">32</span><span class="op">;</span></span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> Point <span class="op">*</span>ptr <span class="op">=</span> <span class="op">&amp;</span>p<span class="op">;</span></span>
<span id="cb143-11"><a href="#cb143-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ptr<span class="op">-&gt;</span>x <span class="op">+</span> ptr<span class="op">-&gt;</span>y<span class="op">;</span></span>
<span id="cb143-12"><a href="#cb143-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.3.38" id="struct-et-fonctions"><span class="header-section-number">2.3.38</span> Struct et Fonctions</h3>
<div class="sourceCode" id="cb144"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Struct et Fonctions - Solution</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> Point <span class="op">{</span> <span class="dt">int</span> x<span class="op">;</span> <span class="dt">int</span> y<span class="op">;</span> <span class="op">};</span></span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> distance_sq<span class="op">(</span><span class="kw">struct</span> Point <span class="op">*</span>p<span class="op">)</span> <span class="op">{</span></span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> p<span class="op">-&gt;</span>x <span class="op">*</span> p<span class="op">-&gt;</span>x <span class="op">+</span> p<span class="op">-&gt;</span>y <span class="op">*</span> p<span class="op">-&gt;</span>y<span class="op">;</span></span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb144-8"><a href="#cb144-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-9"><a href="#cb144-9" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb144-10"><a href="#cb144-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> Point p<span class="op">;</span></span>
<span id="cb144-11"><a href="#cb144-11" aria-hidden="true" tabindex="-1"></a>    p<span class="op">.</span>x <span class="op">=</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb144-12"><a href="#cb144-12" aria-hidden="true" tabindex="-1"></a>    p<span class="op">.</span>y <span class="op">=</span> <span class="dv">4</span><span class="op">;</span></span>
<span id="cb144-13"><a href="#cb144-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> distance_sq<span class="op">(&amp;</span>p<span class="op">);</span></span>
<span id="cb144-14"><a href="#cb144-14" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.3.39" id="structs-imbriquées"><span class="header-section-number">2.3.39</span> Structs Imbriquées</h3>
<div class="sourceCode" id="cb145"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Structs Imbriquées - Solution</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> Point <span class="op">{</span> <span class="dt">int</span> x<span class="op">;</span> <span class="dt">int</span> y<span class="op">;</span> <span class="op">};</span></span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> Rectangle <span class="op">{</span> <span class="kw">struct</span> Point corner<span class="op">;</span> <span class="dt">int</span> width<span class="op">;</span> <span class="dt">int</span> height<span class="op">;</span> <span class="op">};</span></span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> Rectangle r<span class="op">;</span></span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a>    r<span class="op">.</span>corner<span class="op">.</span>x <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a>    r<span class="op">.</span>corner<span class="op">.</span>y <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb145-10"><a href="#cb145-10" aria-hidden="true" tabindex="-1"></a>    r<span class="op">.</span>width <span class="op">=</span> <span class="dv">6</span><span class="op">;</span></span>
<span id="cb145-11"><a href="#cb145-11" aria-hidden="true" tabindex="-1"></a>    r<span class="op">.</span>height <span class="op">=</span> <span class="dv">7</span><span class="op">;</span></span>
<span id="cb145-12"><a href="#cb145-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-13"><a href="#cb145-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> r<span class="op">.</span>width <span class="op">*</span> r<span class="op">.</span>height<span class="op">;</span></span>
<span id="cb145-14"><a href="#cb145-14" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.3.40" id="tableau-de-structs"><span class="header-section-number">2.3.40</span> Tableau de Structs</h3>
<div class="sourceCode" id="cb146"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Tableau de Structs - Solution</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> Point <span class="op">{</span> <span class="dt">int</span> x<span class="op">;</span> <span class="dt">int</span> y<span class="op">;</span> <span class="op">};</span></span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> Point points<span class="op">[</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a>    points<span class="op">[</span><span class="dv">0</span><span class="op">].</span>x <span class="op">=</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="cb146-9"><a href="#cb146-9" aria-hidden="true" tabindex="-1"></a>    points<span class="op">[</span><span class="dv">0</span><span class="op">].</span>y <span class="op">=</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb146-10"><a href="#cb146-10" aria-hidden="true" tabindex="-1"></a>    points<span class="op">[</span><span class="dv">1</span><span class="op">].</span>x <span class="op">=</span> <span class="dv">15</span><span class="op">;</span></span>
<span id="cb146-11"><a href="#cb146-11" aria-hidden="true" tabindex="-1"></a>    points<span class="op">[</span><span class="dv">1</span><span class="op">].</span>y <span class="op">=</span> <span class="dv">5</span><span class="op">;</span></span>
<span id="cb146-12"><a href="#cb146-12" aria-hidden="true" tabindex="-1"></a>    points<span class="op">[</span><span class="dv">2</span><span class="op">].</span>x <span class="op">=</span> <span class="dv">8</span><span class="op">;</span></span>
<span id="cb146-13"><a href="#cb146-13" aria-hidden="true" tabindex="-1"></a>    points<span class="op">[</span><span class="dv">2</span><span class="op">].</span>y <span class="op">=</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb146-14"><a href="#cb146-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-15"><a href="#cb146-15" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> sum <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb146-16"><a href="#cb146-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">3</span><span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb146-17"><a href="#cb146-17" aria-hidden="true" tabindex="-1"></a>        sum <span class="op">=</span> sum <span class="op">+</span> points<span class="op">[</span>i<span class="op">].</span>x<span class="op">;</span></span>
<span id="cb146-18"><a href="#cb146-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb146-19"><a href="#cb146-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sum<span class="op">;</span></span>
<span id="cb146-20"><a href="#cb146-20" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.3.41" id="sizeof-struct"><span class="header-section-number">2.3.41</span> Sizeof Struct</h3>
<div class="sourceCode" id="cb147"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Sizeof Struct - Solution</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> S1 <span class="op">{</span> <span class="dt">int</span> a<span class="op">;</span> <span class="op">};</span></span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> S2 <span class="op">{</span> <span class="dt">int</span> x<span class="op">;</span> <span class="dt">int</span> y<span class="op">;</span> <span class="dt">char</span> c<span class="op">;</span> <span class="op">};</span></span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">sizeof</span><span class="op">(</span><span class="kw">struct</span> S1<span class="op">)</span> <span class="op">+</span> <span class="kw">sizeof</span><span class="op">(</span><span class="kw">struct</span> S2<span class="op">);</span></span>
<span id="cb147-8"><a href="#cb147-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.3.42" id="parcours-en-ligne"><span class="header-section-number">2.3.42</span> Parcours en Ligne</h3>
<div class="sourceCode" id="cb148"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Parcours en Ligne - Solution</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="co">// Utilise un tableau 1D avec indexation manuelle: arr[i * 4 + j]</span></span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> arr<span class="op">[</span><span class="dv">16</span><span class="op">];</span></span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i<span class="op">;</span></span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> j<span class="op">;</span></span>
<span id="cb148-9"><a href="#cb148-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> sum<span class="op">;</span></span>
<span id="cb148-10"><a href="#cb148-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-11"><a href="#cb148-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Initialiser (parcours en ligne: cache-friendly)</span></span>
<span id="cb148-12"><a href="#cb148-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Accès: 0, 1, 2, 3, 4, 5, 6, 7... (séquentiel)</span></span>
<span id="cb148-13"><a href="#cb148-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">4</span><span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb148-14"><a href="#cb148-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span>j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> <span class="dv">4</span><span class="op">;</span> j <span class="op">=</span> j <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb148-15"><a href="#cb148-15" aria-hidden="true" tabindex="-1"></a>            arr<span class="op">[</span>i <span class="op">*</span> <span class="dv">4</span> <span class="op">+</span> j<span class="op">]</span> <span class="op">=</span> i <span class="op">*</span> <span class="dv">4</span> <span class="op">+</span> j<span class="op">;</span></span>
<span id="cb148-16"><a href="#cb148-16" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb148-17"><a href="#cb148-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb148-18"><a href="#cb148-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-19"><a href="#cb148-19" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Calculer la somme (accès séquentiel = cache-friendly)</span></span>
<span id="cb148-20"><a href="#cb148-20" aria-hidden="true" tabindex="-1"></a>    sum <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb148-21"><a href="#cb148-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">4</span><span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb148-22"><a href="#cb148-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span>j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> <span class="dv">4</span><span class="op">;</span> j <span class="op">=</span> j <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb148-23"><a href="#cb148-23" aria-hidden="true" tabindex="-1"></a>            sum <span class="op">=</span> sum <span class="op">+</span> arr<span class="op">[</span>i <span class="op">*</span> <span class="dv">4</span> <span class="op">+</span> j<span class="op">];</span></span>
<span id="cb148-24"><a href="#cb148-24" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb148-25"><a href="#cb148-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb148-26"><a href="#cb148-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-27"><a href="#cb148-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sum<span class="op">;</span></span>
<span id="cb148-28"><a href="#cb148-28" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><strong>Explication:</strong> Le parcours row-major (i puis j) génère
des accès séquentiels en mémoire (indices 0, 1, 2, 3, 4…). C’est optimal
pour le cache car une ligne de cache chargée est entièrement utilisée
avant de passer à la suivante.</p>
<hr />
<h3 data-number="2.3.43" id="parcours-en-colonne"><span class="header-section-number">2.3.43</span> Parcours en Colonne</h3>
<div class="sourceCode" id="cb149"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Parcours en Colonne - Solution</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a><span class="co">// Même calcul, mais accès non-séquentiels (cache-unfriendly)</span></span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> arr<span class="op">[</span><span class="dv">16</span><span class="op">];</span></span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i<span class="op">;</span></span>
<span id="cb149-8"><a href="#cb149-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> j<span class="op">;</span></span>
<span id="cb149-9"><a href="#cb149-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> sum<span class="op">;</span></span>
<span id="cb149-10"><a href="#cb149-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-11"><a href="#cb149-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Initialiser (row-major comme d&#39;habitude)</span></span>
<span id="cb149-12"><a href="#cb149-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">4</span><span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb149-13"><a href="#cb149-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span>j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> <span class="dv">4</span><span class="op">;</span> j <span class="op">=</span> j <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb149-14"><a href="#cb149-14" aria-hidden="true" tabindex="-1"></a>            arr<span class="op">[</span>i <span class="op">*</span> <span class="dv">4</span> <span class="op">+</span> j<span class="op">]</span> <span class="op">=</span> i <span class="op">*</span> <span class="dv">4</span> <span class="op">+</span> j<span class="op">;</span></span>
<span id="cb149-15"><a href="#cb149-15" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb149-16"><a href="#cb149-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb149-17"><a href="#cb149-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-18"><a href="#cb149-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Somme en colonne: j d&#39;abord, puis i</span></span>
<span id="cb149-19"><a href="#cb149-19" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Accès: 0, 4, 8, 12, 1, 5, 9, 13... (sauts de 4!)</span></span>
<span id="cb149-20"><a href="#cb149-20" aria-hidden="true" tabindex="-1"></a>    sum <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb149-21"><a href="#cb149-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> <span class="dv">4</span><span class="op">;</span> j <span class="op">=</span> j <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb149-22"><a href="#cb149-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span>i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">4</span><span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb149-23"><a href="#cb149-23" aria-hidden="true" tabindex="-1"></a>            sum <span class="op">=</span> sum <span class="op">+</span> arr<span class="op">[</span>i <span class="op">*</span> <span class="dv">4</span> <span class="op">+</span> j<span class="op">];</span></span>
<span id="cb149-24"><a href="#cb149-24" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb149-25"><a href="#cb149-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb149-26"><a href="#cb149-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-27"><a href="#cb149-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sum<span class="op">;</span></span>
<span id="cb149-28"><a href="#cb149-28" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><strong>Explication:</strong> Le parcours column-major (j puis i)
génère des accès avec des sauts de 4 positions (indices 0, 4, 8, 12,
puis 1, 5, 9, 13…). Chaque accès peut charger une nouvelle ligne de
cache, gaspillant les données déjà chargées.</p>
<hr />
<h3 data-number="2.3.44" id="traitement-par-blocs"><span class="header-section-number">2.3.44</span> Traitement par Blocs</h3>
<div class="sourceCode" id="cb150"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Traitement par Blocs - Solution</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a><span class="co">// Technique de blocking pour améliorer la localité</span></span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> arr<span class="op">[</span><span class="dv">16</span><span class="op">];</span></span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i<span class="op">;</span></span>
<span id="cb150-8"><a href="#cb150-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> j<span class="op">;</span></span>
<span id="cb150-9"><a href="#cb150-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> bi<span class="op">;</span></span>
<span id="cb150-10"><a href="#cb150-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> bj<span class="op">;</span></span>
<span id="cb150-11"><a href="#cb150-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> sum<span class="op">;</span></span>
<span id="cb150-12"><a href="#cb150-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-13"><a href="#cb150-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Initialiser</span></span>
<span id="cb150-14"><a href="#cb150-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">4</span><span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb150-15"><a href="#cb150-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span>j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> <span class="dv">4</span><span class="op">;</span> j <span class="op">=</span> j <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb150-16"><a href="#cb150-16" aria-hidden="true" tabindex="-1"></a>            arr<span class="op">[</span>i <span class="op">*</span> <span class="dv">4</span> <span class="op">+</span> j<span class="op">]</span> <span class="op">=</span> i <span class="op">*</span> <span class="dv">4</span> <span class="op">+</span> j<span class="op">;</span></span>
<span id="cb150-17"><a href="#cb150-17" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb150-18"><a href="#cb150-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb150-19"><a href="#cb150-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-20"><a href="#cb150-20" aria-hidden="true" tabindex="-1"></a>    sum <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb150-21"><a href="#cb150-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-22"><a href="#cb150-22" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Parcours par blocs 2x2</span></span>
<span id="cb150-23"><a href="#cb150-23" aria-hidden="true" tabindex="-1"></a>    <span class="co">// On traite entièrement chaque bloc avant de passer au suivant</span></span>
<span id="cb150-24"><a href="#cb150-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>bi <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> bi <span class="op">&lt;</span> <span class="dv">4</span><span class="op">;</span> bi <span class="op">=</span> bi <span class="op">+</span> <span class="dv">2</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb150-25"><a href="#cb150-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span>bj <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> bj <span class="op">&lt;</span> <span class="dv">4</span><span class="op">;</span> bj <span class="op">=</span> bj <span class="op">+</span> <span class="dv">2</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb150-26"><a href="#cb150-26" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span>i <span class="op">=</span> bi<span class="op">;</span> i <span class="op">&lt;</span> bi <span class="op">+</span> <span class="dv">2</span><span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb150-27"><a href="#cb150-27" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> <span class="op">(</span>j <span class="op">=</span> bj<span class="op">;</span> j <span class="op">&lt;</span> bj <span class="op">+</span> <span class="dv">2</span><span class="op">;</span> j <span class="op">=</span> j <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb150-28"><a href="#cb150-28" aria-hidden="true" tabindex="-1"></a>                    sum <span class="op">=</span> sum <span class="op">+</span> arr<span class="op">[</span>i <span class="op">*</span> <span class="dv">4</span> <span class="op">+</span> j<span class="op">];</span></span>
<span id="cb150-29"><a href="#cb150-29" aria-hidden="true" tabindex="-1"></a>                <span class="op">}</span></span>
<span id="cb150-30"><a href="#cb150-30" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb150-31"><a href="#cb150-31" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb150-32"><a href="#cb150-32" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb150-33"><a href="#cb150-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-34"><a href="#cb150-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sum<span class="op">;</span></span>
<span id="cb150-35"><a href="#cb150-35" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><strong>Explication:</strong> Le blocking divise la matrice en petits
blocs (2x2 ici) qui tiennent dans le cache. On traite chaque bloc
entièrement avant de passer au suivant, maximisant la réutilisation des
données chargées.</p>
<hr />
<h3 data-number="2.3.45" id="localité-temporelle"><span class="header-section-number">2.3.45</span> Localité Temporelle</h3>
<div class="sourceCode" id="cb151"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Localité Temporelle - Solution</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a><span class="co">// Réutiliser les données pendant qu&#39;elles sont en cache</span></span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> arr<span class="op">[</span><span class="dv">4</span><span class="op">];</span></span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i<span class="op">;</span></span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> sum<span class="op">;</span></span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> factor<span class="op">;</span></span>
<span id="cb151-10"><a href="#cb151-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-11"><a href="#cb151-11" aria-hidden="true" tabindex="-1"></a>    arr<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb151-12"><a href="#cb151-12" aria-hidden="true" tabindex="-1"></a>    arr<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb151-13"><a href="#cb151-13" aria-hidden="true" tabindex="-1"></a>    arr<span class="op">[</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb151-14"><a href="#cb151-14" aria-hidden="true" tabindex="-1"></a>    arr<span class="op">[</span><span class="dv">3</span><span class="op">]</span> <span class="op">=</span> <span class="dv">4</span><span class="op">;</span></span>
<span id="cb151-15"><a href="#cb151-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-16"><a href="#cb151-16" aria-hidden="true" tabindex="-1"></a>    sum <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb151-17"><a href="#cb151-17" aria-hidden="true" tabindex="-1"></a>    factor <span class="op">=</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb151-18"><a href="#cb151-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-19"><a href="#cb151-19" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Un seul parcours: chaque élément est lu une seule fois</span></span>
<span id="cb151-20"><a href="#cb151-20" aria-hidden="true" tabindex="-1"></a>    <span class="co">// et utilisé immédiatement (bonne localité temporelle)</span></span>
<span id="cb151-21"><a href="#cb151-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">4</span><span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb151-22"><a href="#cb151-22" aria-hidden="true" tabindex="-1"></a>        sum <span class="op">=</span> sum <span class="op">+</span> arr<span class="op">[</span>i<span class="op">]</span> <span class="op">*</span> factor<span class="op">;</span></span>
<span id="cb151-23"><a href="#cb151-23" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb151-24"><a href="#cb151-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-25"><a href="#cb151-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sum<span class="op">;</span></span>
<span id="cb151-26"><a href="#cb151-26" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><strong>Explication:</strong> La localité temporelle consiste à
réutiliser rapidement les données récemment accédées. Ici, on lit chaque
élément une seule fois et on effectue tout le calcul immédiatement,
plutôt que de faire plusieurs passes sur le tableau.</p>
<hr />
<h3 data-number="2.3.46" id="écrire-un-caractère"><span class="header-section-number">2.3.46</span> Écrire un Caractère</h3>
<div class="sourceCode" id="cb152"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Écrire un Caractère - Solution</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> putchar<span class="op">(</span><span class="dt">int</span> c<span class="op">)</span> <span class="op">{</span></span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> <span class="op">*</span>port <span class="op">=</span> <span class="op">(</span><span class="dt">int</span><span class="op">*)</span><span class="bn">0xFFFF0000</span><span class="op">;</span></span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span>port <span class="op">=</span> c<span class="op">;</span></span>
<span id="cb152-6"><a href="#cb152-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb152-7"><a href="#cb152-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-8"><a href="#cb152-8" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb152-9"><a href="#cb152-9" aria-hidden="true" tabindex="-1"></a>    putchar<span class="op">(</span><span class="dv">65</span><span class="op">);</span>  <span class="co">// Affiche &#39;A&#39;</span></span>
<span id="cb152-10"><a href="#cb152-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">65</span><span class="op">;</span></span>
<span id="cb152-11"><a href="#cb152-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.3.47" id="afficher-une-chaîne"><span class="header-section-number">2.3.47</span> Afficher une Chaîne</h3>
<div class="sourceCode" id="cb153"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Afficher une Chaîne - Solution</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> putchar<span class="op">(</span><span class="dt">int</span> c<span class="op">)</span> <span class="op">{</span></span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> <span class="op">*</span>port <span class="op">=</span> <span class="op">(</span><span class="dt">int</span><span class="op">*)</span><span class="bn">0xFFFF0000</span><span class="op">;</span></span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span>port <span class="op">=</span> c<span class="op">;</span></span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-8"><a href="#cb153-8" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> print<span class="op">(</span><span class="dt">char</span> <span class="op">*</span>s<span class="op">)</span> <span class="op">{</span></span>
<span id="cb153-9"><a href="#cb153-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> count <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb153-10"><a href="#cb153-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(*</span>s<span class="op">)</span> <span class="op">{</span></span>
<span id="cb153-11"><a href="#cb153-11" aria-hidden="true" tabindex="-1"></a>        putchar<span class="op">(*</span>s<span class="op">);</span></span>
<span id="cb153-12"><a href="#cb153-12" aria-hidden="true" tabindex="-1"></a>        s <span class="op">=</span> s <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb153-13"><a href="#cb153-13" aria-hidden="true" tabindex="-1"></a>        count <span class="op">=</span> count <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb153-14"><a href="#cb153-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb153-15"><a href="#cb153-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> count<span class="op">;</span></span>
<span id="cb153-16"><a href="#cb153-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb153-17"><a href="#cb153-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-18"><a href="#cb153-18" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb153-19"><a href="#cb153-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> print<span class="op">(</span><span class="st">&quot;HI&quot;</span><span class="op">);</span></span>
<span id="cb153-20"><a href="#cb153-20" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.3.48" id="afficher-un-nombre"><span class="header-section-number">2.3.48</span> Afficher un Nombre</h3>
<div class="sourceCode" id="cb154"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Afficher un Nombre - Solution</span></span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> putchar<span class="op">(</span><span class="dt">int</span> c<span class="op">)</span> <span class="op">{</span></span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> <span class="op">*</span>port <span class="op">=</span> <span class="op">(</span><span class="dt">int</span><span class="op">*)</span><span class="bn">0xFFFF0000</span><span class="op">;</span></span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span>port <span class="op">=</span> c<span class="op">;</span></span>
<span id="cb154-6"><a href="#cb154-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb154-7"><a href="#cb154-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-8"><a href="#cb154-8" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> print_int<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb154-9"><a href="#cb154-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> buf<span class="op">[</span><span class="dv">12</span><span class="op">];</span></span>
<span id="cb154-10"><a href="#cb154-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb154-11"><a href="#cb154-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-12"><a href="#cb154-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb154-13"><a href="#cb154-13" aria-hidden="true" tabindex="-1"></a>        putchar<span class="op">(</span><span class="dv">48</span><span class="op">);</span></span>
<span id="cb154-14"><a href="#cb154-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span><span class="op">;</span></span>
<span id="cb154-15"><a href="#cb154-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb154-16"><a href="#cb154-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-17"><a href="#cb154-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>n <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb154-18"><a href="#cb154-18" aria-hidden="true" tabindex="-1"></a>        buf<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="dv">48</span> <span class="op">+</span> <span class="op">(</span>n <span class="op">%</span> <span class="dv">10</span><span class="op">);</span></span>
<span id="cb154-19"><a href="#cb154-19" aria-hidden="true" tabindex="-1"></a>        n <span class="op">=</span> n <span class="op">/</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="cb154-20"><a href="#cb154-20" aria-hidden="true" tabindex="-1"></a>        i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb154-21"><a href="#cb154-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb154-22"><a href="#cb154-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-23"><a href="#cb154-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>i <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb154-24"><a href="#cb154-24" aria-hidden="true" tabindex="-1"></a>        i <span class="op">=</span> i <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb154-25"><a href="#cb154-25" aria-hidden="true" tabindex="-1"></a>        putchar<span class="op">(</span>buf<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb154-26"><a href="#cb154-26" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb154-27"><a href="#cb154-27" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb154-28"><a href="#cb154-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-29"><a href="#cb154-29" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb154-30"><a href="#cb154-30" aria-hidden="true" tabindex="-1"></a>    print_int<span class="op">(</span><span class="dv">42</span><span class="op">);</span></span>
<span id="cb154-31"><a href="#cb154-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">42</span><span class="op">;</span></span>
<span id="cb154-32"><a href="#cb154-32" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.3.49" id="dessiner-un-pixel"><span class="header-section-number">2.3.49</span> Dessiner un Pixel</h3>
<div class="sourceCode" id="cb155"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Dessiner un Pixel - Solution</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> <span class="op">*</span>screen <span class="op">=</span> <span class="op">(</span><span class="dt">char</span><span class="op">*)</span><span class="bn">0x00400000</span><span class="op">;</span></span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span>screen <span class="op">=</span> <span class="bn">0x80</span><span class="op">;</span>  <span class="co">// 0b10000000 - allume le pixel 0</span></span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">128</span><span class="op">;</span></span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.3.50" id="ligne-horizontale-1"><span class="header-section-number">2.3.50</span> Ligne Horizontale</h3>
<div class="sourceCode" id="cb156"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Ligne Horizontale - Solution</span></span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> <span class="op">*</span>screen <span class="op">=</span> <span class="op">(</span><span class="dt">char</span><span class="op">*)</span><span class="bn">0x00400000</span><span class="op">;</span></span>
<span id="cb156-5"><a href="#cb156-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-6"><a href="#cb156-6" aria-hidden="true" tabindex="-1"></a>    screen<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="bn">0xFF</span><span class="op">;</span>  <span class="co">// 8 premiers pixels</span></span>
<span id="cb156-7"><a href="#cb156-7" aria-hidden="true" tabindex="-1"></a>    screen<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="bn">0xFF</span><span class="op">;</span>  <span class="co">// 8 pixels suivants</span></span>
<span id="cb156-8"><a href="#cb156-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-9"><a href="#cb156-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">16</span><span class="op">;</span></span>
<span id="cb156-10"><a href="#cb156-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.3.51" id="dessiner-un-rectangle"><span class="header-section-number">2.3.51</span> Dessiner un Rectangle</h3>
<div class="sourceCode" id="cb157"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Dessiner un Rectangle - Solution</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> <span class="op">*</span>screen <span class="op">=</span> <span class="op">(</span><span class="dt">char</span><span class="op">*)</span><span class="bn">0x00400000</span><span class="op">;</span></span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> y <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> y <span class="op">&lt;</span> <span class="dv">8</span><span class="op">;</span> y <span class="op">=</span> y <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true" tabindex="-1"></a>        screen<span class="op">[</span>y <span class="op">*</span> <span class="dv">40</span><span class="op">]</span> <span class="op">=</span> <span class="bn">0xFF</span><span class="op">;</span>  <span class="co">// 40 bytes par ligne</span></span>
<span id="cb157-8"><a href="#cb157-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb157-9"><a href="#cb157-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-10"><a href="#cb157-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">64</span><span class="op">;</span></span>
<span id="cb157-11"><a href="#cb157-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.3.52" id="crible-d"><span class="header-section-number">2.3.52</span> Crible d<br />
</h3>
<div class="sourceCode" id="cb158"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Crible d&#39;Ératosthène - Solution</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> is_prime<span class="op">[</span><span class="dv">51</span><span class="op">];</span></span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i<span class="op">;</span></span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> j<span class="op">;</span></span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> count<span class="op">;</span></span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-9"><a href="#cb158-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;=</span> <span class="dv">50</span><span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb158-10"><a href="#cb158-10" aria-hidden="true" tabindex="-1"></a>        is_prime<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb158-11"><a href="#cb158-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb158-12"><a href="#cb158-12" aria-hidden="true" tabindex="-1"></a>    is_prime<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb158-13"><a href="#cb158-13" aria-hidden="true" tabindex="-1"></a>    is_prime<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb158-14"><a href="#cb158-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-15"><a href="#cb158-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>i <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> i <span class="op">*</span> i <span class="op">&lt;=</span> <span class="dv">50</span><span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb158-16"><a href="#cb158-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>is_prime<span class="op">[</span>i<span class="op">])</span> <span class="op">{</span></span>
<span id="cb158-17"><a href="#cb158-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> <span class="op">(</span>j <span class="op">=</span> i <span class="op">*</span> i<span class="op">;</span> j <span class="op">&lt;=</span> <span class="dv">50</span><span class="op">;</span> j <span class="op">=</span> j <span class="op">+</span> i<span class="op">)</span> <span class="op">{</span></span>
<span id="cb158-18"><a href="#cb158-18" aria-hidden="true" tabindex="-1"></a>                is_prime<span class="op">[</span>j<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb158-19"><a href="#cb158-19" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb158-20"><a href="#cb158-20" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb158-21"><a href="#cb158-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb158-22"><a href="#cb158-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-23"><a href="#cb158-23" aria-hidden="true" tabindex="-1"></a>    count <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb158-24"><a href="#cb158-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>i <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> i <span class="op">&lt;=</span> <span class="dv">50</span><span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb158-25"><a href="#cb158-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>is_prime<span class="op">[</span>i<span class="op">])</span> <span class="op">{</span></span>
<span id="cb158-26"><a href="#cb158-26" aria-hidden="true" tabindex="-1"></a>            count <span class="op">=</span> count <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb158-27"><a href="#cb158-27" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb158-28"><a href="#cb158-28" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb158-29"><a href="#cb158-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> count<span class="op">;</span></span>
<span id="cb158-30"><a href="#cb158-30" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.3.53" id="suite-de-collatz"><span class="header-section-number">2.3.53</span> Suite de Collatz</h3>
<div class="sourceCode" id="cb159"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Suite de Collatz - Solution</span></span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> collatz_length<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> count<span class="op">;</span></span>
<span id="cb159-5"><a href="#cb159-5" aria-hidden="true" tabindex="-1"></a>    count <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb159-6"><a href="#cb159-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>n <span class="op">!=</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb159-7"><a href="#cb159-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>n <span class="op">%</span> <span class="dv">2</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb159-8"><a href="#cb159-8" aria-hidden="true" tabindex="-1"></a>            n <span class="op">=</span> n <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb159-9"><a href="#cb159-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb159-10"><a href="#cb159-10" aria-hidden="true" tabindex="-1"></a>            n <span class="op">=</span> <span class="dv">3</span> <span class="op">*</span> n <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb159-11"><a href="#cb159-11" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb159-12"><a href="#cb159-12" aria-hidden="true" tabindex="-1"></a>        count <span class="op">=</span> count <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb159-13"><a href="#cb159-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb159-14"><a href="#cb159-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> count<span class="op">;</span></span>
<span id="cb159-15"><a href="#cb159-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb159-16"><a href="#cb159-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb159-17"><a href="#cb159-17" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb159-18"><a href="#cb159-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> collatz_length<span class="op">(</span><span class="dv">27</span><span class="op">);</span>  <span class="co">// attendu: 112</span></span>
<span id="cb159-19"><a href="#cb159-19" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.3.54" id="projet-final"><span class="header-section-number">2.3.54</span> Projet Final</h3>
<div class="sourceCode" id="cb160"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Projet Final - Solution</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> sum_divisors<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> sum <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;</span> n<span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb160-6"><a href="#cb160-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>n <span class="op">%</span> i <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb160-7"><a href="#cb160-7" aria-hidden="true" tabindex="-1"></a>            sum <span class="op">=</span> sum <span class="op">+</span> i<span class="op">;</span></span>
<span id="cb160-8"><a href="#cb160-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb160-9"><a href="#cb160-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb160-10"><a href="#cb160-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sum<span class="op">;</span></span>
<span id="cb160-11"><a href="#cb160-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb160-12"><a href="#cb160-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-13"><a href="#cb160-13" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb160-14"><a href="#cb160-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sum_divisors<span class="op">(</span><span class="dv">28</span><span class="op">);</span></span>
<span id="cb160-15"><a href="#cb160-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h2 data-number="2.4" id="d.-solutions-construction-du-compilateur"><span class="header-section-number">2.4</span> D. Solutions Construction du
Compilateur</h2>
<h3 data-number="2.4.1" id="reconnaître-un-chiffre"><span class="header-section-number">2.4.1</span> 1.1 Reconnaître un
Chiffre</h3>
<div class="sourceCode" id="cb161"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> is_digit<span class="op">(</span><span class="dt">char</span> c<span class="op">)</span> <span class="op">{</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> c <span class="op">&gt;=</span> <span class="ch">&#39;0&#39;</span> <span class="op">&amp;&amp;</span> c <span class="op">&lt;=</span> <span class="ch">&#39;9&#39;</span><span class="op">;</span></span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> score <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>is_digit<span class="op">(</span><span class="ch">&#39;0&#39;</span><span class="op">)</span> <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb161-8"><a href="#cb161-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>is_digit<span class="op">(</span><span class="ch">&#39;5&#39;</span><span class="op">)</span> <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb161-9"><a href="#cb161-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>is_digit<span class="op">(</span><span class="ch">&#39;9&#39;</span><span class="op">)</span> <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb161-10"><a href="#cb161-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>is_digit<span class="op">(</span><span class="ch">&#39;a&#39;</span><span class="op">)</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb161-11"><a href="#cb161-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>is_digit<span class="op">(</span><span class="ch">&#39; &#39;</span><span class="op">)</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb161-12"><a href="#cb161-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score<span class="op">;</span></span>
<span id="cb161-13"><a href="#cb161-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.4.2" id="lire-un-nombre"><span class="header-section-number">2.4.2</span> 1.2 Lire un Nombre</h3>
<div class="sourceCode" id="cb162"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> is_digit<span class="op">(</span><span class="dt">char</span> c<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> c <span class="op">&gt;=</span> <span class="ch">&#39;0&#39;</span> <span class="op">&amp;&amp;</span> c <span class="op">&lt;=</span> <span class="ch">&#39;9&#39;</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> parse_number<span class="op">(</span><span class="dt">char</span><span class="op">*</span> s<span class="op">,</span> <span class="dt">int</span><span class="op">*</span> pos<span class="op">)</span> <span class="op">{</span></span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> result <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>is_digit<span class="op">(</span>s<span class="op">[*</span>pos<span class="op">]))</span> <span class="op">{</span></span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a>        result <span class="op">=</span> result <span class="op">*</span> <span class="dv">10</span> <span class="op">+</span> <span class="op">(</span>s<span class="op">[*</span>pos<span class="op">]</span> <span class="op">-</span> <span class="ch">&#39;0&#39;</span><span class="op">);</span></span>
<span id="cb162-7"><a href="#cb162-7" aria-hidden="true" tabindex="-1"></a>        <span class="op">*</span>pos <span class="op">=</span> <span class="op">*</span>pos <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb162-8"><a href="#cb162-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb162-9"><a href="#cb162-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result<span class="op">;</span></span>
<span id="cb162-10"><a href="#cb162-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb162-11"><a href="#cb162-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-12"><a href="#cb162-12" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb162-13"><a href="#cb162-13" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> score <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb162-14"><a href="#cb162-14" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> p<span class="op">;</span></span>
<span id="cb162-15"><a href="#cb162-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-16"><a href="#cb162-16" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb162-17"><a href="#cb162-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>parse_number<span class="op">(</span><span class="st">&quot;42&quot;</span><span class="op">,</span> <span class="op">&amp;</span>p<span class="op">)</span> <span class="op">==</span> <span class="dv">42</span> <span class="op">&amp;&amp;</span> p <span class="op">==</span> <span class="dv">2</span><span class="op">)</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb162-18"><a href="#cb162-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-19"><a href="#cb162-19" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb162-20"><a href="#cb162-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>parse_number<span class="op">(</span><span class="st">&quot;123+45&quot;</span><span class="op">,</span> <span class="op">&amp;</span>p<span class="op">)</span> <span class="op">==</span> <span class="dv">123</span> <span class="op">&amp;&amp;</span> p <span class="op">==</span> <span class="dv">3</span><span class="op">)</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb162-21"><a href="#cb162-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-22"><a href="#cb162-22" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> <span class="dv">4</span><span class="op">;</span></span>
<span id="cb162-23"><a href="#cb162-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>parse_number<span class="op">(</span><span class="st">&quot;123+45&quot;</span><span class="op">,</span> <span class="op">&amp;</span>p<span class="op">)</span> <span class="op">==</span> <span class="dv">45</span> <span class="op">&amp;&amp;</span> p <span class="op">==</span> <span class="dv">6</span><span class="op">)</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb162-24"><a href="#cb162-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-25"><a href="#cb162-25" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb162-26"><a href="#cb162-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>parse_number<span class="op">(</span><span class="st">&quot;7&quot;</span><span class="op">,</span> <span class="op">&amp;</span>p<span class="op">)</span> <span class="op">==</span> <span class="dv">7</span> <span class="op">&amp;&amp;</span> p <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb162-27"><a href="#cb162-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-28"><a href="#cb162-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score<span class="op">;</span></span>
<span id="cb162-29"><a href="#cb162-29" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.4.3" id="identifier-les-tokens"><span class="header-section-number">2.4.3</span> 1.3 Identifier les
Tokens</h3>
<div class="sourceCode" id="cb163"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> is_digit<span class="op">(</span><span class="dt">char</span> c<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> c <span class="op">&gt;=</span> <span class="ch">&#39;0&#39;</span> <span class="op">&amp;&amp;</span> c <span class="op">&lt;=</span> <span class="ch">&#39;9&#39;</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> next_token<span class="op">(</span><span class="dt">char</span><span class="op">*</span> s<span class="op">,</span> <span class="dt">int</span><span class="op">*</span> pos<span class="op">)</span> <span class="op">{</span></span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>s<span class="op">[*</span>pos<span class="op">]</span> <span class="op">==</span> <span class="ch">&#39; &#39;</span><span class="op">)</span> <span class="op">*</span>pos <span class="op">=</span> <span class="op">*</span>pos <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> c <span class="op">=</span> s<span class="op">[*</span>pos<span class="op">];</span></span>
<span id="cb163-7"><a href="#cb163-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>c <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb163-8"><a href="#cb163-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-9"><a href="#cb163-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>is_digit<span class="op">(</span>c<span class="op">))</span> <span class="op">{</span></span>
<span id="cb163-10"><a href="#cb163-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="op">(</span>is_digit<span class="op">(</span>s<span class="op">[*</span>pos<span class="op">]))</span> <span class="op">*</span>pos <span class="op">=</span> <span class="op">*</span>pos <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb163-11"><a href="#cb163-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb163-12"><a href="#cb163-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb163-13"><a href="#cb163-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-14"><a href="#cb163-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span>pos <span class="op">=</span> <span class="op">*</span>pos <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb163-15"><a href="#cb163-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>c <span class="op">==</span> <span class="ch">&#39;+&#39;</span><span class="op">)</span> <span class="cf">return</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb163-16"><a href="#cb163-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>c <span class="op">==</span> <span class="ch">&#39;-&#39;</span><span class="op">)</span> <span class="cf">return</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb163-17"><a href="#cb163-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>c <span class="op">==</span> <span class="ch">&#39;*&#39;</span><span class="op">)</span> <span class="cf">return</span> <span class="dv">4</span><span class="op">;</span></span>
<span id="cb163-18"><a href="#cb163-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>c <span class="op">==</span> <span class="ch">&#39;/&#39;</span><span class="op">)</span> <span class="cf">return</span> <span class="dv">5</span><span class="op">;</span></span>
<span id="cb163-19"><a href="#cb163-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>c <span class="op">==</span> <span class="ch">&#39;(&#39;</span><span class="op">)</span> <span class="cf">return</span> <span class="dv">6</span><span class="op">;</span></span>
<span id="cb163-20"><a href="#cb163-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>c <span class="op">==</span> <span class="ch">&#39;)&#39;</span><span class="op">)</span> <span class="cf">return</span> <span class="dv">7</span><span class="op">;</span></span>
<span id="cb163-21"><a href="#cb163-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-22"><a href="#cb163-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb163-23"><a href="#cb163-23" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb163-24"><a href="#cb163-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-25"><a href="#cb163-25" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb163-26"><a href="#cb163-26" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> score <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb163-27"><a href="#cb163-27" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> p<span class="op">;</span></span>
<span id="cb163-28"><a href="#cb163-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-29"><a href="#cb163-29" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb163-30"><a href="#cb163-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>next_token<span class="op">(</span><span class="st">&quot;42&quot;</span><span class="op">,</span> <span class="op">&amp;</span>p<span class="op">)</span> <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb163-31"><a href="#cb163-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-32"><a href="#cb163-32" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb163-33"><a href="#cb163-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>next_token<span class="op">(</span><span class="st">&quot;+&quot;</span><span class="op">,</span> <span class="op">&amp;</span>p<span class="op">)</span> <span class="op">==</span> <span class="dv">2</span><span class="op">)</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb163-34"><a href="#cb163-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-35"><a href="#cb163-35" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb163-36"><a href="#cb163-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>next_token<span class="op">(</span><span class="st">&quot;3 + 5&quot;</span><span class="op">,</span> <span class="op">&amp;</span>p<span class="op">)</span> <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb163-37"><a href="#cb163-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>next_token<span class="op">(</span><span class="st">&quot;3 + 5&quot;</span><span class="op">,</span> <span class="op">&amp;</span>p<span class="op">)</span> <span class="op">==</span> <span class="dv">2</span><span class="op">)</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb163-38"><a href="#cb163-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>next_token<span class="op">(</span><span class="st">&quot;3 + 5&quot;</span><span class="op">,</span> <span class="op">&amp;</span>p<span class="op">)</span> <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb163-39"><a href="#cb163-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>next_token<span class="op">(</span><span class="st">&quot;3 + 5&quot;</span><span class="op">,</span> <span class="op">&amp;</span>p<span class="op">)</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb163-40"><a href="#cb163-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-41"><a href="#cb163-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score<span class="op">;</span></span>
<span id="cb163-42"><a href="#cb163-42" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.4.4" id="évaluer-a-b"><span class="header-section-number">2.4.4</span> 2.1 Évaluer a + b</h3>
<div class="sourceCode" id="cb164"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> is_digit<span class="op">(</span><span class="dt">char</span> c<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> c <span class="op">&gt;=</span> <span class="ch">&#39;0&#39;</span> <span class="op">&amp;&amp;</span> c <span class="op">&lt;=</span> <span class="ch">&#39;9&#39;</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> parse_num<span class="op">(</span><span class="dt">char</span><span class="op">*</span> s<span class="op">,</span> <span class="dt">int</span><span class="op">*</span> p<span class="op">)</span> <span class="op">{</span></span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>s<span class="op">[*</span>p<span class="op">]</span> <span class="op">==</span> <span class="ch">&#39; &#39;</span><span class="op">)</span> <span class="op">*</span>p <span class="op">=</span> <span class="op">*</span>p <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> v <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb164-6"><a href="#cb164-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>is_digit<span class="op">(</span>s<span class="op">[*</span>p<span class="op">]))</span> <span class="op">{</span></span>
<span id="cb164-7"><a href="#cb164-7" aria-hidden="true" tabindex="-1"></a>        v <span class="op">=</span> v <span class="op">*</span> <span class="dv">10</span> <span class="op">+</span> <span class="op">(</span>s<span class="op">[*</span>p<span class="op">]</span> <span class="op">-</span> <span class="ch">&#39;0&#39;</span><span class="op">);</span></span>
<span id="cb164-8"><a href="#cb164-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">*</span>p <span class="op">=</span> <span class="op">*</span>p <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb164-9"><a href="#cb164-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb164-10"><a href="#cb164-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> v<span class="op">;</span></span>
<span id="cb164-11"><a href="#cb164-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb164-12"><a href="#cb164-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-13"><a href="#cb164-13" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> eval_simple<span class="op">(</span><span class="dt">char</span><span class="op">*</span> s<span class="op">)</span> <span class="op">{</span></span>
<span id="cb164-14"><a href="#cb164-14" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> pos <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb164-15"><a href="#cb164-15" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> a <span class="op">=</span> parse_num<span class="op">(</span>s<span class="op">,</span> <span class="op">&amp;</span>pos<span class="op">);</span></span>
<span id="cb164-16"><a href="#cb164-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-17"><a href="#cb164-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>s<span class="op">[</span>pos<span class="op">]</span> <span class="op">==</span> <span class="ch">&#39; &#39;</span><span class="op">)</span> pos <span class="op">=</span> pos <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb164-18"><a href="#cb164-18" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> op <span class="op">=</span> s<span class="op">[</span>pos<span class="op">];</span></span>
<span id="cb164-19"><a href="#cb164-19" aria-hidden="true" tabindex="-1"></a>    pos <span class="op">=</span> pos <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb164-20"><a href="#cb164-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-21"><a href="#cb164-21" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> b <span class="op">=</span> parse_num<span class="op">(</span>s<span class="op">,</span> <span class="op">&amp;</span>pos<span class="op">);</span></span>
<span id="cb164-22"><a href="#cb164-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-23"><a href="#cb164-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>op <span class="op">==</span> <span class="ch">&#39;+&#39;</span><span class="op">)</span> <span class="cf">return</span> a <span class="op">+</span> b<span class="op">;</span></span>
<span id="cb164-24"><a href="#cb164-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>op <span class="op">==</span> <span class="ch">&#39;-&#39;</span><span class="op">)</span> <span class="cf">return</span> a <span class="op">-</span> b<span class="op">;</span></span>
<span id="cb164-25"><a href="#cb164-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>op <span class="op">==</span> <span class="ch">&#39;*&#39;</span><span class="op">)</span> <span class="cf">return</span> a <span class="op">*</span> b<span class="op">;</span></span>
<span id="cb164-26"><a href="#cb164-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>op <span class="op">==</span> <span class="ch">&#39;/&#39;</span><span class="op">)</span> <span class="cf">return</span> a <span class="op">/</span> b<span class="op">;</span></span>
<span id="cb164-27"><a href="#cb164-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb164-28"><a href="#cb164-28" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb164-29"><a href="#cb164-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-30"><a href="#cb164-30" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb164-31"><a href="#cb164-31" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> score <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb164-32"><a href="#cb164-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>eval_simple<span class="op">(</span><span class="st">&quot;3 + 5&quot;</span><span class="op">)</span> <span class="op">==</span> <span class="dv">8</span><span class="op">)</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb164-33"><a href="#cb164-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>eval_simple<span class="op">(</span><span class="st">&quot;10 - 4&quot;</span><span class="op">)</span> <span class="op">==</span> <span class="dv">6</span><span class="op">)</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb164-34"><a href="#cb164-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>eval_simple<span class="op">(</span><span class="st">&quot;6 * 7&quot;</span><span class="op">)</span> <span class="op">==</span> <span class="dv">42</span><span class="op">)</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb164-35"><a href="#cb164-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>eval_simple<span class="op">(</span><span class="st">&quot;20 / 4&quot;</span><span class="op">)</span> <span class="op">==</span> <span class="dv">5</span><span class="op">)</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb164-36"><a href="#cb164-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score<span class="op">;</span></span>
<span id="cb164-37"><a href="#cb164-37" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.4.5" id="évaluer-a-b-c"><span class="header-section-number">2.4.5</span> 2.2 Évaluer a + b + c</h3>
<div class="sourceCode" id="cb165"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> is_digit<span class="op">(</span><span class="dt">char</span> c<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> c <span class="op">&gt;=</span> <span class="ch">&#39;0&#39;</span> <span class="op">&amp;&amp;</span> c <span class="op">&lt;=</span> <span class="ch">&#39;9&#39;</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> parse_num<span class="op">(</span><span class="dt">char</span><span class="op">*</span> s<span class="op">,</span> <span class="dt">int</span><span class="op">*</span> p<span class="op">)</span> <span class="op">{</span></span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>s<span class="op">[*</span>p<span class="op">]</span> <span class="op">==</span> <span class="ch">&#39; &#39;</span><span class="op">)</span> <span class="op">*</span>p <span class="op">=</span> <span class="op">*</span>p <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> v <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>is_digit<span class="op">(</span>s<span class="op">[*</span>p<span class="op">]))</span> <span class="op">{</span> v <span class="op">=</span> v <span class="op">*</span> <span class="dv">10</span> <span class="op">+</span> <span class="op">(</span>s<span class="op">[*</span>p<span class="op">]</span> <span class="op">-</span> <span class="ch">&#39;0&#39;</span><span class="op">);</span> <span class="op">*</span>p <span class="op">=</span> <span class="op">*</span>p <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb165-7"><a href="#cb165-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> v<span class="op">;</span></span>
<span id="cb165-8"><a href="#cb165-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb165-9"><a href="#cb165-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-10"><a href="#cb165-10" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> is_op<span class="op">(</span><span class="dt">char</span> c<span class="op">)</span> <span class="op">{</span></span>
<span id="cb165-11"><a href="#cb165-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> c <span class="op">==</span> <span class="ch">&#39;+&#39;</span> <span class="op">||</span> c <span class="op">==</span> <span class="ch">&#39;-&#39;</span> <span class="op">||</span> c <span class="op">==</span> <span class="ch">&#39;*&#39;</span> <span class="op">||</span> c <span class="op">==</span> <span class="ch">&#39;/&#39;</span><span class="op">;</span></span>
<span id="cb165-12"><a href="#cb165-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb165-13"><a href="#cb165-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-14"><a href="#cb165-14" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> eval_chain<span class="op">(</span><span class="dt">char</span><span class="op">*</span> s<span class="op">)</span> <span class="op">{</span></span>
<span id="cb165-15"><a href="#cb165-15" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> pos <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb165-16"><a href="#cb165-16" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> result <span class="op">=</span> parse_num<span class="op">(</span>s<span class="op">,</span> <span class="op">&amp;</span>pos<span class="op">);</span></span>
<span id="cb165-17"><a href="#cb165-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-18"><a href="#cb165-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span><span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb165-19"><a href="#cb165-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="op">(</span>s<span class="op">[</span>pos<span class="op">]</span> <span class="op">==</span> <span class="ch">&#39; &#39;</span><span class="op">)</span> pos <span class="op">=</span> pos <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb165-20"><a href="#cb165-20" aria-hidden="true" tabindex="-1"></a>        <span class="dt">char</span> op <span class="op">=</span> s<span class="op">[</span>pos<span class="op">];</span></span>
<span id="cb165-21"><a href="#cb165-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(!</span>is_op<span class="op">(</span>op<span class="op">))</span> <span class="cf">break</span><span class="op">;</span></span>
<span id="cb165-22"><a href="#cb165-22" aria-hidden="true" tabindex="-1"></a>        pos <span class="op">=</span> pos <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb165-23"><a href="#cb165-23" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> b <span class="op">=</span> parse_num<span class="op">(</span>s<span class="op">,</span> <span class="op">&amp;</span>pos<span class="op">);</span></span>
<span id="cb165-24"><a href="#cb165-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-25"><a href="#cb165-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>op <span class="op">==</span> <span class="ch">&#39;+&#39;</span><span class="op">)</span> result <span class="op">=</span> result <span class="op">+</span> b<span class="op">;</span></span>
<span id="cb165-26"><a href="#cb165-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>op <span class="op">==</span> <span class="ch">&#39;-&#39;</span><span class="op">)</span> result <span class="op">=</span> result <span class="op">-</span> b<span class="op">;</span></span>
<span id="cb165-27"><a href="#cb165-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>op <span class="op">==</span> <span class="ch">&#39;*&#39;</span><span class="op">)</span> result <span class="op">=</span> result <span class="op">*</span> b<span class="op">;</span></span>
<span id="cb165-28"><a href="#cb165-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>op <span class="op">==</span> <span class="ch">&#39;/&#39;</span><span class="op">)</span> result <span class="op">=</span> result <span class="op">/</span> b<span class="op">;</span></span>
<span id="cb165-29"><a href="#cb165-29" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb165-30"><a href="#cb165-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-31"><a href="#cb165-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result<span class="op">;</span></span>
<span id="cb165-32"><a href="#cb165-32" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb165-33"><a href="#cb165-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-34"><a href="#cb165-34" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb165-35"><a href="#cb165-35" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> score <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb165-36"><a href="#cb165-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>eval_chain<span class="op">(</span><span class="st">&quot;5&quot;</span><span class="op">)</span> <span class="op">==</span> <span class="dv">5</span><span class="op">)</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb165-37"><a href="#cb165-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>eval_chain<span class="op">(</span><span class="st">&quot;3 + 5&quot;</span><span class="op">)</span> <span class="op">==</span> <span class="dv">8</span><span class="op">)</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb165-38"><a href="#cb165-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>eval_chain<span class="op">(</span><span class="st">&quot;1 + 2 + 3&quot;</span><span class="op">)</span> <span class="op">==</span> <span class="dv">6</span><span class="op">)</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb165-39"><a href="#cb165-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>eval_chain<span class="op">(</span><span class="st">&quot;10 - 2 - 3&quot;</span><span class="op">)</span> <span class="op">==</span> <span class="dv">5</span><span class="op">)</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb165-40"><a href="#cb165-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>eval_chain<span class="op">(</span><span class="st">&quot;2 * 3 * 4&quot;</span><span class="op">)</span> <span class="op">==</span> <span class="dv">24</span><span class="op">)</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb165-41"><a href="#cb165-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score<span class="op">;</span></span>
<span id="cb165-42"><a href="#cb165-42" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.4.6" id="respecter-la-précédence"><span class="header-section-number">2.4.6</span> 2.3 Respecter la
Précédence</h3>
<div class="sourceCode" id="cb166"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> is_digit<span class="op">(</span><span class="dt">char</span> c<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> c <span class="op">&gt;=</span> <span class="ch">&#39;0&#39;</span> <span class="op">&amp;&amp;</span> c <span class="op">&lt;=</span> <span class="ch">&#39;9&#39;</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a><span class="dt">char</span><span class="op">*</span> input<span class="op">;</span></span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> pos<span class="op">;</span></span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-5"><a href="#cb166-5" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> skip<span class="op">()</span> <span class="op">{</span> <span class="cf">while</span> <span class="op">(</span>input<span class="op">[</span>pos<span class="op">]</span> <span class="op">==</span> <span class="ch">&#39; &#39;</span><span class="op">)</span> pos <span class="op">=</span> pos <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb166-6"><a href="#cb166-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-7"><a href="#cb166-7" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> parse_num<span class="op">()</span> <span class="op">{</span></span>
<span id="cb166-8"><a href="#cb166-8" aria-hidden="true" tabindex="-1"></a>    skip<span class="op">();</span></span>
<span id="cb166-9"><a href="#cb166-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> v <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb166-10"><a href="#cb166-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>is_digit<span class="op">(</span>input<span class="op">[</span>pos<span class="op">]))</span> <span class="op">{</span> v <span class="op">=</span> v <span class="op">*</span> <span class="dv">10</span> <span class="op">+</span> <span class="op">(</span>input<span class="op">[</span>pos<span class="op">]</span> <span class="op">-</span> <span class="ch">&#39;0&#39;</span><span class="op">);</span> pos <span class="op">=</span> pos <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb166-11"><a href="#cb166-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> v<span class="op">;</span></span>
<span id="cb166-12"><a href="#cb166-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb166-13"><a href="#cb166-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-14"><a href="#cb166-14" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> parse_factor<span class="op">()</span> <span class="op">{</span></span>
<span id="cb166-15"><a href="#cb166-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> parse_num<span class="op">();</span></span>
<span id="cb166-16"><a href="#cb166-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb166-17"><a href="#cb166-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-18"><a href="#cb166-18" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> parse_term<span class="op">()</span> <span class="op">{</span></span>
<span id="cb166-19"><a href="#cb166-19" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> left <span class="op">=</span> parse_factor<span class="op">();</span></span>
<span id="cb166-20"><a href="#cb166-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span><span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb166-21"><a href="#cb166-21" aria-hidden="true" tabindex="-1"></a>        skip<span class="op">();</span></span>
<span id="cb166-22"><a href="#cb166-22" aria-hidden="true" tabindex="-1"></a>        <span class="dt">char</span> op <span class="op">=</span> input<span class="op">[</span>pos<span class="op">];</span></span>
<span id="cb166-23"><a href="#cb166-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>op <span class="op">!=</span> <span class="ch">&#39;*&#39;</span> <span class="op">&amp;&amp;</span> op <span class="op">!=</span> <span class="ch">&#39;/&#39;</span><span class="op">)</span> <span class="cf">break</span><span class="op">;</span></span>
<span id="cb166-24"><a href="#cb166-24" aria-hidden="true" tabindex="-1"></a>        pos <span class="op">=</span> pos <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb166-25"><a href="#cb166-25" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> right <span class="op">=</span> parse_factor<span class="op">();</span></span>
<span id="cb166-26"><a href="#cb166-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>op <span class="op">==</span> <span class="ch">&#39;*&#39;</span><span class="op">)</span> left <span class="op">=</span> left <span class="op">*</span> right<span class="op">;</span></span>
<span id="cb166-27"><a href="#cb166-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> left <span class="op">=</span> left <span class="op">/</span> right<span class="op">;</span></span>
<span id="cb166-28"><a href="#cb166-28" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb166-29"><a href="#cb166-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> left<span class="op">;</span></span>
<span id="cb166-30"><a href="#cb166-30" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb166-31"><a href="#cb166-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-32"><a href="#cb166-32" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> parse_expr<span class="op">()</span> <span class="op">{</span></span>
<span id="cb166-33"><a href="#cb166-33" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> left <span class="op">=</span> parse_term<span class="op">();</span></span>
<span id="cb166-34"><a href="#cb166-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span><span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb166-35"><a href="#cb166-35" aria-hidden="true" tabindex="-1"></a>        skip<span class="op">();</span></span>
<span id="cb166-36"><a href="#cb166-36" aria-hidden="true" tabindex="-1"></a>        <span class="dt">char</span> op <span class="op">=</span> input<span class="op">[</span>pos<span class="op">];</span></span>
<span id="cb166-37"><a href="#cb166-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>op <span class="op">!=</span> <span class="ch">&#39;+&#39;</span> <span class="op">&amp;&amp;</span> op <span class="op">!=</span> <span class="ch">&#39;-&#39;</span><span class="op">)</span> <span class="cf">break</span><span class="op">;</span></span>
<span id="cb166-38"><a href="#cb166-38" aria-hidden="true" tabindex="-1"></a>        pos <span class="op">=</span> pos <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb166-39"><a href="#cb166-39" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> right <span class="op">=</span> parse_term<span class="op">();</span></span>
<span id="cb166-40"><a href="#cb166-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>op <span class="op">==</span> <span class="ch">&#39;+&#39;</span><span class="op">)</span> left <span class="op">=</span> left <span class="op">+</span> right<span class="op">;</span></span>
<span id="cb166-41"><a href="#cb166-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> left <span class="op">=</span> left <span class="op">-</span> right<span class="op">;</span></span>
<span id="cb166-42"><a href="#cb166-42" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb166-43"><a href="#cb166-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> left<span class="op">;</span></span>
<span id="cb166-44"><a href="#cb166-44" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb166-45"><a href="#cb166-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-46"><a href="#cb166-46" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> eval<span class="op">(</span><span class="dt">char</span><span class="op">*</span> s<span class="op">)</span> <span class="op">{</span></span>
<span id="cb166-47"><a href="#cb166-47" aria-hidden="true" tabindex="-1"></a>    input <span class="op">=</span> s<span class="op">;</span></span>
<span id="cb166-48"><a href="#cb166-48" aria-hidden="true" tabindex="-1"></a>    pos <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb166-49"><a href="#cb166-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> parse_expr<span class="op">();</span></span>
<span id="cb166-50"><a href="#cb166-50" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb166-51"><a href="#cb166-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-52"><a href="#cb166-52" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb166-53"><a href="#cb166-53" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> score <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb166-54"><a href="#cb166-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>eval<span class="op">(</span><span class="st">&quot;42&quot;</span><span class="op">)</span> <span class="op">==</span> <span class="dv">42</span><span class="op">)</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb166-55"><a href="#cb166-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>eval<span class="op">(</span><span class="st">&quot;3 + 5&quot;</span><span class="op">)</span> <span class="op">==</span> <span class="dv">8</span><span class="op">)</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb166-56"><a href="#cb166-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>eval<span class="op">(</span><span class="st">&quot;3 * 4&quot;</span><span class="op">)</span> <span class="op">==</span> <span class="dv">12</span><span class="op">)</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb166-57"><a href="#cb166-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>eval<span class="op">(</span><span class="st">&quot;2 + 3 * 4&quot;</span><span class="op">)</span> <span class="op">==</span> <span class="dv">14</span><span class="op">)</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb166-58"><a href="#cb166-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>eval<span class="op">(</span><span class="st">&quot;2 * 3 + 4&quot;</span><span class="op">)</span> <span class="op">==</span> <span class="dv">10</span><span class="op">)</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb166-59"><a href="#cb166-59" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>eval<span class="op">(</span><span class="st">&quot;10 - 2 * 3&quot;</span><span class="op">)</span> <span class="op">==</span> <span class="dv">4</span><span class="op">)</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb166-60"><a href="#cb166-60" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score<span class="op">;</span></span>
<span id="cb166-61"><a href="#cb166-61" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.4.7" id="gérer-les-parenthèses"><span class="header-section-number">2.4.7</span> 2.4 Gérer les
Parenthèses</h3>
<div class="sourceCode" id="cb167"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> is_digit<span class="op">(</span><span class="dt">char</span> c<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> c <span class="op">&gt;=</span> <span class="ch">&#39;0&#39;</span> <span class="op">&amp;&amp;</span> c <span class="op">&lt;=</span> <span class="ch">&#39;9&#39;</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a><span class="dt">char</span><span class="op">*</span> input<span class="op">;</span></span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> pos<span class="op">;</span></span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> skip<span class="op">()</span> <span class="op">{</span> <span class="cf">while</span> <span class="op">(</span>input<span class="op">[</span>pos<span class="op">]</span> <span class="op">==</span> <span class="ch">&#39; &#39;</span><span class="op">)</span> pos <span class="op">=</span> pos <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-7"><a href="#cb167-7" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> parse_expr<span class="op">();</span></span>
<span id="cb167-8"><a href="#cb167-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-9"><a href="#cb167-9" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> parse_num<span class="op">()</span> <span class="op">{</span></span>
<span id="cb167-10"><a href="#cb167-10" aria-hidden="true" tabindex="-1"></a>    skip<span class="op">();</span></span>
<span id="cb167-11"><a href="#cb167-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> v <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb167-12"><a href="#cb167-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>is_digit<span class="op">(</span>input<span class="op">[</span>pos<span class="op">]))</span> <span class="op">{</span> v <span class="op">=</span> v <span class="op">*</span> <span class="dv">10</span> <span class="op">+</span> <span class="op">(</span>input<span class="op">[</span>pos<span class="op">]</span> <span class="op">-</span> <span class="ch">&#39;0&#39;</span><span class="op">);</span> pos <span class="op">=</span> pos <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb167-13"><a href="#cb167-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> v<span class="op">;</span></span>
<span id="cb167-14"><a href="#cb167-14" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb167-15"><a href="#cb167-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-16"><a href="#cb167-16" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> parse_factor<span class="op">()</span> <span class="op">{</span></span>
<span id="cb167-17"><a href="#cb167-17" aria-hidden="true" tabindex="-1"></a>    skip<span class="op">();</span></span>
<span id="cb167-18"><a href="#cb167-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>input<span class="op">[</span>pos<span class="op">]</span> <span class="op">==</span> <span class="ch">&#39;(&#39;</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb167-19"><a href="#cb167-19" aria-hidden="true" tabindex="-1"></a>        pos <span class="op">=</span> pos <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb167-20"><a href="#cb167-20" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> v <span class="op">=</span> parse_expr<span class="op">();</span></span>
<span id="cb167-21"><a href="#cb167-21" aria-hidden="true" tabindex="-1"></a>        skip<span class="op">();</span></span>
<span id="cb167-22"><a href="#cb167-22" aria-hidden="true" tabindex="-1"></a>        pos <span class="op">=</span> pos <span class="op">+</span> <span class="dv">1</span><span class="op">;</span>  <span class="co">// &#39;)&#39;</span></span>
<span id="cb167-23"><a href="#cb167-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> v<span class="op">;</span></span>
<span id="cb167-24"><a href="#cb167-24" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb167-25"><a href="#cb167-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> parse_num<span class="op">();</span></span>
<span id="cb167-26"><a href="#cb167-26" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb167-27"><a href="#cb167-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-28"><a href="#cb167-28" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> parse_term<span class="op">()</span> <span class="op">{</span></span>
<span id="cb167-29"><a href="#cb167-29" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> left <span class="op">=</span> parse_factor<span class="op">();</span></span>
<span id="cb167-30"><a href="#cb167-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span><span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb167-31"><a href="#cb167-31" aria-hidden="true" tabindex="-1"></a>        skip<span class="op">();</span></span>
<span id="cb167-32"><a href="#cb167-32" aria-hidden="true" tabindex="-1"></a>        <span class="dt">char</span> op <span class="op">=</span> input<span class="op">[</span>pos<span class="op">];</span></span>
<span id="cb167-33"><a href="#cb167-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>op <span class="op">!=</span> <span class="ch">&#39;*&#39;</span> <span class="op">&amp;&amp;</span> op <span class="op">!=</span> <span class="ch">&#39;/&#39;</span><span class="op">)</span> <span class="cf">break</span><span class="op">;</span></span>
<span id="cb167-34"><a href="#cb167-34" aria-hidden="true" tabindex="-1"></a>        pos <span class="op">=</span> pos <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb167-35"><a href="#cb167-35" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> right <span class="op">=</span> parse_factor<span class="op">();</span></span>
<span id="cb167-36"><a href="#cb167-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>op <span class="op">==</span> <span class="ch">&#39;*&#39;</span><span class="op">)</span> left <span class="op">=</span> left <span class="op">*</span> right<span class="op">;</span></span>
<span id="cb167-37"><a href="#cb167-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> left <span class="op">=</span> left <span class="op">/</span> right<span class="op">;</span></span>
<span id="cb167-38"><a href="#cb167-38" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb167-39"><a href="#cb167-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> left<span class="op">;</span></span>
<span id="cb167-40"><a href="#cb167-40" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb167-41"><a href="#cb167-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-42"><a href="#cb167-42" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> parse_expr<span class="op">()</span> <span class="op">{</span></span>
<span id="cb167-43"><a href="#cb167-43" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> left <span class="op">=</span> parse_term<span class="op">();</span></span>
<span id="cb167-44"><a href="#cb167-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span><span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb167-45"><a href="#cb167-45" aria-hidden="true" tabindex="-1"></a>        skip<span class="op">();</span></span>
<span id="cb167-46"><a href="#cb167-46" aria-hidden="true" tabindex="-1"></a>        <span class="dt">char</span> op <span class="op">=</span> input<span class="op">[</span>pos<span class="op">];</span></span>
<span id="cb167-47"><a href="#cb167-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>op <span class="op">!=</span> <span class="ch">&#39;+&#39;</span> <span class="op">&amp;&amp;</span> op <span class="op">!=</span> <span class="ch">&#39;-&#39;</span><span class="op">)</span> <span class="cf">break</span><span class="op">;</span></span>
<span id="cb167-48"><a href="#cb167-48" aria-hidden="true" tabindex="-1"></a>        pos <span class="op">=</span> pos <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb167-49"><a href="#cb167-49" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> right <span class="op">=</span> parse_term<span class="op">();</span></span>
<span id="cb167-50"><a href="#cb167-50" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>op <span class="op">==</span> <span class="ch">&#39;+&#39;</span><span class="op">)</span> left <span class="op">=</span> left <span class="op">+</span> right<span class="op">;</span></span>
<span id="cb167-51"><a href="#cb167-51" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> left <span class="op">=</span> left <span class="op">-</span> right<span class="op">;</span></span>
<span id="cb167-52"><a href="#cb167-52" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb167-53"><a href="#cb167-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> left<span class="op">;</span></span>
<span id="cb167-54"><a href="#cb167-54" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb167-55"><a href="#cb167-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-56"><a href="#cb167-56" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> eval<span class="op">(</span><span class="dt">char</span><span class="op">*</span> s<span class="op">)</span> <span class="op">{</span> input <span class="op">=</span> s<span class="op">;</span> pos <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> <span class="cf">return</span> parse_expr<span class="op">();</span> <span class="op">}</span></span>
<span id="cb167-57"><a href="#cb167-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-58"><a href="#cb167-58" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb167-59"><a href="#cb167-59" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> score <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb167-60"><a href="#cb167-60" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>eval<span class="op">(</span><span class="st">&quot;(5)&quot;</span><span class="op">)</span> <span class="op">==</span> <span class="dv">5</span><span class="op">)</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb167-61"><a href="#cb167-61" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>eval<span class="op">(</span><span class="st">&quot;(2 + 3)&quot;</span><span class="op">)</span> <span class="op">==</span> <span class="dv">5</span><span class="op">)</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb167-62"><a href="#cb167-62" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>eval<span class="op">(</span><span class="st">&quot;(2 + 3) * 4&quot;</span><span class="op">)</span> <span class="op">==</span> <span class="dv">20</span><span class="op">)</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb167-63"><a href="#cb167-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>eval<span class="op">(</span><span class="st">&quot;2 * (3 + 4)&quot;</span><span class="op">)</span> <span class="op">==</span> <span class="dv">14</span><span class="op">)</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb167-64"><a href="#cb167-64" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>eval<span class="op">(</span><span class="st">&quot;(1 + 2) * (3 + 4)&quot;</span><span class="op">)</span> <span class="op">==</span> <span class="dv">21</span><span class="op">)</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb167-65"><a href="#cb167-65" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>eval<span class="op">(</span><span class="st">&quot;((2))&quot;</span><span class="op">)</span> <span class="op">==</span> <span class="dv">2</span><span class="op">)</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb167-66"><a href="#cb167-66" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score<span class="op">;</span></span>
<span id="cb167-67"><a href="#cb167-67" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.4.8" id="émettre-mov"><span class="header-section-number">2.4.8</span> 3.1 Émettre MOV</h3>
<div class="sourceCode" id="cb168"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> strlen<span class="op">(</span><span class="dt">char</span><span class="op">*</span> s<span class="op">)</span> <span class="op">{</span> <span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> <span class="cf">while</span> <span class="op">(</span>s<span class="op">[</span>i<span class="op">])</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> <span class="cf">return</span> i<span class="op">;</span> <span class="op">}</span></span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> append<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">char</span><span class="op">*</span> s<span class="op">)</span> <span class="op">{</span></span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i <span class="op">=</span> strlen<span class="op">(</span>buf<span class="op">);</span></span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb168-6"><a href="#cb168-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>s<span class="op">[</span>j<span class="op">])</span> <span class="op">{</span> buf<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> s<span class="op">[</span>j<span class="op">];</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> j <span class="op">=</span> j <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb168-7"><a href="#cb168-7" aria-hidden="true" tabindex="-1"></a>    buf<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb168-8"><a href="#cb168-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb168-9"><a href="#cb168-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-10"><a href="#cb168-10" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> append_num<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb168-11"><a href="#cb168-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> tmp<span class="op">[</span><span class="dv">12</span><span class="op">];</span></span>
<span id="cb168-12"><a href="#cb168-12" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb168-13"><a href="#cb168-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span> tmp<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="ch">&#39;0&#39;</span><span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb168-14"><a href="#cb168-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb168-15"><a href="#cb168-15" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> rev<span class="op">[</span><span class="dv">12</span><span class="op">];</span> <span class="dt">int</span> r <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb168-16"><a href="#cb168-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="op">(</span>n <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span> rev<span class="op">[</span>r<span class="op">]</span> <span class="op">=</span> n <span class="op">%</span> <span class="dv">10</span><span class="op">;</span> r <span class="op">=</span> r <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> n <span class="op">=</span> n <span class="op">/</span> <span class="dv">10</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb168-17"><a href="#cb168-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="op">(</span>r <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span> r <span class="op">=</span> r <span class="op">-</span> <span class="dv">1</span><span class="op">;</span> tmp<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="ch">&#39;0&#39;</span> <span class="op">+</span> rev<span class="op">[</span>r<span class="op">];</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb168-18"><a href="#cb168-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb168-19"><a href="#cb168-19" aria-hidden="true" tabindex="-1"></a>    tmp<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb168-20"><a href="#cb168-20" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> tmp<span class="op">);</span></span>
<span id="cb168-21"><a href="#cb168-21" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb168-22"><a href="#cb168-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-23"><a href="#cb168-23" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> emit_mov<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">int</span> reg<span class="op">,</span> <span class="dt">int</span> val<span class="op">)</span> <span class="op">{</span></span>
<span id="cb168-24"><a href="#cb168-24" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;MOV R&quot;</span><span class="op">);</span></span>
<span id="cb168-25"><a href="#cb168-25" aria-hidden="true" tabindex="-1"></a>    append_num<span class="op">(</span>buf<span class="op">,</span> reg<span class="op">);</span></span>
<span id="cb168-26"><a href="#cb168-26" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;, #&quot;</span><span class="op">);</span></span>
<span id="cb168-27"><a href="#cb168-27" aria-hidden="true" tabindex="-1"></a>    append_num<span class="op">(</span>buf<span class="op">,</span> val<span class="op">);</span></span>
<span id="cb168-28"><a href="#cb168-28" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">n&quot;</span><span class="op">);</span></span>
<span id="cb168-29"><a href="#cb168-29" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb168-30"><a href="#cb168-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-31"><a href="#cb168-31" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> check<span class="op">(</span><span class="dt">char</span><span class="op">*</span> a<span class="op">,</span> <span class="dt">char</span><span class="op">*</span> b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb168-32"><a href="#cb168-32" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb168-33"><a href="#cb168-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>a<span class="op">[</span>i<span class="op">]</span> <span class="op">&amp;&amp;</span> b<span class="op">[</span>i<span class="op">])</span> <span class="op">{</span> <span class="cf">if</span> <span class="op">(</span>a<span class="op">[</span>i<span class="op">]</span> <span class="op">!=</span> b<span class="op">[</span>i<span class="op">])</span> <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb168-34"><a href="#cb168-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> a<span class="op">[</span>i<span class="op">]</span> <span class="op">==</span> b<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb168-35"><a href="#cb168-35" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb168-36"><a href="#cb168-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-37"><a href="#cb168-37" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb168-38"><a href="#cb168-38" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> buf<span class="op">[</span><span class="dv">100</span><span class="op">];</span></span>
<span id="cb168-39"><a href="#cb168-39" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> score <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb168-40"><a href="#cb168-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-41"><a href="#cb168-41" aria-hidden="true" tabindex="-1"></a>    buf<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb168-42"><a href="#cb168-42" aria-hidden="true" tabindex="-1"></a>    emit_mov<span class="op">(</span>buf<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">42</span><span class="op">);</span></span>
<span id="cb168-43"><a href="#cb168-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>check<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;MOV R0, #42</span><span class="sc">\\</span><span class="st">n&quot;</span><span class="op">))</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb168-44"><a href="#cb168-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-45"><a href="#cb168-45" aria-hidden="true" tabindex="-1"></a>    buf<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb168-46"><a href="#cb168-46" aria-hidden="true" tabindex="-1"></a>    emit_mov<span class="op">(</span>buf<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">5</span><span class="op">);</span></span>
<span id="cb168-47"><a href="#cb168-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>check<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;MOV R1, #5</span><span class="sc">\\</span><span class="st">n&quot;</span><span class="op">))</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb168-48"><a href="#cb168-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-49"><a href="#cb168-49" aria-hidden="true" tabindex="-1"></a>    buf<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb168-50"><a href="#cb168-50" aria-hidden="true" tabindex="-1"></a>    emit_mov<span class="op">(</span>buf<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb168-51"><a href="#cb168-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>check<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;MOV R0, #0</span><span class="sc">\\</span><span class="st">n&quot;</span><span class="op">))</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb168-52"><a href="#cb168-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb168-53"><a href="#cb168-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score<span class="op">;</span></span>
<span id="cb168-54"><a href="#cb168-54" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.4.9" id="émettre-addsubmul"><span class="header-section-number">2.4.9</span> 3.2 Émettre ADD/SUB/MUL</h3>
<div class="sourceCode" id="cb169"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> strlen<span class="op">(</span><span class="dt">char</span><span class="op">*</span> s<span class="op">)</span> <span class="op">{</span> <span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> <span class="cf">while</span> <span class="op">(</span>s<span class="op">[</span>i<span class="op">])</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> <span class="cf">return</span> i<span class="op">;</span> <span class="op">}</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> append<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">char</span><span class="op">*</span> s<span class="op">)</span> <span class="op">{</span></span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i <span class="op">=</span> strlen<span class="op">(</span>buf<span class="op">);</span> <span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>s<span class="op">[</span>j<span class="op">])</span> <span class="op">{</span> buf<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> s<span class="op">[</span>j<span class="op">];</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> j <span class="op">=</span> j <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a>    buf<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb169-6"><a href="#cb169-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb169-7"><a href="#cb169-7" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> append_num<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb169-8"><a href="#cb169-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;0&quot;</span><span class="op">);</span> <span class="cf">return</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb169-9"><a href="#cb169-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> tmp<span class="op">[</span><span class="dv">12</span><span class="op">];</span> <span class="dt">int</span> i <span class="op">=</span> <span class="dv">11</span><span class="op">;</span> tmp<span class="op">[</span><span class="dv">11</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb169-10"><a href="#cb169-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>n <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span> i <span class="op">=</span> i <span class="op">-</span> <span class="dv">1</span><span class="op">;</span> tmp<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="ch">&#39;0&#39;</span> <span class="op">+</span> <span class="op">(</span>n <span class="op">%</span> <span class="dv">10</span><span class="op">);</span> n <span class="op">=</span> n <span class="op">/</span> <span class="dv">10</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb169-11"><a href="#cb169-11" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> tmp <span class="op">+</span> i<span class="op">);</span></span>
<span id="cb169-12"><a href="#cb169-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb169-13"><a href="#cb169-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-14"><a href="#cb169-14" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> emit_op<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">char</span> op<span class="op">,</span> <span class="dt">int</span> rd<span class="op">,</span> <span class="dt">int</span> rn<span class="op">,</span> <span class="dt">int</span> rm<span class="op">)</span> <span class="op">{</span></span>
<span id="cb169-15"><a href="#cb169-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>op <span class="op">==</span> <span class="ch">&#39;+&#39;</span><span class="op">)</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;ADD R&quot;</span><span class="op">);</span></span>
<span id="cb169-16"><a href="#cb169-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>op <span class="op">==</span> <span class="ch">&#39;-&#39;</span><span class="op">)</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;SUB R&quot;</span><span class="op">);</span></span>
<span id="cb169-17"><a href="#cb169-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>op <span class="op">==</span> <span class="ch">&#39;*&#39;</span><span class="op">)</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;MUL R&quot;</span><span class="op">);</span></span>
<span id="cb169-18"><a href="#cb169-18" aria-hidden="true" tabindex="-1"></a>    append_num<span class="op">(</span>buf<span class="op">,</span> rd<span class="op">);</span></span>
<span id="cb169-19"><a href="#cb169-19" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;, R&quot;</span><span class="op">);</span></span>
<span id="cb169-20"><a href="#cb169-20" aria-hidden="true" tabindex="-1"></a>    append_num<span class="op">(</span>buf<span class="op">,</span> rn<span class="op">);</span></span>
<span id="cb169-21"><a href="#cb169-21" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;, R&quot;</span><span class="op">);</span></span>
<span id="cb169-22"><a href="#cb169-22" aria-hidden="true" tabindex="-1"></a>    append_num<span class="op">(</span>buf<span class="op">,</span> rm<span class="op">);</span></span>
<span id="cb169-23"><a href="#cb169-23" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">n&quot;</span><span class="op">);</span></span>
<span id="cb169-24"><a href="#cb169-24" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb169-25"><a href="#cb169-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-26"><a href="#cb169-26" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> check<span class="op">(</span><span class="dt">char</span><span class="op">*</span> a<span class="op">,</span> <span class="dt">char</span><span class="op">*</span> b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb169-27"><a href="#cb169-27" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb169-28"><a href="#cb169-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>a<span class="op">[</span>i<span class="op">]</span> <span class="op">&amp;&amp;</span> b<span class="op">[</span>i<span class="op">])</span> <span class="op">{</span> <span class="cf">if</span> <span class="op">(</span>a<span class="op">[</span>i<span class="op">]</span> <span class="op">!=</span> b<span class="op">[</span>i<span class="op">])</span> <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb169-29"><a href="#cb169-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> a<span class="op">[</span>i<span class="op">]</span> <span class="op">==</span> b<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb169-30"><a href="#cb169-30" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb169-31"><a href="#cb169-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-32"><a href="#cb169-32" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb169-33"><a href="#cb169-33" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> buf<span class="op">[</span><span class="dv">100</span><span class="op">];</span></span>
<span id="cb169-34"><a href="#cb169-34" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> score <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb169-35"><a href="#cb169-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-36"><a href="#cb169-36" aria-hidden="true" tabindex="-1"></a>    buf<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb169-37"><a href="#cb169-37" aria-hidden="true" tabindex="-1"></a>    emit_op<span class="op">(</span>buf<span class="op">,</span> <span class="ch">&#39;+&#39;</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb169-38"><a href="#cb169-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>check<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;ADD R0, R1, R2</span><span class="sc">\\</span><span class="st">n&quot;</span><span class="op">))</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb169-39"><a href="#cb169-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-40"><a href="#cb169-40" aria-hidden="true" tabindex="-1"></a>    buf<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb169-41"><a href="#cb169-41" aria-hidden="true" tabindex="-1"></a>    emit_op<span class="op">(</span>buf<span class="op">,</span> <span class="ch">&#39;-&#39;</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb169-42"><a href="#cb169-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>check<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;SUB R0, R0, R1</span><span class="sc">\\</span><span class="st">n&quot;</span><span class="op">))</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb169-43"><a href="#cb169-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-44"><a href="#cb169-44" aria-hidden="true" tabindex="-1"></a>    buf<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb169-45"><a href="#cb169-45" aria-hidden="true" tabindex="-1"></a>    emit_op<span class="op">(</span>buf<span class="op">,</span> <span class="ch">&#39;*&#39;</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">4</span><span class="op">);</span></span>
<span id="cb169-46"><a href="#cb169-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>check<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;MUL R2, R3, R4</span><span class="sc">\\</span><span class="st">n&quot;</span><span class="op">))</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb169-47"><a href="#cb169-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-48"><a href="#cb169-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score<span class="op">;</span></span>
<span id="cb169-49"><a href="#cb169-49" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.4.10" id="émettre-pushpop"><span class="header-section-number">2.4.10</span> 3.3 Émettre PUSH/POP</h3>
<div class="sourceCode" id="cb170"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> strlen<span class="op">(</span><span class="dt">char</span><span class="op">*</span> s<span class="op">)</span> <span class="op">{</span> <span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> <span class="cf">while</span> <span class="op">(</span>s<span class="op">[</span>i<span class="op">])</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> <span class="cf">return</span> i<span class="op">;</span> <span class="op">}</span></span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> append<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">char</span><span class="op">*</span> s<span class="op">)</span> <span class="op">{</span></span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i <span class="op">=</span> strlen<span class="op">(</span>buf<span class="op">);</span> <span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>s<span class="op">[</span>j<span class="op">])</span> <span class="op">{</span> buf<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> s<span class="op">[</span>j<span class="op">];</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> j <span class="op">=</span> j <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb170-5"><a href="#cb170-5" aria-hidden="true" tabindex="-1"></a>    buf<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb170-6"><a href="#cb170-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb170-7"><a href="#cb170-7" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> append_num<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb170-8"><a href="#cb170-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;0&quot;</span><span class="op">);</span> <span class="cf">return</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb170-9"><a href="#cb170-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> tmp<span class="op">[</span><span class="dv">12</span><span class="op">];</span> <span class="dt">int</span> i <span class="op">=</span> <span class="dv">11</span><span class="op">;</span> tmp<span class="op">[</span><span class="dv">11</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb170-10"><a href="#cb170-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>n <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span> i <span class="op">=</span> i <span class="op">-</span> <span class="dv">1</span><span class="op">;</span> tmp<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="ch">&#39;0&#39;</span> <span class="op">+</span> <span class="op">(</span>n <span class="op">%</span> <span class="dv">10</span><span class="op">);</span> n <span class="op">=</span> n <span class="op">/</span> <span class="dv">10</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb170-11"><a href="#cb170-11" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> tmp <span class="op">+</span> i<span class="op">);</span></span>
<span id="cb170-12"><a href="#cb170-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb170-13"><a href="#cb170-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-14"><a href="#cb170-14" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> emit_push<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">int</span> reg<span class="op">)</span> <span class="op">{</span></span>
<span id="cb170-15"><a href="#cb170-15" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;STR R&quot;</span><span class="op">);</span></span>
<span id="cb170-16"><a href="#cb170-16" aria-hidden="true" tabindex="-1"></a>    append_num<span class="op">(</span>buf<span class="op">,</span> reg<span class="op">);</span></span>
<span id="cb170-17"><a href="#cb170-17" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;, [SP, #-4]!</span><span class="sc">\\</span><span class="st">n&quot;</span><span class="op">);</span></span>
<span id="cb170-18"><a href="#cb170-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb170-19"><a href="#cb170-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-20"><a href="#cb170-20" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> emit_pop<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">int</span> reg<span class="op">)</span> <span class="op">{</span></span>
<span id="cb170-21"><a href="#cb170-21" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;LDR R&quot;</span><span class="op">);</span></span>
<span id="cb170-22"><a href="#cb170-22" aria-hidden="true" tabindex="-1"></a>    append_num<span class="op">(</span>buf<span class="op">,</span> reg<span class="op">);</span></span>
<span id="cb170-23"><a href="#cb170-23" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;, [SP], #4</span><span class="sc">\\</span><span class="st">n&quot;</span><span class="op">);</span></span>
<span id="cb170-24"><a href="#cb170-24" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb170-25"><a href="#cb170-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-26"><a href="#cb170-26" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> check<span class="op">(</span><span class="dt">char</span><span class="op">*</span> a<span class="op">,</span> <span class="dt">char</span><span class="op">*</span> b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb170-27"><a href="#cb170-27" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb170-28"><a href="#cb170-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>a<span class="op">[</span>i<span class="op">]</span> <span class="op">&amp;&amp;</span> b<span class="op">[</span>i<span class="op">])</span> <span class="op">{</span> <span class="cf">if</span> <span class="op">(</span>a<span class="op">[</span>i<span class="op">]</span> <span class="op">!=</span> b<span class="op">[</span>i<span class="op">])</span> <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb170-29"><a href="#cb170-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> a<span class="op">[</span>i<span class="op">]</span> <span class="op">==</span> b<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb170-30"><a href="#cb170-30" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb170-31"><a href="#cb170-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-32"><a href="#cb170-32" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb170-33"><a href="#cb170-33" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> buf<span class="op">[</span><span class="dv">100</span><span class="op">];</span></span>
<span id="cb170-34"><a href="#cb170-34" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> score <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb170-35"><a href="#cb170-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-36"><a href="#cb170-36" aria-hidden="true" tabindex="-1"></a>    buf<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb170-37"><a href="#cb170-37" aria-hidden="true" tabindex="-1"></a>    emit_push<span class="op">(</span>buf<span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb170-38"><a href="#cb170-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>check<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;STR R0, [SP, #-4]!</span><span class="sc">\\</span><span class="st">n&quot;</span><span class="op">))</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb170-39"><a href="#cb170-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-40"><a href="#cb170-40" aria-hidden="true" tabindex="-1"></a>    buf<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb170-41"><a href="#cb170-41" aria-hidden="true" tabindex="-1"></a>    emit_pop<span class="op">(</span>buf<span class="op">,</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb170-42"><a href="#cb170-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>check<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;LDR R1, [SP], #4</span><span class="sc">\\</span><span class="st">n&quot;</span><span class="op">))</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb170-43"><a href="#cb170-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-44"><a href="#cb170-44" aria-hidden="true" tabindex="-1"></a>    buf<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb170-45"><a href="#cb170-45" aria-hidden="true" tabindex="-1"></a>    emit_push<span class="op">(</span>buf<span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb170-46"><a href="#cb170-46" aria-hidden="true" tabindex="-1"></a>    emit_pop<span class="op">(</span>buf<span class="op">,</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb170-47"><a href="#cb170-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>check<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;STR R0, [SP, #-4]!</span><span class="sc">\\</span><span class="st">nLDR R1, [SP], #4</span><span class="sc">\\</span><span class="st">n&quot;</span><span class="op">))</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb170-48"><a href="#cb170-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-49"><a href="#cb170-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score<span class="op">;</span></span>
<span id="cb170-50"><a href="#cb170-50" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.4.11" id="compiler-une-constante"><span class="header-section-number">2.4.11</span> 4.1 Compiler une
Constante</h3>
<div class="sourceCode" id="cb171"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> strlen<span class="op">(</span><span class="dt">char</span><span class="op">*</span> s<span class="op">)</span> <span class="op">{</span> <span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> <span class="cf">while</span> <span class="op">(</span>s<span class="op">[</span>i<span class="op">])</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> <span class="cf">return</span> i<span class="op">;</span> <span class="op">}</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> append<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">char</span><span class="op">*</span> s<span class="op">)</span> <span class="op">{</span></span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i <span class="op">=</span> strlen<span class="op">(</span>buf<span class="op">);</span> <span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>s<span class="op">[</span>j<span class="op">])</span> <span class="op">{</span> buf<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> s<span class="op">[</span>j<span class="op">];</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> j <span class="op">=</span> j <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a>    buf<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb171-7"><a href="#cb171-7" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> append_num<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb171-8"><a href="#cb171-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;0&quot;</span><span class="op">);</span> <span class="cf">return</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb171-9"><a href="#cb171-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> tmp<span class="op">[</span><span class="dv">12</span><span class="op">];</span> <span class="dt">int</span> i <span class="op">=</span> <span class="dv">11</span><span class="op">;</span> tmp<span class="op">[</span><span class="dv">11</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb171-10"><a href="#cb171-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>n <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span> i <span class="op">=</span> i <span class="op">-</span> <span class="dv">1</span><span class="op">;</span> tmp<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="ch">&#39;0&#39;</span> <span class="op">+</span> <span class="op">(</span>n <span class="op">%</span> <span class="dv">10</span><span class="op">);</span> n <span class="op">=</span> n <span class="op">/</span> <span class="dv">10</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb171-11"><a href="#cb171-11" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> tmp <span class="op">+</span> i<span class="op">);</span></span>
<span id="cb171-12"><a href="#cb171-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb171-13"><a href="#cb171-13" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> emit_mov<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">int</span> reg<span class="op">,</span> <span class="dt">int</span> val<span class="op">)</span> <span class="op">{</span></span>
<span id="cb171-14"><a href="#cb171-14" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;MOV R&quot;</span><span class="op">);</span> append_num<span class="op">(</span>buf<span class="op">,</span> reg<span class="op">);</span></span>
<span id="cb171-15"><a href="#cb171-15" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;, #&quot;</span><span class="op">);</span> append_num<span class="op">(</span>buf<span class="op">,</span> val<span class="op">);</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">n&quot;</span><span class="op">);</span></span>
<span id="cb171-16"><a href="#cb171-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb171-17"><a href="#cb171-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-18"><a href="#cb171-18" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> is_digit<span class="op">(</span><span class="dt">char</span> c<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> c <span class="op">&gt;=</span> <span class="ch">&#39;0&#39;</span> <span class="op">&amp;&amp;</span> c <span class="op">&lt;=</span> <span class="ch">&#39;9&#39;</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb171-19"><a href="#cb171-19" aria-hidden="true" tabindex="-1"></a><span class="dt">char</span><span class="op">*</span> input<span class="op">;</span></span>
<span id="cb171-20"><a href="#cb171-20" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> pos<span class="op">;</span></span>
<span id="cb171-21"><a href="#cb171-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-22"><a href="#cb171-22" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> parse_num<span class="op">()</span> <span class="op">{</span></span>
<span id="cb171-23"><a href="#cb171-23" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> v <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb171-24"><a href="#cb171-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>is_digit<span class="op">(</span>input<span class="op">[</span>pos<span class="op">]))</span> <span class="op">{</span> v <span class="op">=</span> v <span class="op">*</span> <span class="dv">10</span> <span class="op">+</span> <span class="op">(</span>input<span class="op">[</span>pos<span class="op">]</span> <span class="op">-</span> <span class="ch">&#39;0&#39;</span><span class="op">);</span> pos <span class="op">=</span> pos <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb171-25"><a href="#cb171-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> v<span class="op">;</span></span>
<span id="cb171-26"><a href="#cb171-26" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb171-27"><a href="#cb171-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-28"><a href="#cb171-28" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> codegen_const<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">)</span> <span class="op">{</span></span>
<span id="cb171-29"><a href="#cb171-29" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> n <span class="op">=</span> parse_num<span class="op">();</span></span>
<span id="cb171-30"><a href="#cb171-30" aria-hidden="true" tabindex="-1"></a>    emit_mov<span class="op">(</span>buf<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> n<span class="op">);</span></span>
<span id="cb171-31"><a href="#cb171-31" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb171-32"><a href="#cb171-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-33"><a href="#cb171-33" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> check<span class="op">(</span><span class="dt">char</span><span class="op">*</span> a<span class="op">,</span> <span class="dt">char</span><span class="op">*</span> b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb171-34"><a href="#cb171-34" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb171-35"><a href="#cb171-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>a<span class="op">[</span>i<span class="op">]</span> <span class="op">&amp;&amp;</span> b<span class="op">[</span>i<span class="op">])</span> <span class="op">{</span> <span class="cf">if</span> <span class="op">(</span>a<span class="op">[</span>i<span class="op">]</span> <span class="op">!=</span> b<span class="op">[</span>i<span class="op">])</span> <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb171-36"><a href="#cb171-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> a<span class="op">[</span>i<span class="op">]</span> <span class="op">==</span> b<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb171-37"><a href="#cb171-37" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb171-38"><a href="#cb171-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-39"><a href="#cb171-39" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb171-40"><a href="#cb171-40" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> buf<span class="op">[</span><span class="dv">100</span><span class="op">];</span></span>
<span id="cb171-41"><a href="#cb171-41" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> score <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb171-42"><a href="#cb171-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-43"><a href="#cb171-43" aria-hidden="true" tabindex="-1"></a>    buf<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> input <span class="op">=</span> <span class="st">&quot;42&quot;</span><span class="op">;</span> pos <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb171-44"><a href="#cb171-44" aria-hidden="true" tabindex="-1"></a>    codegen_const<span class="op">(</span>buf<span class="op">);</span></span>
<span id="cb171-45"><a href="#cb171-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>check<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;MOV R0, #42</span><span class="sc">\\</span><span class="st">n&quot;</span><span class="op">))</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb171-46"><a href="#cb171-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-47"><a href="#cb171-47" aria-hidden="true" tabindex="-1"></a>    buf<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> input <span class="op">=</span> <span class="st">&quot;5&quot;</span><span class="op">;</span> pos <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb171-48"><a href="#cb171-48" aria-hidden="true" tabindex="-1"></a>    codegen_const<span class="op">(</span>buf<span class="op">);</span></span>
<span id="cb171-49"><a href="#cb171-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>check<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;MOV R0, #5</span><span class="sc">\\</span><span class="st">n&quot;</span><span class="op">))</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb171-50"><a href="#cb171-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-51"><a href="#cb171-51" aria-hidden="true" tabindex="-1"></a>    buf<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> input <span class="op">=</span> <span class="st">&quot;123&quot;</span><span class="op">;</span> pos <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb171-52"><a href="#cb171-52" aria-hidden="true" tabindex="-1"></a>    codegen_const<span class="op">(</span>buf<span class="op">);</span></span>
<span id="cb171-53"><a href="#cb171-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>check<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;MOV R0, #123</span><span class="sc">\\</span><span class="st">n&quot;</span><span class="op">))</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb171-54"><a href="#cb171-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-55"><a href="#cb171-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score<span class="op">;</span></span>
<span id="cb171-56"><a href="#cb171-56" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.4.12" id="compiler-a-b"><span class="header-section-number">2.4.12</span> 4.2 Compiler a + b</h3>
<div class="sourceCode" id="cb172"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> strlen<span class="op">(</span><span class="dt">char</span><span class="op">*</span> s<span class="op">)</span> <span class="op">{</span> <span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> <span class="cf">while</span> <span class="op">(</span>s<span class="op">[</span>i<span class="op">])</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> <span class="cf">return</span> i<span class="op">;</span> <span class="op">}</span></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> append<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">char</span><span class="op">*</span> s<span class="op">)</span> <span class="op">{</span></span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i <span class="op">=</span> strlen<span class="op">(</span>buf<span class="op">);</span> <span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>s<span class="op">[</span>j<span class="op">])</span> <span class="op">{</span> buf<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> s<span class="op">[</span>j<span class="op">];</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> j <span class="op">=</span> j <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> <span class="op">}</span> buf<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb172-5"><a href="#cb172-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb172-6"><a href="#cb172-6" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> append_num<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb172-7"><a href="#cb172-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;0&quot;</span><span class="op">);</span> <span class="cf">return</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb172-8"><a href="#cb172-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> tmp<span class="op">[</span><span class="dv">12</span><span class="op">];</span> <span class="dt">int</span> i <span class="op">=</span> <span class="dv">11</span><span class="op">;</span> tmp<span class="op">[</span><span class="dv">11</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb172-9"><a href="#cb172-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>n <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span> i <span class="op">=</span> i <span class="op">-</span> <span class="dv">1</span><span class="op">;</span> tmp<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="ch">&#39;0&#39;</span> <span class="op">+</span> <span class="op">(</span>n <span class="op">%</span> <span class="dv">10</span><span class="op">);</span> n <span class="op">=</span> n <span class="op">/</span> <span class="dv">10</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb172-10"><a href="#cb172-10" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> tmp <span class="op">+</span> i<span class="op">);</span></span>
<span id="cb172-11"><a href="#cb172-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb172-12"><a href="#cb172-12" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> emit_mov<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">int</span> reg<span class="op">,</span> <span class="dt">int</span> val<span class="op">)</span> <span class="op">{</span></span>
<span id="cb172-13"><a href="#cb172-13" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;MOV R&quot;</span><span class="op">);</span> append_num<span class="op">(</span>buf<span class="op">,</span> reg<span class="op">);</span></span>
<span id="cb172-14"><a href="#cb172-14" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;, #&quot;</span><span class="op">);</span> append_num<span class="op">(</span>buf<span class="op">,</span> val<span class="op">);</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">n&quot;</span><span class="op">);</span></span>
<span id="cb172-15"><a href="#cb172-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb172-16"><a href="#cb172-16" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> emit_push<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">int</span> reg<span class="op">)</span> <span class="op">{</span></span>
<span id="cb172-17"><a href="#cb172-17" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;STR R&quot;</span><span class="op">);</span> append_num<span class="op">(</span>buf<span class="op">,</span> reg<span class="op">);</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;, [SP, #-4]!</span><span class="sc">\\</span><span class="st">n&quot;</span><span class="op">);</span></span>
<span id="cb172-18"><a href="#cb172-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb172-19"><a href="#cb172-19" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> emit_pop<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">int</span> reg<span class="op">)</span> <span class="op">{</span></span>
<span id="cb172-20"><a href="#cb172-20" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;LDR R&quot;</span><span class="op">);</span> append_num<span class="op">(</span>buf<span class="op">,</span> reg<span class="op">);</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;, [SP], #4</span><span class="sc">\\</span><span class="st">n&quot;</span><span class="op">);</span></span>
<span id="cb172-21"><a href="#cb172-21" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb172-22"><a href="#cb172-22" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> emit_op<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">char</span> op<span class="op">,</span> <span class="dt">int</span> rd<span class="op">,</span> <span class="dt">int</span> rn<span class="op">,</span> <span class="dt">int</span> rm<span class="op">)</span> <span class="op">{</span></span>
<span id="cb172-23"><a href="#cb172-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>op <span class="op">==</span> <span class="ch">&#39;+&#39;</span><span class="op">)</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;ADD R&quot;</span><span class="op">);</span></span>
<span id="cb172-24"><a href="#cb172-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>op <span class="op">==</span> <span class="ch">&#39;-&#39;</span><span class="op">)</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;SUB R&quot;</span><span class="op">);</span></span>
<span id="cb172-25"><a href="#cb172-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>op <span class="op">==</span> <span class="ch">&#39;*&#39;</span><span class="op">)</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;MUL R&quot;</span><span class="op">);</span></span>
<span id="cb172-26"><a href="#cb172-26" aria-hidden="true" tabindex="-1"></a>    append_num<span class="op">(</span>buf<span class="op">,</span> rd<span class="op">);</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;, R&quot;</span><span class="op">);</span> append_num<span class="op">(</span>buf<span class="op">,</span> rn<span class="op">);</span></span>
<span id="cb172-27"><a href="#cb172-27" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;, R&quot;</span><span class="op">);</span> append_num<span class="op">(</span>buf<span class="op">,</span> rm<span class="op">);</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">n&quot;</span><span class="op">);</span></span>
<span id="cb172-28"><a href="#cb172-28" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb172-29"><a href="#cb172-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-30"><a href="#cb172-30" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> is_digit<span class="op">(</span><span class="dt">char</span> c<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> c <span class="op">&gt;=</span> <span class="ch">&#39;0&#39;</span> <span class="op">&amp;&amp;</span> c <span class="op">&lt;=</span> <span class="ch">&#39;9&#39;</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb172-31"><a href="#cb172-31" aria-hidden="true" tabindex="-1"></a><span class="dt">char</span><span class="op">*</span> input<span class="op">;</span></span>
<span id="cb172-32"><a href="#cb172-32" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> pos<span class="op">;</span></span>
<span id="cb172-33"><a href="#cb172-33" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> skip<span class="op">()</span> <span class="op">{</span> <span class="cf">while</span> <span class="op">(</span>input<span class="op">[</span>pos<span class="op">]</span> <span class="op">==</span> <span class="ch">&#39; &#39;</span><span class="op">)</span> pos <span class="op">=</span> pos <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb172-34"><a href="#cb172-34" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> parse_num<span class="op">()</span> <span class="op">{</span></span>
<span id="cb172-35"><a href="#cb172-35" aria-hidden="true" tabindex="-1"></a>    skip<span class="op">();</span></span>
<span id="cb172-36"><a href="#cb172-36" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> v <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb172-37"><a href="#cb172-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>is_digit<span class="op">(</span>input<span class="op">[</span>pos<span class="op">]))</span> <span class="op">{</span> v <span class="op">=</span> v <span class="op">*</span> <span class="dv">10</span> <span class="op">+</span> <span class="op">(</span>input<span class="op">[</span>pos<span class="op">]</span> <span class="op">-</span> <span class="ch">&#39;0&#39;</span><span class="op">);</span> pos <span class="op">=</span> pos <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb172-38"><a href="#cb172-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> v<span class="op">;</span></span>
<span id="cb172-39"><a href="#cb172-39" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb172-40"><a href="#cb172-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-41"><a href="#cb172-41" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> codegen_binop<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">)</span> <span class="op">{</span></span>
<span id="cb172-42"><a href="#cb172-42" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> a <span class="op">=</span> parse_num<span class="op">();</span></span>
<span id="cb172-43"><a href="#cb172-43" aria-hidden="true" tabindex="-1"></a>    emit_mov<span class="op">(</span>buf<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> a<span class="op">);</span></span>
<span id="cb172-44"><a href="#cb172-44" aria-hidden="true" tabindex="-1"></a>    emit_push<span class="op">(</span>buf<span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb172-45"><a href="#cb172-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-46"><a href="#cb172-46" aria-hidden="true" tabindex="-1"></a>    skip<span class="op">();</span></span>
<span id="cb172-47"><a href="#cb172-47" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> op <span class="op">=</span> input<span class="op">[</span>pos<span class="op">];</span></span>
<span id="cb172-48"><a href="#cb172-48" aria-hidden="true" tabindex="-1"></a>    pos <span class="op">=</span> pos <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb172-49"><a href="#cb172-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-50"><a href="#cb172-50" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> b <span class="op">=</span> parse_num<span class="op">();</span></span>
<span id="cb172-51"><a href="#cb172-51" aria-hidden="true" tabindex="-1"></a>    emit_mov<span class="op">(</span>buf<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> b<span class="op">);</span></span>
<span id="cb172-52"><a href="#cb172-52" aria-hidden="true" tabindex="-1"></a>    emit_pop<span class="op">(</span>buf<span class="op">,</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb172-53"><a href="#cb172-53" aria-hidden="true" tabindex="-1"></a>    emit_op<span class="op">(</span>buf<span class="op">,</span> op<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb172-54"><a href="#cb172-54" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb172-55"><a href="#cb172-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-56"><a href="#cb172-56" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> contains<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">char</span><span class="op">*</span> sub<span class="op">)</span> <span class="op">{</span></span>
<span id="cb172-57"><a href="#cb172-57" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb172-58"><a href="#cb172-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>buf<span class="op">[</span>i<span class="op">])</span> <span class="op">{</span></span>
<span id="cb172-59"><a href="#cb172-59" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb172-60"><a href="#cb172-60" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="op">(</span>sub<span class="op">[</span>j<span class="op">]</span> <span class="op">&amp;&amp;</span> buf<span class="op">[</span>i<span class="op">+</span>j<span class="op">]</span> <span class="op">==</span> sub<span class="op">[</span>j<span class="op">])</span> j <span class="op">=</span> j <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb172-61"><a href="#cb172-61" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>sub<span class="op">[</span>j<span class="op">]</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb172-62"><a href="#cb172-62" aria-hidden="true" tabindex="-1"></a>        i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb172-63"><a href="#cb172-63" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb172-64"><a href="#cb172-64" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb172-65"><a href="#cb172-65" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb172-66"><a href="#cb172-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-67"><a href="#cb172-67" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb172-68"><a href="#cb172-68" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> buf<span class="op">[</span><span class="dv">200</span><span class="op">];</span></span>
<span id="cb172-69"><a href="#cb172-69" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> score <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb172-70"><a href="#cb172-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-71"><a href="#cb172-71" aria-hidden="true" tabindex="-1"></a>    buf<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> input <span class="op">=</span> <span class="st">&quot;3 + 5&quot;</span><span class="op">;</span> pos <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb172-72"><a href="#cb172-72" aria-hidden="true" tabindex="-1"></a>    codegen_binop<span class="op">(</span>buf<span class="op">);</span></span>
<span id="cb172-73"><a href="#cb172-73" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>contains<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;MOV R0, #3&quot;</span><span class="op">)</span> <span class="op">&amp;&amp;</span> contains<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;MOV R0, #5&quot;</span><span class="op">)</span> <span class="op">&amp;&amp;</span></span>
<span id="cb172-74"><a href="#cb172-74" aria-hidden="true" tabindex="-1"></a>        contains<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;ADD R0&quot;</span><span class="op">))</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb172-75"><a href="#cb172-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-76"><a href="#cb172-76" aria-hidden="true" tabindex="-1"></a>    buf<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> input <span class="op">=</span> <span class="st">&quot;10 - 4&quot;</span><span class="op">;</span> pos <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb172-77"><a href="#cb172-77" aria-hidden="true" tabindex="-1"></a>    codegen_binop<span class="op">(</span>buf<span class="op">);</span></span>
<span id="cb172-78"><a href="#cb172-78" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>contains<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;MOV R0, #10&quot;</span><span class="op">)</span> <span class="op">&amp;&amp;</span> contains<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;SUB R0&quot;</span><span class="op">))</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb172-79"><a href="#cb172-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-80"><a href="#cb172-80" aria-hidden="true" tabindex="-1"></a>    buf<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> input <span class="op">=</span> <span class="st">&quot;6 * 7&quot;</span><span class="op">;</span> pos <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb172-81"><a href="#cb172-81" aria-hidden="true" tabindex="-1"></a>    codegen_binop<span class="op">(</span>buf<span class="op">);</span></span>
<span id="cb172-82"><a href="#cb172-82" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>contains<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;MUL R0&quot;</span><span class="op">))</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb172-83"><a href="#cb172-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-84"><a href="#cb172-84" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score<span class="op">;</span></span>
<span id="cb172-85"><a href="#cb172-85" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.4.13" id="compiler-expressions-complètes"><span class="header-section-number">2.4.13</span> 4.3 Compiler Expressions
Complètes</h3>
<div class="sourceCode" id="cb173"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> strlen<span class="op">(</span><span class="dt">char</span><span class="op">*</span> s<span class="op">)</span> <span class="op">{</span> <span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> <span class="cf">while</span> <span class="op">(</span>s<span class="op">[</span>i<span class="op">])</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> <span class="cf">return</span> i<span class="op">;</span> <span class="op">}</span></span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> append<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">char</span><span class="op">*</span> s<span class="op">)</span> <span class="op">{</span></span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i <span class="op">=</span> strlen<span class="op">(</span>buf<span class="op">);</span> <span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>s<span class="op">[</span>j<span class="op">])</span> <span class="op">{</span> buf<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> s<span class="op">[</span>j<span class="op">];</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> j <span class="op">=</span> j <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> <span class="op">}</span> buf<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb173-6"><a href="#cb173-6" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> append_num<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb173-7"><a href="#cb173-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;0&quot;</span><span class="op">);</span> <span class="cf">return</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb173-8"><a href="#cb173-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> tmp<span class="op">[</span><span class="dv">12</span><span class="op">];</span> <span class="dt">int</span> i <span class="op">=</span> <span class="dv">11</span><span class="op">;</span> tmp<span class="op">[</span><span class="dv">11</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb173-9"><a href="#cb173-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>n <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span> i <span class="op">=</span> i <span class="op">-</span> <span class="dv">1</span><span class="op">;</span> tmp<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="ch">&#39;0&#39;</span> <span class="op">+</span> <span class="op">(</span>n <span class="op">%</span> <span class="dv">10</span><span class="op">);</span> n <span class="op">=</span> n <span class="op">/</span> <span class="dv">10</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb173-10"><a href="#cb173-10" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> tmp <span class="op">+</span> i<span class="op">);</span></span>
<span id="cb173-11"><a href="#cb173-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb173-12"><a href="#cb173-12" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> emit_mov<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">int</span> reg<span class="op">,</span> <span class="dt">int</span> val<span class="op">)</span> <span class="op">{</span></span>
<span id="cb173-13"><a href="#cb173-13" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;MOV R&quot;</span><span class="op">);</span> append_num<span class="op">(</span>buf<span class="op">,</span> reg<span class="op">);</span></span>
<span id="cb173-14"><a href="#cb173-14" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;, #&quot;</span><span class="op">);</span> append_num<span class="op">(</span>buf<span class="op">,</span> val<span class="op">);</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">n&quot;</span><span class="op">);</span></span>
<span id="cb173-15"><a href="#cb173-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb173-16"><a href="#cb173-16" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> emit_push<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">int</span> reg<span class="op">)</span> <span class="op">{</span></span>
<span id="cb173-17"><a href="#cb173-17" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;STR R&quot;</span><span class="op">);</span> append_num<span class="op">(</span>buf<span class="op">,</span> reg<span class="op">);</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;, [SP, #-4]!</span><span class="sc">\\</span><span class="st">n&quot;</span><span class="op">);</span></span>
<span id="cb173-18"><a href="#cb173-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb173-19"><a href="#cb173-19" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> emit_pop<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">int</span> reg<span class="op">)</span> <span class="op">{</span></span>
<span id="cb173-20"><a href="#cb173-20" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;LDR R&quot;</span><span class="op">);</span> append_num<span class="op">(</span>buf<span class="op">,</span> reg<span class="op">);</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;, [SP], #4</span><span class="sc">\\</span><span class="st">n&quot;</span><span class="op">);</span></span>
<span id="cb173-21"><a href="#cb173-21" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb173-22"><a href="#cb173-22" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> emit_op<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">char</span> op<span class="op">,</span> <span class="dt">int</span> rd<span class="op">,</span> <span class="dt">int</span> rn<span class="op">,</span> <span class="dt">int</span> rm<span class="op">)</span> <span class="op">{</span></span>
<span id="cb173-23"><a href="#cb173-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>op <span class="op">==</span> <span class="ch">&#39;+&#39;</span><span class="op">)</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;ADD R&quot;</span><span class="op">);</span></span>
<span id="cb173-24"><a href="#cb173-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>op <span class="op">==</span> <span class="ch">&#39;-&#39;</span><span class="op">)</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;SUB R&quot;</span><span class="op">);</span></span>
<span id="cb173-25"><a href="#cb173-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>op <span class="op">==</span> <span class="ch">&#39;*&#39;</span><span class="op">)</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;MUL R&quot;</span><span class="op">);</span></span>
<span id="cb173-26"><a href="#cb173-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>op <span class="op">==</span> <span class="ch">&#39;/&#39;</span><span class="op">)</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;SDIV R&quot;</span><span class="op">);</span></span>
<span id="cb173-27"><a href="#cb173-27" aria-hidden="true" tabindex="-1"></a>    append_num<span class="op">(</span>buf<span class="op">,</span> rd<span class="op">);</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;, R&quot;</span><span class="op">);</span> append_num<span class="op">(</span>buf<span class="op">,</span> rn<span class="op">);</span></span>
<span id="cb173-28"><a href="#cb173-28" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;, R&quot;</span><span class="op">);</span> append_num<span class="op">(</span>buf<span class="op">,</span> rm<span class="op">);</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">n&quot;</span><span class="op">);</span></span>
<span id="cb173-29"><a href="#cb173-29" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb173-30"><a href="#cb173-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-31"><a href="#cb173-31" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> is_digit<span class="op">(</span><span class="dt">char</span> c<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> c <span class="op">&gt;=</span> <span class="ch">&#39;0&#39;</span> <span class="op">&amp;&amp;</span> c <span class="op">&lt;=</span> <span class="ch">&#39;9&#39;</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb173-32"><a href="#cb173-32" aria-hidden="true" tabindex="-1"></a><span class="dt">char</span><span class="op">*</span> input<span class="op">;</span></span>
<span id="cb173-33"><a href="#cb173-33" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> pos<span class="op">;</span></span>
<span id="cb173-34"><a href="#cb173-34" aria-hidden="true" tabindex="-1"></a><span class="dt">char</span><span class="op">*</span> out<span class="op">;</span></span>
<span id="cb173-35"><a href="#cb173-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-36"><a href="#cb173-36" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> skip<span class="op">()</span> <span class="op">{</span> <span class="cf">while</span> <span class="op">(</span>input<span class="op">[</span>pos<span class="op">]</span> <span class="op">==</span> <span class="ch">&#39; &#39;</span><span class="op">)</span> pos <span class="op">=</span> pos <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb173-37"><a href="#cb173-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-38"><a href="#cb173-38" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> codegen_expr<span class="op">();</span></span>
<span id="cb173-39"><a href="#cb173-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-40"><a href="#cb173-40" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> codegen_factor<span class="op">()</span> <span class="op">{</span></span>
<span id="cb173-41"><a href="#cb173-41" aria-hidden="true" tabindex="-1"></a>    skip<span class="op">();</span></span>
<span id="cb173-42"><a href="#cb173-42" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> v <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb173-43"><a href="#cb173-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>is_digit<span class="op">(</span>input<span class="op">[</span>pos<span class="op">]))</span> <span class="op">{</span> v <span class="op">=</span> v <span class="op">*</span> <span class="dv">10</span> <span class="op">+</span> <span class="op">(</span>input<span class="op">[</span>pos<span class="op">]</span> <span class="op">-</span> <span class="ch">&#39;0&#39;</span><span class="op">);</span> pos <span class="op">=</span> pos <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb173-44"><a href="#cb173-44" aria-hidden="true" tabindex="-1"></a>    emit_mov<span class="op">(</span>out<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> v<span class="op">);</span></span>
<span id="cb173-45"><a href="#cb173-45" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb173-46"><a href="#cb173-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-47"><a href="#cb173-47" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> codegen_term<span class="op">()</span> <span class="op">{</span></span>
<span id="cb173-48"><a href="#cb173-48" aria-hidden="true" tabindex="-1"></a>    codegen_factor<span class="op">();</span></span>
<span id="cb173-49"><a href="#cb173-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span><span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb173-50"><a href="#cb173-50" aria-hidden="true" tabindex="-1"></a>        skip<span class="op">();</span></span>
<span id="cb173-51"><a href="#cb173-51" aria-hidden="true" tabindex="-1"></a>        <span class="dt">char</span> op <span class="op">=</span> input<span class="op">[</span>pos<span class="op">];</span></span>
<span id="cb173-52"><a href="#cb173-52" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>op <span class="op">!=</span> <span class="ch">&#39;*&#39;</span> <span class="op">&amp;&amp;</span> op <span class="op">!=</span> <span class="ch">&#39;/&#39;</span><span class="op">)</span> <span class="cf">break</span><span class="op">;</span></span>
<span id="cb173-53"><a href="#cb173-53" aria-hidden="true" tabindex="-1"></a>        pos <span class="op">=</span> pos <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb173-54"><a href="#cb173-54" aria-hidden="true" tabindex="-1"></a>        emit_push<span class="op">(</span>out<span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb173-55"><a href="#cb173-55" aria-hidden="true" tabindex="-1"></a>        codegen_factor<span class="op">();</span></span>
<span id="cb173-56"><a href="#cb173-56" aria-hidden="true" tabindex="-1"></a>        emit_pop<span class="op">(</span>out<span class="op">,</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb173-57"><a href="#cb173-57" aria-hidden="true" tabindex="-1"></a>        emit_op<span class="op">(</span>out<span class="op">,</span> op<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb173-58"><a href="#cb173-58" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb173-59"><a href="#cb173-59" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb173-60"><a href="#cb173-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-61"><a href="#cb173-61" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> codegen_expr<span class="op">()</span> <span class="op">{</span></span>
<span id="cb173-62"><a href="#cb173-62" aria-hidden="true" tabindex="-1"></a>    codegen_term<span class="op">();</span></span>
<span id="cb173-63"><a href="#cb173-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span><span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb173-64"><a href="#cb173-64" aria-hidden="true" tabindex="-1"></a>        skip<span class="op">();</span></span>
<span id="cb173-65"><a href="#cb173-65" aria-hidden="true" tabindex="-1"></a>        <span class="dt">char</span> op <span class="op">=</span> input<span class="op">[</span>pos<span class="op">];</span></span>
<span id="cb173-66"><a href="#cb173-66" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>op <span class="op">!=</span> <span class="ch">&#39;+&#39;</span> <span class="op">&amp;&amp;</span> op <span class="op">!=</span> <span class="ch">&#39;-&#39;</span><span class="op">)</span> <span class="cf">break</span><span class="op">;</span></span>
<span id="cb173-67"><a href="#cb173-67" aria-hidden="true" tabindex="-1"></a>        pos <span class="op">=</span> pos <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb173-68"><a href="#cb173-68" aria-hidden="true" tabindex="-1"></a>        emit_push<span class="op">(</span>out<span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb173-69"><a href="#cb173-69" aria-hidden="true" tabindex="-1"></a>        codegen_term<span class="op">();</span></span>
<span id="cb173-70"><a href="#cb173-70" aria-hidden="true" tabindex="-1"></a>        emit_pop<span class="op">(</span>out<span class="op">,</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb173-71"><a href="#cb173-71" aria-hidden="true" tabindex="-1"></a>        emit_op<span class="op">(</span>out<span class="op">,</span> op<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb173-72"><a href="#cb173-72" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb173-73"><a href="#cb173-73" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb173-74"><a href="#cb173-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-75"><a href="#cb173-75" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> compile<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">char</span><span class="op">*</span> src<span class="op">)</span> <span class="op">{</span></span>
<span id="cb173-76"><a href="#cb173-76" aria-hidden="true" tabindex="-1"></a>    out <span class="op">=</span> buf<span class="op">;</span></span>
<span id="cb173-77"><a href="#cb173-77" aria-hidden="true" tabindex="-1"></a>    input <span class="op">=</span> src<span class="op">;</span></span>
<span id="cb173-78"><a href="#cb173-78" aria-hidden="true" tabindex="-1"></a>    pos <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb173-79"><a href="#cb173-79" aria-hidden="true" tabindex="-1"></a>    buf<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb173-80"><a href="#cb173-80" aria-hidden="true" tabindex="-1"></a>    codegen_expr<span class="op">();</span></span>
<span id="cb173-81"><a href="#cb173-81" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb173-82"><a href="#cb173-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-83"><a href="#cb173-83" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> contains<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">char</span><span class="op">*</span> sub<span class="op">)</span> <span class="op">{</span></span>
<span id="cb173-84"><a href="#cb173-84" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb173-85"><a href="#cb173-85" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>buf<span class="op">[</span>i<span class="op">])</span> <span class="op">{</span></span>
<span id="cb173-86"><a href="#cb173-86" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> <span class="cf">while</span> <span class="op">(</span>sub<span class="op">[</span>j<span class="op">]</span> <span class="op">&amp;&amp;</span> buf<span class="op">[</span>i<span class="op">+</span>j<span class="op">]</span> <span class="op">==</span> sub<span class="op">[</span>j<span class="op">])</span> j <span class="op">=</span> j <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb173-87"><a href="#cb173-87" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>sub<span class="op">[</span>j<span class="op">]</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb173-88"><a href="#cb173-88" aria-hidden="true" tabindex="-1"></a>        i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb173-89"><a href="#cb173-89" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb173-90"><a href="#cb173-90" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb173-91"><a href="#cb173-91" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb173-92"><a href="#cb173-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-93"><a href="#cb173-93" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> count<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">char</span><span class="op">*</span> sub<span class="op">)</span> <span class="op">{</span></span>
<span id="cb173-94"><a href="#cb173-94" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> c <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb173-95"><a href="#cb173-95" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>buf<span class="op">[</span>i<span class="op">])</span> <span class="op">{</span></span>
<span id="cb173-96"><a href="#cb173-96" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> <span class="cf">while</span> <span class="op">(</span>sub<span class="op">[</span>j<span class="op">]</span> <span class="op">&amp;&amp;</span> buf<span class="op">[</span>i<span class="op">+</span>j<span class="op">]</span> <span class="op">==</span> sub<span class="op">[</span>j<span class="op">])</span> j <span class="op">=</span> j <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb173-97"><a href="#cb173-97" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>sub<span class="op">[</span>j<span class="op">]</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> c <span class="op">=</span> c <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb173-98"><a href="#cb173-98" aria-hidden="true" tabindex="-1"></a>        i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb173-99"><a href="#cb173-99" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb173-100"><a href="#cb173-100" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> c<span class="op">;</span></span>
<span id="cb173-101"><a href="#cb173-101" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb173-102"><a href="#cb173-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-103"><a href="#cb173-103" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb173-104"><a href="#cb173-104" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> buf<span class="op">[</span><span class="dv">500</span><span class="op">];</span></span>
<span id="cb173-105"><a href="#cb173-105" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> score <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb173-106"><a href="#cb173-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-107"><a href="#cb173-107" aria-hidden="true" tabindex="-1"></a>    compile<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;42&quot;</span><span class="op">);</span></span>
<span id="cb173-108"><a href="#cb173-108" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>contains<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;MOV R0, #42&quot;</span><span class="op">))</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb173-109"><a href="#cb173-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-110"><a href="#cb173-110" aria-hidden="true" tabindex="-1"></a>    compile<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;3 + 5&quot;</span><span class="op">);</span></span>
<span id="cb173-111"><a href="#cb173-111" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>contains<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;ADD R0&quot;</span><span class="op">))</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb173-112"><a href="#cb173-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-113"><a href="#cb173-113" aria-hidden="true" tabindex="-1"></a>    compile<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;2 + 3 * 4&quot;</span><span class="op">);</span></span>
<span id="cb173-114"><a href="#cb173-114" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>contains<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;MUL R0&quot;</span><span class="op">)</span> <span class="op">&amp;&amp;</span> contains<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;ADD R0&quot;</span><span class="op">))</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb173-115"><a href="#cb173-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-116"><a href="#cb173-116" aria-hidden="true" tabindex="-1"></a>    compile<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;1 + 2 + 3&quot;</span><span class="op">);</span></span>
<span id="cb173-117"><a href="#cb173-117" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>count<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;ADD R0&quot;</span><span class="op">)</span> <span class="op">==</span> <span class="dv">2</span><span class="op">)</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb173-118"><a href="#cb173-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-119"><a href="#cb173-119" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score<span class="op">;</span></span>
<span id="cb173-120"><a href="#cb173-120" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.4.14" id="générer-des-labels"><span class="header-section-number">2.4.14</span> 5.1 Générer des Labels</h3>
<div class="sourceCode" id="cb174"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> strlen<span class="op">(</span><span class="dt">char</span><span class="op">*</span> s<span class="op">)</span> <span class="op">{</span> <span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> <span class="cf">while</span> <span class="op">(</span>s<span class="op">[</span>i<span class="op">])</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> <span class="cf">return</span> i<span class="op">;</span> <span class="op">}</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> append<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">char</span><span class="op">*</span> s<span class="op">)</span> <span class="op">{</span></span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i <span class="op">=</span> strlen<span class="op">(</span>buf<span class="op">);</span> <span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>s<span class="op">[</span>j<span class="op">])</span> <span class="op">{</span> buf<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> s<span class="op">[</span>j<span class="op">];</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> j <span class="op">=</span> j <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> <span class="op">}</span> buf<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb174-5"><a href="#cb174-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb174-6"><a href="#cb174-6" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> append_num<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb174-7"><a href="#cb174-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;0&quot;</span><span class="op">);</span> <span class="cf">return</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb174-8"><a href="#cb174-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> tmp<span class="op">[</span><span class="dv">12</span><span class="op">];</span> <span class="dt">int</span> i <span class="op">=</span> <span class="dv">11</span><span class="op">;</span> tmp<span class="op">[</span><span class="dv">11</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb174-9"><a href="#cb174-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>n <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span> i <span class="op">=</span> i <span class="op">-</span> <span class="dv">1</span><span class="op">;</span> tmp<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="ch">&#39;0&#39;</span> <span class="op">+</span> <span class="op">(</span>n <span class="op">%</span> <span class="dv">10</span><span class="op">);</span> n <span class="op">=</span> n <span class="op">/</span> <span class="dv">10</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb174-10"><a href="#cb174-10" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> tmp <span class="op">+</span> i<span class="op">);</span></span>
<span id="cb174-11"><a href="#cb174-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb174-12"><a href="#cb174-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-13"><a href="#cb174-13" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> emit_label<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">char</span><span class="op">*</span> prefix<span class="op">,</span> <span class="dt">int</span> num<span class="op">)</span> <span class="op">{</span></span>
<span id="cb174-14"><a href="#cb174-14" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;.L&quot;</span><span class="op">);</span></span>
<span id="cb174-15"><a href="#cb174-15" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> prefix<span class="op">);</span></span>
<span id="cb174-16"><a href="#cb174-16" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;_&quot;</span><span class="op">);</span></span>
<span id="cb174-17"><a href="#cb174-17" aria-hidden="true" tabindex="-1"></a>    append_num<span class="op">(</span>buf<span class="op">,</span> num<span class="op">);</span></span>
<span id="cb174-18"><a href="#cb174-18" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;:</span><span class="sc">\\</span><span class="st">n&quot;</span><span class="op">);</span></span>
<span id="cb174-19"><a href="#cb174-19" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb174-20"><a href="#cb174-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-21"><a href="#cb174-21" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> emit_branch<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">int</span> cond<span class="op">,</span> <span class="dt">char</span><span class="op">*</span> prefix<span class="op">,</span> <span class="dt">int</span> num<span class="op">)</span> <span class="op">{</span></span>
<span id="cb174-22"><a href="#cb174-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>cond <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;B .L&quot;</span><span class="op">);</span></span>
<span id="cb174-23"><a href="#cb174-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>cond <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;B.EQ .L&quot;</span><span class="op">);</span></span>
<span id="cb174-24"><a href="#cb174-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>cond <span class="op">==</span> <span class="dv">2</span><span class="op">)</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;B.NE .L&quot;</span><span class="op">);</span></span>
<span id="cb174-25"><a href="#cb174-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>cond <span class="op">==</span> <span class="dv">3</span><span class="op">)</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;B.LT .L&quot;</span><span class="op">);</span></span>
<span id="cb174-26"><a href="#cb174-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>cond <span class="op">==</span> <span class="dv">4</span><span class="op">)</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;B.GE .L&quot;</span><span class="op">);</span></span>
<span id="cb174-27"><a href="#cb174-27" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> prefix<span class="op">);</span></span>
<span id="cb174-28"><a href="#cb174-28" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;_&quot;</span><span class="op">);</span></span>
<span id="cb174-29"><a href="#cb174-29" aria-hidden="true" tabindex="-1"></a>    append_num<span class="op">(</span>buf<span class="op">,</span> num<span class="op">);</span></span>
<span id="cb174-30"><a href="#cb174-30" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">n&quot;</span><span class="op">);</span></span>
<span id="cb174-31"><a href="#cb174-31" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb174-32"><a href="#cb174-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-33"><a href="#cb174-33" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> check<span class="op">(</span><span class="dt">char</span><span class="op">*</span> a<span class="op">,</span> <span class="dt">char</span><span class="op">*</span> b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb174-34"><a href="#cb174-34" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb174-35"><a href="#cb174-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>a<span class="op">[</span>i<span class="op">]</span> <span class="op">&amp;&amp;</span> b<span class="op">[</span>i<span class="op">])</span> <span class="op">{</span> <span class="cf">if</span> <span class="op">(</span>a<span class="op">[</span>i<span class="op">]</span> <span class="op">!=</span> b<span class="op">[</span>i<span class="op">])</span> <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb174-36"><a href="#cb174-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> a<span class="op">[</span>i<span class="op">]</span> <span class="op">==</span> b<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb174-37"><a href="#cb174-37" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb174-38"><a href="#cb174-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-39"><a href="#cb174-39" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb174-40"><a href="#cb174-40" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> buf<span class="op">[</span><span class="dv">100</span><span class="op">];</span></span>
<span id="cb174-41"><a href="#cb174-41" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> score <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb174-42"><a href="#cb174-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-43"><a href="#cb174-43" aria-hidden="true" tabindex="-1"></a>    buf<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb174-44"><a href="#cb174-44" aria-hidden="true" tabindex="-1"></a>    emit_label<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;if&quot;</span><span class="op">,</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb174-45"><a href="#cb174-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>check<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;.Lif_1:</span><span class="sc">\\</span><span class="st">n&quot;</span><span class="op">))</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb174-46"><a href="#cb174-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-47"><a href="#cb174-47" aria-hidden="true" tabindex="-1"></a>    buf<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb174-48"><a href="#cb174-48" aria-hidden="true" tabindex="-1"></a>    emit_branch<span class="op">(</span>buf<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="st">&quot;end&quot;</span><span class="op">,</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb174-49"><a href="#cb174-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>check<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;B .Lend_2</span><span class="sc">\\</span><span class="st">n&quot;</span><span class="op">))</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb174-50"><a href="#cb174-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-51"><a href="#cb174-51" aria-hidden="true" tabindex="-1"></a>    buf<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb174-52"><a href="#cb174-52" aria-hidden="true" tabindex="-1"></a>    emit_branch<span class="op">(</span>buf<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="st">&quot;else&quot;</span><span class="op">,</span> <span class="dv">3</span><span class="op">);</span></span>
<span id="cb174-53"><a href="#cb174-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>check<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;B.EQ .Lelse_3</span><span class="sc">\\</span><span class="st">n&quot;</span><span class="op">))</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb174-54"><a href="#cb174-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-55"><a href="#cb174-55" aria-hidden="true" tabindex="-1"></a>    buf<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb174-56"><a href="#cb174-56" aria-hidden="true" tabindex="-1"></a>    emit_branch<span class="op">(</span>buf<span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="st">&quot;loop&quot;</span><span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb174-57"><a href="#cb174-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>check<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;B.LT .Lloop_0</span><span class="sc">\\</span><span class="st">n&quot;</span><span class="op">))</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb174-58"><a href="#cb174-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-59"><a href="#cb174-59" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score<span class="op">;</span></span>
<span id="cb174-60"><a href="#cb174-60" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.4.15" id="générer-comparaisons"><span class="header-section-number">2.4.15</span> 5.2 Générer
Comparaisons</h3>
<div class="sourceCode" id="cb175"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> strlen<span class="op">(</span><span class="dt">char</span><span class="op">*</span> s<span class="op">)</span> <span class="op">{</span> <span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> <span class="cf">while</span> <span class="op">(</span>s<span class="op">[</span>i<span class="op">])</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> <span class="cf">return</span> i<span class="op">;</span> <span class="op">}</span></span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> append<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">char</span><span class="op">*</span> s<span class="op">)</span> <span class="op">{</span></span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i <span class="op">=</span> strlen<span class="op">(</span>buf<span class="op">);</span> <span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>s<span class="op">[</span>j<span class="op">])</span> <span class="op">{</span> buf<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> s<span class="op">[</span>j<span class="op">];</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> j <span class="op">=</span> j <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> <span class="op">}</span> buf<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb175-5"><a href="#cb175-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb175-6"><a href="#cb175-6" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> append_num<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb175-7"><a href="#cb175-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;0&quot;</span><span class="op">);</span> <span class="cf">return</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb175-8"><a href="#cb175-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> tmp<span class="op">[</span><span class="dv">12</span><span class="op">];</span> <span class="dt">int</span> i <span class="op">=</span> <span class="dv">11</span><span class="op">;</span> tmp<span class="op">[</span><span class="dv">11</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb175-9"><a href="#cb175-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>n <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span> i <span class="op">=</span> i <span class="op">-</span> <span class="dv">1</span><span class="op">;</span> tmp<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="ch">&#39;0&#39;</span> <span class="op">+</span> <span class="op">(</span>n <span class="op">%</span> <span class="dv">10</span><span class="op">);</span> n <span class="op">=</span> n <span class="op">/</span> <span class="dv">10</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb175-10"><a href="#cb175-10" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> tmp <span class="op">+</span> i<span class="op">);</span></span>
<span id="cb175-11"><a href="#cb175-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb175-12"><a href="#cb175-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-13"><a href="#cb175-13" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> emit_cmp<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">int</span> rn<span class="op">,</span> <span class="dt">int</span> rm<span class="op">)</span> <span class="op">{</span></span>
<span id="cb175-14"><a href="#cb175-14" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;CMP R&quot;</span><span class="op">);</span></span>
<span id="cb175-15"><a href="#cb175-15" aria-hidden="true" tabindex="-1"></a>    append_num<span class="op">(</span>buf<span class="op">,</span> rn<span class="op">);</span></span>
<span id="cb175-16"><a href="#cb175-16" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;, R&quot;</span><span class="op">);</span></span>
<span id="cb175-17"><a href="#cb175-17" aria-hidden="true" tabindex="-1"></a>    append_num<span class="op">(</span>buf<span class="op">,</span> rm<span class="op">);</span></span>
<span id="cb175-18"><a href="#cb175-18" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">n&quot;</span><span class="op">);</span></span>
<span id="cb175-19"><a href="#cb175-19" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb175-20"><a href="#cb175-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-21"><a href="#cb175-21" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> get_branch_cond<span class="op">(</span><span class="dt">char</span> op<span class="op">)</span> <span class="op">{</span></span>
<span id="cb175-22"><a href="#cb175-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>op <span class="op">==</span> <span class="ch">&#39;&lt;&#39;</span><span class="op">)</span> <span class="cf">return</span> <span class="dv">4</span><span class="op">;</span>  <span class="co">// BGE</span></span>
<span id="cb175-23"><a href="#cb175-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>op <span class="op">==</span> <span class="ch">&#39;&gt;&#39;</span><span class="op">)</span> <span class="cf">return</span> <span class="dv">3</span><span class="op">;</span>  <span class="co">// BLT (simplifié, &gt;= aussi)</span></span>
<span id="cb175-24"><a href="#cb175-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>op <span class="op">==</span> <span class="ch">&#39;=&#39;</span><span class="op">)</span> <span class="cf">return</span> <span class="dv">2</span><span class="op">;</span>  <span class="co">// BNE</span></span>
<span id="cb175-25"><a href="#cb175-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>op <span class="op">==</span> <span class="ch">&#39;!&#39;</span><span class="op">)</span> <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span>  <span class="co">// BEQ</span></span>
<span id="cb175-26"><a href="#cb175-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb175-27"><a href="#cb175-27" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb175-28"><a href="#cb175-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-29"><a href="#cb175-29" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> check<span class="op">(</span><span class="dt">char</span><span class="op">*</span> a<span class="op">,</span> <span class="dt">char</span><span class="op">*</span> b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb175-30"><a href="#cb175-30" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb175-31"><a href="#cb175-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>a<span class="op">[</span>i<span class="op">]</span> <span class="op">&amp;&amp;</span> b<span class="op">[</span>i<span class="op">])</span> <span class="op">{</span> <span class="cf">if</span> <span class="op">(</span>a<span class="op">[</span>i<span class="op">]</span> <span class="op">!=</span> b<span class="op">[</span>i<span class="op">])</span> <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb175-32"><a href="#cb175-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> a<span class="op">[</span>i<span class="op">]</span> <span class="op">==</span> b<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb175-33"><a href="#cb175-33" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb175-34"><a href="#cb175-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-35"><a href="#cb175-35" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb175-36"><a href="#cb175-36" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> buf<span class="op">[</span><span class="dv">100</span><span class="op">];</span></span>
<span id="cb175-37"><a href="#cb175-37" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> score <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb175-38"><a href="#cb175-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-39"><a href="#cb175-39" aria-hidden="true" tabindex="-1"></a>    buf<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb175-40"><a href="#cb175-40" aria-hidden="true" tabindex="-1"></a>    emit_cmp<span class="op">(</span>buf<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb175-41"><a href="#cb175-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>check<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;CMP R0, R1</span><span class="sc">\\</span><span class="st">n&quot;</span><span class="op">))</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb175-42"><a href="#cb175-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-43"><a href="#cb175-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>get_branch_cond<span class="op">(</span><span class="ch">&#39;&lt;&#39;</span><span class="op">)</span> <span class="op">==</span> <span class="dv">4</span><span class="op">)</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb175-44"><a href="#cb175-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>get_branch_cond<span class="op">(</span><span class="ch">&#39;=&#39;</span><span class="op">)</span> <span class="op">==</span> <span class="dv">2</span><span class="op">)</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb175-45"><a href="#cb175-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>get_branch_cond<span class="op">(</span><span class="ch">&#39;!&#39;</span><span class="op">)</span> <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb175-46"><a href="#cb175-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>get_branch_cond<span class="op">(</span><span class="ch">&#39;&gt;&#39;</span><span class="op">)</span> <span class="op">==</span> <span class="dv">3</span><span class="op">)</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb175-47"><a href="#cb175-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-48"><a href="#cb175-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score<span class="op">;</span></span>
<span id="cb175-49"><a href="#cb175-49" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.4.16" id="compiler-ifelse"><span class="header-section-number">2.4.16</span> 5.3 Compiler if/else</h3>
<div class="sourceCode" id="cb176"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> strlen<span class="op">(</span><span class="dt">char</span><span class="op">*</span> s<span class="op">)</span> <span class="op">{</span> <span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> <span class="cf">while</span> <span class="op">(</span>s<span class="op">[</span>i<span class="op">])</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> <span class="cf">return</span> i<span class="op">;</span> <span class="op">}</span></span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> append<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">char</span><span class="op">*</span> s<span class="op">)</span> <span class="op">{</span></span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i <span class="op">=</span> strlen<span class="op">(</span>buf<span class="op">);</span> <span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>s<span class="op">[</span>j<span class="op">])</span> <span class="op">{</span> buf<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> s<span class="op">[</span>j<span class="op">];</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> j <span class="op">=</span> j <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> <span class="op">}</span> buf<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb176-6"><a href="#cb176-6" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> append_num<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb176-7"><a href="#cb176-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;0&quot;</span><span class="op">);</span> <span class="cf">return</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb176-8"><a href="#cb176-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> tmp<span class="op">[</span><span class="dv">12</span><span class="op">];</span> <span class="dt">int</span> i <span class="op">=</span> <span class="dv">11</span><span class="op">;</span> tmp<span class="op">[</span><span class="dv">11</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb176-9"><a href="#cb176-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>n <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span> i <span class="op">=</span> i <span class="op">-</span> <span class="dv">1</span><span class="op">;</span> tmp<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="ch">&#39;0&#39;</span> <span class="op">+</span> <span class="op">(</span>n <span class="op">%</span> <span class="dv">10</span><span class="op">);</span> n <span class="op">=</span> n <span class="op">/</span> <span class="dv">10</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb176-10"><a href="#cb176-10" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> tmp <span class="op">+</span> i<span class="op">);</span></span>
<span id="cb176-11"><a href="#cb176-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb176-12"><a href="#cb176-12" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> emit_cmp<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">int</span> rn<span class="op">,</span> <span class="dt">int</span> rm<span class="op">)</span> <span class="op">{</span></span>
<span id="cb176-13"><a href="#cb176-13" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;CMP R&quot;</span><span class="op">);</span> append_num<span class="op">(</span>buf<span class="op">,</span> rn<span class="op">);</span></span>
<span id="cb176-14"><a href="#cb176-14" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;, R&quot;</span><span class="op">);</span> append_num<span class="op">(</span>buf<span class="op">,</span> rm<span class="op">);</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">n&quot;</span><span class="op">);</span></span>
<span id="cb176-15"><a href="#cb176-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb176-16"><a href="#cb176-16" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> emit_label<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">char</span><span class="op">*</span> prefix<span class="op">,</span> <span class="dt">int</span> num<span class="op">)</span> <span class="op">{</span></span>
<span id="cb176-17"><a href="#cb176-17" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;.L&quot;</span><span class="op">);</span> append<span class="op">(</span>buf<span class="op">,</span> prefix<span class="op">);</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;_&quot;</span><span class="op">);</span></span>
<span id="cb176-18"><a href="#cb176-18" aria-hidden="true" tabindex="-1"></a>    append_num<span class="op">(</span>buf<span class="op">,</span> num<span class="op">);</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;:</span><span class="sc">\\</span><span class="st">n&quot;</span><span class="op">);</span></span>
<span id="cb176-19"><a href="#cb176-19" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb176-20"><a href="#cb176-20" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> emit_branch<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">int</span> cond<span class="op">,</span> <span class="dt">char</span><span class="op">*</span> prefix<span class="op">,</span> <span class="dt">int</span> num<span class="op">)</span> <span class="op">{</span></span>
<span id="cb176-21"><a href="#cb176-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>cond <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;B .L&quot;</span><span class="op">);</span></span>
<span id="cb176-22"><a href="#cb176-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>cond <span class="op">==</span> <span class="dv">4</span><span class="op">)</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;B.GE .L&quot;</span><span class="op">);</span></span>
<span id="cb176-23"><a href="#cb176-23" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> prefix<span class="op">);</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;_&quot;</span><span class="op">);</span></span>
<span id="cb176-24"><a href="#cb176-24" aria-hidden="true" tabindex="-1"></a>    append_num<span class="op">(</span>buf<span class="op">,</span> num<span class="op">);</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">n&quot;</span><span class="op">);</span></span>
<span id="cb176-25"><a href="#cb176-25" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb176-26"><a href="#cb176-26" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> emit_mov<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">int</span> reg<span class="op">,</span> <span class="dt">int</span> val<span class="op">)</span> <span class="op">{</span></span>
<span id="cb176-27"><a href="#cb176-27" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;MOV R&quot;</span><span class="op">);</span> append_num<span class="op">(</span>buf<span class="op">,</span> reg<span class="op">);</span></span>
<span id="cb176-28"><a href="#cb176-28" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;, #&quot;</span><span class="op">);</span> append_num<span class="op">(</span>buf<span class="op">,</span> val<span class="op">);</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">n&quot;</span><span class="op">);</span></span>
<span id="cb176-29"><a href="#cb176-29" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb176-30"><a href="#cb176-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-31"><a href="#cb176-31" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> codegen_if<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb176-32"><a href="#cb176-32" aria-hidden="true" tabindex="-1"></a>    emit_cmp<span class="op">(</span>buf<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb176-33"><a href="#cb176-33" aria-hidden="true" tabindex="-1"></a>    emit_branch<span class="op">(</span>buf<span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="st">&quot;else&quot;</span><span class="op">,</span> n<span class="op">);</span></span>
<span id="cb176-34"><a href="#cb176-34" aria-hidden="true" tabindex="-1"></a>    emit_mov<span class="op">(</span>buf<span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb176-35"><a href="#cb176-35" aria-hidden="true" tabindex="-1"></a>    emit_branch<span class="op">(</span>buf<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="st">&quot;end&quot;</span><span class="op">,</span> n<span class="op">);</span></span>
<span id="cb176-36"><a href="#cb176-36" aria-hidden="true" tabindex="-1"></a>    emit_label<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;else&quot;</span><span class="op">,</span> n<span class="op">);</span></span>
<span id="cb176-37"><a href="#cb176-37" aria-hidden="true" tabindex="-1"></a>    emit_mov<span class="op">(</span>buf<span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb176-38"><a href="#cb176-38" aria-hidden="true" tabindex="-1"></a>    emit_label<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;end&quot;</span><span class="op">,</span> n<span class="op">);</span></span>
<span id="cb176-39"><a href="#cb176-39" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb176-40"><a href="#cb176-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-41"><a href="#cb176-41" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> contains<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">char</span><span class="op">*</span> sub<span class="op">)</span> <span class="op">{</span></span>
<span id="cb176-42"><a href="#cb176-42" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb176-43"><a href="#cb176-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>buf<span class="op">[</span>i<span class="op">])</span> <span class="op">{</span></span>
<span id="cb176-44"><a href="#cb176-44" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> <span class="cf">while</span> <span class="op">(</span>sub<span class="op">[</span>j<span class="op">]</span> <span class="op">&amp;&amp;</span> buf<span class="op">[</span>i<span class="op">+</span>j<span class="op">]</span> <span class="op">==</span> sub<span class="op">[</span>j<span class="op">])</span> j <span class="op">=</span> j <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb176-45"><a href="#cb176-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>sub<span class="op">[</span>j<span class="op">]</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb176-46"><a href="#cb176-46" aria-hidden="true" tabindex="-1"></a>        i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb176-47"><a href="#cb176-47" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb176-48"><a href="#cb176-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb176-49"><a href="#cb176-49" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb176-50"><a href="#cb176-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-51"><a href="#cb176-51" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb176-52"><a href="#cb176-52" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> buf<span class="op">[</span><span class="dv">300</span><span class="op">];</span></span>
<span id="cb176-53"><a href="#cb176-53" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> score <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb176-54"><a href="#cb176-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-55"><a href="#cb176-55" aria-hidden="true" tabindex="-1"></a>    buf<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb176-56"><a href="#cb176-56" aria-hidden="true" tabindex="-1"></a>    codegen_if<span class="op">(</span>buf<span class="op">,</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb176-57"><a href="#cb176-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-58"><a href="#cb176-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>contains<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;CMP R0, R1&quot;</span><span class="op">))</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb176-59"><a href="#cb176-59" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>contains<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;B.GE .Lelse_1&quot;</span><span class="op">))</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb176-60"><a href="#cb176-60" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>contains<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;B .Lend_1&quot;</span><span class="op">))</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb176-61"><a href="#cb176-61" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>contains<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;.Lelse_1:&quot;</span><span class="op">))</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb176-62"><a href="#cb176-62" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>contains<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;.Lend_1:&quot;</span><span class="op">))</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb176-63"><a href="#cb176-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-64"><a href="#cb176-64" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score<span class="op">;</span></span>
<span id="cb176-65"><a href="#cb176-65" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.4.17" id="compiler-while"><span class="header-section-number">2.4.17</span> 5.4 Compiler while</h3>
<div class="sourceCode" id="cb177"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> strlen<span class="op">(</span><span class="dt">char</span><span class="op">*</span> s<span class="op">)</span> <span class="op">{</span> <span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> <span class="cf">while</span> <span class="op">(</span>s<span class="op">[</span>i<span class="op">])</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> <span class="cf">return</span> i<span class="op">;</span> <span class="op">}</span></span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> append<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">char</span><span class="op">*</span> s<span class="op">)</span> <span class="op">{</span></span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i <span class="op">=</span> strlen<span class="op">(</span>buf<span class="op">);</span> <span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>s<span class="op">[</span>j<span class="op">])</span> <span class="op">{</span> buf<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> s<span class="op">[</span>j<span class="op">];</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> j <span class="op">=</span> j <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> <span class="op">}</span> buf<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb177-5"><a href="#cb177-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb177-6"><a href="#cb177-6" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> append_num<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb177-7"><a href="#cb177-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;0&quot;</span><span class="op">);</span> <span class="cf">return</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb177-8"><a href="#cb177-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> tmp<span class="op">[</span><span class="dv">12</span><span class="op">];</span> <span class="dt">int</span> i <span class="op">=</span> <span class="dv">11</span><span class="op">;</span> tmp<span class="op">[</span><span class="dv">11</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb177-9"><a href="#cb177-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>n <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span> i <span class="op">=</span> i <span class="op">-</span> <span class="dv">1</span><span class="op">;</span> tmp<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="ch">&#39;0&#39;</span> <span class="op">+</span> <span class="op">(</span>n <span class="op">%</span> <span class="dv">10</span><span class="op">);</span> n <span class="op">=</span> n <span class="op">/</span> <span class="dv">10</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb177-10"><a href="#cb177-10" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> tmp <span class="op">+</span> i<span class="op">);</span></span>
<span id="cb177-11"><a href="#cb177-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb177-12"><a href="#cb177-12" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> emit_cmp<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">int</span> rn<span class="op">,</span> <span class="dt">int</span> rm<span class="op">)</span> <span class="op">{</span></span>
<span id="cb177-13"><a href="#cb177-13" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;CMP R&quot;</span><span class="op">);</span> append_num<span class="op">(</span>buf<span class="op">,</span> rn<span class="op">);</span></span>
<span id="cb177-14"><a href="#cb177-14" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;, R&quot;</span><span class="op">);</span> append_num<span class="op">(</span>buf<span class="op">,</span> rm<span class="op">);</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">n&quot;</span><span class="op">);</span></span>
<span id="cb177-15"><a href="#cb177-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb177-16"><a href="#cb177-16" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> emit_label<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">char</span><span class="op">*</span> prefix<span class="op">,</span> <span class="dt">int</span> num<span class="op">)</span> <span class="op">{</span></span>
<span id="cb177-17"><a href="#cb177-17" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;.L&quot;</span><span class="op">);</span> append<span class="op">(</span>buf<span class="op">,</span> prefix<span class="op">);</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;_&quot;</span><span class="op">);</span></span>
<span id="cb177-18"><a href="#cb177-18" aria-hidden="true" tabindex="-1"></a>    append_num<span class="op">(</span>buf<span class="op">,</span> num<span class="op">);</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;:</span><span class="sc">\\</span><span class="st">n&quot;</span><span class="op">);</span></span>
<span id="cb177-19"><a href="#cb177-19" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb177-20"><a href="#cb177-20" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> emit_branch<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">int</span> cond<span class="op">,</span> <span class="dt">char</span><span class="op">*</span> prefix<span class="op">,</span> <span class="dt">int</span> num<span class="op">)</span> <span class="op">{</span></span>
<span id="cb177-21"><a href="#cb177-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>cond <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;B .L&quot;</span><span class="op">);</span></span>
<span id="cb177-22"><a href="#cb177-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>cond <span class="op">==</span> <span class="dv">4</span><span class="op">)</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;B.GE .L&quot;</span><span class="op">);</span></span>
<span id="cb177-23"><a href="#cb177-23" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> prefix<span class="op">);</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;_&quot;</span><span class="op">);</span></span>
<span id="cb177-24"><a href="#cb177-24" aria-hidden="true" tabindex="-1"></a>    append_num<span class="op">(</span>buf<span class="op">,</span> num<span class="op">);</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">n&quot;</span><span class="op">);</span></span>
<span id="cb177-25"><a href="#cb177-25" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb177-26"><a href="#cb177-26" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> emit_add_imm<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">int</span> rd<span class="op">,</span> <span class="dt">int</span> rn<span class="op">,</span> <span class="dt">int</span> imm<span class="op">)</span> <span class="op">{</span></span>
<span id="cb177-27"><a href="#cb177-27" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;ADD R&quot;</span><span class="op">);</span> append_num<span class="op">(</span>buf<span class="op">,</span> rd<span class="op">);</span></span>
<span id="cb177-28"><a href="#cb177-28" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;, R&quot;</span><span class="op">);</span> append_num<span class="op">(</span>buf<span class="op">,</span> rn<span class="op">);</span></span>
<span id="cb177-29"><a href="#cb177-29" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;, #&quot;</span><span class="op">);</span> append_num<span class="op">(</span>buf<span class="op">,</span> imm<span class="op">);</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">n&quot;</span><span class="op">);</span></span>
<span id="cb177-30"><a href="#cb177-30" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb177-31"><a href="#cb177-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-32"><a href="#cb177-32" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> codegen_while<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb177-33"><a href="#cb177-33" aria-hidden="true" tabindex="-1"></a>    emit_label<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;while&quot;</span><span class="op">,</span> n<span class="op">);</span></span>
<span id="cb177-34"><a href="#cb177-34" aria-hidden="true" tabindex="-1"></a>    emit_cmp<span class="op">(</span>buf<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb177-35"><a href="#cb177-35" aria-hidden="true" tabindex="-1"></a>    emit_branch<span class="op">(</span>buf<span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="st">&quot;end&quot;</span><span class="op">,</span> n<span class="op">);</span></span>
<span id="cb177-36"><a href="#cb177-36" aria-hidden="true" tabindex="-1"></a>    emit_add_imm<span class="op">(</span>buf<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb177-37"><a href="#cb177-37" aria-hidden="true" tabindex="-1"></a>    emit_branch<span class="op">(</span>buf<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="st">&quot;while&quot;</span><span class="op">,</span> n<span class="op">);</span></span>
<span id="cb177-38"><a href="#cb177-38" aria-hidden="true" tabindex="-1"></a>    emit_label<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;end&quot;</span><span class="op">,</span> n<span class="op">);</span></span>
<span id="cb177-39"><a href="#cb177-39" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb177-40"><a href="#cb177-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-41"><a href="#cb177-41" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> contains<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">char</span><span class="op">*</span> sub<span class="op">)</span> <span class="op">{</span></span>
<span id="cb177-42"><a href="#cb177-42" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb177-43"><a href="#cb177-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>buf<span class="op">[</span>i<span class="op">])</span> <span class="op">{</span></span>
<span id="cb177-44"><a href="#cb177-44" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> <span class="cf">while</span> <span class="op">(</span>sub<span class="op">[</span>j<span class="op">]</span> <span class="op">&amp;&amp;</span> buf<span class="op">[</span>i<span class="op">+</span>j<span class="op">]</span> <span class="op">==</span> sub<span class="op">[</span>j<span class="op">])</span> j <span class="op">=</span> j <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb177-45"><a href="#cb177-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>sub<span class="op">[</span>j<span class="op">]</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb177-46"><a href="#cb177-46" aria-hidden="true" tabindex="-1"></a>        i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb177-47"><a href="#cb177-47" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb177-48"><a href="#cb177-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb177-49"><a href="#cb177-49" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb177-50"><a href="#cb177-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-51"><a href="#cb177-51" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb177-52"><a href="#cb177-52" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> buf<span class="op">[</span><span class="dv">300</span><span class="op">];</span></span>
<span id="cb177-53"><a href="#cb177-53" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> score <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb177-54"><a href="#cb177-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-55"><a href="#cb177-55" aria-hidden="true" tabindex="-1"></a>    buf<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb177-56"><a href="#cb177-56" aria-hidden="true" tabindex="-1"></a>    codegen_while<span class="op">(</span>buf<span class="op">,</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb177-57"><a href="#cb177-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-58"><a href="#cb177-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>contains<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;.Lwhile_2:&quot;</span><span class="op">))</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb177-59"><a href="#cb177-59" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>contains<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;CMP R0, R1&quot;</span><span class="op">))</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb177-60"><a href="#cb177-60" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>contains<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;B.GE .Lend_2&quot;</span><span class="op">))</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb177-61"><a href="#cb177-61" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>contains<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;B .Lwhile_2&quot;</span><span class="op">))</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb177-62"><a href="#cb177-62" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>contains<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;.Lend_2:&quot;</span><span class="op">))</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb177-63"><a href="#cb177-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-64"><a href="#cb177-64" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score<span class="op">;</span></span>
<span id="cb177-65"><a href="#cb177-65" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.4.18" id="prologue-et-épilogue"><span class="header-section-number">2.4.18</span> 6.1 Prologue et
Épilogue</h3>
<div class="sourceCode" id="cb178"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> strlen<span class="op">(</span><span class="dt">char</span><span class="op">*</span> s<span class="op">)</span> <span class="op">{</span> <span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> <span class="cf">while</span> <span class="op">(</span>s<span class="op">[</span>i<span class="op">])</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> <span class="cf">return</span> i<span class="op">;</span> <span class="op">}</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> append<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">char</span><span class="op">*</span> s<span class="op">)</span> <span class="op">{</span></span>
<span id="cb178-3"><a href="#cb178-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i <span class="op">=</span> strlen<span class="op">(</span>buf<span class="op">);</span> <span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb178-4"><a href="#cb178-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>s<span class="op">[</span>j<span class="op">])</span> <span class="op">{</span> buf<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> s<span class="op">[</span>j<span class="op">];</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> j <span class="op">=</span> j <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> <span class="op">}</span> buf<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb178-5"><a href="#cb178-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb178-6"><a href="#cb178-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-7"><a href="#cb178-7" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> emit_prologue<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">char</span><span class="op">*</span> name<span class="op">)</span> <span class="op">{</span></span>
<span id="cb178-8"><a href="#cb178-8" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> name<span class="op">);</span></span>
<span id="cb178-9"><a href="#cb178-9" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;:</span><span class="sc">\\</span><span class="st">n    STR LR, [SP, #-4]!</span><span class="sc">\\</span><span class="st">n&quot;</span><span class="op">);</span></span>
<span id="cb178-10"><a href="#cb178-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb178-11"><a href="#cb178-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-12"><a href="#cb178-12" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> emit_epilogue<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">)</span> <span class="op">{</span></span>
<span id="cb178-13"><a href="#cb178-13" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;    LDR LR, [SP], #4</span><span class="sc">\\</span><span class="st">n    BX LR</span><span class="sc">\\</span><span class="st">n&quot;</span><span class="op">);</span></span>
<span id="cb178-14"><a href="#cb178-14" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb178-15"><a href="#cb178-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-16"><a href="#cb178-16" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> contains<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">char</span><span class="op">*</span> sub<span class="op">)</span> <span class="op">{</span></span>
<span id="cb178-17"><a href="#cb178-17" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb178-18"><a href="#cb178-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>buf<span class="op">[</span>i<span class="op">])</span> <span class="op">{</span></span>
<span id="cb178-19"><a href="#cb178-19" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> <span class="cf">while</span> <span class="op">(</span>sub<span class="op">[</span>j<span class="op">]</span> <span class="op">&amp;&amp;</span> buf<span class="op">[</span>i<span class="op">+</span>j<span class="op">]</span> <span class="op">==</span> sub<span class="op">[</span>j<span class="op">])</span> j <span class="op">=</span> j <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb178-20"><a href="#cb178-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>sub<span class="op">[</span>j<span class="op">]</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb178-21"><a href="#cb178-21" aria-hidden="true" tabindex="-1"></a>        i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb178-22"><a href="#cb178-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb178-23"><a href="#cb178-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb178-24"><a href="#cb178-24" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb178-25"><a href="#cb178-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-26"><a href="#cb178-26" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb178-27"><a href="#cb178-27" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> buf<span class="op">[</span><span class="dv">200</span><span class="op">];</span></span>
<span id="cb178-28"><a href="#cb178-28" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> score <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb178-29"><a href="#cb178-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-30"><a href="#cb178-30" aria-hidden="true" tabindex="-1"></a>    buf<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb178-31"><a href="#cb178-31" aria-hidden="true" tabindex="-1"></a>    emit_prologue<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;add&quot;</span><span class="op">);</span></span>
<span id="cb178-32"><a href="#cb178-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>contains<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;add:&quot;</span><span class="op">)</span> <span class="op">&amp;&amp;</span> contains<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;STR LR&quot;</span><span class="op">))</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb178-33"><a href="#cb178-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-34"><a href="#cb178-34" aria-hidden="true" tabindex="-1"></a>    buf<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb178-35"><a href="#cb178-35" aria-hidden="true" tabindex="-1"></a>    emit_epilogue<span class="op">(</span>buf<span class="op">);</span></span>
<span id="cb178-36"><a href="#cb178-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>contains<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;LDR LR&quot;</span><span class="op">)</span> <span class="op">&amp;&amp;</span> contains<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;BX LR&quot;</span><span class="op">))</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb178-37"><a href="#cb178-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-38"><a href="#cb178-38" aria-hidden="true" tabindex="-1"></a>    buf<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb178-39"><a href="#cb178-39" aria-hidden="true" tabindex="-1"></a>    emit_prologue<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;main&quot;</span><span class="op">);</span></span>
<span id="cb178-40"><a href="#cb178-40" aria-hidden="true" tabindex="-1"></a>    emit_epilogue<span class="op">(</span>buf<span class="op">);</span></span>
<span id="cb178-41"><a href="#cb178-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>contains<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;main:&quot;</span><span class="op">)</span> <span class="op">&amp;&amp;</span> contains<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;BX LR&quot;</span><span class="op">))</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb178-42"><a href="#cb178-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb178-43"><a href="#cb178-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score<span class="op">;</span></span>
<span id="cb178-44"><a href="#cb178-44" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.4.19" id="appels-de-fonction"><span class="header-section-number">2.4.19</span> 6.2 Appels de Fonction</h3>
<div class="sourceCode" id="cb179"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> strlen<span class="op">(</span><span class="dt">char</span><span class="op">*</span> s<span class="op">)</span> <span class="op">{</span> <span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> <span class="cf">while</span> <span class="op">(</span>s<span class="op">[</span>i<span class="op">])</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> <span class="cf">return</span> i<span class="op">;</span> <span class="op">}</span></span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> append<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">char</span><span class="op">*</span> s<span class="op">)</span> <span class="op">{</span></span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i <span class="op">=</span> strlen<span class="op">(</span>buf<span class="op">);</span> <span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>s<span class="op">[</span>j<span class="op">])</span> <span class="op">{</span> buf<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> s<span class="op">[</span>j<span class="op">];</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> j <span class="op">=</span> j <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> <span class="op">}</span> buf<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb179-5"><a href="#cb179-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb179-6"><a href="#cb179-6" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> append_num<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb179-7"><a href="#cb179-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;0&quot;</span><span class="op">);</span> <span class="cf">return</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb179-8"><a href="#cb179-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> tmp<span class="op">[</span><span class="dv">12</span><span class="op">];</span> <span class="dt">int</span> i <span class="op">=</span> <span class="dv">11</span><span class="op">;</span> tmp<span class="op">[</span><span class="dv">11</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb179-9"><a href="#cb179-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>n <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span> i <span class="op">=</span> i <span class="op">-</span> <span class="dv">1</span><span class="op">;</span> tmp<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="ch">&#39;0&#39;</span> <span class="op">+</span> <span class="op">(</span>n <span class="op">%</span> <span class="dv">10</span><span class="op">);</span> n <span class="op">=</span> n <span class="op">/</span> <span class="dv">10</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb179-10"><a href="#cb179-10" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> tmp <span class="op">+</span> i<span class="op">);</span></span>
<span id="cb179-11"><a href="#cb179-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb179-12"><a href="#cb179-12" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> emit_mov<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">int</span> reg<span class="op">,</span> <span class="dt">int</span> val<span class="op">)</span> <span class="op">{</span></span>
<span id="cb179-13"><a href="#cb179-13" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;MOV R&quot;</span><span class="op">);</span> append_num<span class="op">(</span>buf<span class="op">,</span> reg<span class="op">);</span></span>
<span id="cb179-14"><a href="#cb179-14" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;, #&quot;</span><span class="op">);</span> append_num<span class="op">(</span>buf<span class="op">,</span> val<span class="op">);</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">n&quot;</span><span class="op">);</span></span>
<span id="cb179-15"><a href="#cb179-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb179-16"><a href="#cb179-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-17"><a href="#cb179-17" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> emit_call<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">char</span><span class="op">*</span> name<span class="op">)</span> <span class="op">{</span></span>
<span id="cb179-18"><a href="#cb179-18" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;BL &quot;</span><span class="op">);</span></span>
<span id="cb179-19"><a href="#cb179-19" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> name<span class="op">);</span></span>
<span id="cb179-20"><a href="#cb179-20" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">n&quot;</span><span class="op">);</span></span>
<span id="cb179-21"><a href="#cb179-21" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb179-22"><a href="#cb179-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-23"><a href="#cb179-23" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> contains<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">char</span><span class="op">*</span> sub<span class="op">)</span> <span class="op">{</span></span>
<span id="cb179-24"><a href="#cb179-24" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb179-25"><a href="#cb179-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>buf<span class="op">[</span>i<span class="op">])</span> <span class="op">{</span></span>
<span id="cb179-26"><a href="#cb179-26" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> <span class="cf">while</span> <span class="op">(</span>sub<span class="op">[</span>j<span class="op">]</span> <span class="op">&amp;&amp;</span> buf<span class="op">[</span>i<span class="op">+</span>j<span class="op">]</span> <span class="op">==</span> sub<span class="op">[</span>j<span class="op">])</span> j <span class="op">=</span> j <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb179-27"><a href="#cb179-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>sub<span class="op">[</span>j<span class="op">]</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb179-28"><a href="#cb179-28" aria-hidden="true" tabindex="-1"></a>        i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb179-29"><a href="#cb179-29" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb179-30"><a href="#cb179-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb179-31"><a href="#cb179-31" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb179-32"><a href="#cb179-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-33"><a href="#cb179-33" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb179-34"><a href="#cb179-34" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> buf<span class="op">[</span><span class="dv">200</span><span class="op">];</span></span>
<span id="cb179-35"><a href="#cb179-35" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> score <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb179-36"><a href="#cb179-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-37"><a href="#cb179-37" aria-hidden="true" tabindex="-1"></a>    buf<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb179-38"><a href="#cb179-38" aria-hidden="true" tabindex="-1"></a>    emit_call<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;putchar&quot;</span><span class="op">);</span></span>
<span id="cb179-39"><a href="#cb179-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>contains<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;BL putchar&quot;</span><span class="op">))</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb179-40"><a href="#cb179-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-41"><a href="#cb179-41" aria-hidden="true" tabindex="-1"></a>    buf<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb179-42"><a href="#cb179-42" aria-hidden="true" tabindex="-1"></a>    emit_mov<span class="op">(</span>buf<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">65</span><span class="op">);</span></span>
<span id="cb179-43"><a href="#cb179-43" aria-hidden="true" tabindex="-1"></a>    emit_call<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;putchar&quot;</span><span class="op">);</span></span>
<span id="cb179-44"><a href="#cb179-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>contains<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;MOV R0, #65&quot;</span><span class="op">)</span> <span class="op">&amp;&amp;</span> contains<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;BL putchar&quot;</span><span class="op">))</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb179-45"><a href="#cb179-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-46"><a href="#cb179-46" aria-hidden="true" tabindex="-1"></a>    buf<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb179-47"><a href="#cb179-47" aria-hidden="true" tabindex="-1"></a>    emit_mov<span class="op">(</span>buf<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">3</span><span class="op">);</span></span>
<span id="cb179-48"><a href="#cb179-48" aria-hidden="true" tabindex="-1"></a>    emit_mov<span class="op">(</span>buf<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">5</span><span class="op">);</span></span>
<span id="cb179-49"><a href="#cb179-49" aria-hidden="true" tabindex="-1"></a>    emit_call<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;add&quot;</span><span class="op">);</span></span>
<span id="cb179-50"><a href="#cb179-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>contains<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;MOV R0, #3&quot;</span><span class="op">)</span> <span class="op">&amp;&amp;</span> contains<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;MOV R1, #5&quot;</span><span class="op">)</span> <span class="op">&amp;&amp;</span></span>
<span id="cb179-51"><a href="#cb179-51" aria-hidden="true" tabindex="-1"></a>        contains<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;BL add&quot;</span><span class="op">))</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb179-52"><a href="#cb179-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-53"><a href="#cb179-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score<span class="op">;</span></span>
<span id="cb179-54"><a href="#cb179-54" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.4.20" id="mini-compilateur-complet"><span class="header-section-number">2.4.20</span> 7.1 Mini-Compilateur
Complet</h3>
<div class="sourceCode" id="cb180"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="co">// === UTILITAIRES ===</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> strlen<span class="op">(</span><span class="dt">char</span><span class="op">*</span> s<span class="op">)</span> <span class="op">{</span> <span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> <span class="cf">while</span> <span class="op">(</span>s<span class="op">[</span>i<span class="op">])</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> <span class="cf">return</span> i<span class="op">;</span> <span class="op">}</span></span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> append<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">char</span><span class="op">*</span> s<span class="op">)</span> <span class="op">{</span></span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i <span class="op">=</span> strlen<span class="op">(</span>buf<span class="op">);</span> <span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb180-5"><a href="#cb180-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>s<span class="op">[</span>j<span class="op">])</span> <span class="op">{</span> buf<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> s<span class="op">[</span>j<span class="op">];</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> j <span class="op">=</span> j <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> <span class="op">}</span> buf<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb180-6"><a href="#cb180-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb180-7"><a href="#cb180-7" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> append_num<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb180-8"><a href="#cb180-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;0&quot;</span><span class="op">);</span> <span class="cf">return</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb180-9"><a href="#cb180-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> tmp<span class="op">[</span><span class="dv">12</span><span class="op">];</span> <span class="dt">int</span> i <span class="op">=</span> <span class="dv">11</span><span class="op">;</span> tmp<span class="op">[</span><span class="dv">11</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb180-10"><a href="#cb180-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>n <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span> i <span class="op">=</span> i <span class="op">-</span> <span class="dv">1</span><span class="op">;</span> tmp<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="ch">&#39;0&#39;</span> <span class="op">+</span> <span class="op">(</span>n <span class="op">%</span> <span class="dv">10</span><span class="op">);</span> n <span class="op">=</span> n <span class="op">/</span> <span class="dv">10</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb180-11"><a href="#cb180-11" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> tmp <span class="op">+</span> i<span class="op">);</span></span>
<span id="cb180-12"><a href="#cb180-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb180-13"><a href="#cb180-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-14"><a href="#cb180-14" aria-hidden="true" tabindex="-1"></a><span class="co">// === ÉMETTEURS ===</span></span>
<span id="cb180-15"><a href="#cb180-15" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> emit_mov<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">int</span> reg<span class="op">,</span> <span class="dt">int</span> val<span class="op">)</span> <span class="op">{</span></span>
<span id="cb180-16"><a href="#cb180-16" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;MOV R&quot;</span><span class="op">);</span> append_num<span class="op">(</span>buf<span class="op">,</span> reg<span class="op">);</span></span>
<span id="cb180-17"><a href="#cb180-17" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;, #&quot;</span><span class="op">);</span> append_num<span class="op">(</span>buf<span class="op">,</span> val<span class="op">);</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">n&quot;</span><span class="op">);</span></span>
<span id="cb180-18"><a href="#cb180-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb180-19"><a href="#cb180-19" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> emit_push<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">int</span> reg<span class="op">)</span> <span class="op">{</span></span>
<span id="cb180-20"><a href="#cb180-20" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;STR R&quot;</span><span class="op">);</span> append_num<span class="op">(</span>buf<span class="op">,</span> reg<span class="op">);</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;, [SP, #-4]!</span><span class="sc">\\</span><span class="st">n&quot;</span><span class="op">);</span></span>
<span id="cb180-21"><a href="#cb180-21" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb180-22"><a href="#cb180-22" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> emit_pop<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">int</span> reg<span class="op">)</span> <span class="op">{</span></span>
<span id="cb180-23"><a href="#cb180-23" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;LDR R&quot;</span><span class="op">);</span> append_num<span class="op">(</span>buf<span class="op">,</span> reg<span class="op">);</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;, [SP], #4</span><span class="sc">\\</span><span class="st">n&quot;</span><span class="op">);</span></span>
<span id="cb180-24"><a href="#cb180-24" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb180-25"><a href="#cb180-25" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> emit_op<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">char</span> op<span class="op">,</span> <span class="dt">int</span> rd<span class="op">,</span> <span class="dt">int</span> rn<span class="op">,</span> <span class="dt">int</span> rm<span class="op">)</span> <span class="op">{</span></span>
<span id="cb180-26"><a href="#cb180-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>op <span class="op">==</span> <span class="ch">&#39;+&#39;</span><span class="op">)</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;ADD R&quot;</span><span class="op">);</span></span>
<span id="cb180-27"><a href="#cb180-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>op <span class="op">==</span> <span class="ch">&#39;-&#39;</span><span class="op">)</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;SUB R&quot;</span><span class="op">);</span></span>
<span id="cb180-28"><a href="#cb180-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>op <span class="op">==</span> <span class="ch">&#39;*&#39;</span><span class="op">)</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;MUL R&quot;</span><span class="op">);</span></span>
<span id="cb180-29"><a href="#cb180-29" aria-hidden="true" tabindex="-1"></a>    append_num<span class="op">(</span>buf<span class="op">,</span> rd<span class="op">);</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;, R&quot;</span><span class="op">);</span> append_num<span class="op">(</span>buf<span class="op">,</span> rn<span class="op">);</span></span>
<span id="cb180-30"><a href="#cb180-30" aria-hidden="true" tabindex="-1"></a>    append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;, R&quot;</span><span class="op">);</span> append_num<span class="op">(</span>buf<span class="op">,</span> rm<span class="op">);</span> append<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">n&quot;</span><span class="op">);</span></span>
<span id="cb180-31"><a href="#cb180-31" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb180-32"><a href="#cb180-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-33"><a href="#cb180-33" aria-hidden="true" tabindex="-1"></a><span class="co">// === PARSER + CODEGEN ===</span></span>
<span id="cb180-34"><a href="#cb180-34" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> is_digit<span class="op">(</span><span class="dt">char</span> c<span class="op">)</span> <span class="op">{</span> <span class="cf">return</span> c <span class="op">&gt;=</span> <span class="ch">&#39;0&#39;</span> <span class="op">&amp;&amp;</span> c <span class="op">&lt;=</span> <span class="ch">&#39;9&#39;</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb180-35"><a href="#cb180-35" aria-hidden="true" tabindex="-1"></a><span class="dt">char</span><span class="op">*</span> input<span class="op">;</span></span>
<span id="cb180-36"><a href="#cb180-36" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> pos<span class="op">;</span></span>
<span id="cb180-37"><a href="#cb180-37" aria-hidden="true" tabindex="-1"></a><span class="dt">char</span><span class="op">*</span> out<span class="op">;</span></span>
<span id="cb180-38"><a href="#cb180-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-39"><a href="#cb180-39" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> skip<span class="op">()</span> <span class="op">{</span> <span class="cf">while</span> <span class="op">(</span>input<span class="op">[</span>pos<span class="op">]</span> <span class="op">==</span> <span class="ch">&#39; &#39;</span><span class="op">)</span> pos <span class="op">=</span> pos <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb180-40"><a href="#cb180-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-41"><a href="#cb180-41" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> codegen_expr<span class="op">();</span></span>
<span id="cb180-42"><a href="#cb180-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-43"><a href="#cb180-43" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> codegen_factor<span class="op">()</span> <span class="op">{</span></span>
<span id="cb180-44"><a href="#cb180-44" aria-hidden="true" tabindex="-1"></a>    skip<span class="op">();</span></span>
<span id="cb180-45"><a href="#cb180-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>input<span class="op">[</span>pos<span class="op">]</span> <span class="op">==</span> <span class="ch">&#39;(&#39;</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb180-46"><a href="#cb180-46" aria-hidden="true" tabindex="-1"></a>        pos <span class="op">=</span> pos <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb180-47"><a href="#cb180-47" aria-hidden="true" tabindex="-1"></a>        codegen_expr<span class="op">();</span></span>
<span id="cb180-48"><a href="#cb180-48" aria-hidden="true" tabindex="-1"></a>        skip<span class="op">();</span></span>
<span id="cb180-49"><a href="#cb180-49" aria-hidden="true" tabindex="-1"></a>        pos <span class="op">=</span> pos <span class="op">+</span> <span class="dv">1</span><span class="op">;</span>  <span class="co">// &#39;)&#39;</span></span>
<span id="cb180-50"><a href="#cb180-50" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb180-51"><a href="#cb180-51" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> v <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb180-52"><a href="#cb180-52" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="op">(</span>is_digit<span class="op">(</span>input<span class="op">[</span>pos<span class="op">]))</span> <span class="op">{</span></span>
<span id="cb180-53"><a href="#cb180-53" aria-hidden="true" tabindex="-1"></a>            v <span class="op">=</span> v <span class="op">*</span> <span class="dv">10</span> <span class="op">+</span> <span class="op">(</span>input<span class="op">[</span>pos<span class="op">]</span> <span class="op">-</span> <span class="ch">&#39;0&#39;</span><span class="op">);</span></span>
<span id="cb180-54"><a href="#cb180-54" aria-hidden="true" tabindex="-1"></a>            pos <span class="op">=</span> pos <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb180-55"><a href="#cb180-55" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb180-56"><a href="#cb180-56" aria-hidden="true" tabindex="-1"></a>        emit_mov<span class="op">(</span>out<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> v<span class="op">);</span></span>
<span id="cb180-57"><a href="#cb180-57" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb180-58"><a href="#cb180-58" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb180-59"><a href="#cb180-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-60"><a href="#cb180-60" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> codegen_term<span class="op">()</span> <span class="op">{</span></span>
<span id="cb180-61"><a href="#cb180-61" aria-hidden="true" tabindex="-1"></a>    codegen_factor<span class="op">();</span></span>
<span id="cb180-62"><a href="#cb180-62" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span><span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb180-63"><a href="#cb180-63" aria-hidden="true" tabindex="-1"></a>        skip<span class="op">();</span></span>
<span id="cb180-64"><a href="#cb180-64" aria-hidden="true" tabindex="-1"></a>        <span class="dt">char</span> op <span class="op">=</span> input<span class="op">[</span>pos<span class="op">];</span></span>
<span id="cb180-65"><a href="#cb180-65" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>op <span class="op">!=</span> <span class="ch">&#39;*&#39;</span> <span class="op">&amp;&amp;</span> op <span class="op">!=</span> <span class="ch">&#39;/&#39;</span><span class="op">)</span> <span class="cf">break</span><span class="op">;</span></span>
<span id="cb180-66"><a href="#cb180-66" aria-hidden="true" tabindex="-1"></a>        pos <span class="op">=</span> pos <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb180-67"><a href="#cb180-67" aria-hidden="true" tabindex="-1"></a>        emit_push<span class="op">(</span>out<span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb180-68"><a href="#cb180-68" aria-hidden="true" tabindex="-1"></a>        codegen_factor<span class="op">();</span></span>
<span id="cb180-69"><a href="#cb180-69" aria-hidden="true" tabindex="-1"></a>        emit_pop<span class="op">(</span>out<span class="op">,</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb180-70"><a href="#cb180-70" aria-hidden="true" tabindex="-1"></a>        emit_op<span class="op">(</span>out<span class="op">,</span> op<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb180-71"><a href="#cb180-71" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb180-72"><a href="#cb180-72" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb180-73"><a href="#cb180-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-74"><a href="#cb180-74" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> codegen_expr<span class="op">()</span> <span class="op">{</span></span>
<span id="cb180-75"><a href="#cb180-75" aria-hidden="true" tabindex="-1"></a>    codegen_term<span class="op">();</span></span>
<span id="cb180-76"><a href="#cb180-76" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span><span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb180-77"><a href="#cb180-77" aria-hidden="true" tabindex="-1"></a>        skip<span class="op">();</span></span>
<span id="cb180-78"><a href="#cb180-78" aria-hidden="true" tabindex="-1"></a>        <span class="dt">char</span> op <span class="op">=</span> input<span class="op">[</span>pos<span class="op">];</span></span>
<span id="cb180-79"><a href="#cb180-79" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>op <span class="op">!=</span> <span class="ch">&#39;+&#39;</span> <span class="op">&amp;&amp;</span> op <span class="op">!=</span> <span class="ch">&#39;-&#39;</span><span class="op">)</span> <span class="cf">break</span><span class="op">;</span></span>
<span id="cb180-80"><a href="#cb180-80" aria-hidden="true" tabindex="-1"></a>        pos <span class="op">=</span> pos <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb180-81"><a href="#cb180-81" aria-hidden="true" tabindex="-1"></a>        emit_push<span class="op">(</span>out<span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb180-82"><a href="#cb180-82" aria-hidden="true" tabindex="-1"></a>        codegen_term<span class="op">();</span></span>
<span id="cb180-83"><a href="#cb180-83" aria-hidden="true" tabindex="-1"></a>        emit_pop<span class="op">(</span>out<span class="op">,</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb180-84"><a href="#cb180-84" aria-hidden="true" tabindex="-1"></a>        emit_op<span class="op">(</span>out<span class="op">,</span> op<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb180-85"><a href="#cb180-85" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb180-86"><a href="#cb180-86" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb180-87"><a href="#cb180-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-88"><a href="#cb180-88" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> compile<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">char</span><span class="op">*</span> src<span class="op">)</span> <span class="op">{</span></span>
<span id="cb180-89"><a href="#cb180-89" aria-hidden="true" tabindex="-1"></a>    out <span class="op">=</span> buf<span class="op">;</span> input <span class="op">=</span> src<span class="op">;</span> pos <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> buf<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb180-90"><a href="#cb180-90" aria-hidden="true" tabindex="-1"></a>    codegen_expr<span class="op">();</span></span>
<span id="cb180-91"><a href="#cb180-91" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb180-92"><a href="#cb180-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-93"><a href="#cb180-93" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> contains<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">char</span><span class="op">*</span> sub<span class="op">)</span> <span class="op">{</span></span>
<span id="cb180-94"><a href="#cb180-94" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb180-95"><a href="#cb180-95" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>buf<span class="op">[</span>i<span class="op">])</span> <span class="op">{</span></span>
<span id="cb180-96"><a href="#cb180-96" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> <span class="cf">while</span> <span class="op">(</span>sub<span class="op">[</span>j<span class="op">]</span> <span class="op">&amp;&amp;</span> buf<span class="op">[</span>i<span class="op">+</span>j<span class="op">]</span> <span class="op">==</span> sub<span class="op">[</span>j<span class="op">])</span> j <span class="op">=</span> j <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb180-97"><a href="#cb180-97" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>sub<span class="op">[</span>j<span class="op">]</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb180-98"><a href="#cb180-98" aria-hidden="true" tabindex="-1"></a>        i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb180-99"><a href="#cb180-99" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb180-100"><a href="#cb180-100" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb180-101"><a href="#cb180-101" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb180-102"><a href="#cb180-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-103"><a href="#cb180-103" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> count<span class="op">(</span><span class="dt">char</span><span class="op">*</span> buf<span class="op">,</span> <span class="dt">char</span><span class="op">*</span> sub<span class="op">)</span> <span class="op">{</span></span>
<span id="cb180-104"><a href="#cb180-104" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> c <span class="op">=</span> <span class="dv">0</span><span class="op">,</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb180-105"><a href="#cb180-105" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>buf<span class="op">[</span>i<span class="op">])</span> <span class="op">{</span></span>
<span id="cb180-106"><a href="#cb180-106" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> <span class="cf">while</span> <span class="op">(</span>sub<span class="op">[</span>j<span class="op">]</span> <span class="op">&amp;&amp;</span> buf<span class="op">[</span>i<span class="op">+</span>j<span class="op">]</span> <span class="op">==</span> sub<span class="op">[</span>j<span class="op">])</span> j <span class="op">=</span> j <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb180-107"><a href="#cb180-107" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>sub<span class="op">[</span>j<span class="op">]</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> c <span class="op">=</span> c <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb180-108"><a href="#cb180-108" aria-hidden="true" tabindex="-1"></a>        i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb180-109"><a href="#cb180-109" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb180-110"><a href="#cb180-110" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> c<span class="op">;</span></span>
<span id="cb180-111"><a href="#cb180-111" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb180-112"><a href="#cb180-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-113"><a href="#cb180-113" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb180-114"><a href="#cb180-114" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span> buf<span class="op">[</span><span class="dv">500</span><span class="op">];</span></span>
<span id="cb180-115"><a href="#cb180-115" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> score <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb180-116"><a href="#cb180-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-117"><a href="#cb180-117" aria-hidden="true" tabindex="-1"></a>    compile<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;42&quot;</span><span class="op">);</span></span>
<span id="cb180-118"><a href="#cb180-118" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>contains<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;MOV R0, #42&quot;</span><span class="op">))</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb180-119"><a href="#cb180-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-120"><a href="#cb180-120" aria-hidden="true" tabindex="-1"></a>    compile<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;(5)&quot;</span><span class="op">);</span></span>
<span id="cb180-121"><a href="#cb180-121" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>contains<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;MOV R0, #5&quot;</span><span class="op">))</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb180-122"><a href="#cb180-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-123"><a href="#cb180-123" aria-hidden="true" tabindex="-1"></a>    compile<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;2 + 3 * 4&quot;</span><span class="op">);</span></span>
<span id="cb180-124"><a href="#cb180-124" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>contains<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;MUL&quot;</span><span class="op">)</span> <span class="op">&amp;&amp;</span> contains<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;ADD&quot;</span><span class="op">))</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb180-125"><a href="#cb180-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-126"><a href="#cb180-126" aria-hidden="true" tabindex="-1"></a>    compile<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;(2 + 3) * 4&quot;</span><span class="op">);</span></span>
<span id="cb180-127"><a href="#cb180-127" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>count<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;ADD&quot;</span><span class="op">)</span> <span class="op">==</span> <span class="dv">1</span> <span class="op">&amp;&amp;</span> count<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;MUL&quot;</span><span class="op">)</span> <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb180-128"><a href="#cb180-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-129"><a href="#cb180-129" aria-hidden="true" tabindex="-1"></a>    compile<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;(1 + 2) * (3 + 4)&quot;</span><span class="op">);</span></span>
<span id="cb180-130"><a href="#cb180-130" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>count<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;ADD&quot;</span><span class="op">)</span> <span class="op">==</span> <span class="dv">2</span> <span class="op">&amp;&amp;</span> count<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;MUL&quot;</span><span class="op">)</span> <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> score <span class="op">=</span> score <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb180-131"><a href="#cb180-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-132"><a href="#cb180-132" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score<span class="op">;</span></span>
<span id="cb180-133"><a href="#cb180-133" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h2 data-number="2.5" id="e.-solutions-systeme-dexploitation"><span class="header-section-number">2.5</span> E. Solutions Systeme
d’Exploitation</h2>
<h3 data-number="2.5.1" id="bootstrap"><span class="header-section-number">2.5.1</span> Bootstrap</h3>
<div class="sourceCode" id="cb181"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Bootstrap - Solution</span></span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> bss_start <span class="op">=</span> <span class="bn">0x00402800</span><span class="op">;</span></span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> bss_end <span class="op">=</span> <span class="bn">0x00403000</span><span class="op">;</span></span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb181-7"><a href="#cb181-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">42</span><span class="op">;</span></span>
<span id="cb181-8"><a href="#cb181-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb181-9"><a href="#cb181-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-10"><a href="#cb181-10" aria-hidden="true" tabindex="-1"></a><span class="co">// Note: En vrai, _start serait en ASM</span></span>
<span id="cb181-11"><a href="#cb181-11" aria-hidden="true" tabindex="-1"></a><span class="co">// Ici on simule le concept</span></span>
<span id="cb181-12"><a href="#cb181-12" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> _start<span class="op">()</span> <span class="op">{</span></span>
<span id="cb181-13"><a href="#cb181-13" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> ptr<span class="op">;</span></span>
<span id="cb181-14"><a href="#cb181-14" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> result<span class="op">;</span></span>
<span id="cb181-15"><a href="#cb181-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-16"><a href="#cb181-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Effacer BSS (simulation)</span></span>
<span id="cb181-17"><a href="#cb181-17" aria-hidden="true" tabindex="-1"></a>    ptr <span class="op">=</span> bss_start<span class="op">;</span></span>
<span id="cb181-18"><a href="#cb181-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>ptr <span class="op">&lt;</span> bss_end<span class="op">)</span> <span class="op">{</span></span>
<span id="cb181-19"><a href="#cb181-19" aria-hidden="true" tabindex="-1"></a>        <span class="co">// En vrai: *((int*)ptr) = 0;</span></span>
<span id="cb181-20"><a href="#cb181-20" aria-hidden="true" tabindex="-1"></a>        ptr <span class="op">=</span> ptr <span class="op">+</span> <span class="dv">4</span><span class="op">;</span></span>
<span id="cb181-21"><a href="#cb181-21" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb181-22"><a href="#cb181-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-23"><a href="#cb181-23" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Appeler main</span></span>
<span id="cb181-24"><a href="#cb181-24" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> main<span class="op">();</span></span>
<span id="cb181-25"><a href="#cb181-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-26"><a href="#cb181-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result<span class="op">;</span></span>
<span id="cb181-27"><a href="#cb181-27" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.5.2" id="bump-allocator"><span class="header-section-number">2.5.2</span> Bump Allocator</h3>
<div class="sourceCode" id="cb182"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Bump Allocator - Solution</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> heap_start <span class="op">=</span> <span class="bn">0x00403000</span><span class="op">;</span></span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> heap_end <span class="op">=</span> <span class="bn">0x00410000</span><span class="op">;</span></span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> next_free <span class="op">=</span> <span class="bn">0x00403000</span><span class="op">;</span></span>
<span id="cb182-6"><a href="#cb182-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-7"><a href="#cb182-7" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> bump_alloc<span class="op">(</span><span class="dt">int</span> size<span class="op">)</span> <span class="op">{</span></span>
<span id="cb182-8"><a href="#cb182-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> addr<span class="op">;</span></span>
<span id="cb182-9"><a href="#cb182-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-10"><a href="#cb182-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Vérifier qu&#39;il reste de la place</span></span>
<span id="cb182-11"><a href="#cb182-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>next_free <span class="op">+</span> size <span class="op">&gt;</span> heap_end<span class="op">)</span> <span class="op">{</span></span>
<span id="cb182-12"><a href="#cb182-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb182-13"><a href="#cb182-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb182-14"><a href="#cb182-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-15"><a href="#cb182-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Sauvegarder l&#39;adresse actuelle</span></span>
<span id="cb182-16"><a href="#cb182-16" aria-hidden="true" tabindex="-1"></a>    addr <span class="op">=</span> next_free<span class="op">;</span></span>
<span id="cb182-17"><a href="#cb182-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-18"><a href="#cb182-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Avancer le pointeur</span></span>
<span id="cb182-19"><a href="#cb182-19" aria-hidden="true" tabindex="-1"></a>    next_free <span class="op">=</span> next_free <span class="op">+</span> size<span class="op">;</span></span>
<span id="cb182-20"><a href="#cb182-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-21"><a href="#cb182-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> addr<span class="op">;</span></span>
<span id="cb182-22"><a href="#cb182-22" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb182-23"><a href="#cb182-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-24"><a href="#cb182-24" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb182-25"><a href="#cb182-25" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> ptr1<span class="op">;</span></span>
<span id="cb182-26"><a href="#cb182-26" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> ptr2<span class="op">;</span></span>
<span id="cb182-27"><a href="#cb182-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-28"><a href="#cb182-28" aria-hidden="true" tabindex="-1"></a>    ptr1 <span class="op">=</span> bump_alloc<span class="op">(</span><span class="dv">100</span><span class="op">);</span></span>
<span id="cb182-29"><a href="#cb182-29" aria-hidden="true" tabindex="-1"></a>    ptr2 <span class="op">=</span> bump_alloc<span class="op">(</span><span class="dv">200</span><span class="op">);</span></span>
<span id="cb182-30"><a href="#cb182-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-31"><a href="#cb182-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ptr2 <span class="op">-</span> ptr1<span class="op">;</span></span>
<span id="cb182-32"><a href="#cb182-32" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.5.3" id="free-list"><span class="header-section-number">2.5.3</span> Free List</h3>
<div class="sourceCode" id="cb183"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Free List - Solution simplifiée</span></span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a><span class="co">// Note: Version conceptuelle, pas de vrais pointeurs</span></span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> heap_start <span class="op">=</span> <span class="bn">0x00403000</span><span class="op">;</span></span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> heap_size <span class="op">=</span> <span class="bn">0x1000</span><span class="op">;</span></span>
<span id="cb183-6"><a href="#cb183-6" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> alloc1 <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb183-7"><a href="#cb183-7" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> alloc2 <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb183-8"><a href="#cb183-8" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> freed1 <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb183-9"><a href="#cb183-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-10"><a href="#cb183-10" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> my_malloc<span class="op">(</span><span class="dt">int</span> size<span class="op">)</span> <span class="op">{</span></span>
<span id="cb183-11"><a href="#cb183-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>alloc1 <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb183-12"><a href="#cb183-12" aria-hidden="true" tabindex="-1"></a>        alloc1 <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb183-13"><a href="#cb183-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> heap_start <span class="op">+</span> <span class="dv">100</span><span class="op">;</span></span>
<span id="cb183-14"><a href="#cb183-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb183-15"><a href="#cb183-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>alloc2 <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb183-16"><a href="#cb183-16" aria-hidden="true" tabindex="-1"></a>        alloc2 <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb183-17"><a href="#cb183-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> heap_start <span class="op">+</span> <span class="dv">200</span><span class="op">;</span></span>
<span id="cb183-18"><a href="#cb183-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb183-19"><a href="#cb183-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>freed1 <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb183-20"><a href="#cb183-20" aria-hidden="true" tabindex="-1"></a>        freed1 <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb183-21"><a href="#cb183-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> heap_start <span class="op">+</span> <span class="dv">100</span><span class="op">;</span></span>
<span id="cb183-22"><a href="#cb183-22" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb183-23"><a href="#cb183-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb183-24"><a href="#cb183-24" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb183-25"><a href="#cb183-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-26"><a href="#cb183-26" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> my_free<span class="op">(</span><span class="dt">int</span> ptr<span class="op">)</span> <span class="op">{</span></span>
<span id="cb183-27"><a href="#cb183-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>ptr <span class="op">==</span> heap_start <span class="op">+</span> <span class="dv">100</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb183-28"><a href="#cb183-28" aria-hidden="true" tabindex="-1"></a>        freed1 <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb183-29"><a href="#cb183-29" aria-hidden="true" tabindex="-1"></a>        alloc1 <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb183-30"><a href="#cb183-30" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb183-31"><a href="#cb183-31" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb183-32"><a href="#cb183-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-33"><a href="#cb183-33" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb183-34"><a href="#cb183-34" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> p1<span class="op">;</span></span>
<span id="cb183-35"><a href="#cb183-35" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> p2<span class="op">;</span></span>
<span id="cb183-36"><a href="#cb183-36" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> p3<span class="op">;</span></span>
<span id="cb183-37"><a href="#cb183-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-38"><a href="#cb183-38" aria-hidden="true" tabindex="-1"></a>    p1 <span class="op">=</span> my_malloc<span class="op">(</span><span class="dv">50</span><span class="op">);</span></span>
<span id="cb183-39"><a href="#cb183-39" aria-hidden="true" tabindex="-1"></a>    p2 <span class="op">=</span> my_malloc<span class="op">(</span><span class="dv">50</span><span class="op">);</span></span>
<span id="cb183-40"><a href="#cb183-40" aria-hidden="true" tabindex="-1"></a>    my_free<span class="op">(</span>p1<span class="op">);</span></span>
<span id="cb183-41"><a href="#cb183-41" aria-hidden="true" tabindex="-1"></a>    p3 <span class="op">=</span> my_malloc<span class="op">(</span><span class="dv">30</span><span class="op">);</span></span>
<span id="cb183-42"><a href="#cb183-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-43"><a href="#cb183-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>p3 <span class="op">==</span> p1<span class="op">)</span> <span class="op">{</span></span>
<span id="cb183-44"><a href="#cb183-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb183-45"><a href="#cb183-45" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb183-46"><a href="#cb183-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb183-47"><a href="#cb183-47" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.5.4" id="driver-écran"><span class="header-section-number">2.5.4</span> Driver Écran</h3>
<div class="sourceCode" id="cb184"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Driver Écran - Solution (optimisé)</span></span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> <span class="op">*</span>SCREEN <span class="op">=</span> <span class="op">(</span><span class="dt">int</span><span class="op">*)</span><span class="bn">0x00400000</span><span class="op">;</span></span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-5"><a href="#cb184-5" aria-hidden="true" tabindex="-1"></a><span class="co">// Dessiner une ligne horizontale (optimisé: un seul calcul de row)</span></span>
<span id="cb184-6"><a href="#cb184-6" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> hline<span class="op">(</span><span class="dt">int</span> x1<span class="op">,</span> <span class="dt">int</span> x2<span class="op">,</span> <span class="dt">int</span> y<span class="op">)</span> <span class="op">{</span></span>
<span id="cb184-7"><a href="#cb184-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> row_base<span class="op">;</span></span>
<span id="cb184-8"><a href="#cb184-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> x<span class="op">;</span></span>
<span id="cb184-9"><a href="#cb184-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> byte_idx<span class="op">;</span></span>
<span id="cb184-10"><a href="#cb184-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> bit_pos<span class="op">;</span></span>
<span id="cb184-11"><a href="#cb184-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> <span class="op">*</span>ptr<span class="op">;</span></span>
<span id="cb184-12"><a href="#cb184-12" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> val<span class="op">;</span></span>
<span id="cb184-13"><a href="#cb184-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-14"><a href="#cb184-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">// y * 10 calculé une seule fois</span></span>
<span id="cb184-15"><a href="#cb184-15" aria-hidden="true" tabindex="-1"></a>    row_base <span class="op">=</span> <span class="op">(</span>y <span class="op">&lt;&lt;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span>y <span class="op">&lt;&lt;</span> <span class="dv">1</span><span class="op">);</span>  <span class="co">// y*8 + y*2 = y*10</span></span>
<span id="cb184-16"><a href="#cb184-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-17"><a href="#cb184-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>x <span class="op">=</span> x1<span class="op">;</span> x <span class="op">&lt;=</span> x2<span class="op">;</span> x <span class="op">=</span> x <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb184-18"><a href="#cb184-18" aria-hidden="true" tabindex="-1"></a>        ptr <span class="op">=</span> SCREEN <span class="op">+</span> row_base <span class="op">+</span> <span class="op">(</span>x <span class="op">&gt;&gt;</span> <span class="dv">5</span><span class="op">);</span></span>
<span id="cb184-19"><a href="#cb184-19" aria-hidden="true" tabindex="-1"></a>        byte_idx <span class="op">=</span> <span class="op">(</span>x <span class="op">&gt;&gt;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">&amp;</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb184-20"><a href="#cb184-20" aria-hidden="true" tabindex="-1"></a>        bit_pos <span class="op">=</span> byte_idx <span class="op">*</span> <span class="dv">8</span> <span class="op">+</span> <span class="dv">7</span> <span class="op">-</span> <span class="op">(</span>x <span class="op">&amp;</span> <span class="dv">7</span><span class="op">);</span></span>
<span id="cb184-21"><a href="#cb184-21" aria-hidden="true" tabindex="-1"></a>        val <span class="op">=</span> <span class="op">*</span>ptr<span class="op">;</span></span>
<span id="cb184-22"><a href="#cb184-22" aria-hidden="true" tabindex="-1"></a>        <span class="op">*</span>ptr <span class="op">=</span> val <span class="op">|</span> <span class="op">(</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> bit_pos<span class="op">);</span></span>
<span id="cb184-23"><a href="#cb184-23" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb184-24"><a href="#cb184-24" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb184-25"><a href="#cb184-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-26"><a href="#cb184-26" aria-hidden="true" tabindex="-1"></a><span class="co">// Dessiner une ligne verticale</span></span>
<span id="cb184-27"><a href="#cb184-27" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> vline<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y1<span class="op">,</span> <span class="dt">int</span> y2<span class="op">)</span> <span class="op">{</span></span>
<span id="cb184-28"><a href="#cb184-28" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> y<span class="op">;</span></span>
<span id="cb184-29"><a href="#cb184-29" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> row_base<span class="op">;</span></span>
<span id="cb184-30"><a href="#cb184-30" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> byte_idx<span class="op">;</span></span>
<span id="cb184-31"><a href="#cb184-31" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> bit_pos<span class="op">;</span></span>
<span id="cb184-32"><a href="#cb184-32" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> <span class="op">*</span>ptr<span class="op">;</span></span>
<span id="cb184-33"><a href="#cb184-33" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> val<span class="op">;</span></span>
<span id="cb184-34"><a href="#cb184-34" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> mask<span class="op">;</span></span>
<span id="cb184-35"><a href="#cb184-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-36"><a href="#cb184-36" aria-hidden="true" tabindex="-1"></a>    byte_idx <span class="op">=</span> <span class="op">(</span>x <span class="op">&gt;&gt;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">&amp;</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb184-37"><a href="#cb184-37" aria-hidden="true" tabindex="-1"></a>    bit_pos <span class="op">=</span> byte_idx <span class="op">*</span> <span class="dv">8</span> <span class="op">+</span> <span class="dv">7</span> <span class="op">-</span> <span class="op">(</span>x <span class="op">&amp;</span> <span class="dv">7</span><span class="op">);</span></span>
<span id="cb184-38"><a href="#cb184-38" aria-hidden="true" tabindex="-1"></a>    mask <span class="op">=</span> <span class="dv">1</span> <span class="op">&lt;&lt;</span> bit_pos<span class="op">;</span></span>
<span id="cb184-39"><a href="#cb184-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-40"><a href="#cb184-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>y <span class="op">=</span> y1<span class="op">;</span> y <span class="op">&lt;=</span> y2<span class="op">;</span> y <span class="op">=</span> y <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb184-41"><a href="#cb184-41" aria-hidden="true" tabindex="-1"></a>        row_base <span class="op">=</span> <span class="op">(</span>y <span class="op">&lt;&lt;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span>y <span class="op">&lt;&lt;</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb184-42"><a href="#cb184-42" aria-hidden="true" tabindex="-1"></a>        ptr <span class="op">=</span> SCREEN <span class="op">+</span> row_base <span class="op">+</span> <span class="op">(</span>x <span class="op">&gt;&gt;</span> <span class="dv">5</span><span class="op">);</span></span>
<span id="cb184-43"><a href="#cb184-43" aria-hidden="true" tabindex="-1"></a>        val <span class="op">=</span> <span class="op">*</span>ptr<span class="op">;</span></span>
<span id="cb184-44"><a href="#cb184-44" aria-hidden="true" tabindex="-1"></a>        <span class="op">*</span>ptr <span class="op">=</span> val <span class="op">|</span> mask<span class="op">;</span></span>
<span id="cb184-45"><a href="#cb184-45" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb184-46"><a href="#cb184-46" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb184-47"><a href="#cb184-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-48"><a href="#cb184-48" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb184-49"><a href="#cb184-49" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Dessiner les 4 coins</span></span>
<span id="cb184-50"><a href="#cb184-50" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> <span class="op">*</span>ptr<span class="op">;</span></span>
<span id="cb184-51"><a href="#cb184-51" aria-hidden="true" tabindex="-1"></a>    ptr <span class="op">=</span> SCREEN<span class="op">;</span></span>
<span id="cb184-52"><a href="#cb184-52" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span>ptr <span class="op">=</span> <span class="bn">0xE0E0E0</span><span class="op">;</span>           <span class="co">// Coin haut-gauche (3x3)</span></span>
<span id="cb184-53"><a href="#cb184-53" aria-hidden="true" tabindex="-1"></a>    <span class="op">*(</span>ptr <span class="op">+</span> <span class="dv">10</span><span class="op">)</span> <span class="op">=</span> <span class="bn">0xE0E0E0</span><span class="op">;</span></span>
<span id="cb184-54"><a href="#cb184-54" aria-hidden="true" tabindex="-1"></a>    <span class="op">*(</span>ptr <span class="op">+</span> <span class="dv">20</span><span class="op">)</span> <span class="op">=</span> <span class="bn">0xE0E0E0</span><span class="op">;</span></span>
<span id="cb184-55"><a href="#cb184-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-56"><a href="#cb184-56" aria-hidden="true" tabindex="-1"></a>    ptr <span class="op">=</span> SCREEN <span class="op">+</span> <span class="dv">9</span><span class="op">;</span></span>
<span id="cb184-57"><a href="#cb184-57" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span>ptr <span class="op">=</span> <span class="bn">0x07070700</span><span class="op">;</span>         <span class="co">// Coin haut-droit</span></span>
<span id="cb184-58"><a href="#cb184-58" aria-hidden="true" tabindex="-1"></a>    <span class="op">*(</span>ptr <span class="op">+</span> <span class="dv">10</span><span class="op">)</span> <span class="op">=</span> <span class="bn">0x07070700</span><span class="op">;</span></span>
<span id="cb184-59"><a href="#cb184-59" aria-hidden="true" tabindex="-1"></a>    <span class="op">*(</span>ptr <span class="op">+</span> <span class="dv">20</span><span class="op">)</span> <span class="op">=</span> <span class="bn">0x07070700</span><span class="op">;</span></span>
<span id="cb184-60"><a href="#cb184-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-61"><a href="#cb184-61" aria-hidden="true" tabindex="-1"></a>    ptr <span class="op">=</span> SCREEN <span class="op">+</span> <span class="dv">2370</span><span class="op">;</span>       <span class="co">// Ligne 237</span></span>
<span id="cb184-62"><a href="#cb184-62" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span>ptr <span class="op">=</span> <span class="bn">0xE0E0E0</span><span class="op">;</span>           <span class="co">// Coin bas-gauche</span></span>
<span id="cb184-63"><a href="#cb184-63" aria-hidden="true" tabindex="-1"></a>    <span class="op">*(</span>ptr <span class="op">+</span> <span class="dv">10</span><span class="op">)</span> <span class="op">=</span> <span class="bn">0xE0E0E0</span><span class="op">;</span></span>
<span id="cb184-64"><a href="#cb184-64" aria-hidden="true" tabindex="-1"></a>    <span class="op">*(</span>ptr <span class="op">+</span> <span class="dv">20</span><span class="op">)</span> <span class="op">=</span> <span class="bn">0xE0E0E0</span><span class="op">;</span></span>
<span id="cb184-65"><a href="#cb184-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-66"><a href="#cb184-66" aria-hidden="true" tabindex="-1"></a>    ptr <span class="op">=</span> SCREEN <span class="op">+</span> <span class="dv">2379</span><span class="op">;</span></span>
<span id="cb184-67"><a href="#cb184-67" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span>ptr <span class="op">=</span> <span class="bn">0x07070700</span><span class="op">;</span>         <span class="co">// Coin bas-droit</span></span>
<span id="cb184-68"><a href="#cb184-68" aria-hidden="true" tabindex="-1"></a>    <span class="op">*(</span>ptr <span class="op">+</span> <span class="dv">10</span><span class="op">)</span> <span class="op">=</span> <span class="bn">0x07070700</span><span class="op">;</span></span>
<span id="cb184-69"><a href="#cb184-69" aria-hidden="true" tabindex="-1"></a>    <span class="op">*(</span>ptr <span class="op">+</span> <span class="dv">20</span><span class="op">)</span> <span class="op">=</span> <span class="bn">0x07070700</span><span class="op">;</span></span>
<span id="cb184-70"><a href="#cb184-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-71"><a href="#cb184-71" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Croix au centre</span></span>
<span id="cb184-72"><a href="#cb184-72" aria-hidden="true" tabindex="-1"></a>    hline<span class="op">(</span><span class="dv">120</span><span class="op">,</span> <span class="dv">200</span><span class="op">,</span> <span class="dv">120</span><span class="op">);</span>      <span class="co">// Ligne horizontale</span></span>
<span id="cb184-73"><a href="#cb184-73" aria-hidden="true" tabindex="-1"></a>    vline<span class="op">(</span><span class="dv">160</span><span class="op">,</span> <span class="dv">80</span><span class="op">,</span> <span class="dv">160</span><span class="op">);</span>       <span class="co">// Ligne verticale</span></span>
<span id="cb184-74"><a href="#cb184-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-75"><a href="#cb184-75" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">4</span><span class="op">;</span></span>
<span id="cb184-76"><a href="#cb184-76" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.5.5" id="police-bitmap"><span class="header-section-number">2.5.5</span> Police Bitmap</h3>
<div class="sourceCode" id="cb185"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Police Bitmap - Solution (affichage réel)</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a><span class="co">//</span></span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a><span class="co">// Table des caractères ASCII 8x8 (hex: ligne0-ligne7)</span></span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a><span class="co">// ====================================================</span></span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39; &#39; (32): 0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00</span></span>
<span id="cb185-6"><a href="#cb185-6" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;!&#39; (33): 0x18,0x18,0x18,0x18,0x18,0x00,0x18,0x00</span></span>
<span id="cb185-7"><a href="#cb185-7" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;&quot;&#39; (34): 0x6C,0x6C,0x00,0x00,0x00,0x00,0x00,0x00</span></span>
<span id="cb185-8"><a href="#cb185-8" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;#&#39; (35): 0x24,0x7E,0x24,0x24,0x7E,0x24,0x00,0x00</span></span>
<span id="cb185-9"><a href="#cb185-9" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;$&#39; (36): 0x18,0x3E,0x58,0x3C,0x1A,0x7C,0x18,0x00</span></span>
<span id="cb185-10"><a href="#cb185-10" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;%&#39; (37): 0x62,0x64,0x08,0x10,0x26,0x46,0x00,0x00</span></span>
<span id="cb185-11"><a href="#cb185-11" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;&amp;&#39; (38): 0x30,0x48,0x30,0x56,0x88,0x76,0x00,0x00</span></span>
<span id="cb185-12"><a href="#cb185-12" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;&#39;&#39; (39): 0x18,0x18,0x30,0x00,0x00,0x00,0x00,0x00</span></span>
<span id="cb185-13"><a href="#cb185-13" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;(&#39; (40): 0x0C,0x18,0x30,0x30,0x30,0x18,0x0C,0x00</span></span>
<span id="cb185-14"><a href="#cb185-14" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;)&#39; (41): 0x30,0x18,0x0C,0x0C,0x0C,0x18,0x30,0x00</span></span>
<span id="cb185-15"><a href="#cb185-15" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;*&#39; (42): 0x00,0x24,0x18,0x7E,0x18,0x24,0x00,0x00</span></span>
<span id="cb185-16"><a href="#cb185-16" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;+&#39; (43): 0x00,0x18,0x18,0x7E,0x18,0x18,0x00,0x00</span></span>
<span id="cb185-17"><a href="#cb185-17" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;,&#39; (44): 0x00,0x00,0x00,0x00,0x00,0x18,0x18,0x30</span></span>
<span id="cb185-18"><a href="#cb185-18" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;-&#39; (45): 0x00,0x00,0x00,0x7E,0x00,0x00,0x00,0x00</span></span>
<span id="cb185-19"><a href="#cb185-19" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;.&#39; (46): 0x00,0x00,0x00,0x00,0x00,0x18,0x18,0x00</span></span>
<span id="cb185-20"><a href="#cb185-20" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;/&#39; (47): 0x02,0x04,0x08,0x10,0x20,0x40,0x80,0x00</span></span>
<span id="cb185-21"><a href="#cb185-21" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;0&#39; (48): 0x3C,0x46,0x4A,0x52,0x62,0x3C,0x00,0x00</span></span>
<span id="cb185-22"><a href="#cb185-22" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;1&#39; (49): 0x18,0x38,0x18,0x18,0x18,0x3C,0x00,0x00</span></span>
<span id="cb185-23"><a href="#cb185-23" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;2&#39; (50): 0x3C,0x42,0x02,0x1C,0x20,0x7E,0x00,0x00</span></span>
<span id="cb185-24"><a href="#cb185-24" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;3&#39; (51): 0x3C,0x42,0x0C,0x02,0x42,0x3C,0x00,0x00</span></span>
<span id="cb185-25"><a href="#cb185-25" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;4&#39; (52): 0x04,0x0C,0x14,0x24,0x7E,0x04,0x00,0x00</span></span>
<span id="cb185-26"><a href="#cb185-26" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;5&#39; (53): 0x7E,0x40,0x7C,0x02,0x42,0x3C,0x00,0x00</span></span>
<span id="cb185-27"><a href="#cb185-27" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;6&#39; (54): 0x1C,0x20,0x7C,0x42,0x42,0x3C,0x00,0x00</span></span>
<span id="cb185-28"><a href="#cb185-28" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;7&#39; (55): 0x7E,0x02,0x04,0x08,0x10,0x10,0x00,0x00</span></span>
<span id="cb185-29"><a href="#cb185-29" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;8&#39; (56): 0x3C,0x42,0x3C,0x42,0x42,0x3C,0x00,0x00</span></span>
<span id="cb185-30"><a href="#cb185-30" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;9&#39; (57): 0x3C,0x42,0x42,0x3E,0x04,0x38,0x00,0x00</span></span>
<span id="cb185-31"><a href="#cb185-31" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;:&#39; (58): 0x00,0x18,0x18,0x00,0x18,0x18,0x00,0x00</span></span>
<span id="cb185-32"><a href="#cb185-32" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;;&#39; (59): 0x00,0x18,0x18,0x00,0x18,0x18,0x30,0x00</span></span>
<span id="cb185-33"><a href="#cb185-33" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;&lt;&#39; (60): 0x06,0x18,0x60,0x60,0x18,0x06,0x00,0x00</span></span>
<span id="cb185-34"><a href="#cb185-34" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;=&#39; (61): 0x00,0x00,0x7E,0x00,0x7E,0x00,0x00,0x00</span></span>
<span id="cb185-35"><a href="#cb185-35" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;&gt;&#39; (62): 0x60,0x18,0x06,0x06,0x18,0x60,0x00,0x00</span></span>
<span id="cb185-36"><a href="#cb185-36" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;?&#39; (63): 0x3C,0x42,0x04,0x08,0x00,0x08,0x00,0x00</span></span>
<span id="cb185-37"><a href="#cb185-37" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;@&#39; (64): 0x3C,0x42,0x5E,0x5E,0x40,0x3C,0x00,0x00</span></span>
<span id="cb185-38"><a href="#cb185-38" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;A&#39; (65): 0x18,0x24,0x42,0x7E,0x42,0x42,0x42,0x00</span></span>
<span id="cb185-39"><a href="#cb185-39" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;B&#39; (66): 0x7C,0x42,0x7C,0x42,0x42,0x7C,0x00,0x00</span></span>
<span id="cb185-40"><a href="#cb185-40" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;C&#39; (67): 0x3C,0x42,0x40,0x40,0x42,0x3C,0x00,0x00</span></span>
<span id="cb185-41"><a href="#cb185-41" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;D&#39; (68): 0x78,0x44,0x42,0x42,0x44,0x78,0x00,0x00</span></span>
<span id="cb185-42"><a href="#cb185-42" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;E&#39; (69): 0x7E,0x40,0x7C,0x40,0x40,0x7E,0x00,0x00</span></span>
<span id="cb185-43"><a href="#cb185-43" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;F&#39; (70): 0x7E,0x40,0x7C,0x40,0x40,0x40,0x00,0x00</span></span>
<span id="cb185-44"><a href="#cb185-44" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;G&#39; (71): 0x3C,0x42,0x40,0x4E,0x42,0x3C,0x00,0x00</span></span>
<span id="cb185-45"><a href="#cb185-45" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;H&#39; (72): 0x42,0x42,0x7E,0x42,0x42,0x42,0x00,0x00</span></span>
<span id="cb185-46"><a href="#cb185-46" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;I&#39; (73): 0x3E,0x08,0x08,0x08,0x08,0x3E,0x00,0x00</span></span>
<span id="cb185-47"><a href="#cb185-47" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;J&#39; (74): 0x1E,0x04,0x04,0x04,0x44,0x38,0x00,0x00</span></span>
<span id="cb185-48"><a href="#cb185-48" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;K&#39; (75): 0x42,0x44,0x78,0x48,0x44,0x42,0x00,0x00</span></span>
<span id="cb185-49"><a href="#cb185-49" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;L&#39; (76): 0x40,0x40,0x40,0x40,0x40,0x7E,0x00,0x00</span></span>
<span id="cb185-50"><a href="#cb185-50" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;M&#39; (77): 0x42,0x66,0x5A,0x42,0x42,0x42,0x00,0x00</span></span>
<span id="cb185-51"><a href="#cb185-51" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;N&#39; (78): 0x42,0x62,0x52,0x4A,0x46,0x42,0x00,0x00</span></span>
<span id="cb185-52"><a href="#cb185-52" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;O&#39; (79): 0x3C,0x42,0x42,0x42,0x42,0x3C,0x00,0x00</span></span>
<span id="cb185-53"><a href="#cb185-53" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;P&#39; (80): 0x7C,0x42,0x7C,0x40,0x40,0x40,0x00,0x00</span></span>
<span id="cb185-54"><a href="#cb185-54" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;Q&#39; (81): 0x3C,0x42,0x42,0x4A,0x44,0x3A,0x00,0x00</span></span>
<span id="cb185-55"><a href="#cb185-55" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;R&#39; (82): 0x7C,0x42,0x7C,0x48,0x44,0x42,0x00,0x00</span></span>
<span id="cb185-56"><a href="#cb185-56" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;S&#39; (83): 0x3C,0x40,0x3C,0x02,0x42,0x3C,0x00,0x00</span></span>
<span id="cb185-57"><a href="#cb185-57" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;T&#39; (84): 0x7E,0x18,0x18,0x18,0x18,0x18,0x00,0x00</span></span>
<span id="cb185-58"><a href="#cb185-58" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;U&#39; (85): 0x42,0x42,0x42,0x42,0x42,0x3C,0x00,0x00</span></span>
<span id="cb185-59"><a href="#cb185-59" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;V&#39; (86): 0x42,0x42,0x42,0x42,0x24,0x18,0x00,0x00</span></span>
<span id="cb185-60"><a href="#cb185-60" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;W&#39; (87): 0x42,0x42,0x42,0x5A,0x66,0x42,0x00,0x00</span></span>
<span id="cb185-61"><a href="#cb185-61" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;X&#39; (88): 0x42,0x24,0x18,0x18,0x24,0x42,0x00,0x00</span></span>
<span id="cb185-62"><a href="#cb185-62" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;Y&#39; (89): 0x42,0x42,0x24,0x18,0x18,0x18,0x00,0x00</span></span>
<span id="cb185-63"><a href="#cb185-63" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;Z&#39; (90): 0x7E,0x04,0x08,0x10,0x20,0x7E,0x00,0x00</span></span>
<span id="cb185-64"><a href="#cb185-64" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;[&#39; (91): 0x3C,0x30,0x30,0x30,0x30,0x3C,0x00,0x00</span></span>
<span id="cb185-65"><a href="#cb185-65" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;\\&#39; (92): 0x80,0x40,0x20,0x10,0x08,0x04,0x02,0x00</span></span>
<span id="cb185-66"><a href="#cb185-66" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;]&#39; (93): 0x3C,0x0C,0x0C,0x0C,0x0C,0x3C,0x00,0x00</span></span>
<span id="cb185-67"><a href="#cb185-67" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;^&#39; (94): 0x18,0x24,0x00,0x00,0x00,0x00,0x00,0x00</span></span>
<span id="cb185-68"><a href="#cb185-68" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;_&#39; (95): 0x00,0x00,0x00,0x00,0x00,0x00,0x7E,0x00</span></span>
<span id="cb185-69"><a href="#cb185-69" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;a&#39; (97): 0x00,0x3C,0x02,0x3E,0x42,0x3E,0x00,0x00</span></span>
<span id="cb185-70"><a href="#cb185-70" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;b&#39; (98): 0x40,0x40,0x7C,0x42,0x42,0x7C,0x00,0x00</span></span>
<span id="cb185-71"><a href="#cb185-71" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;c&#39; (99): 0x00,0x3C,0x40,0x40,0x40,0x3C,0x00,0x00</span></span>
<span id="cb185-72"><a href="#cb185-72" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;d&#39;(100): 0x02,0x02,0x3E,0x42,0x42,0x3E,0x00,0x00</span></span>
<span id="cb185-73"><a href="#cb185-73" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;e&#39;(101): 0x00,0x3C,0x42,0x7E,0x40,0x3C,0x00,0x00</span></span>
<span id="cb185-74"><a href="#cb185-74" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;f&#39;(102): 0x0C,0x10,0x3C,0x10,0x10,0x10,0x00,0x00</span></span>
<span id="cb185-75"><a href="#cb185-75" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;g&#39;(103): 0x00,0x3E,0x42,0x3E,0x02,0x3C,0x00,0x00</span></span>
<span id="cb185-76"><a href="#cb185-76" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;h&#39;(104): 0x40,0x40,0x7C,0x42,0x42,0x42,0x00,0x00</span></span>
<span id="cb185-77"><a href="#cb185-77" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;i&#39;(105): 0x18,0x00,0x38,0x18,0x18,0x3C,0x00,0x00</span></span>
<span id="cb185-78"><a href="#cb185-78" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;j&#39;(106): 0x04,0x00,0x04,0x04,0x04,0x44,0x38,0x00</span></span>
<span id="cb185-79"><a href="#cb185-79" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;k&#39;(107): 0x40,0x44,0x48,0x70,0x48,0x44,0x00,0x00</span></span>
<span id="cb185-80"><a href="#cb185-80" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;l&#39;(108): 0x38,0x18,0x18,0x18,0x18,0x3C,0x00,0x00</span></span>
<span id="cb185-81"><a href="#cb185-81" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;m&#39;(109): 0x00,0x76,0x5A,0x5A,0x42,0x42,0x00,0x00</span></span>
<span id="cb185-82"><a href="#cb185-82" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;n&#39;(110): 0x00,0x7C,0x42,0x42,0x42,0x42,0x00,0x00</span></span>
<span id="cb185-83"><a href="#cb185-83" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;o&#39;(111): 0x00,0x3C,0x42,0x42,0x42,0x3C,0x00,0x00</span></span>
<span id="cb185-84"><a href="#cb185-84" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;p&#39;(112): 0x00,0x7C,0x42,0x7C,0x40,0x40,0x00,0x00</span></span>
<span id="cb185-85"><a href="#cb185-85" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;q&#39;(113): 0x00,0x3E,0x42,0x3E,0x02,0x02,0x00,0x00</span></span>
<span id="cb185-86"><a href="#cb185-86" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;r&#39;(114): 0x00,0x5C,0x60,0x40,0x40,0x40,0x00,0x00</span></span>
<span id="cb185-87"><a href="#cb185-87" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;s&#39;(115): 0x00,0x3E,0x40,0x3C,0x02,0x7C,0x00,0x00</span></span>
<span id="cb185-88"><a href="#cb185-88" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;t&#39;(116): 0x10,0x3C,0x10,0x10,0x10,0x0C,0x00,0x00</span></span>
<span id="cb185-89"><a href="#cb185-89" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;u&#39;(117): 0x00,0x42,0x42,0x42,0x42,0x3E,0x00,0x00</span></span>
<span id="cb185-90"><a href="#cb185-90" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;v&#39;(118): 0x00,0x42,0x42,0x42,0x24,0x18,0x00,0x00</span></span>
<span id="cb185-91"><a href="#cb185-91" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;w&#39;(119): 0x00,0x42,0x42,0x5A,0x5A,0x66,0x00,0x00</span></span>
<span id="cb185-92"><a href="#cb185-92" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;x&#39;(120): 0x00,0x42,0x24,0x18,0x24,0x42,0x00,0x00</span></span>
<span id="cb185-93"><a href="#cb185-93" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;y&#39;(121): 0x00,0x42,0x42,0x3E,0x02,0x3C,0x00,0x00</span></span>
<span id="cb185-94"><a href="#cb185-94" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;z&#39;(122): 0x00,0x7E,0x04,0x18,0x20,0x7E,0x00,0x00</span></span>
<span id="cb185-95"><a href="#cb185-95" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;{&#39;(123): 0x0E,0x18,0x30,0x18,0x18,0x0E,0x00,0x00</span></span>
<span id="cb185-96"><a href="#cb185-96" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;|&#39;(124): 0x18,0x18,0x18,0x18,0x18,0x18,0x00,0x00</span></span>
<span id="cb185-97"><a href="#cb185-97" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;}&#39;(125): 0x70,0x18,0x0C,0x18,0x18,0x70,0x00,0x00</span></span>
<span id="cb185-98"><a href="#cb185-98" aria-hidden="true" tabindex="-1"></a><span class="co">// &#39;~&#39;(126): 0x00,0x32,0x4C,0x00,0x00,0x00,0x00,0x00</span></span>
<span id="cb185-99"><a href="#cb185-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-100"><a href="#cb185-100" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> <span class="op">*</span>SCREEN <span class="op">=</span> <span class="op">(</span><span class="dt">int</span><span class="op">*)</span><span class="bn">0x00400000</span><span class="op">;</span></span>
<span id="cb185-101"><a href="#cb185-101" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> pixels_drawn <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb185-102"><a href="#cb185-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-103"><a href="#cb185-103" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> set_pixel<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">)</span> <span class="op">{</span></span>
<span id="cb185-104"><a href="#cb185-104" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> row_base<span class="op">;</span></span>
<span id="cb185-105"><a href="#cb185-105" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> byte_idx<span class="op">;</span></span>
<span id="cb185-106"><a href="#cb185-106" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> bit_pos<span class="op">;</span></span>
<span id="cb185-107"><a href="#cb185-107" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> <span class="op">*</span>ptr<span class="op">;</span></span>
<span id="cb185-108"><a href="#cb185-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-109"><a href="#cb185-109" aria-hidden="true" tabindex="-1"></a>    row_base <span class="op">=</span> <span class="op">(</span>y <span class="op">&lt;&lt;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span>y <span class="op">&lt;&lt;</span> <span class="dv">1</span><span class="op">);</span>  <span class="co">// y * 10</span></span>
<span id="cb185-110"><a href="#cb185-110" aria-hidden="true" tabindex="-1"></a>    ptr <span class="op">=</span> SCREEN <span class="op">+</span> row_base <span class="op">+</span> <span class="op">(</span>x <span class="op">&gt;&gt;</span> <span class="dv">5</span><span class="op">);</span></span>
<span id="cb185-111"><a href="#cb185-111" aria-hidden="true" tabindex="-1"></a>    byte_idx <span class="op">=</span> <span class="op">(</span>x <span class="op">&gt;&gt;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">&amp;</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb185-112"><a href="#cb185-112" aria-hidden="true" tabindex="-1"></a>    bit_pos <span class="op">=</span> byte_idx <span class="op">*</span> <span class="dv">8</span> <span class="op">+</span> <span class="dv">7</span> <span class="op">-</span> <span class="op">(</span>x <span class="op">&amp;</span> <span class="dv">7</span><span class="op">);</span></span>
<span id="cb185-113"><a href="#cb185-113" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span>ptr <span class="op">=</span> <span class="op">*</span>ptr <span class="op">|</span> <span class="op">(</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> bit_pos<span class="op">);</span></span>
<span id="cb185-114"><a href="#cb185-114" aria-hidden="true" tabindex="-1"></a>    pixels_drawn <span class="op">=</span> pixels_drawn <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb185-115"><a href="#cb185-115" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb185-116"><a href="#cb185-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-117"><a href="#cb185-117" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> draw_line<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">,</span> <span class="dt">int</span> line_data<span class="op">)</span> <span class="op">{</span></span>
<span id="cb185-118"><a href="#cb185-118" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> bit<span class="op">;</span></span>
<span id="cb185-119"><a href="#cb185-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-120"><a href="#cb185-120" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>bit <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> bit <span class="op">&lt;</span> <span class="dv">8</span><span class="op">;</span> bit <span class="op">=</span> bit <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb185-121"><a href="#cb185-121" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">((</span>line_data <span class="op">&gt;&gt;</span> <span class="op">(</span><span class="dv">7</span> <span class="op">-</span> bit<span class="op">))</span> <span class="op">&amp;</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb185-122"><a href="#cb185-122" aria-hidden="true" tabindex="-1"></a>            set_pixel<span class="op">(</span>x <span class="op">+</span> bit<span class="op">,</span> y<span class="op">);</span></span>
<span id="cb185-123"><a href="#cb185-123" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb185-124"><a href="#cb185-124" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb185-125"><a href="#cb185-125" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb185-126"><a href="#cb185-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-127"><a href="#cb185-127" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> draw_char<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">,</span> <span class="dt">int</span> line0<span class="op">,</span> <span class="dt">int</span> line1<span class="op">,</span> <span class="dt">int</span> line2<span class="op">,</span> <span class="dt">int</span> line3<span class="op">,</span></span>
<span id="cb185-128"><a href="#cb185-128" aria-hidden="true" tabindex="-1"></a>               <span class="dt">int</span> line4<span class="op">,</span> <span class="dt">int</span> line5<span class="op">,</span> <span class="dt">int</span> line6<span class="op">,</span> <span class="dt">int</span> line7<span class="op">)</span> <span class="op">{</span></span>
<span id="cb185-129"><a href="#cb185-129" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y<span class="op">,</span> line0<span class="op">);</span></span>
<span id="cb185-130"><a href="#cb185-130" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> line1<span class="op">);</span></span>
<span id="cb185-131"><a href="#cb185-131" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> <span class="dv">2</span><span class="op">,</span> line2<span class="op">);</span></span>
<span id="cb185-132"><a href="#cb185-132" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> <span class="dv">3</span><span class="op">,</span> line3<span class="op">);</span></span>
<span id="cb185-133"><a href="#cb185-133" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> <span class="dv">4</span><span class="op">,</span> line4<span class="op">);</span></span>
<span id="cb185-134"><a href="#cb185-134" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> <span class="dv">5</span><span class="op">,</span> line5<span class="op">);</span></span>
<span id="cb185-135"><a href="#cb185-135" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> <span class="dv">6</span><span class="op">,</span> line6<span class="op">);</span></span>
<span id="cb185-136"><a href="#cb185-136" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> <span class="dv">7</span><span class="op">,</span> line7<span class="op">);</span></span>
<span id="cb185-137"><a href="#cb185-137" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb185-138"><a href="#cb185-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-139"><a href="#cb185-139" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb185-140"><a href="#cb185-140" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Dessiner &quot;HI&quot; en grand (position centrale)</span></span>
<span id="cb185-141"><a href="#cb185-141" aria-hidden="true" tabindex="-1"></a>    <span class="co">// H: lignes verticales + barre horizontale</span></span>
<span id="cb185-142"><a href="#cb185-142" aria-hidden="true" tabindex="-1"></a>    draw_char<span class="op">(</span><span class="dv">100</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> <span class="bn">0x42</span><span class="op">,</span> <span class="bn">0x42</span><span class="op">,</span> <span class="bn">0x42</span><span class="op">,</span> <span class="bn">0x7E</span><span class="op">,</span> <span class="bn">0x42</span><span class="op">,</span> <span class="bn">0x42</span><span class="op">,</span> <span class="bn">0x42</span><span class="op">,</span> <span class="bn">0x00</span><span class="op">);</span></span>
<span id="cb185-143"><a href="#cb185-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-144"><a href="#cb185-144" aria-hidden="true" tabindex="-1"></a>    <span class="co">// I: barre verticale centrée</span></span>
<span id="cb185-145"><a href="#cb185-145" aria-hidden="true" tabindex="-1"></a>    draw_char<span class="op">(</span><span class="dv">112</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> <span class="bn">0x3E</span><span class="op">,</span> <span class="bn">0x08</span><span class="op">,</span> <span class="bn">0x08</span><span class="op">,</span> <span class="bn">0x08</span><span class="op">,</span> <span class="bn">0x08</span><span class="op">,</span> <span class="bn">0x08</span><span class="op">,</span> <span class="bn">0x3E</span><span class="op">,</span> <span class="bn">0x00</span><span class="op">);</span></span>
<span id="cb185-146"><a href="#cb185-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-147"><a href="#cb185-147" aria-hidden="true" tabindex="-1"></a>    <span class="co">// A</span></span>
<span id="cb185-148"><a href="#cb185-148" aria-hidden="true" tabindex="-1"></a>    draw_char<span class="op">(</span><span class="dv">124</span><span class="op">,</span> <span class="dv">100</span><span class="op">,</span> <span class="bn">0x18</span><span class="op">,</span> <span class="bn">0x24</span><span class="op">,</span> <span class="bn">0x42</span><span class="op">,</span> <span class="bn">0x7E</span><span class="op">,</span> <span class="bn">0x42</span><span class="op">,</span> <span class="bn">0x42</span><span class="op">,</span> <span class="bn">0x42</span><span class="op">,</span> <span class="bn">0x00</span><span class="op">);</span></span>
<span id="cb185-149"><a href="#cb185-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-150"><a href="#cb185-150" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pixels_drawn<span class="op">;</span></span>
<span id="cb185-151"><a href="#cb185-151" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.5.6" id="console"><span class="header-section-number">2.5.6</span> Console</h3>
<div class="sourceCode" id="cb186"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Console - Solution (affichage réel optimisé)</span></span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> <span class="op">*</span>SCREEN <span class="op">=</span> <span class="op">(</span><span class="dt">int</span><span class="op">*)</span><span class="bn">0x00400000</span><span class="op">;</span></span>
<span id="cb186-4"><a href="#cb186-4" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> cursor_x <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb186-5"><a href="#cb186-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> cursor_y <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb186-6"><a href="#cb186-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-7"><a href="#cb186-7" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> set_pixel<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">)</span> <span class="op">{</span></span>
<span id="cb186-8"><a href="#cb186-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> row_base<span class="op">;</span></span>
<span id="cb186-9"><a href="#cb186-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> <span class="op">*</span>ptr<span class="op">;</span></span>
<span id="cb186-10"><a href="#cb186-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> bit_pos<span class="op">;</span></span>
<span id="cb186-11"><a href="#cb186-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-12"><a href="#cb186-12" aria-hidden="true" tabindex="-1"></a>    row_base <span class="op">=</span> <span class="op">(</span>y <span class="op">&lt;&lt;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span>y <span class="op">&lt;&lt;</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb186-13"><a href="#cb186-13" aria-hidden="true" tabindex="-1"></a>    ptr <span class="op">=</span> SCREEN <span class="op">+</span> row_base <span class="op">+</span> <span class="op">(</span>x <span class="op">&gt;&gt;</span> <span class="dv">5</span><span class="op">);</span></span>
<span id="cb186-14"><a href="#cb186-14" aria-hidden="true" tabindex="-1"></a>    bit_pos <span class="op">=</span> <span class="op">((</span>x <span class="op">&gt;&gt;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">&amp;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">*</span> <span class="dv">8</span> <span class="op">+</span> <span class="dv">7</span> <span class="op">-</span> <span class="op">(</span>x <span class="op">&amp;</span> <span class="dv">7</span><span class="op">);</span></span>
<span id="cb186-15"><a href="#cb186-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span>ptr <span class="op">=</span> <span class="op">*</span>ptr <span class="op">|</span> <span class="op">(</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> bit_pos<span class="op">);</span></span>
<span id="cb186-16"><a href="#cb186-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb186-17"><a href="#cb186-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-18"><a href="#cb186-18" aria-hidden="true" tabindex="-1"></a><span class="co">// Dessine une ligne de 8 pixels</span></span>
<span id="cb186-19"><a href="#cb186-19" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> draw_line<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">,</span> <span class="dt">int</span> data<span class="op">)</span> <span class="op">{</span></span>
<span id="cb186-20"><a href="#cb186-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>data <span class="op">&amp;</span> <span class="bn">0x80</span><span class="op">)</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">);</span></span>
<span id="cb186-21"><a href="#cb186-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>data <span class="op">&amp;</span> <span class="bn">0x40</span><span class="op">)</span> set_pixel<span class="op">(</span>x <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> y<span class="op">);</span></span>
<span id="cb186-22"><a href="#cb186-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>data <span class="op">&amp;</span> <span class="bn">0x20</span><span class="op">)</span> set_pixel<span class="op">(</span>x <span class="op">+</span> <span class="dv">2</span><span class="op">,</span> y<span class="op">);</span></span>
<span id="cb186-23"><a href="#cb186-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>data <span class="op">&amp;</span> <span class="bn">0x10</span><span class="op">)</span> set_pixel<span class="op">(</span>x <span class="op">+</span> <span class="dv">3</span><span class="op">,</span> y<span class="op">);</span></span>
<span id="cb186-24"><a href="#cb186-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>data <span class="op">&amp;</span> <span class="bn">0x08</span><span class="op">)</span> set_pixel<span class="op">(</span>x <span class="op">+</span> <span class="dv">4</span><span class="op">,</span> y<span class="op">);</span></span>
<span id="cb186-25"><a href="#cb186-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>data <span class="op">&amp;</span> <span class="bn">0x04</span><span class="op">)</span> set_pixel<span class="op">(</span>x <span class="op">+</span> <span class="dv">5</span><span class="op">,</span> y<span class="op">);</span></span>
<span id="cb186-26"><a href="#cb186-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>data <span class="op">&amp;</span> <span class="bn">0x02</span><span class="op">)</span> set_pixel<span class="op">(</span>x <span class="op">+</span> <span class="dv">6</span><span class="op">,</span> y<span class="op">);</span></span>
<span id="cb186-27"><a href="#cb186-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>data <span class="op">&amp;</span> <span class="bn">0x01</span><span class="op">)</span> set_pixel<span class="op">(</span>x <span class="op">+</span> <span class="dv">7</span><span class="op">,</span> y<span class="op">);</span></span>
<span id="cb186-28"><a href="#cb186-28" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb186-29"><a href="#cb186-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-30"><a href="#cb186-30" aria-hidden="true" tabindex="-1"></a><span class="co">// Dessine H à (x, y)</span></span>
<span id="cb186-31"><a href="#cb186-31" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> draw_H<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">)</span> <span class="op">{</span></span>
<span id="cb186-32"><a href="#cb186-32" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y<span class="op">,</span> <span class="bn">0x42</span><span class="op">);</span></span>
<span id="cb186-33"><a href="#cb186-33" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> <span class="bn">0x42</span><span class="op">);</span></span>
<span id="cb186-34"><a href="#cb186-34" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> <span class="dv">2</span><span class="op">,</span> <span class="bn">0x7E</span><span class="op">);</span></span>
<span id="cb186-35"><a href="#cb186-35" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> <span class="dv">3</span><span class="op">,</span> <span class="bn">0x42</span><span class="op">);</span></span>
<span id="cb186-36"><a href="#cb186-36" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> <span class="dv">4</span><span class="op">,</span> <span class="bn">0x42</span><span class="op">);</span></span>
<span id="cb186-37"><a href="#cb186-37" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> <span class="dv">5</span><span class="op">,</span> <span class="bn">0x42</span><span class="op">);</span></span>
<span id="cb186-38"><a href="#cb186-38" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb186-39"><a href="#cb186-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-40"><a href="#cb186-40" aria-hidden="true" tabindex="-1"></a><span class="co">// Dessine e à (x, y)</span></span>
<span id="cb186-41"><a href="#cb186-41" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> draw_e<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">)</span> <span class="op">{</span></span>
<span id="cb186-42"><a href="#cb186-42" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> <span class="dv">2</span><span class="op">,</span> <span class="bn">0x3C</span><span class="op">);</span></span>
<span id="cb186-43"><a href="#cb186-43" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> <span class="dv">3</span><span class="op">,</span> <span class="bn">0x42</span><span class="op">);</span></span>
<span id="cb186-44"><a href="#cb186-44" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> <span class="dv">4</span><span class="op">,</span> <span class="bn">0x7E</span><span class="op">);</span></span>
<span id="cb186-45"><a href="#cb186-45" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> <span class="dv">5</span><span class="op">,</span> <span class="bn">0x40</span><span class="op">);</span></span>
<span id="cb186-46"><a href="#cb186-46" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> <span class="dv">6</span><span class="op">,</span> <span class="bn">0x3C</span><span class="op">);</span></span>
<span id="cb186-47"><a href="#cb186-47" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb186-48"><a href="#cb186-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-49"><a href="#cb186-49" aria-hidden="true" tabindex="-1"></a><span class="co">// Dessine l à (x, y)</span></span>
<span id="cb186-50"><a href="#cb186-50" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> draw_l<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">)</span> <span class="op">{</span></span>
<span id="cb186-51"><a href="#cb186-51" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y<span class="op">,</span> <span class="bn">0x38</span><span class="op">);</span></span>
<span id="cb186-52"><a href="#cb186-52" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> <span class="bn">0x18</span><span class="op">);</span></span>
<span id="cb186-53"><a href="#cb186-53" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> <span class="dv">2</span><span class="op">,</span> <span class="bn">0x18</span><span class="op">);</span></span>
<span id="cb186-54"><a href="#cb186-54" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> <span class="dv">3</span><span class="op">,</span> <span class="bn">0x18</span><span class="op">);</span></span>
<span id="cb186-55"><a href="#cb186-55" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> <span class="dv">4</span><span class="op">,</span> <span class="bn">0x18</span><span class="op">);</span></span>
<span id="cb186-56"><a href="#cb186-56" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> <span class="dv">5</span><span class="op">,</span> <span class="bn">0x3C</span><span class="op">);</span></span>
<span id="cb186-57"><a href="#cb186-57" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb186-58"><a href="#cb186-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-59"><a href="#cb186-59" aria-hidden="true" tabindex="-1"></a><span class="co">// Dessine o à (x, y)</span></span>
<span id="cb186-60"><a href="#cb186-60" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> draw_o<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">)</span> <span class="op">{</span></span>
<span id="cb186-61"><a href="#cb186-61" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> <span class="dv">2</span><span class="op">,</span> <span class="bn">0x3C</span><span class="op">);</span></span>
<span id="cb186-62"><a href="#cb186-62" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> <span class="dv">3</span><span class="op">,</span> <span class="bn">0x42</span><span class="op">);</span></span>
<span id="cb186-63"><a href="#cb186-63" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> <span class="dv">4</span><span class="op">,</span> <span class="bn">0x42</span><span class="op">);</span></span>
<span id="cb186-64"><a href="#cb186-64" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> <span class="dv">5</span><span class="op">,</span> <span class="bn">0x42</span><span class="op">);</span></span>
<span id="cb186-65"><a href="#cb186-65" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> <span class="dv">6</span><span class="op">,</span> <span class="bn">0x3C</span><span class="op">);</span></span>
<span id="cb186-66"><a href="#cb186-66" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb186-67"><a href="#cb186-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-68"><a href="#cb186-68" aria-hidden="true" tabindex="-1"></a><span class="co">// Dessine W à (x, y)</span></span>
<span id="cb186-69"><a href="#cb186-69" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> draw_W<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">)</span> <span class="op">{</span></span>
<span id="cb186-70"><a href="#cb186-70" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y<span class="op">,</span> <span class="bn">0x42</span><span class="op">);</span></span>
<span id="cb186-71"><a href="#cb186-71" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> <span class="bn">0x42</span><span class="op">);</span></span>
<span id="cb186-72"><a href="#cb186-72" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> <span class="dv">2</span><span class="op">,</span> <span class="bn">0x42</span><span class="op">);</span></span>
<span id="cb186-73"><a href="#cb186-73" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> <span class="dv">3</span><span class="op">,</span> <span class="bn">0x5A</span><span class="op">);</span></span>
<span id="cb186-74"><a href="#cb186-74" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> <span class="dv">4</span><span class="op">,</span> <span class="bn">0x66</span><span class="op">);</span></span>
<span id="cb186-75"><a href="#cb186-75" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> <span class="dv">5</span><span class="op">,</span> <span class="bn">0x42</span><span class="op">);</span></span>
<span id="cb186-76"><a href="#cb186-76" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb186-77"><a href="#cb186-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-78"><a href="#cb186-78" aria-hidden="true" tabindex="-1"></a><span class="co">// Dessine r à (x, y)</span></span>
<span id="cb186-79"><a href="#cb186-79" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> draw_r<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">)</span> <span class="op">{</span></span>
<span id="cb186-80"><a href="#cb186-80" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> <span class="dv">2</span><span class="op">,</span> <span class="bn">0x5C</span><span class="op">);</span></span>
<span id="cb186-81"><a href="#cb186-81" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> <span class="dv">3</span><span class="op">,</span> <span class="bn">0x60</span><span class="op">);</span></span>
<span id="cb186-82"><a href="#cb186-82" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> <span class="dv">4</span><span class="op">,</span> <span class="bn">0x40</span><span class="op">);</span></span>
<span id="cb186-83"><a href="#cb186-83" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> <span class="dv">5</span><span class="op">,</span> <span class="bn">0x40</span><span class="op">);</span></span>
<span id="cb186-84"><a href="#cb186-84" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> <span class="dv">6</span><span class="op">,</span> <span class="bn">0x40</span><span class="op">);</span></span>
<span id="cb186-85"><a href="#cb186-85" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb186-86"><a href="#cb186-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-87"><a href="#cb186-87" aria-hidden="true" tabindex="-1"></a><span class="co">// Dessine d à (x, y)</span></span>
<span id="cb186-88"><a href="#cb186-88" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> draw_d<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">)</span> <span class="op">{</span></span>
<span id="cb186-89"><a href="#cb186-89" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y<span class="op">,</span> <span class="bn">0x02</span><span class="op">);</span></span>
<span id="cb186-90"><a href="#cb186-90" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> <span class="bn">0x02</span><span class="op">);</span></span>
<span id="cb186-91"><a href="#cb186-91" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> <span class="dv">2</span><span class="op">,</span> <span class="bn">0x3E</span><span class="op">);</span></span>
<span id="cb186-92"><a href="#cb186-92" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> <span class="dv">3</span><span class="op">,</span> <span class="bn">0x42</span><span class="op">);</span></span>
<span id="cb186-93"><a href="#cb186-93" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> <span class="dv">4</span><span class="op">,</span> <span class="bn">0x42</span><span class="op">);</span></span>
<span id="cb186-94"><a href="#cb186-94" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> <span class="dv">5</span><span class="op">,</span> <span class="bn">0x3E</span><span class="op">);</span></span>
<span id="cb186-95"><a href="#cb186-95" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb186-96"><a href="#cb186-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-97"><a href="#cb186-97" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb186-98"><a href="#cb186-98" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Hello (ligne 0, y=0)</span></span>
<span id="cb186-99"><a href="#cb186-99" aria-hidden="true" tabindex="-1"></a>    draw_H<span class="op">(</span><span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb186-100"><a href="#cb186-100" aria-hidden="true" tabindex="-1"></a>    draw_e<span class="op">(</span><span class="dv">8</span><span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb186-101"><a href="#cb186-101" aria-hidden="true" tabindex="-1"></a>    draw_l<span class="op">(</span><span class="dv">16</span><span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb186-102"><a href="#cb186-102" aria-hidden="true" tabindex="-1"></a>    draw_l<span class="op">(</span><span class="dv">24</span><span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb186-103"><a href="#cb186-103" aria-hidden="true" tabindex="-1"></a>    draw_o<span class="op">(</span><span class="dv">32</span><span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb186-104"><a href="#cb186-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-105"><a href="#cb186-105" aria-hidden="true" tabindex="-1"></a>    <span class="co">// World (ligne 1, y=8)</span></span>
<span id="cb186-106"><a href="#cb186-106" aria-hidden="true" tabindex="-1"></a>    draw_W<span class="op">(</span><span class="dv">0</span><span class="op">,</span> <span class="dv">8</span><span class="op">);</span></span>
<span id="cb186-107"><a href="#cb186-107" aria-hidden="true" tabindex="-1"></a>    draw_o<span class="op">(</span><span class="dv">8</span><span class="op">,</span> <span class="dv">8</span><span class="op">);</span></span>
<span id="cb186-108"><a href="#cb186-108" aria-hidden="true" tabindex="-1"></a>    draw_r<span class="op">(</span><span class="dv">16</span><span class="op">,</span> <span class="dv">8</span><span class="op">);</span></span>
<span id="cb186-109"><a href="#cb186-109" aria-hidden="true" tabindex="-1"></a>    draw_l<span class="op">(</span><span class="dv">24</span><span class="op">,</span> <span class="dv">8</span><span class="op">);</span></span>
<span id="cb186-110"><a href="#cb186-110" aria-hidden="true" tabindex="-1"></a>    draw_d<span class="op">(</span><span class="dv">32</span><span class="op">,</span> <span class="dv">8</span><span class="op">);</span></span>
<span id="cb186-111"><a href="#cb186-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-112"><a href="#cb186-112" aria-hidden="true" tabindex="-1"></a>    cursor_y <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb186-113"><a href="#cb186-113" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cursor_y<span class="op">;</span></span>
<span id="cb186-114"><a href="#cb186-114" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.5.7" id="driver-clavier"><span class="header-section-number">2.5.7</span> Driver Clavier</h3>
<div class="sourceCode" id="cb187"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Driver Clavier - Solution Interactive</span></span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a><span class="co">// Activez &quot;Capturer clavier&quot; et appuyez sur des touches!</span></span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> <span class="op">*</span>SCREEN <span class="op">=</span> <span class="op">(</span><span class="dt">int</span><span class="op">*)</span><span class="bn">0x00400000</span><span class="op">;</span></span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> <span class="op">*</span>KEYBOARD <span class="op">=</span> <span class="op">(</span><span class="dt">int</span><span class="op">*)</span><span class="bn">0x00402600</span><span class="op">;</span></span>
<span id="cb187-6"><a href="#cb187-6" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> key_count <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb187-7"><a href="#cb187-7" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> cursor_x <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb187-8"><a href="#cb187-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-9"><a href="#cb187-9" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> set_pixel<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">)</span> <span class="op">{</span></span>
<span id="cb187-10"><a href="#cb187-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> row_base<span class="op">;</span></span>
<span id="cb187-11"><a href="#cb187-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> <span class="op">*</span>ptr<span class="op">;</span></span>
<span id="cb187-12"><a href="#cb187-12" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> bit_pos<span class="op">;</span></span>
<span id="cb187-13"><a href="#cb187-13" aria-hidden="true" tabindex="-1"></a>    row_base <span class="op">=</span> <span class="op">(</span>y <span class="op">&lt;&lt;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span>y <span class="op">&lt;&lt;</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb187-14"><a href="#cb187-14" aria-hidden="true" tabindex="-1"></a>    ptr <span class="op">=</span> SCREEN <span class="op">+</span> row_base <span class="op">+</span> <span class="op">(</span>x <span class="op">&gt;&gt;</span> <span class="dv">5</span><span class="op">);</span></span>
<span id="cb187-15"><a href="#cb187-15" aria-hidden="true" tabindex="-1"></a>    bit_pos <span class="op">=</span> <span class="op">((</span>x <span class="op">&gt;&gt;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">&amp;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">*</span> <span class="dv">8</span> <span class="op">+</span> <span class="dv">7</span> <span class="op">-</span> <span class="op">(</span>x <span class="op">&amp;</span> <span class="dv">7</span><span class="op">);</span></span>
<span id="cb187-16"><a href="#cb187-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span>ptr <span class="op">=</span> <span class="op">*</span>ptr <span class="op">|</span> <span class="op">(</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> bit_pos<span class="op">);</span></span>
<span id="cb187-17"><a href="#cb187-17" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb187-18"><a href="#cb187-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-19"><a href="#cb187-19" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> draw_line<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">,</span> <span class="dt">int</span> data<span class="op">)</span> <span class="op">{</span></span>
<span id="cb187-20"><a href="#cb187-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>data <span class="op">&amp;</span> <span class="bn">0x80</span><span class="op">)</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">);</span></span>
<span id="cb187-21"><a href="#cb187-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>data <span class="op">&amp;</span> <span class="bn">0x40</span><span class="op">)</span> set_pixel<span class="op">(</span>x <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> y<span class="op">);</span></span>
<span id="cb187-22"><a href="#cb187-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>data <span class="op">&amp;</span> <span class="bn">0x20</span><span class="op">)</span> set_pixel<span class="op">(</span>x <span class="op">+</span> <span class="dv">2</span><span class="op">,</span> y<span class="op">);</span></span>
<span id="cb187-23"><a href="#cb187-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>data <span class="op">&amp;</span> <span class="bn">0x10</span><span class="op">)</span> set_pixel<span class="op">(</span>x <span class="op">+</span> <span class="dv">3</span><span class="op">,</span> y<span class="op">);</span></span>
<span id="cb187-24"><a href="#cb187-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>data <span class="op">&amp;</span> <span class="bn">0x08</span><span class="op">)</span> set_pixel<span class="op">(</span>x <span class="op">+</span> <span class="dv">4</span><span class="op">,</span> y<span class="op">);</span></span>
<span id="cb187-25"><a href="#cb187-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>data <span class="op">&amp;</span> <span class="bn">0x04</span><span class="op">)</span> set_pixel<span class="op">(</span>x <span class="op">+</span> <span class="dv">5</span><span class="op">,</span> y<span class="op">);</span></span>
<span id="cb187-26"><a href="#cb187-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>data <span class="op">&amp;</span> <span class="bn">0x02</span><span class="op">)</span> set_pixel<span class="op">(</span>x <span class="op">+</span> <span class="dv">6</span><span class="op">,</span> y<span class="op">);</span></span>
<span id="cb187-27"><a href="#cb187-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>data <span class="op">&amp;</span> <span class="bn">0x01</span><span class="op">)</span> set_pixel<span class="op">(</span>x <span class="op">+</span> <span class="dv">7</span><span class="op">,</span> y<span class="op">);</span></span>
<span id="cb187-28"><a href="#cb187-28" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb187-29"><a href="#cb187-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-30"><a href="#cb187-30" aria-hidden="true" tabindex="-1"></a><span class="co">// Dessine un caractère générique (carré avec le code)</span></span>
<span id="cb187-31"><a href="#cb187-31" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> draw_key<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">,</span> <span class="dt">int</span> key<span class="op">)</span> <span class="op">{</span></span>
<span id="cb187-32"><a href="#cb187-32" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Dessiner un petit carré pour indiquer la touche</span></span>
<span id="cb187-33"><a href="#cb187-33" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y<span class="op">,</span> <span class="bn">0xFF</span><span class="op">);</span></span>
<span id="cb187-34"><a href="#cb187-34" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> <span class="bn">0x81</span><span class="op">);</span></span>
<span id="cb187-35"><a href="#cb187-35" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> <span class="dv">2</span><span class="op">,</span> <span class="bn">0x81</span><span class="op">);</span></span>
<span id="cb187-36"><a href="#cb187-36" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> <span class="dv">3</span><span class="op">,</span> <span class="bn">0x81</span><span class="op">);</span></span>
<span id="cb187-37"><a href="#cb187-37" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> <span class="dv">4</span><span class="op">,</span> <span class="bn">0x81</span><span class="op">);</span></span>
<span id="cb187-38"><a href="#cb187-38" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> <span class="dv">5</span><span class="op">,</span> <span class="bn">0x81</span><span class="op">);</span></span>
<span id="cb187-39"><a href="#cb187-39" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> <span class="dv">6</span><span class="op">,</span> <span class="bn">0x81</span><span class="op">);</span></span>
<span id="cb187-40"><a href="#cb187-40" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> <span class="dv">7</span><span class="op">,</span> <span class="bn">0xFF</span><span class="op">);</span></span>
<span id="cb187-41"><a href="#cb187-41" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Afficher une marque au centre basée sur le code</span></span>
<span id="cb187-42"><a href="#cb187-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>key <span class="op">&amp;</span> <span class="dv">1</span><span class="op">)</span> set_pixel<span class="op">(</span>x <span class="op">+</span> <span class="dv">3</span><span class="op">,</span> y <span class="op">+</span> <span class="dv">3</span><span class="op">);</span></span>
<span id="cb187-43"><a href="#cb187-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>key <span class="op">&amp;</span> <span class="dv">2</span><span class="op">)</span> set_pixel<span class="op">(</span>x <span class="op">+</span> <span class="dv">4</span><span class="op">,</span> y <span class="op">+</span> <span class="dv">3</span><span class="op">);</span></span>
<span id="cb187-44"><a href="#cb187-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>key <span class="op">&amp;</span> <span class="dv">4</span><span class="op">)</span> set_pixel<span class="op">(</span>x <span class="op">+</span> <span class="dv">3</span><span class="op">,</span> y <span class="op">+</span> <span class="dv">4</span><span class="op">);</span></span>
<span id="cb187-45"><a href="#cb187-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>key <span class="op">&amp;</span> <span class="dv">8</span><span class="op">)</span> set_pixel<span class="op">(</span>x <span class="op">+</span> <span class="dv">4</span><span class="op">,</span> y <span class="op">+</span> <span class="dv">4</span><span class="op">);</span></span>
<span id="cb187-46"><a href="#cb187-46" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb187-47"><a href="#cb187-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-48"><a href="#cb187-48" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> read_key<span class="op">()</span> <span class="op">{</span></span>
<span id="cb187-49"><a href="#cb187-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">*</span>KEYBOARD<span class="op">;</span></span>
<span id="cb187-50"><a href="#cb187-50" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb187-51"><a href="#cb187-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-52"><a href="#cb187-52" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb187-53"><a href="#cb187-53" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> key<span class="op">;</span></span>
<span id="cb187-54"><a href="#cb187-54" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> last_key<span class="op">;</span></span>
<span id="cb187-55"><a href="#cb187-55" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> timeout<span class="op">;</span></span>
<span id="cb187-56"><a href="#cb187-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-57"><a href="#cb187-57" aria-hidden="true" tabindex="-1"></a>    last_key <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb187-58"><a href="#cb187-58" aria-hidden="true" tabindex="-1"></a>    timeout <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb187-59"><a href="#cb187-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-60"><a href="#cb187-60" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Afficher 5 indicateurs en haut</span></span>
<span id="cb187-61"><a href="#cb187-61" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span><span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="bn">0xFF</span><span class="op">);</span></span>
<span id="cb187-62"><a href="#cb187-62" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span><span class="dv">0</span><span class="op">,</span> <span class="dv">7</span><span class="op">,</span> <span class="bn">0xFF</span><span class="op">);</span></span>
<span id="cb187-63"><a href="#cb187-63" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span><span class="dv">10</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="bn">0xFF</span><span class="op">);</span></span>
<span id="cb187-64"><a href="#cb187-64" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span><span class="dv">10</span><span class="op">,</span> <span class="dv">7</span><span class="op">,</span> <span class="bn">0xFF</span><span class="op">);</span></span>
<span id="cb187-65"><a href="#cb187-65" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span><span class="dv">20</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="bn">0xFF</span><span class="op">);</span></span>
<span id="cb187-66"><a href="#cb187-66" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span><span class="dv">20</span><span class="op">,</span> <span class="dv">7</span><span class="op">,</span> <span class="bn">0xFF</span><span class="op">);</span></span>
<span id="cb187-67"><a href="#cb187-67" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span><span class="dv">30</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="bn">0xFF</span><span class="op">);</span></span>
<span id="cb187-68"><a href="#cb187-68" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span><span class="dv">30</span><span class="op">,</span> <span class="dv">7</span><span class="op">,</span> <span class="bn">0xFF</span><span class="op">);</span></span>
<span id="cb187-69"><a href="#cb187-69" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span><span class="dv">40</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="bn">0xFF</span><span class="op">);</span></span>
<span id="cb187-70"><a href="#cb187-70" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span><span class="dv">40</span><span class="op">,</span> <span class="dv">7</span><span class="op">,</span> <span class="bn">0xFF</span><span class="op">);</span></span>
<span id="cb187-71"><a href="#cb187-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-72"><a href="#cb187-72" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Boucle principale: attendre 5 touches (avec timeout)</span></span>
<span id="cb187-73"><a href="#cb187-73" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>key_count <span class="op">&lt;</span> <span class="dv">5</span> <span class="op">&amp;&amp;</span> timeout <span class="op">&lt;</span> <span class="dv">100000</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb187-74"><a href="#cb187-74" aria-hidden="true" tabindex="-1"></a>        key <span class="op">=</span> read_key<span class="op">();</span></span>
<span id="cb187-75"><a href="#cb187-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-76"><a href="#cb187-76" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Nouvelle touche pressée?</span></span>
<span id="cb187-77"><a href="#cb187-77" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>key <span class="op">!=</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> key <span class="op">!=</span> last_key<span class="op">)</span> <span class="op">{</span></span>
<span id="cb187-78"><a href="#cb187-78" aria-hidden="true" tabindex="-1"></a>            draw_key<span class="op">(</span>cursor_x<span class="op">,</span> <span class="dv">16</span><span class="op">,</span> key<span class="op">);</span></span>
<span id="cb187-79"><a href="#cb187-79" aria-hidden="true" tabindex="-1"></a>            cursor_x <span class="op">=</span> cursor_x <span class="op">+</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="cb187-80"><a href="#cb187-80" aria-hidden="true" tabindex="-1"></a>            key_count <span class="op">=</span> key_count <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb187-81"><a href="#cb187-81" aria-hidden="true" tabindex="-1"></a>            timeout <span class="op">=</span> <span class="dv">0</span><span class="op">;</span>  <span class="co">// Reset timeout quand touche pressée</span></span>
<span id="cb187-82"><a href="#cb187-82" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb187-83"><a href="#cb187-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-84"><a href="#cb187-84" aria-hidden="true" tabindex="-1"></a>        last_key <span class="op">=</span> key<span class="op">;</span></span>
<span id="cb187-85"><a href="#cb187-85" aria-hidden="true" tabindex="-1"></a>        timeout <span class="op">=</span> timeout <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb187-86"><a href="#cb187-86" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb187-87"><a href="#cb187-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-88"><a href="#cb187-88" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Si timeout atteint sans 5 touches, retourner quand même key_count</span></span>
<span id="cb187-89"><a href="#cb187-89" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span>  <span class="co">// Test visuel uniquement</span></span>
<span id="cb187-90"><a href="#cb187-90" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.5.8" id="shell"><span class="header-section-number">2.5.8</span> Shell</h3>
<div class="sourceCode" id="cb188"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Shell Interactif - Solution</span></span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a><span class="co">// Cochez &quot;Capturer clavier&quot; et tapez des chiffres!</span></span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> <span class="op">*</span>SCREEN <span class="op">=</span> <span class="op">(</span><span class="dt">int</span><span class="op">*)</span><span class="bn">0x00400000</span><span class="op">;</span></span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> <span class="op">*</span>KEYBOARD <span class="op">=</span> <span class="op">(</span><span class="dt">int</span><span class="op">*)</span><span class="bn">0x00402600</span><span class="op">;</span></span>
<span id="cb188-6"><a href="#cb188-6" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> number <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb188-7"><a href="#cb188-7" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> cursor_x <span class="op">=</span> <span class="dv">16</span><span class="op">;</span></span>
<span id="cb188-8"><a href="#cb188-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-9"><a href="#cb188-9" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> set_pixel<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">)</span> <span class="op">{</span></span>
<span id="cb188-10"><a href="#cb188-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> row_base<span class="op">;</span></span>
<span id="cb188-11"><a href="#cb188-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> <span class="op">*</span>ptr<span class="op">;</span></span>
<span id="cb188-12"><a href="#cb188-12" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> bit_pos<span class="op">;</span></span>
<span id="cb188-13"><a href="#cb188-13" aria-hidden="true" tabindex="-1"></a>    row_base <span class="op">=</span> <span class="op">(</span>y <span class="op">&lt;&lt;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span>y <span class="op">&lt;&lt;</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb188-14"><a href="#cb188-14" aria-hidden="true" tabindex="-1"></a>    ptr <span class="op">=</span> SCREEN <span class="op">+</span> row_base <span class="op">+</span> <span class="op">(</span>x <span class="op">&gt;&gt;</span> <span class="dv">5</span><span class="op">);</span></span>
<span id="cb188-15"><a href="#cb188-15" aria-hidden="true" tabindex="-1"></a>    bit_pos <span class="op">=</span> <span class="op">((</span>x <span class="op">&gt;&gt;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">&amp;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">*</span> <span class="dv">8</span> <span class="op">+</span> <span class="dv">7</span> <span class="op">-</span> <span class="op">(</span>x <span class="op">&amp;</span> <span class="dv">7</span><span class="op">);</span></span>
<span id="cb188-16"><a href="#cb188-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span>ptr <span class="op">=</span> <span class="op">*</span>ptr <span class="op">|</span> <span class="op">(</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> bit_pos<span class="op">);</span></span>
<span id="cb188-17"><a href="#cb188-17" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb188-18"><a href="#cb188-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-19"><a href="#cb188-19" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> draw_line<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">,</span> <span class="dt">int</span> data<span class="op">)</span> <span class="op">{</span></span>
<span id="cb188-20"><a href="#cb188-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>data <span class="op">&amp;</span> <span class="bn">0x80</span><span class="op">)</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">);</span></span>
<span id="cb188-21"><a href="#cb188-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>data <span class="op">&amp;</span> <span class="bn">0x40</span><span class="op">)</span> set_pixel<span class="op">(</span>x <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> y<span class="op">);</span></span>
<span id="cb188-22"><a href="#cb188-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>data <span class="op">&amp;</span> <span class="bn">0x20</span><span class="op">)</span> set_pixel<span class="op">(</span>x <span class="op">+</span> <span class="dv">2</span><span class="op">,</span> y<span class="op">);</span></span>
<span id="cb188-23"><a href="#cb188-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>data <span class="op">&amp;</span> <span class="bn">0x10</span><span class="op">)</span> set_pixel<span class="op">(</span>x <span class="op">+</span> <span class="dv">3</span><span class="op">,</span> y<span class="op">);</span></span>
<span id="cb188-24"><a href="#cb188-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>data <span class="op">&amp;</span> <span class="bn">0x08</span><span class="op">)</span> set_pixel<span class="op">(</span>x <span class="op">+</span> <span class="dv">4</span><span class="op">,</span> y<span class="op">);</span></span>
<span id="cb188-25"><a href="#cb188-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>data <span class="op">&amp;</span> <span class="bn">0x04</span><span class="op">)</span> set_pixel<span class="op">(</span>x <span class="op">+</span> <span class="dv">5</span><span class="op">,</span> y<span class="op">);</span></span>
<span id="cb188-26"><a href="#cb188-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>data <span class="op">&amp;</span> <span class="bn">0x02</span><span class="op">)</span> set_pixel<span class="op">(</span>x <span class="op">+</span> <span class="dv">6</span><span class="op">,</span> y<span class="op">);</span></span>
<span id="cb188-27"><a href="#cb188-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>data <span class="op">&amp;</span> <span class="bn">0x01</span><span class="op">)</span> set_pixel<span class="op">(</span>x <span class="op">+</span> <span class="dv">7</span><span class="op">,</span> y<span class="op">);</span></span>
<span id="cb188-28"><a href="#cb188-28" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb188-29"><a href="#cb188-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-30"><a href="#cb188-30" aria-hidden="true" tabindex="-1"></a><span class="co">// Dessine &quot;&gt;&quot; prompt</span></span>
<span id="cb188-31"><a href="#cb188-31" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> show_prompt<span class="op">()</span> <span class="op">{</span></span>
<span id="cb188-32"><a href="#cb188-32" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span><span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="bn">0x40</span><span class="op">);</span></span>
<span id="cb188-33"><a href="#cb188-33" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span><span class="dv">0</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="bn">0x20</span><span class="op">);</span></span>
<span id="cb188-34"><a href="#cb188-34" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span><span class="dv">0</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="bn">0x10</span><span class="op">);</span></span>
<span id="cb188-35"><a href="#cb188-35" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span><span class="dv">0</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="bn">0x20</span><span class="op">);</span></span>
<span id="cb188-36"><a href="#cb188-36" aria-hidden="true" tabindex="-1"></a>    draw_line<span class="op">(</span><span class="dv">0</span><span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="bn">0x40</span><span class="op">);</span></span>
<span id="cb188-37"><a href="#cb188-37" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb188-38"><a href="#cb188-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-39"><a href="#cb188-39" aria-hidden="true" tabindex="-1"></a><span class="co">// Dessine un chiffre simplifié</span></span>
<span id="cb188-40"><a href="#cb188-40" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> draw_digit<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> d<span class="op">)</span> <span class="op">{</span></span>
<span id="cb188-41"><a href="#cb188-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb188-42"><a href="#cb188-42" aria-hidden="true" tabindex="-1"></a>        draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="bn">0x3C</span><span class="op">);</span> draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="bn">0x42</span><span class="op">);</span></span>
<span id="cb188-43"><a href="#cb188-43" aria-hidden="true" tabindex="-1"></a>        draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="bn">0x42</span><span class="op">);</span> draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="bn">0x42</span><span class="op">);</span></span>
<span id="cb188-44"><a href="#cb188-44" aria-hidden="true" tabindex="-1"></a>        draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="bn">0x42</span><span class="op">);</span> draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="bn">0x3C</span><span class="op">);</span></span>
<span id="cb188-45"><a href="#cb188-45" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb188-46"><a href="#cb188-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb188-47"><a href="#cb188-47" aria-hidden="true" tabindex="-1"></a>        draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="bn">0x18</span><span class="op">);</span> draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="bn">0x38</span><span class="op">);</span></span>
<span id="cb188-48"><a href="#cb188-48" aria-hidden="true" tabindex="-1"></a>        draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="bn">0x18</span><span class="op">);</span> draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="bn">0x18</span><span class="op">);</span></span>
<span id="cb188-49"><a href="#cb188-49" aria-hidden="true" tabindex="-1"></a>        draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="bn">0x18</span><span class="op">);</span> draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="bn">0x3C</span><span class="op">);</span></span>
<span id="cb188-50"><a href="#cb188-50" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb188-51"><a href="#cb188-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">==</span> <span class="dv">2</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb188-52"><a href="#cb188-52" aria-hidden="true" tabindex="-1"></a>        draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="bn">0x3C</span><span class="op">);</span> draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="bn">0x42</span><span class="op">);</span></span>
<span id="cb188-53"><a href="#cb188-53" aria-hidden="true" tabindex="-1"></a>        draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="bn">0x04</span><span class="op">);</span> draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="bn">0x18</span><span class="op">);</span></span>
<span id="cb188-54"><a href="#cb188-54" aria-hidden="true" tabindex="-1"></a>        draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="bn">0x20</span><span class="op">);</span> draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="bn">0x7E</span><span class="op">);</span></span>
<span id="cb188-55"><a href="#cb188-55" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb188-56"><a href="#cb188-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">==</span> <span class="dv">3</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb188-57"><a href="#cb188-57" aria-hidden="true" tabindex="-1"></a>        draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="bn">0x3C</span><span class="op">);</span> draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="bn">0x42</span><span class="op">);</span></span>
<span id="cb188-58"><a href="#cb188-58" aria-hidden="true" tabindex="-1"></a>        draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="bn">0x0C</span><span class="op">);</span> draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="bn">0x02</span><span class="op">);</span></span>
<span id="cb188-59"><a href="#cb188-59" aria-hidden="true" tabindex="-1"></a>        draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="bn">0x42</span><span class="op">);</span> draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="bn">0x3C</span><span class="op">);</span></span>
<span id="cb188-60"><a href="#cb188-60" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb188-61"><a href="#cb188-61" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">==</span> <span class="dv">4</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb188-62"><a href="#cb188-62" aria-hidden="true" tabindex="-1"></a>        draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="bn">0x04</span><span class="op">);</span> draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="bn">0x0C</span><span class="op">);</span></span>
<span id="cb188-63"><a href="#cb188-63" aria-hidden="true" tabindex="-1"></a>        draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="bn">0x14</span><span class="op">);</span> draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="bn">0x24</span><span class="op">);</span></span>
<span id="cb188-64"><a href="#cb188-64" aria-hidden="true" tabindex="-1"></a>        draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="bn">0x7E</span><span class="op">);</span> draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="bn">0x04</span><span class="op">);</span></span>
<span id="cb188-65"><a href="#cb188-65" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb188-66"><a href="#cb188-66" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">==</span> <span class="dv">5</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb188-67"><a href="#cb188-67" aria-hidden="true" tabindex="-1"></a>        draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="bn">0x7E</span><span class="op">);</span> draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="bn">0x40</span><span class="op">);</span></span>
<span id="cb188-68"><a href="#cb188-68" aria-hidden="true" tabindex="-1"></a>        draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="bn">0x7C</span><span class="op">);</span> draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="bn">0x02</span><span class="op">);</span></span>
<span id="cb188-69"><a href="#cb188-69" aria-hidden="true" tabindex="-1"></a>        draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="bn">0x42</span><span class="op">);</span> draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="bn">0x3C</span><span class="op">);</span></span>
<span id="cb188-70"><a href="#cb188-70" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb188-71"><a href="#cb188-71" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">==</span> <span class="dv">6</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb188-72"><a href="#cb188-72" aria-hidden="true" tabindex="-1"></a>        draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="bn">0x1C</span><span class="op">);</span> draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="bn">0x20</span><span class="op">);</span></span>
<span id="cb188-73"><a href="#cb188-73" aria-hidden="true" tabindex="-1"></a>        draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="bn">0x7C</span><span class="op">);</span> draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="bn">0x42</span><span class="op">);</span></span>
<span id="cb188-74"><a href="#cb188-74" aria-hidden="true" tabindex="-1"></a>        draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="bn">0x42</span><span class="op">);</span> draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="bn">0x3C</span><span class="op">);</span></span>
<span id="cb188-75"><a href="#cb188-75" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb188-76"><a href="#cb188-76" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">==</span> <span class="dv">7</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb188-77"><a href="#cb188-77" aria-hidden="true" tabindex="-1"></a>        draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="bn">0x7E</span><span class="op">);</span> draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="bn">0x02</span><span class="op">);</span></span>
<span id="cb188-78"><a href="#cb188-78" aria-hidden="true" tabindex="-1"></a>        draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="bn">0x04</span><span class="op">);</span> draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="bn">0x08</span><span class="op">);</span></span>
<span id="cb188-79"><a href="#cb188-79" aria-hidden="true" tabindex="-1"></a>        draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="bn">0x10</span><span class="op">);</span> draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="bn">0x10</span><span class="op">);</span></span>
<span id="cb188-80"><a href="#cb188-80" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb188-81"><a href="#cb188-81" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">==</span> <span class="dv">8</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb188-82"><a href="#cb188-82" aria-hidden="true" tabindex="-1"></a>        draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="bn">0x3C</span><span class="op">);</span> draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="bn">0x42</span><span class="op">);</span></span>
<span id="cb188-83"><a href="#cb188-83" aria-hidden="true" tabindex="-1"></a>        draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="bn">0x3C</span><span class="op">);</span> draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="bn">0x42</span><span class="op">);</span></span>
<span id="cb188-84"><a href="#cb188-84" aria-hidden="true" tabindex="-1"></a>        draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="bn">0x42</span><span class="op">);</span> draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="bn">0x3C</span><span class="op">);</span></span>
<span id="cb188-85"><a href="#cb188-85" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb188-86"><a href="#cb188-86" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">==</span> <span class="dv">9</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb188-87"><a href="#cb188-87" aria-hidden="true" tabindex="-1"></a>        draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="bn">0x3C</span><span class="op">);</span> draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="bn">0x42</span><span class="op">);</span></span>
<span id="cb188-88"><a href="#cb188-88" aria-hidden="true" tabindex="-1"></a>        draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="bn">0x42</span><span class="op">);</span> draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="bn">0x3E</span><span class="op">);</span></span>
<span id="cb188-89"><a href="#cb188-89" aria-hidden="true" tabindex="-1"></a>        draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="bn">0x04</span><span class="op">);</span> draw_line<span class="op">(</span>x<span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="bn">0x38</span><span class="op">);</span></span>
<span id="cb188-90"><a href="#cb188-90" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb188-91"><a href="#cb188-91" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb188-92"><a href="#cb188-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-93"><a href="#cb188-93" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> read_key<span class="op">()</span> <span class="op">{</span></span>
<span id="cb188-94"><a href="#cb188-94" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">*</span>KEYBOARD<span class="op">;</span></span>
<span id="cb188-95"><a href="#cb188-95" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb188-96"><a href="#cb188-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-97"><a href="#cb188-97" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb188-98"><a href="#cb188-98" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> key<span class="op">;</span></span>
<span id="cb188-99"><a href="#cb188-99" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> last_key<span class="op">;</span></span>
<span id="cb188-100"><a href="#cb188-100" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> timeout<span class="op">;</span></span>
<span id="cb188-101"><a href="#cb188-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-102"><a href="#cb188-102" aria-hidden="true" tabindex="-1"></a>    last_key <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb188-103"><a href="#cb188-103" aria-hidden="true" tabindex="-1"></a>    timeout <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb188-104"><a href="#cb188-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-105"><a href="#cb188-105" aria-hidden="true" tabindex="-1"></a>    show_prompt<span class="op">();</span></span>
<span id="cb188-106"><a href="#cb188-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-107"><a href="#cb188-107" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>timeout <span class="op">&lt;</span> <span class="dv">50000</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb188-108"><a href="#cb188-108" aria-hidden="true" tabindex="-1"></a>        key <span class="op">=</span> read_key<span class="op">();</span></span>
<span id="cb188-109"><a href="#cb188-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-110"><a href="#cb188-110" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>key <span class="op">!=</span> last_key <span class="op">&amp;&amp;</span> key <span class="op">!=</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb188-111"><a href="#cb188-111" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Esc (27) = quitter</span></span>
<span id="cb188-112"><a href="#cb188-112" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>key <span class="op">==</span> <span class="dv">27</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb188-113"><a href="#cb188-113" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> number<span class="op">;</span></span>
<span id="cb188-114"><a href="#cb188-114" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb188-115"><a href="#cb188-115" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Enter (13) = terminer</span></span>
<span id="cb188-116"><a href="#cb188-116" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>key <span class="op">==</span> <span class="dv">13</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb188-117"><a href="#cb188-117" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> number<span class="op">;</span></span>
<span id="cb188-118"><a href="#cb188-118" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb188-119"><a href="#cb188-119" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Chiffres 0-9 (48-57)</span></span>
<span id="cb188-120"><a href="#cb188-120" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>key <span class="op">&gt;=</span> <span class="dv">48</span> <span class="op">&amp;&amp;</span> key <span class="op">&lt;=</span> <span class="dv">57</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb188-121"><a href="#cb188-121" aria-hidden="true" tabindex="-1"></a>                draw_digit<span class="op">(</span>cursor_x<span class="op">,</span> key <span class="op">-</span> <span class="dv">48</span><span class="op">);</span></span>
<span id="cb188-122"><a href="#cb188-122" aria-hidden="true" tabindex="-1"></a>                cursor_x <span class="op">=</span> cursor_x <span class="op">+</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="cb188-123"><a href="#cb188-123" aria-hidden="true" tabindex="-1"></a>                number <span class="op">=</span> number <span class="op">*</span> <span class="dv">10</span> <span class="op">+</span> <span class="op">(</span>key <span class="op">-</span> <span class="dv">48</span><span class="op">);</span></span>
<span id="cb188-124"><a href="#cb188-124" aria-hidden="true" tabindex="-1"></a>                timeout <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb188-125"><a href="#cb188-125" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb188-126"><a href="#cb188-126" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb188-127"><a href="#cb188-127" aria-hidden="true" tabindex="-1"></a>        last_key <span class="op">=</span> key<span class="op">;</span></span>
<span id="cb188-128"><a href="#cb188-128" aria-hidden="true" tabindex="-1"></a>        timeout <span class="op">=</span> timeout <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb188-129"><a href="#cb188-129" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb188-130"><a href="#cb188-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-131"><a href="#cb188-131" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> number<span class="op">;</span></span>
<span id="cb188-132"><a href="#cb188-132" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.5.9" id="calculatrice"><span class="header-section-number">2.5.9</span> Calculatrice</h3>
<div class="sourceCode" id="cb189"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Calculatrice Interactive - Solution</span></span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a><span class="co">// Cochez &quot;Capturer clavier&quot;, tapez: 3+5 Enter</span></span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-4"><a href="#cb189-4" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> <span class="op">*</span>SCREEN <span class="op">=</span> <span class="op">(</span><span class="dt">int</span><span class="op">*)</span><span class="bn">0x00400000</span><span class="op">;</span></span>
<span id="cb189-5"><a href="#cb189-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> <span class="op">*</span>KEYBOARD <span class="op">=</span> <span class="op">(</span><span class="dt">int</span><span class="op">*)</span><span class="bn">0x00402600</span><span class="op">;</span></span>
<span id="cb189-6"><a href="#cb189-6" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> cursor_x <span class="op">=</span> <span class="dv">4</span><span class="op">;</span></span>
<span id="cb189-7"><a href="#cb189-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-8"><a href="#cb189-8" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> set_pixel<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">)</span> <span class="op">{</span></span>
<span id="cb189-9"><a href="#cb189-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> <span class="op">*</span>ptr<span class="op">;</span></span>
<span id="cb189-10"><a href="#cb189-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> bit_pos<span class="op">;</span></span>
<span id="cb189-11"><a href="#cb189-11" aria-hidden="true" tabindex="-1"></a>    ptr <span class="op">=</span> SCREEN <span class="op">+</span> <span class="op">(</span>y <span class="op">&lt;&lt;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span>y <span class="op">&lt;&lt;</span> <span class="dv">1</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span>x <span class="op">&gt;&gt;</span> <span class="dv">5</span><span class="op">);</span></span>
<span id="cb189-12"><a href="#cb189-12" aria-hidden="true" tabindex="-1"></a>    bit_pos <span class="op">=</span> <span class="op">((</span>x <span class="op">&gt;&gt;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">&amp;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">*</span> <span class="dv">8</span> <span class="op">+</span> <span class="dv">7</span> <span class="op">-</span> <span class="op">(</span>x <span class="op">&amp;</span> <span class="dv">7</span><span class="op">);</span></span>
<span id="cb189-13"><a href="#cb189-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span>ptr <span class="op">=</span> <span class="op">*</span>ptr <span class="op">|</span> <span class="op">(</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> bit_pos<span class="op">);</span></span>
<span id="cb189-14"><a href="#cb189-14" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb189-15"><a href="#cb189-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-16"><a href="#cb189-16" aria-hidden="true" tabindex="-1"></a><span class="co">// Chiffre 3x5 pixels</span></span>
<span id="cb189-17"><a href="#cb189-17" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> draw_digit<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">,</span> <span class="dt">int</span> d<span class="op">)</span> <span class="op">{</span></span>
<span id="cb189-18"><a href="#cb189-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">!=</span> <span class="dv">1</span> <span class="op">&amp;&amp;</span> d <span class="op">!=</span> <span class="dv">4</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">);</span> <span class="op">}</span></span>
<span id="cb189-19"><a href="#cb189-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">==</span> <span class="dv">0</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">4</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">5</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">6</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">8</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">9</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">1</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb189-20"><a href="#cb189-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">!=</span> <span class="dv">5</span> <span class="op">&amp;&amp;</span> d <span class="op">!=</span> <span class="dv">6</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">+</span><span class="dv">1</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb189-21"><a href="#cb189-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">!=</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> d <span class="op">!=</span> <span class="dv">1</span> <span class="op">&amp;&amp;</span> d <span class="op">!=</span> <span class="dv">7</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb189-22"><a href="#cb189-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">==</span> <span class="dv">0</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">2</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">6</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">8</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">3</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb189-23"><a href="#cb189-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">!=</span> <span class="dv">2</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">+</span><span class="dv">3</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb189-24"><a href="#cb189-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">!=</span> <span class="dv">1</span> <span class="op">&amp;&amp;</span> d <span class="op">!=</span> <span class="dv">4</span> <span class="op">&amp;&amp;</span> d <span class="op">!=</span> <span class="dv">7</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">4</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">4</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">+</span><span class="dv">4</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb189-25"><a href="#cb189-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">1</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">3</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">4</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb189-26"><a href="#cb189-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">==</span> <span class="dv">7</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">);</span> <span class="op">}</span></span>
<span id="cb189-27"><a href="#cb189-27" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb189-28"><a href="#cb189-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-29"><a href="#cb189-29" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> draw_plus<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">)</span> <span class="op">{</span></span>
<span id="cb189-30"><a href="#cb189-30" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">1</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span></span>
<span id="cb189-31"><a href="#cb189-31" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">1</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">+</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb189-32"><a href="#cb189-32" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb189-33"><a href="#cb189-33" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> draw_minus<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">1</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">1</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">+</span><span class="dv">1</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb189-34"><a href="#cb189-34" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> draw_times<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">,</span>y<span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span>y<span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span>y<span class="op">+</span><span class="dv">1</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">,</span>y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span>y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb189-35"><a href="#cb189-35" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> draw_equal<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">,</span>y<span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span>y<span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span>y<span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">,</span>y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span>y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span>y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb189-36"><a href="#cb189-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-37"><a href="#cb189-37" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb189-38"><a href="#cb189-38" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> key<span class="op">;</span> <span class="dt">int</span> lk<span class="op">;</span> <span class="dt">int</span> a<span class="op">;</span> <span class="dt">int</span> b<span class="op">;</span> <span class="dt">int</span> op<span class="op">;</span> <span class="dt">int</span> st<span class="op">;</span> <span class="dt">int</span> r<span class="op">;</span> <span class="dt">int</span> t<span class="op">;</span> <span class="dt">int</span> tens<span class="op">;</span> <span class="dt">int</span> u<span class="op">;</span></span>
<span id="cb189-39"><a href="#cb189-39" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> b <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> op <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> st <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> lk <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> t <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb189-40"><a href="#cb189-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-41"><a href="#cb189-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>t <span class="op">&lt;</span> <span class="dv">50000</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb189-42"><a href="#cb189-42" aria-hidden="true" tabindex="-1"></a>        key <span class="op">=</span> <span class="op">*</span>KEYBOARD<span class="op">;</span></span>
<span id="cb189-43"><a href="#cb189-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>key <span class="op">!=</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> key <span class="op">!=</span> lk<span class="op">)</span> <span class="op">{</span></span>
<span id="cb189-44"><a href="#cb189-44" aria-hidden="true" tabindex="-1"></a>            t <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb189-45"><a href="#cb189-45" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>key <span class="op">==</span> <span class="dv">13</span> <span class="op">&amp;&amp;</span> st <span class="op">==</span> <span class="dv">2</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb189-46"><a href="#cb189-46" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="op">(</span>op <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> r <span class="op">=</span> a <span class="op">+</span> b<span class="op">;</span></span>
<span id="cb189-47"><a href="#cb189-47" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="op">(</span>op <span class="op">==</span> <span class="dv">2</span><span class="op">)</span> r <span class="op">=</span> a <span class="op">-</span> b<span class="op">;</span></span>
<span id="cb189-48"><a href="#cb189-48" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="op">(</span>op <span class="op">==</span> <span class="dv">3</span><span class="op">)</span> r <span class="op">=</span> a <span class="op">*</span> b<span class="op">;</span></span>
<span id="cb189-49"><a href="#cb189-49" aria-hidden="true" tabindex="-1"></a>                draw_equal<span class="op">(</span>cursor_x<span class="op">,</span> <span class="dv">10</span><span class="op">);</span> cursor_x <span class="op">=</span> cursor_x <span class="op">+</span> <span class="dv">5</span><span class="op">;</span></span>
<span id="cb189-50"><a href="#cb189-50" aria-hidden="true" tabindex="-1"></a>                tens <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> u <span class="op">=</span> r<span class="op">;</span></span>
<span id="cb189-51"><a href="#cb189-51" aria-hidden="true" tabindex="-1"></a>                <span class="cf">while</span> <span class="op">(</span>u <span class="op">&gt;=</span> <span class="dv">10</span><span class="op">)</span> <span class="op">{</span> u <span class="op">=</span> u <span class="op">-</span> <span class="dv">10</span><span class="op">;</span> tens <span class="op">=</span> tens <span class="op">+</span> <span class="dv">1</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb189-52"><a href="#cb189-52" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="op">(</span>tens <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span> draw_digit<span class="op">(</span>cursor_x<span class="op">,</span> <span class="dv">10</span><span class="op">,</span> tens<span class="op">);</span> cursor_x <span class="op">=</span> cursor_x <span class="op">+</span> <span class="dv">5</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb189-53"><a href="#cb189-53" aria-hidden="true" tabindex="-1"></a>                draw_digit<span class="op">(</span>cursor_x<span class="op">,</span> <span class="dv">10</span><span class="op">,</span> u<span class="op">);</span></span>
<span id="cb189-54"><a href="#cb189-54" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> r<span class="op">;</span></span>
<span id="cb189-55"><a href="#cb189-55" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb189-56"><a href="#cb189-56" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>key <span class="op">&gt;=</span> <span class="dv">48</span> <span class="op">&amp;&amp;</span> key <span class="op">&lt;=</span> <span class="dv">57</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb189-57"><a href="#cb189-57" aria-hidden="true" tabindex="-1"></a>                draw_digit<span class="op">(</span>cursor_x<span class="op">,</span> <span class="dv">10</span><span class="op">,</span> key <span class="op">-</span> <span class="dv">48</span><span class="op">);</span></span>
<span id="cb189-58"><a href="#cb189-58" aria-hidden="true" tabindex="-1"></a>                cursor_x <span class="op">=</span> cursor_x <span class="op">+</span> <span class="dv">5</span><span class="op">;</span></span>
<span id="cb189-59"><a href="#cb189-59" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="op">(</span>st <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span> a <span class="op">=</span> key <span class="op">-</span> <span class="dv">48</span><span class="op">;</span> st <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb189-60"><a href="#cb189-60" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>st <span class="op">==</span> <span class="dv">2</span><span class="op">)</span> <span class="op">{</span> b <span class="op">=</span> key <span class="op">-</span> <span class="dv">48</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb189-61"><a href="#cb189-61" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb189-62"><a href="#cb189-62" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>key <span class="op">==</span> <span class="dv">43</span> <span class="op">&amp;&amp;</span> st <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span> draw_plus<span class="op">(</span>cursor_x<span class="op">,</span> <span class="dv">10</span><span class="op">);</span> cursor_x <span class="op">=</span> cursor_x <span class="op">+</span> <span class="dv">5</span><span class="op">;</span> op <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> st <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb189-63"><a href="#cb189-63" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>key <span class="op">==</span> <span class="dv">45</span> <span class="op">&amp;&amp;</span> st <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span> draw_minus<span class="op">(</span>cursor_x<span class="op">,</span> <span class="dv">10</span><span class="op">);</span> cursor_x <span class="op">=</span> cursor_x <span class="op">+</span> <span class="dv">5</span><span class="op">;</span> op <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> st <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb189-64"><a href="#cb189-64" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>key <span class="op">==</span> <span class="dv">42</span> <span class="op">&amp;&amp;</span> st <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span> draw_times<span class="op">(</span>cursor_x<span class="op">,</span> <span class="dv">10</span><span class="op">);</span> cursor_x <span class="op">=</span> cursor_x <span class="op">+</span> <span class="dv">5</span><span class="op">;</span> op <span class="op">=</span> <span class="dv">3</span><span class="op">;</span> st <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb189-65"><a href="#cb189-65" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb189-66"><a href="#cb189-66" aria-hidden="true" tabindex="-1"></a>        lk <span class="op">=</span> key<span class="op">;</span> t <span class="op">=</span> t <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb189-67"><a href="#cb189-67" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb189-68"><a href="#cb189-68" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb189-69"><a href="#cb189-69" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.5.10" id="variables-shell"><span class="header-section-number">2.5.10</span> Variables Shell</h3>
<div class="sourceCode" id="cb190"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Variables Shell Interactive - Solution</span></span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a><span class="co">// Cochez &quot;Capturer clavier&quot;, tapez: a=5 b=3 Enter</span></span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-4"><a href="#cb190-4" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> <span class="op">*</span>SCREEN <span class="op">=</span> <span class="op">(</span><span class="dt">int</span><span class="op">*)</span><span class="bn">0x00400000</span><span class="op">;</span></span>
<span id="cb190-5"><a href="#cb190-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> <span class="op">*</span>KEYBOARD <span class="op">=</span> <span class="op">(</span><span class="dt">int</span><span class="op">*)</span><span class="bn">0x00402600</span><span class="op">;</span></span>
<span id="cb190-6"><a href="#cb190-6" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> cursor_x <span class="op">=</span> <span class="dv">4</span><span class="op">;</span></span>
<span id="cb190-7"><a href="#cb190-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-8"><a href="#cb190-8" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> var_names<span class="op">[</span><span class="dv">8</span><span class="op">];</span></span>
<span id="cb190-9"><a href="#cb190-9" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> var_values<span class="op">[</span><span class="dv">8</span><span class="op">];</span></span>
<span id="cb190-10"><a href="#cb190-10" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> var_count <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb190-11"><a href="#cb190-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-12"><a href="#cb190-12" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> set_pixel<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">)</span> <span class="op">{</span></span>
<span id="cb190-13"><a href="#cb190-13" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> <span class="op">*</span>ptr<span class="op">;</span></span>
<span id="cb190-14"><a href="#cb190-14" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> bit_pos<span class="op">;</span></span>
<span id="cb190-15"><a href="#cb190-15" aria-hidden="true" tabindex="-1"></a>    ptr <span class="op">=</span> SCREEN <span class="op">+</span> <span class="op">(</span>y <span class="op">&lt;&lt;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span>y <span class="op">&lt;&lt;</span> <span class="dv">1</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span>x <span class="op">&gt;&gt;</span> <span class="dv">5</span><span class="op">);</span></span>
<span id="cb190-16"><a href="#cb190-16" aria-hidden="true" tabindex="-1"></a>    bit_pos <span class="op">=</span> <span class="op">((</span>x <span class="op">&gt;&gt;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">&amp;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">*</span> <span class="dv">8</span> <span class="op">+</span> <span class="dv">7</span> <span class="op">-</span> <span class="op">(</span>x <span class="op">&amp;</span> <span class="dv">7</span><span class="op">);</span></span>
<span id="cb190-17"><a href="#cb190-17" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span>ptr <span class="op">=</span> <span class="op">*</span>ptr <span class="op">|</span> <span class="op">(</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> bit_pos<span class="op">);</span></span>
<span id="cb190-18"><a href="#cb190-18" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb190-19"><a href="#cb190-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-20"><a href="#cb190-20" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> draw_char<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">,</span> <span class="dt">int</span> c<span class="op">)</span> <span class="op">{</span></span>
<span id="cb190-21"><a href="#cb190-21" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i<span class="op">;</span></span>
<span id="cb190-22"><a href="#cb190-22" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Lettre = ligne verticale + petit trait</span></span>
<span id="cb190-23"><a href="#cb190-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>c <span class="op">&gt;=</span> <span class="dv">97</span> <span class="op">&amp;&amp;</span> c <span class="op">&lt;=</span> <span class="dv">122</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb190-24"><a href="#cb190-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span>i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">5</span><span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> i<span class="op">);</span> <span class="op">}</span></span>
<span id="cb190-25"><a href="#cb190-25" aria-hidden="true" tabindex="-1"></a>        set_pixel<span class="op">(</span>x <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> y <span class="op">+</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb190-26"><a href="#cb190-26" aria-hidden="true" tabindex="-1"></a>        set_pixel<span class="op">(</span>x <span class="op">+</span> <span class="dv">2</span><span class="op">,</span> y <span class="op">+</span> <span class="op">(</span>c <span class="op">-</span> <span class="dv">97</span><span class="op">)</span> <span class="op">%</span> <span class="dv">3</span><span class="op">);</span></span>
<span id="cb190-27"><a href="#cb190-27" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb190-28"><a href="#cb190-28" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Chiffre 3x5</span></span>
<span id="cb190-29"><a href="#cb190-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>c <span class="op">&gt;=</span> <span class="dv">48</span> <span class="op">&amp;&amp;</span> c <span class="op">&lt;=</span> <span class="dv">57</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb190-30"><a href="#cb190-30" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> d<span class="op">;</span></span>
<span id="cb190-31"><a href="#cb190-31" aria-hidden="true" tabindex="-1"></a>        d <span class="op">=</span> c <span class="op">-</span> <span class="dv">48</span><span class="op">;</span></span>
<span id="cb190-32"><a href="#cb190-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>d <span class="op">!=</span> <span class="dv">1</span> <span class="op">&amp;&amp;</span> d <span class="op">!=</span> <span class="dv">4</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">);</span> <span class="op">}</span></span>
<span id="cb190-33"><a href="#cb190-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>d <span class="op">==</span> <span class="dv">0</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">4</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">5</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">6</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">8</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">9</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">1</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb190-34"><a href="#cb190-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>d <span class="op">!=</span> <span class="dv">5</span> <span class="op">&amp;&amp;</span> d <span class="op">!=</span> <span class="dv">6</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">+</span><span class="dv">1</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb190-35"><a href="#cb190-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>d <span class="op">!=</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> d <span class="op">!=</span> <span class="dv">1</span> <span class="op">&amp;&amp;</span> d <span class="op">!=</span> <span class="dv">7</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb190-36"><a href="#cb190-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>d <span class="op">==</span> <span class="dv">0</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">2</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">6</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">8</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">3</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb190-37"><a href="#cb190-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>d <span class="op">!=</span> <span class="dv">2</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">+</span><span class="dv">3</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb190-38"><a href="#cb190-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>d <span class="op">!=</span> <span class="dv">1</span> <span class="op">&amp;&amp;</span> d <span class="op">!=</span> <span class="dv">4</span> <span class="op">&amp;&amp;</span> d <span class="op">!=</span> <span class="dv">7</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">4</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">4</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">+</span><span class="dv">4</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb190-39"><a href="#cb190-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>d <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">1</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">3</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">4</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb190-40"><a href="#cb190-40" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb190-41"><a href="#cb190-41" aria-hidden="true" tabindex="-1"></a>    <span class="co">// = sign</span></span>
<span id="cb190-42"><a href="#cb190-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>c <span class="op">==</span> <span class="dv">61</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">,</span>y<span class="op">+</span><span class="dv">1</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span>y<span class="op">+</span><span class="dv">1</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span>y<span class="op">+</span><span class="dv">1</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">,</span>y<span class="op">+</span><span class="dv">3</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span>y<span class="op">+</span><span class="dv">3</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span>y<span class="op">+</span><span class="dv">3</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb190-43"><a href="#cb190-43" aria-hidden="true" tabindex="-1"></a>    <span class="co">// + sign</span></span>
<span id="cb190-44"><a href="#cb190-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>c <span class="op">==</span> <span class="dv">43</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span>y<span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span>y<span class="op">+</span><span class="dv">1</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span>y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">,</span>y<span class="op">+</span><span class="dv">1</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span>y<span class="op">+</span><span class="dv">1</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb190-45"><a href="#cb190-45" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb190-46"><a href="#cb190-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-47"><a href="#cb190-47" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> find_var<span class="op">(</span><span class="dt">int</span> name<span class="op">)</span> <span class="op">{</span></span>
<span id="cb190-48"><a href="#cb190-48" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i<span class="op">;</span></span>
<span id="cb190-49"><a href="#cb190-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> var_count<span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb190-50"><a href="#cb190-50" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>var_names<span class="op">[</span>i<span class="op">]</span> <span class="op">==</span> name<span class="op">)</span> <span class="cf">return</span> i<span class="op">;</span></span>
<span id="cb190-51"><a href="#cb190-51" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb190-52"><a href="#cb190-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span> <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb190-53"><a href="#cb190-53" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb190-54"><a href="#cb190-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-55"><a href="#cb190-55" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> set_var<span class="op">(</span><span class="dt">int</span> name<span class="op">,</span> <span class="dt">int</span> value<span class="op">)</span> <span class="op">{</span></span>
<span id="cb190-56"><a href="#cb190-56" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> idx<span class="op">;</span></span>
<span id="cb190-57"><a href="#cb190-57" aria-hidden="true" tabindex="-1"></a>    idx <span class="op">=</span> find_var<span class="op">(</span>name<span class="op">);</span></span>
<span id="cb190-58"><a href="#cb190-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>idx <span class="op">&gt;=</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span> var_values<span class="op">[</span>idx<span class="op">]</span> <span class="op">=</span> value<span class="op">;</span> <span class="cf">return</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb190-59"><a href="#cb190-59" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>var_count <span class="op">&lt;</span> <span class="dv">8</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb190-60"><a href="#cb190-60" aria-hidden="true" tabindex="-1"></a>        var_names<span class="op">[</span>var_count<span class="op">]</span> <span class="op">=</span> name<span class="op">;</span></span>
<span id="cb190-61"><a href="#cb190-61" aria-hidden="true" tabindex="-1"></a>        var_values<span class="op">[</span>var_count<span class="op">]</span> <span class="op">=</span> value<span class="op">;</span></span>
<span id="cb190-62"><a href="#cb190-62" aria-hidden="true" tabindex="-1"></a>        var_count <span class="op">=</span> var_count <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb190-63"><a href="#cb190-63" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb190-64"><a href="#cb190-64" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb190-65"><a href="#cb190-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-66"><a href="#cb190-66" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> get_var<span class="op">(</span><span class="dt">int</span> name<span class="op">)</span> <span class="op">{</span></span>
<span id="cb190-67"><a href="#cb190-67" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> idx<span class="op">;</span></span>
<span id="cb190-68"><a href="#cb190-68" aria-hidden="true" tabindex="-1"></a>    idx <span class="op">=</span> find_var<span class="op">(</span>name<span class="op">);</span></span>
<span id="cb190-69"><a href="#cb190-69" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>idx <span class="op">&gt;=</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> var_values<span class="op">[</span>idx<span class="op">];</span></span>
<span id="cb190-70"><a href="#cb190-70" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb190-71"><a href="#cb190-71" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb190-72"><a href="#cb190-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-73"><a href="#cb190-73" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb190-74"><a href="#cb190-74" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> key<span class="op">;</span> <span class="dt">int</span> lk<span class="op">;</span> <span class="dt">int</span> t<span class="op">;</span> <span class="dt">int</span> st<span class="op">;</span> <span class="dt">int</span> cur_name<span class="op">;</span> <span class="dt">int</span> result<span class="op">;</span></span>
<span id="cb190-75"><a href="#cb190-75" aria-hidden="true" tabindex="-1"></a>    lk <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> t <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> st <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> cur_name <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> result <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb190-76"><a href="#cb190-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-77"><a href="#cb190-77" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>t <span class="op">&lt;</span> <span class="dv">50000</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb190-78"><a href="#cb190-78" aria-hidden="true" tabindex="-1"></a>        key <span class="op">=</span> <span class="op">*</span>KEYBOARD<span class="op">;</span></span>
<span id="cb190-79"><a href="#cb190-79" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>key <span class="op">!=</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> key <span class="op">!=</span> lk<span class="op">)</span> <span class="op">{</span></span>
<span id="cb190-80"><a href="#cb190-80" aria-hidden="true" tabindex="-1"></a>            t <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb190-81"><a href="#cb190-81" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Enter = calculer résultat</span></span>
<span id="cb190-82"><a href="#cb190-82" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>key <span class="op">==</span> <span class="dv">13</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb190-83"><a href="#cb190-83" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="op">(</span>var_count <span class="op">&gt;=</span> <span class="dv">2</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb190-84"><a href="#cb190-84" aria-hidden="true" tabindex="-1"></a>                    result <span class="op">=</span> var_values<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">+</span> var_values<span class="op">[</span><span class="dv">1</span><span class="op">];</span></span>
<span id="cb190-85"><a href="#cb190-85" aria-hidden="true" tabindex="-1"></a>                    draw_char<span class="op">(</span>cursor_x<span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">61</span><span class="op">);</span> cursor_x <span class="op">=</span> cursor_x <span class="op">+</span> <span class="dv">5</span><span class="op">;</span></span>
<span id="cb190-86"><a href="#cb190-86" aria-hidden="true" tabindex="-1"></a>                    draw_char<span class="op">(</span>cursor_x<span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">48</span> <span class="op">+</span> result<span class="op">);</span> cursor_x <span class="op">=</span> cursor_x <span class="op">+</span> <span class="dv">5</span><span class="op">;</span></span>
<span id="cb190-87"><a href="#cb190-87" aria-hidden="true" tabindex="-1"></a>                <span class="op">}</span></span>
<span id="cb190-88"><a href="#cb190-88" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> result<span class="op">;</span></span>
<span id="cb190-89"><a href="#cb190-89" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb190-90"><a href="#cb190-90" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Lettre a-z</span></span>
<span id="cb190-91"><a href="#cb190-91" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>key <span class="op">&gt;=</span> <span class="dv">97</span> <span class="op">&amp;&amp;</span> key <span class="op">&lt;=</span> <span class="dv">122</span> <span class="op">&amp;&amp;</span> st <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb190-92"><a href="#cb190-92" aria-hidden="true" tabindex="-1"></a>                draw_char<span class="op">(</span>cursor_x<span class="op">,</span> <span class="dv">10</span><span class="op">,</span> key<span class="op">);</span> cursor_x <span class="op">=</span> cursor_x <span class="op">+</span> <span class="dv">5</span><span class="op">;</span></span>
<span id="cb190-93"><a href="#cb190-93" aria-hidden="true" tabindex="-1"></a>                cur_name <span class="op">=</span> key<span class="op">;</span></span>
<span id="cb190-94"><a href="#cb190-94" aria-hidden="true" tabindex="-1"></a>                st <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb190-95"><a href="#cb190-95" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb190-96"><a href="#cb190-96" aria-hidden="true" tabindex="-1"></a>            <span class="co">// = après lettre</span></span>
<span id="cb190-97"><a href="#cb190-97" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>key <span class="op">==</span> <span class="dv">61</span> <span class="op">&amp;&amp;</span> st <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb190-98"><a href="#cb190-98" aria-hidden="true" tabindex="-1"></a>                draw_char<span class="op">(</span>cursor_x<span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">61</span><span class="op">);</span> cursor_x <span class="op">=</span> cursor_x <span class="op">+</span> <span class="dv">5</span><span class="op">;</span></span>
<span id="cb190-99"><a href="#cb190-99" aria-hidden="true" tabindex="-1"></a>                st <span class="op">=</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb190-100"><a href="#cb190-100" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb190-101"><a href="#cb190-101" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Chiffre après =</span></span>
<span id="cb190-102"><a href="#cb190-102" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>key <span class="op">&gt;=</span> <span class="dv">48</span> <span class="op">&amp;&amp;</span> key <span class="op">&lt;=</span> <span class="dv">57</span> <span class="op">&amp;&amp;</span> st <span class="op">==</span> <span class="dv">2</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb190-103"><a href="#cb190-103" aria-hidden="true" tabindex="-1"></a>                draw_char<span class="op">(</span>cursor_x<span class="op">,</span> <span class="dv">10</span><span class="op">,</span> key<span class="op">);</span> cursor_x <span class="op">=</span> cursor_x <span class="op">+</span> <span class="dv">5</span><span class="op">;</span></span>
<span id="cb190-104"><a href="#cb190-104" aria-hidden="true" tabindex="-1"></a>                set_var<span class="op">(</span>cur_name<span class="op">,</span> key <span class="op">-</span> <span class="dv">48</span><span class="op">);</span></span>
<span id="cb190-105"><a href="#cb190-105" aria-hidden="true" tabindex="-1"></a>                st <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb190-106"><a href="#cb190-106" aria-hidden="true" tabindex="-1"></a>                cursor_x <span class="op">=</span> cursor_x <span class="op">+</span> <span class="dv">3</span><span class="op">;</span> <span class="co">// espace</span></span>
<span id="cb190-107"><a href="#cb190-107" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb190-108"><a href="#cb190-108" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb190-109"><a href="#cb190-109" aria-hidden="true" tabindex="-1"></a>        lk <span class="op">=</span> key<span class="op">;</span> t <span class="op">=</span> t <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb190-110"><a href="#cb190-110" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb190-111"><a href="#cb190-111" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb190-112"><a href="#cb190-112" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.5.11" id="compte-à-rebours"><span class="header-section-number">2.5.11</span> Compte à Rebours</h3>
<div class="sourceCode" id="cb191"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Compte à Rebours Interactif - Solution</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a><span class="co">// Cochez &quot;Capturer clavier&quot;, tapez 3 pour 3 secondes</span></span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> <span class="op">*</span>SCREEN <span class="op">=</span> <span class="op">(</span><span class="dt">int</span><span class="op">*)</span><span class="bn">0x00400000</span><span class="op">;</span></span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> <span class="op">*</span>KEYBOARD <span class="op">=</span> <span class="op">(</span><span class="dt">int</span><span class="op">*)</span><span class="bn">0x00402600</span><span class="op">;</span></span>
<span id="cb191-6"><a href="#cb191-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-7"><a href="#cb191-7" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> set_pixel<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">)</span> <span class="op">{</span></span>
<span id="cb191-8"><a href="#cb191-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> <span class="op">*</span>ptr<span class="op">;</span></span>
<span id="cb191-9"><a href="#cb191-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> bit_pos<span class="op">;</span></span>
<span id="cb191-10"><a href="#cb191-10" aria-hidden="true" tabindex="-1"></a>    ptr <span class="op">=</span> SCREEN <span class="op">+</span> <span class="op">(</span>y <span class="op">&lt;&lt;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span>y <span class="op">&lt;&lt;</span> <span class="dv">1</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span>x <span class="op">&gt;&gt;</span> <span class="dv">5</span><span class="op">);</span></span>
<span id="cb191-11"><a href="#cb191-11" aria-hidden="true" tabindex="-1"></a>    bit_pos <span class="op">=</span> <span class="op">((</span>x <span class="op">&gt;&gt;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">&amp;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">*</span> <span class="dv">8</span> <span class="op">+</span> <span class="dv">7</span> <span class="op">-</span> <span class="op">(</span>x <span class="op">&amp;</span> <span class="dv">7</span><span class="op">);</span></span>
<span id="cb191-12"><a href="#cb191-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span>ptr <span class="op">=</span> <span class="op">*</span>ptr <span class="op">|</span> <span class="op">(</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> bit_pos<span class="op">);</span></span>
<span id="cb191-13"><a href="#cb191-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb191-14"><a href="#cb191-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-15"><a href="#cb191-15" aria-hidden="true" tabindex="-1"></a><span class="co">// Dessine chiffre 3x5</span></span>
<span id="cb191-16"><a href="#cb191-16" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> draw_digit<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">,</span> <span class="dt">int</span> d<span class="op">,</span> <span class="dt">int</span> on<span class="op">)</span> <span class="op">{</span></span>
<span id="cb191-17"><a href="#cb191-17" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i<span class="op">;</span> <span class="dt">int</span> j<span class="op">;</span> <span class="dt">int</span> <span class="op">*</span>ptr<span class="op">;</span> <span class="dt">int</span> bit_pos<span class="op">;</span> <span class="dt">int</span> px<span class="op">;</span> <span class="dt">int</span> py<span class="op">;</span></span>
<span id="cb191-18"><a href="#cb191-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Efface d&#39;abord la zone</span></span>
<span id="cb191-19"><a href="#cb191-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">4</span><span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb191-20"><a href="#cb191-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span>j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> <span class="dv">6</span><span class="op">;</span> j <span class="op">=</span> j <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb191-21"><a href="#cb191-21" aria-hidden="true" tabindex="-1"></a>            px <span class="op">=</span> x <span class="op">+</span> i<span class="op">;</span> py <span class="op">=</span> y <span class="op">+</span> j<span class="op">;</span></span>
<span id="cb191-22"><a href="#cb191-22" aria-hidden="true" tabindex="-1"></a>            ptr <span class="op">=</span> SCREEN <span class="op">+</span> <span class="op">(</span>py <span class="op">&lt;&lt;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span>py <span class="op">&lt;&lt;</span> <span class="dv">1</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span>px <span class="op">&gt;&gt;</span> <span class="dv">5</span><span class="op">);</span></span>
<span id="cb191-23"><a href="#cb191-23" aria-hidden="true" tabindex="-1"></a>            bit_pos <span class="op">=</span> <span class="op">((</span>px <span class="op">&gt;&gt;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">&amp;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">*</span> <span class="dv">8</span> <span class="op">+</span> <span class="dv">7</span> <span class="op">-</span> <span class="op">(</span>px <span class="op">&amp;</span> <span class="dv">7</span><span class="op">);</span></span>
<span id="cb191-24"><a href="#cb191-24" aria-hidden="true" tabindex="-1"></a>            <span class="op">*</span>ptr <span class="op">=</span> <span class="op">*</span>ptr <span class="op">&amp;</span> <span class="op">(</span><span class="bn">0xFFFFFFFF</span> <span class="op">^</span> <span class="op">(</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> bit_pos<span class="op">));</span></span>
<span id="cb191-25"><a href="#cb191-25" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb191-26"><a href="#cb191-26" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb191-27"><a href="#cb191-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>on <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">return</span><span class="op">;</span></span>
<span id="cb191-28"><a href="#cb191-28" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Dessine le chiffre</span></span>
<span id="cb191-29"><a href="#cb191-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">!=</span> <span class="dv">1</span> <span class="op">&amp;&amp;</span> d <span class="op">!=</span> <span class="dv">4</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">);</span> <span class="op">}</span></span>
<span id="cb191-30"><a href="#cb191-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">==</span> <span class="dv">0</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">4</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">5</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">6</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">8</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">9</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">1</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb191-31"><a href="#cb191-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">!=</span> <span class="dv">5</span> <span class="op">&amp;&amp;</span> d <span class="op">!=</span> <span class="dv">6</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">+</span><span class="dv">1</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb191-32"><a href="#cb191-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">!=</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> d <span class="op">!=</span> <span class="dv">1</span> <span class="op">&amp;&amp;</span> d <span class="op">!=</span> <span class="dv">7</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb191-33"><a href="#cb191-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">==</span> <span class="dv">0</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">2</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">6</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">8</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">3</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb191-34"><a href="#cb191-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">!=</span> <span class="dv">2</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">+</span><span class="dv">3</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb191-35"><a href="#cb191-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">!=</span> <span class="dv">1</span> <span class="op">&amp;&amp;</span> d <span class="op">!=</span> <span class="dv">4</span> <span class="op">&amp;&amp;</span> d <span class="op">!=</span> <span class="dv">7</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">4</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">4</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">+</span><span class="dv">4</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb191-36"><a href="#cb191-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">1</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">3</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">4</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb191-37"><a href="#cb191-37" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb191-38"><a href="#cb191-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-39"><a href="#cb191-39" aria-hidden="true" tabindex="-1"></a><span class="co">// Dessine barre horizontale</span></span>
<span id="cb191-40"><a href="#cb191-40" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> draw_hbar<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">,</span> <span class="dt">int</span> w<span class="op">)</span> <span class="op">{</span></span>
<span id="cb191-41"><a href="#cb191-41" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i<span class="op">;</span> <span class="dt">int</span> j<span class="op">;</span></span>
<span id="cb191-42"><a href="#cb191-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> w<span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb191-43"><a href="#cb191-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span>j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> <span class="dv">4</span><span class="op">;</span> j <span class="op">=</span> j <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb191-44"><a href="#cb191-44" aria-hidden="true" tabindex="-1"></a>            set_pixel<span class="op">(</span>x <span class="op">+</span> i<span class="op">,</span> y <span class="op">+</span> j<span class="op">);</span></span>
<span id="cb191-45"><a href="#cb191-45" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb191-46"><a href="#cb191-46" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb191-47"><a href="#cb191-47" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb191-48"><a href="#cb191-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-49"><a href="#cb191-49" aria-hidden="true" tabindex="-1"></a><span class="co">// Efface colonne de barre (XOR avec 0xFFFFFFFF au lieu de ~)</span></span>
<span id="cb191-50"><a href="#cb191-50" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> clear_col<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">)</span> <span class="op">{</span></span>
<span id="cb191-51"><a href="#cb191-51" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> j<span class="op">;</span> <span class="dt">int</span> <span class="op">*</span>ptr<span class="op">;</span> <span class="dt">int</span> bit_pos<span class="op">;</span> <span class="dt">int</span> py<span class="op">;</span></span>
<span id="cb191-52"><a href="#cb191-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> <span class="dv">4</span><span class="op">;</span> j <span class="op">=</span> j <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb191-53"><a href="#cb191-53" aria-hidden="true" tabindex="-1"></a>        py <span class="op">=</span> y <span class="op">+</span> j<span class="op">;</span></span>
<span id="cb191-54"><a href="#cb191-54" aria-hidden="true" tabindex="-1"></a>        ptr <span class="op">=</span> SCREEN <span class="op">+</span> <span class="op">(</span>py <span class="op">&lt;&lt;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span>py <span class="op">&lt;&lt;</span> <span class="dv">1</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span>x <span class="op">&gt;&gt;</span> <span class="dv">5</span><span class="op">);</span></span>
<span id="cb191-55"><a href="#cb191-55" aria-hidden="true" tabindex="-1"></a>        bit_pos <span class="op">=</span> <span class="op">((</span>x <span class="op">&gt;&gt;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">&amp;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">*</span> <span class="dv">8</span> <span class="op">+</span> <span class="dv">7</span> <span class="op">-</span> <span class="op">(</span>x <span class="op">&amp;</span> <span class="dv">7</span><span class="op">);</span></span>
<span id="cb191-56"><a href="#cb191-56" aria-hidden="true" tabindex="-1"></a>        <span class="op">*</span>ptr <span class="op">=</span> <span class="op">*</span>ptr <span class="op">&amp;</span> <span class="op">(</span><span class="bn">0xFFFFFFFF</span> <span class="op">^</span> <span class="op">(</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> bit_pos<span class="op">));</span></span>
<span id="cb191-57"><a href="#cb191-57" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb191-58"><a href="#cb191-58" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb191-59"><a href="#cb191-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-60"><a href="#cb191-60" aria-hidden="true" tabindex="-1"></a><span class="co">// Flash rectangle</span></span>
<span id="cb191-61"><a href="#cb191-61" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> flash<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">,</span> <span class="dt">int</span> w<span class="op">,</span> <span class="dt">int</span> h<span class="op">)</span> <span class="op">{</span></span>
<span id="cb191-62"><a href="#cb191-62" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i<span class="op">;</span> <span class="dt">int</span> j<span class="op">;</span></span>
<span id="cb191-63"><a href="#cb191-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> w<span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb191-64"><a href="#cb191-64" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span>j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> h<span class="op">;</span> j <span class="op">=</span> j <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb191-65"><a href="#cb191-65" aria-hidden="true" tabindex="-1"></a>            set_pixel<span class="op">(</span>x <span class="op">+</span> i<span class="op">,</span> y <span class="op">+</span> j<span class="op">);</span></span>
<span id="cb191-66"><a href="#cb191-66" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb191-67"><a href="#cb191-67" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb191-68"><a href="#cb191-68" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb191-69"><a href="#cb191-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-70"><a href="#cb191-70" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> state <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb191-71"><a href="#cb191-71" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> secs <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb191-72"><a href="#cb191-72" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> bar_x <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb191-73"><a href="#cb191-73" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> step <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb191-74"><a href="#cb191-74" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> tick <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb191-75"><a href="#cb191-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-76"><a href="#cb191-76" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb191-77"><a href="#cb191-77" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> key<span class="op">;</span> <span class="dt">int</span> lk<span class="op">;</span> <span class="dt">int</span> t<span class="op">;</span> <span class="dt">int</span> bar_w<span class="op">;</span></span>
<span id="cb191-78"><a href="#cb191-78" aria-hidden="true" tabindex="-1"></a>    lk <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> t <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb191-79"><a href="#cb191-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-80"><a href="#cb191-80" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>t <span class="op">&lt;</span> <span class="dv">500000</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb191-81"><a href="#cb191-81" aria-hidden="true" tabindex="-1"></a>        key <span class="op">=</span> <span class="op">*</span>KEYBOARD<span class="op">;</span></span>
<span id="cb191-82"><a href="#cb191-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-83"><a href="#cb191-83" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>state <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb191-84"><a href="#cb191-84" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>key <span class="op">&gt;=</span> <span class="dv">49</span> <span class="op">&amp;&amp;</span> key <span class="op">&lt;=</span> <span class="dv">57</span> <span class="op">&amp;&amp;</span> key <span class="op">!=</span> lk<span class="op">)</span> <span class="op">{</span></span>
<span id="cb191-85"><a href="#cb191-85" aria-hidden="true" tabindex="-1"></a>                secs <span class="op">=</span> key <span class="op">-</span> <span class="dv">48</span><span class="op">;</span></span>
<span id="cb191-86"><a href="#cb191-86" aria-hidden="true" tabindex="-1"></a>                draw_digit<span class="op">(</span><span class="dv">4</span><span class="op">,</span> <span class="dv">4</span><span class="op">,</span> secs<span class="op">,</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb191-87"><a href="#cb191-87" aria-hidden="true" tabindex="-1"></a>                bar_w <span class="op">=</span> secs <span class="op">&lt;&lt;</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb191-88"><a href="#cb191-88" aria-hidden="true" tabindex="-1"></a>                draw_hbar<span class="op">(</span><span class="dv">4</span><span class="op">,</span> <span class="dv">15</span><span class="op">,</span> bar_w<span class="op">);</span></span>
<span id="cb191-89"><a href="#cb191-89" aria-hidden="true" tabindex="-1"></a>                bar_x <span class="op">=</span> <span class="dv">3</span> <span class="op">+</span> bar_w<span class="op">;</span></span>
<span id="cb191-90"><a href="#cb191-90" aria-hidden="true" tabindex="-1"></a>                step <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb191-91"><a href="#cb191-91" aria-hidden="true" tabindex="-1"></a>                tick <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb191-92"><a href="#cb191-92" aria-hidden="true" tabindex="-1"></a>                state <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb191-93"><a href="#cb191-93" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb191-94"><a href="#cb191-94" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb191-95"><a href="#cb191-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-96"><a href="#cb191-96" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>state <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb191-97"><a href="#cb191-97" aria-hidden="true" tabindex="-1"></a>            tick <span class="op">=</span> tick <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb191-98"><a href="#cb191-98" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>tick <span class="op">&gt;=</span> <span class="dv">800</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb191-99"><a href="#cb191-99" aria-hidden="true" tabindex="-1"></a>                tick <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb191-100"><a href="#cb191-100" aria-hidden="true" tabindex="-1"></a>                clear_col<span class="op">(</span>bar_x<span class="op">,</span> <span class="dv">15</span><span class="op">);</span></span>
<span id="cb191-101"><a href="#cb191-101" aria-hidden="true" tabindex="-1"></a>                bar_x <span class="op">=</span> bar_x <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb191-102"><a href="#cb191-102" aria-hidden="true" tabindex="-1"></a>                step <span class="op">=</span> step <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb191-103"><a href="#cb191-103" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="op">(</span>step <span class="op">&gt;=</span> <span class="dv">8</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb191-104"><a href="#cb191-104" aria-hidden="true" tabindex="-1"></a>                    step <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb191-105"><a href="#cb191-105" aria-hidden="true" tabindex="-1"></a>                    secs <span class="op">=</span> secs <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb191-106"><a href="#cb191-106" aria-hidden="true" tabindex="-1"></a>                    draw_digit<span class="op">(</span><span class="dv">4</span><span class="op">,</span> <span class="dv">4</span><span class="op">,</span> secs<span class="op">,</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb191-107"><a href="#cb191-107" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> <span class="op">(</span>secs <span class="op">&lt;=</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb191-108"><a href="#cb191-108" aria-hidden="true" tabindex="-1"></a>                        state <span class="op">=</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb191-109"><a href="#cb191-109" aria-hidden="true" tabindex="-1"></a>                    <span class="op">}</span></span>
<span id="cb191-110"><a href="#cb191-110" aria-hidden="true" tabindex="-1"></a>                <span class="op">}</span></span>
<span id="cb191-111"><a href="#cb191-111" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb191-112"><a href="#cb191-112" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb191-113"><a href="#cb191-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-114"><a href="#cb191-114" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>state <span class="op">==</span> <span class="dv">2</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb191-115"><a href="#cb191-115" aria-hidden="true" tabindex="-1"></a>            flash<span class="op">(</span><span class="dv">4</span><span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">60</span><span class="op">,</span> <span class="dv">20</span><span class="op">);</span></span>
<span id="cb191-116"><a href="#cb191-116" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb191-117"><a href="#cb191-117" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb191-118"><a href="#cb191-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-119"><a href="#cb191-119" aria-hidden="true" tabindex="-1"></a>        lk <span class="op">=</span> key<span class="op">;</span></span>
<span id="cb191-120"><a href="#cb191-120" aria-hidden="true" tabindex="-1"></a>        t <span class="op">=</span> t <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb191-121"><a href="#cb191-121" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb191-122"><a href="#cb191-122" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb191-123"><a href="#cb191-123" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.5.12" id="interruptions"><span class="header-section-number">2.5.12</span> Interruptions</h3>
<div class="sourceCode" id="cb192"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Interruptions Visuelles - Solution</span></span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a><span class="co">// Cochez &quot;Capturer clavier&quot;, appuyez T/K/S puis Enter</span></span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> <span class="op">*</span>SCREEN <span class="op">=</span> <span class="op">(</span><span class="dt">int</span><span class="op">*)</span><span class="bn">0x00400000</span><span class="op">;</span></span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> <span class="op">*</span>KEYBOARD <span class="op">=</span> <span class="op">(</span><span class="dt">int</span><span class="op">*)</span><span class="bn">0x00402600</span><span class="op">;</span></span>
<span id="cb192-6"><a href="#cb192-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-7"><a href="#cb192-7" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> irq_count<span class="op">[</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb192-8"><a href="#cb192-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-9"><a href="#cb192-9" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> set_pixel<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">)</span> <span class="op">{</span></span>
<span id="cb192-10"><a href="#cb192-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> <span class="op">*</span>ptr<span class="op">;</span> <span class="dt">int</span> bit_pos<span class="op">;</span></span>
<span id="cb192-11"><a href="#cb192-11" aria-hidden="true" tabindex="-1"></a>    ptr <span class="op">=</span> SCREEN <span class="op">+</span> <span class="op">(</span>y <span class="op">&lt;&lt;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span>y <span class="op">&lt;&lt;</span> <span class="dv">1</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span>x <span class="op">&gt;&gt;</span> <span class="dv">5</span><span class="op">);</span></span>
<span id="cb192-12"><a href="#cb192-12" aria-hidden="true" tabindex="-1"></a>    bit_pos <span class="op">=</span> <span class="op">((</span>x <span class="op">&gt;&gt;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">&amp;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">*</span> <span class="dv">8</span> <span class="op">+</span> <span class="dv">7</span> <span class="op">-</span> <span class="op">(</span>x <span class="op">&amp;</span> <span class="dv">7</span><span class="op">);</span></span>
<span id="cb192-13"><a href="#cb192-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span>ptr <span class="op">=</span> <span class="op">*</span>ptr <span class="op">|</span> <span class="op">(</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> bit_pos<span class="op">);</span></span>
<span id="cb192-14"><a href="#cb192-14" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb192-15"><a href="#cb192-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-16"><a href="#cb192-16" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> clear_rect<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">,</span> <span class="dt">int</span> w<span class="op">,</span> <span class="dt">int</span> h<span class="op">)</span> <span class="op">{</span></span>
<span id="cb192-17"><a href="#cb192-17" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i<span class="op">;</span> <span class="dt">int</span> j<span class="op">;</span> <span class="dt">int</span> px<span class="op">;</span> <span class="dt">int</span> py<span class="op">;</span> <span class="dt">int</span> <span class="op">*</span>ptr<span class="op">;</span> <span class="dt">int</span> bit_pos<span class="op">;</span></span>
<span id="cb192-18"><a href="#cb192-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> w<span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb192-19"><a href="#cb192-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span>j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> h<span class="op">;</span> j <span class="op">=</span> j <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb192-20"><a href="#cb192-20" aria-hidden="true" tabindex="-1"></a>            px <span class="op">=</span> x <span class="op">+</span> i<span class="op">;</span> py <span class="op">=</span> y <span class="op">+</span> j<span class="op">;</span></span>
<span id="cb192-21"><a href="#cb192-21" aria-hidden="true" tabindex="-1"></a>            ptr <span class="op">=</span> SCREEN <span class="op">+</span> <span class="op">(</span>py <span class="op">&lt;&lt;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span>py <span class="op">&lt;&lt;</span> <span class="dv">1</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span>px <span class="op">&gt;&gt;</span> <span class="dv">5</span><span class="op">);</span></span>
<span id="cb192-22"><a href="#cb192-22" aria-hidden="true" tabindex="-1"></a>            bit_pos <span class="op">=</span> <span class="op">((</span>px <span class="op">&gt;&gt;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">&amp;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">*</span> <span class="dv">8</span> <span class="op">+</span> <span class="dv">7</span> <span class="op">-</span> <span class="op">(</span>px <span class="op">&amp;</span> <span class="dv">7</span><span class="op">);</span></span>
<span id="cb192-23"><a href="#cb192-23" aria-hidden="true" tabindex="-1"></a>            <span class="op">*</span>ptr <span class="op">=</span> <span class="op">*</span>ptr <span class="op">&amp;</span> <span class="op">(</span><span class="bn">0xFFFFFFFF</span> <span class="op">^</span> <span class="op">(</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> bit_pos<span class="op">));</span></span>
<span id="cb192-24"><a href="#cb192-24" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb192-25"><a href="#cb192-25" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb192-26"><a href="#cb192-26" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb192-27"><a href="#cb192-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-28"><a href="#cb192-28" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> fill_rect<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">,</span> <span class="dt">int</span> w<span class="op">,</span> <span class="dt">int</span> h<span class="op">)</span> <span class="op">{</span></span>
<span id="cb192-29"><a href="#cb192-29" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i<span class="op">;</span> <span class="dt">int</span> j<span class="op">;</span></span>
<span id="cb192-30"><a href="#cb192-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> w<span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb192-31"><a href="#cb192-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span>j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> h<span class="op">;</span> j <span class="op">=</span> j <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb192-32"><a href="#cb192-32" aria-hidden="true" tabindex="-1"></a>            set_pixel<span class="op">(</span>x <span class="op">+</span> i<span class="op">,</span> y <span class="op">+</span> j<span class="op">);</span></span>
<span id="cb192-33"><a href="#cb192-33" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb192-34"><a href="#cb192-34" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb192-35"><a href="#cb192-35" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb192-36"><a href="#cb192-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-37"><a href="#cb192-37" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> draw_box<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">,</span> <span class="dt">int</span> w<span class="op">,</span> <span class="dt">int</span> h<span class="op">)</span> <span class="op">{</span></span>
<span id="cb192-38"><a href="#cb192-38" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i<span class="op">;</span></span>
<span id="cb192-39"><a href="#cb192-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> w<span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x <span class="op">+</span> i<span class="op">,</span> y<span class="op">);</span> set_pixel<span class="op">(</span>x <span class="op">+</span> i<span class="op">,</span> y <span class="op">+</span> h <span class="op">-</span> <span class="dv">1</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb192-40"><a href="#cb192-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> h<span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> i<span class="op">);</span> set_pixel<span class="op">(</span>x <span class="op">+</span> w <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> y <span class="op">+</span> i<span class="op">);</span> <span class="op">}</span></span>
<span id="cb192-41"><a href="#cb192-41" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb192-42"><a href="#cb192-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-43"><a href="#cb192-43" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> draw_digit<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">,</span> <span class="dt">int</span> d<span class="op">)</span> <span class="op">{</span></span>
<span id="cb192-44"><a href="#cb192-44" aria-hidden="true" tabindex="-1"></a>    clear_rect<span class="op">(</span>x<span class="op">,</span> y<span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">6</span><span class="op">);</span></span>
<span id="cb192-45"><a href="#cb192-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">!=</span> <span class="dv">1</span> <span class="op">&amp;&amp;</span> d <span class="op">!=</span> <span class="dv">4</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">);</span> <span class="op">}</span></span>
<span id="cb192-46"><a href="#cb192-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">==</span> <span class="dv">0</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">4</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">5</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">6</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">8</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">9</span><span class="op">)</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb192-47"><a href="#cb192-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">!=</span> <span class="dv">5</span> <span class="op">&amp;&amp;</span> d <span class="op">!=</span> <span class="dv">6</span><span class="op">)</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">+</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb192-48"><a href="#cb192-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">!=</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> d <span class="op">!=</span> <span class="dv">1</span> <span class="op">&amp;&amp;</span> d <span class="op">!=</span> <span class="dv">7</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb192-49"><a href="#cb192-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">==</span> <span class="dv">0</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">2</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">6</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">8</span><span class="op">)</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">3</span><span class="op">);</span></span>
<span id="cb192-50"><a href="#cb192-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">!=</span> <span class="dv">2</span><span class="op">)</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">+</span><span class="dv">3</span><span class="op">);</span></span>
<span id="cb192-51"><a href="#cb192-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">!=</span> <span class="dv">1</span> <span class="op">&amp;&amp;</span> d <span class="op">!=</span> <span class="dv">4</span> <span class="op">&amp;&amp;</span> d <span class="op">!=</span> <span class="dv">7</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">4</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">4</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">+</span><span class="dv">4</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb192-52"><a href="#cb192-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">1</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">3</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">4</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb192-53"><a href="#cb192-53" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb192-54"><a href="#cb192-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-55"><a href="#cb192-55" aria-hidden="true" tabindex="-1"></a><span class="co">// Dessine lettre T, K ou S</span></span>
<span id="cb192-56"><a href="#cb192-56" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> draw_letter<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">,</span> <span class="dt">int</span> c<span class="op">)</span> <span class="op">{</span></span>
<span id="cb192-57"><a href="#cb192-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>c <span class="op">==</span> <span class="dv">84</span><span class="op">)</span> <span class="op">{</span> <span class="co">// T</span></span>
<span id="cb192-58"><a href="#cb192-58" aria-hidden="true" tabindex="-1"></a>        set_pixel<span class="op">(</span>x<span class="op">,</span>y<span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span>y<span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span>y<span class="op">);</span></span>
<span id="cb192-59"><a href="#cb192-59" aria-hidden="true" tabindex="-1"></a>        set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span>y<span class="op">+</span><span class="dv">1</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span>y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span>y<span class="op">+</span><span class="dv">3</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span>y<span class="op">+</span><span class="dv">4</span><span class="op">);</span></span>
<span id="cb192-60"><a href="#cb192-60" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb192-61"><a href="#cb192-61" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>c <span class="op">==</span> <span class="dv">75</span><span class="op">)</span> <span class="op">{</span> <span class="co">// K</span></span>
<span id="cb192-62"><a href="#cb192-62" aria-hidden="true" tabindex="-1"></a>        set_pixel<span class="op">(</span>x<span class="op">,</span>y<span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">,</span>y<span class="op">+</span><span class="dv">1</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">,</span>y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">,</span>y<span class="op">+</span><span class="dv">3</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">,</span>y<span class="op">+</span><span class="dv">4</span><span class="op">);</span></span>
<span id="cb192-63"><a href="#cb192-63" aria-hidden="true" tabindex="-1"></a>        set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span>y<span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span>y<span class="op">+</span><span class="dv">1</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span>y<span class="op">+</span><span class="dv">3</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span>y<span class="op">+</span><span class="dv">4</span><span class="op">);</span></span>
<span id="cb192-64"><a href="#cb192-64" aria-hidden="true" tabindex="-1"></a>        set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span>y<span class="op">+</span><span class="dv">2</span><span class="op">);</span></span>
<span id="cb192-65"><a href="#cb192-65" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb192-66"><a href="#cb192-66" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>c <span class="op">==</span> <span class="dv">83</span><span class="op">)</span> <span class="op">{</span> <span class="co">// S</span></span>
<span id="cb192-67"><a href="#cb192-67" aria-hidden="true" tabindex="-1"></a>        set_pixel<span class="op">(</span>x<span class="op">,</span>y<span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span>y<span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span>y<span class="op">);</span></span>
<span id="cb192-68"><a href="#cb192-68" aria-hidden="true" tabindex="-1"></a>        set_pixel<span class="op">(</span>x<span class="op">,</span>y<span class="op">+</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb192-69"><a href="#cb192-69" aria-hidden="true" tabindex="-1"></a>        set_pixel<span class="op">(</span>x<span class="op">,</span>y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span>y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span>y<span class="op">+</span><span class="dv">2</span><span class="op">);</span></span>
<span id="cb192-70"><a href="#cb192-70" aria-hidden="true" tabindex="-1"></a>        set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span>y<span class="op">+</span><span class="dv">3</span><span class="op">);</span></span>
<span id="cb192-71"><a href="#cb192-71" aria-hidden="true" tabindex="-1"></a>        set_pixel<span class="op">(</span>x<span class="op">,</span>y<span class="op">+</span><span class="dv">4</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span>y<span class="op">+</span><span class="dv">4</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span>y<span class="op">+</span><span class="dv">4</span><span class="op">);</span></span>
<span id="cb192-72"><a href="#cb192-72" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb192-73"><a href="#cb192-73" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb192-74"><a href="#cb192-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-75"><a href="#cb192-75" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> draw_device<span class="op">(</span><span class="dt">int</span> idx<span class="op">)</span> <span class="op">{</span></span>
<span id="cb192-76"><a href="#cb192-76" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> x<span class="op">;</span></span>
<span id="cb192-77"><a href="#cb192-77" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> idx <span class="op">*</span> <span class="dv">25</span> <span class="op">+</span> <span class="dv">4</span><span class="op">;</span></span>
<span id="cb192-78"><a href="#cb192-78" aria-hidden="true" tabindex="-1"></a>    draw_box<span class="op">(</span>x<span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">20</span><span class="op">,</span> <span class="dv">15</span><span class="op">);</span></span>
<span id="cb192-79"><a href="#cb192-79" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>idx <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> draw_letter<span class="op">(</span>x <span class="op">+</span> <span class="dv">8</span><span class="op">,</span> <span class="dv">6</span><span class="op">,</span> <span class="dv">84</span><span class="op">);</span></span>
<span id="cb192-80"><a href="#cb192-80" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>idx <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> draw_letter<span class="op">(</span>x <span class="op">+</span> <span class="dv">8</span><span class="op">,</span> <span class="dv">6</span><span class="op">,</span> <span class="dv">75</span><span class="op">);</span></span>
<span id="cb192-81"><a href="#cb192-81" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>idx <span class="op">==</span> <span class="dv">2</span><span class="op">)</span> draw_letter<span class="op">(</span>x <span class="op">+</span> <span class="dv">8</span><span class="op">,</span> <span class="dv">6</span><span class="op">,</span> <span class="dv">83</span><span class="op">);</span></span>
<span id="cb192-82"><a href="#cb192-82" aria-hidden="true" tabindex="-1"></a>    draw_digit<span class="op">(</span>x <span class="op">+</span> <span class="dv">8</span><span class="op">,</span> <span class="dv">13</span><span class="op">,</span> irq_count<span class="op">[</span>idx<span class="op">]);</span></span>
<span id="cb192-83"><a href="#cb192-83" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb192-84"><a href="#cb192-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-85"><a href="#cb192-85" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> flash_device<span class="op">(</span><span class="dt">int</span> idx<span class="op">)</span> <span class="op">{</span></span>
<span id="cb192-86"><a href="#cb192-86" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> x<span class="op">;</span> <span class="dt">int</span> i<span class="op">;</span></span>
<span id="cb192-87"><a href="#cb192-87" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> idx <span class="op">*</span> <span class="dv">25</span> <span class="op">+</span> <span class="dv">4</span><span class="op">;</span></span>
<span id="cb192-88"><a href="#cb192-88" aria-hidden="true" tabindex="-1"></a>    fill_rect<span class="op">(</span>x <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">18</span><span class="op">,</span> <span class="dv">13</span><span class="op">);</span></span>
<span id="cb192-89"><a href="#cb192-89" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Petit delai</span></span>
<span id="cb192-90"><a href="#cb192-90" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">500</span><span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span> <span class="op">}</span></span>
<span id="cb192-91"><a href="#cb192-91" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb192-92"><a href="#cb192-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-93"><a href="#cb192-93" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> irq_handler<span class="op">(</span><span class="dt">int</span> type<span class="op">)</span> <span class="op">{</span></span>
<span id="cb192-94"><a href="#cb192-94" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>type <span class="op">&gt;=</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> type <span class="op">&lt;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb192-95"><a href="#cb192-95" aria-hidden="true" tabindex="-1"></a>        irq_count<span class="op">[</span>type<span class="op">]</span> <span class="op">=</span> irq_count<span class="op">[</span>type<span class="op">]</span> <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb192-96"><a href="#cb192-96" aria-hidden="true" tabindex="-1"></a>        flash_device<span class="op">(</span>type<span class="op">);</span></span>
<span id="cb192-97"><a href="#cb192-97" aria-hidden="true" tabindex="-1"></a>        draw_device<span class="op">(</span>type<span class="op">);</span></span>
<span id="cb192-98"><a href="#cb192-98" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb192-99"><a href="#cb192-99" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb192-100"><a href="#cb192-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-101"><a href="#cb192-101" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb192-102"><a href="#cb192-102" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> key<span class="op">;</span> <span class="dt">int</span> lk<span class="op">;</span> <span class="dt">int</span> t<span class="op">;</span> <span class="dt">int</span> total<span class="op">;</span></span>
<span id="cb192-103"><a href="#cb192-103" aria-hidden="true" tabindex="-1"></a>    lk <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> t <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb192-104"><a href="#cb192-104" aria-hidden="true" tabindex="-1"></a>    irq_count<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> irq_count<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> irq_count<span class="op">[</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb192-105"><a href="#cb192-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-106"><a href="#cb192-106" aria-hidden="true" tabindex="-1"></a>    draw_device<span class="op">(</span><span class="dv">0</span><span class="op">);</span></span>
<span id="cb192-107"><a href="#cb192-107" aria-hidden="true" tabindex="-1"></a>    draw_device<span class="op">(</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb192-108"><a href="#cb192-108" aria-hidden="true" tabindex="-1"></a>    draw_device<span class="op">(</span><span class="dv">2</span><span class="op">);</span></span>
<span id="cb192-109"><a href="#cb192-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-110"><a href="#cb192-110" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>t <span class="op">&lt;</span> <span class="dv">100000</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb192-111"><a href="#cb192-111" aria-hidden="true" tabindex="-1"></a>        key <span class="op">=</span> <span class="op">*</span>KEYBOARD<span class="op">;</span></span>
<span id="cb192-112"><a href="#cb192-112" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>key <span class="op">!=</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> key <span class="op">!=</span> lk<span class="op">)</span> <span class="op">{</span></span>
<span id="cb192-113"><a href="#cb192-113" aria-hidden="true" tabindex="-1"></a>            t <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb192-114"><a href="#cb192-114" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>key <span class="op">==</span> <span class="dv">13</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb192-115"><a href="#cb192-115" aria-hidden="true" tabindex="-1"></a>                total <span class="op">=</span> irq_count<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">+</span> irq_count<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">+</span> irq_count<span class="op">[</span><span class="dv">2</span><span class="op">];</span></span>
<span id="cb192-116"><a href="#cb192-116" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> total<span class="op">;</span></span>
<span id="cb192-117"><a href="#cb192-117" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb192-118"><a href="#cb192-118" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>key <span class="op">==</span> <span class="dv">116</span> <span class="op">||</span> key <span class="op">==</span> <span class="dv">84</span><span class="op">)</span> irq_handler<span class="op">(</span><span class="dv">0</span><span class="op">);</span></span>
<span id="cb192-119"><a href="#cb192-119" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>key <span class="op">==</span> <span class="dv">107</span> <span class="op">||</span> key <span class="op">==</span> <span class="dv">75</span><span class="op">)</span> irq_handler<span class="op">(</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb192-120"><a href="#cb192-120" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>key <span class="op">==</span> <span class="dv">115</span> <span class="op">||</span> key <span class="op">==</span> <span class="dv">83</span><span class="op">)</span> irq_handler<span class="op">(</span><span class="dv">2</span><span class="op">);</span></span>
<span id="cb192-121"><a href="#cb192-121" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb192-122"><a href="#cb192-122" aria-hidden="true" tabindex="-1"></a>        lk <span class="op">=</span> key<span class="op">;</span></span>
<span id="cb192-123"><a href="#cb192-123" aria-hidden="true" tabindex="-1"></a>        t <span class="op">=</span> t <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb192-124"><a href="#cb192-124" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb192-125"><a href="#cb192-125" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb192-126"><a href="#cb192-126" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.5.13" id="coroutines"><span class="header-section-number">2.5.13</span> Coroutines</h3>
<div class="sourceCode" id="cb193"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Coroutines Visuelles - Solution</span></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a><span class="co">// Cochez &quot;Capturer clavier&quot;, appuyez Espace pour chaque step</span></span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> <span class="op">*</span>SCREEN <span class="op">=</span> <span class="op">(</span><span class="dt">int</span><span class="op">*)</span><span class="bn">0x00400000</span><span class="op">;</span></span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> <span class="op">*</span>KEYBOARD <span class="op">=</span> <span class="op">(</span><span class="dt">int</span><span class="op">*)</span><span class="bn">0x00402600</span><span class="op">;</span></span>
<span id="cb193-6"><a href="#cb193-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-7"><a href="#cb193-7" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> current_task <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb193-8"><a href="#cb193-8" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> task_a_val <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb193-9"><a href="#cb193-9" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> task_b_val <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb193-10"><a href="#cb193-10" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> steps <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb193-11"><a href="#cb193-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-12"><a href="#cb193-12" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> set_pixel<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">)</span> <span class="op">{</span></span>
<span id="cb193-13"><a href="#cb193-13" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> <span class="op">*</span>ptr<span class="op">;</span> <span class="dt">int</span> bit_pos<span class="op">;</span></span>
<span id="cb193-14"><a href="#cb193-14" aria-hidden="true" tabindex="-1"></a>    ptr <span class="op">=</span> SCREEN <span class="op">+</span> <span class="op">(</span>y <span class="op">&lt;&lt;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span>y <span class="op">&lt;&lt;</span> <span class="dv">1</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span>x <span class="op">&gt;&gt;</span> <span class="dv">5</span><span class="op">);</span></span>
<span id="cb193-15"><a href="#cb193-15" aria-hidden="true" tabindex="-1"></a>    bit_pos <span class="op">=</span> <span class="op">((</span>x <span class="op">&gt;&gt;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">&amp;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">*</span> <span class="dv">8</span> <span class="op">+</span> <span class="dv">7</span> <span class="op">-</span> <span class="op">(</span>x <span class="op">&amp;</span> <span class="dv">7</span><span class="op">);</span></span>
<span id="cb193-16"><a href="#cb193-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span>ptr <span class="op">=</span> <span class="op">*</span>ptr <span class="op">|</span> <span class="op">(</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> bit_pos<span class="op">);</span></span>
<span id="cb193-17"><a href="#cb193-17" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb193-18"><a href="#cb193-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-19"><a href="#cb193-19" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> clear_rect<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">,</span> <span class="dt">int</span> w<span class="op">,</span> <span class="dt">int</span> h<span class="op">)</span> <span class="op">{</span></span>
<span id="cb193-20"><a href="#cb193-20" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i<span class="op">;</span> <span class="dt">int</span> j<span class="op">;</span> <span class="dt">int</span> px<span class="op">;</span> <span class="dt">int</span> py<span class="op">;</span> <span class="dt">int</span> <span class="op">*</span>ptr<span class="op">;</span> <span class="dt">int</span> bit_pos<span class="op">;</span></span>
<span id="cb193-21"><a href="#cb193-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> w<span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb193-22"><a href="#cb193-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span>j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> h<span class="op">;</span> j <span class="op">=</span> j <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb193-23"><a href="#cb193-23" aria-hidden="true" tabindex="-1"></a>            px <span class="op">=</span> x <span class="op">+</span> i<span class="op">;</span> py <span class="op">=</span> y <span class="op">+</span> j<span class="op">;</span></span>
<span id="cb193-24"><a href="#cb193-24" aria-hidden="true" tabindex="-1"></a>            ptr <span class="op">=</span> SCREEN <span class="op">+</span> <span class="op">(</span>py <span class="op">&lt;&lt;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span>py <span class="op">&lt;&lt;</span> <span class="dv">1</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span>px <span class="op">&gt;&gt;</span> <span class="dv">5</span><span class="op">);</span></span>
<span id="cb193-25"><a href="#cb193-25" aria-hidden="true" tabindex="-1"></a>            bit_pos <span class="op">=</span> <span class="op">((</span>px <span class="op">&gt;&gt;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">&amp;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">*</span> <span class="dv">8</span> <span class="op">+</span> <span class="dv">7</span> <span class="op">-</span> <span class="op">(</span>px <span class="op">&amp;</span> <span class="dv">7</span><span class="op">);</span></span>
<span id="cb193-26"><a href="#cb193-26" aria-hidden="true" tabindex="-1"></a>            <span class="op">*</span>ptr <span class="op">=</span> <span class="op">*</span>ptr <span class="op">&amp;</span> <span class="op">(</span><span class="bn">0xFFFFFFFF</span> <span class="op">^</span> <span class="op">(</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> bit_pos<span class="op">));</span></span>
<span id="cb193-27"><a href="#cb193-27" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb193-28"><a href="#cb193-28" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb193-29"><a href="#cb193-29" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb193-30"><a href="#cb193-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-31"><a href="#cb193-31" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> fill_rect<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">,</span> <span class="dt">int</span> w<span class="op">,</span> <span class="dt">int</span> h<span class="op">)</span> <span class="op">{</span></span>
<span id="cb193-32"><a href="#cb193-32" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i<span class="op">;</span> <span class="dt">int</span> j<span class="op">;</span></span>
<span id="cb193-33"><a href="#cb193-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> w<span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb193-34"><a href="#cb193-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span>j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> h<span class="op">;</span> j <span class="op">=</span> j <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb193-35"><a href="#cb193-35" aria-hidden="true" tabindex="-1"></a>            set_pixel<span class="op">(</span>x <span class="op">+</span> i<span class="op">,</span> y <span class="op">+</span> j<span class="op">);</span></span>
<span id="cb193-36"><a href="#cb193-36" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb193-37"><a href="#cb193-37" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb193-38"><a href="#cb193-38" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb193-39"><a href="#cb193-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-40"><a href="#cb193-40" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> draw_box<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">,</span> <span class="dt">int</span> w<span class="op">,</span> <span class="dt">int</span> h<span class="op">)</span> <span class="op">{</span></span>
<span id="cb193-41"><a href="#cb193-41" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i<span class="op">;</span></span>
<span id="cb193-42"><a href="#cb193-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> w<span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x <span class="op">+</span> i<span class="op">,</span> y<span class="op">);</span> set_pixel<span class="op">(</span>x <span class="op">+</span> i<span class="op">,</span> y <span class="op">+</span> h <span class="op">-</span> <span class="dv">1</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb193-43"><a href="#cb193-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> h<span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> i<span class="op">);</span> set_pixel<span class="op">(</span>x <span class="op">+</span> w <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> y <span class="op">+</span> i<span class="op">);</span> <span class="op">}</span></span>
<span id="cb193-44"><a href="#cb193-44" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb193-45"><a href="#cb193-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-46"><a href="#cb193-46" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> draw_digit<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">,</span> <span class="dt">int</span> d<span class="op">)</span> <span class="op">{</span></span>
<span id="cb193-47"><a href="#cb193-47" aria-hidden="true" tabindex="-1"></a>    clear_rect<span class="op">(</span>x<span class="op">,</span> y<span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">6</span><span class="op">);</span></span>
<span id="cb193-48"><a href="#cb193-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">!=</span> <span class="dv">1</span> <span class="op">&amp;&amp;</span> d <span class="op">!=</span> <span class="dv">4</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">);</span> <span class="op">}</span></span>
<span id="cb193-49"><a href="#cb193-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">==</span> <span class="dv">0</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">4</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">5</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">6</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">8</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">9</span><span class="op">)</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb193-50"><a href="#cb193-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">!=</span> <span class="dv">5</span> <span class="op">&amp;&amp;</span> d <span class="op">!=</span> <span class="dv">6</span><span class="op">)</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">+</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb193-51"><a href="#cb193-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">!=</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> d <span class="op">!=</span> <span class="dv">1</span> <span class="op">&amp;&amp;</span> d <span class="op">!=</span> <span class="dv">7</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb193-52"><a href="#cb193-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">==</span> <span class="dv">0</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">2</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">6</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">8</span><span class="op">)</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">3</span><span class="op">);</span></span>
<span id="cb193-53"><a href="#cb193-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">!=</span> <span class="dv">2</span><span class="op">)</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">+</span><span class="dv">3</span><span class="op">);</span></span>
<span id="cb193-54"><a href="#cb193-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">!=</span> <span class="dv">1</span> <span class="op">&amp;&amp;</span> d <span class="op">!=</span> <span class="dv">4</span> <span class="op">&amp;&amp;</span> d <span class="op">!=</span> <span class="dv">7</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">4</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">4</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">+</span><span class="dv">4</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb193-55"><a href="#cb193-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">1</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">3</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">4</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb193-56"><a href="#cb193-56" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb193-57"><a href="#cb193-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-58"><a href="#cb193-58" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> draw_letter_A<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">)</span> <span class="op">{</span></span>
<span id="cb193-59"><a href="#cb193-59" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">);</span></span>
<span id="cb193-60"><a href="#cb193-60" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">1</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">+</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb193-61"><a href="#cb193-61" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span></span>
<span id="cb193-62"><a href="#cb193-62" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">3</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">+</span><span class="dv">3</span><span class="op">);</span></span>
<span id="cb193-63"><a href="#cb193-63" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">4</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">+</span><span class="dv">4</span><span class="op">);</span></span>
<span id="cb193-64"><a href="#cb193-64" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb193-65"><a href="#cb193-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-66"><a href="#cb193-66" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> draw_letter_B<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">)</span> <span class="op">{</span></span>
<span id="cb193-67"><a href="#cb193-67" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">);</span></span>
<span id="cb193-68"><a href="#cb193-68" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">1</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">+</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb193-69"><a href="#cb193-69" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span></span>
<span id="cb193-70"><a href="#cb193-70" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">3</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">+</span><span class="dv">3</span><span class="op">);</span></span>
<span id="cb193-71"><a href="#cb193-71" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">4</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">4</span><span class="op">);</span></span>
<span id="cb193-72"><a href="#cb193-72" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb193-73"><a href="#cb193-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-74"><a href="#cb193-74" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> draw_arrow<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">)</span> <span class="op">{</span></span>
<span id="cb193-75"><a href="#cb193-75" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span></span>
<span id="cb193-76"><a href="#cb193-76" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">1</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">3</span><span class="op">);</span></span>
<span id="cb193-77"><a href="#cb193-77" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">+</span><span class="dv">4</span><span class="op">);</span></span>
<span id="cb193-78"><a href="#cb193-78" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">3</span><span class="op">,</span> y<span class="op">+</span><span class="dv">1</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">3</span><span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">3</span><span class="op">,</span> y<span class="op">+</span><span class="dv">3</span><span class="op">);</span></span>
<span id="cb193-79"><a href="#cb193-79" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">4</span><span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span></span>
<span id="cb193-80"><a href="#cb193-80" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb193-81"><a href="#cb193-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-82"><a href="#cb193-82" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> draw_task<span class="op">(</span><span class="dt">int</span> idx<span class="op">,</span> <span class="dt">int</span> active<span class="op">)</span> <span class="op">{</span></span>
<span id="cb193-83"><a href="#cb193-83" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> x<span class="op">;</span></span>
<span id="cb193-84"><a href="#cb193-84" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> idx <span class="op">*</span> <span class="dv">35</span> <span class="op">+</span> <span class="dv">4</span><span class="op">;</span></span>
<span id="cb193-85"><a href="#cb193-85" aria-hidden="true" tabindex="-1"></a>    clear_rect<span class="op">(</span>x<span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">30</span><span class="op">,</span> <span class="dv">20</span><span class="op">);</span></span>
<span id="cb193-86"><a href="#cb193-86" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>active<span class="op">)</span> <span class="op">{</span></span>
<span id="cb193-87"><a href="#cb193-87" aria-hidden="true" tabindex="-1"></a>        fill_rect<span class="op">(</span>x<span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">30</span><span class="op">,</span> <span class="dv">20</span><span class="op">);</span></span>
<span id="cb193-88"><a href="#cb193-88" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Dessiner en inverse (effacer les pixels pour la lettre/chiffre)</span></span>
<span id="cb193-89"><a href="#cb193-89" aria-hidden="true" tabindex="-1"></a>        clear_rect<span class="op">(</span>x <span class="op">+</span> <span class="dv">12</span><span class="op">,</span> <span class="dv">7</span><span class="op">,</span> <span class="dv">6</span><span class="op">,</span> <span class="dv">6</span><span class="op">);</span></span>
<span id="cb193-90"><a href="#cb193-90" aria-hidden="true" tabindex="-1"></a>        clear_rect<span class="op">(</span>x <span class="op">+</span> <span class="dv">12</span><span class="op">,</span> <span class="dv">15</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">6</span><span class="op">);</span></span>
<span id="cb193-91"><a href="#cb193-91" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb193-92"><a href="#cb193-92" aria-hidden="true" tabindex="-1"></a>        draw_box<span class="op">(</span>x<span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">30</span><span class="op">,</span> <span class="dv">20</span><span class="op">);</span></span>
<span id="cb193-93"><a href="#cb193-93" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb193-94"><a href="#cb193-94" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>idx <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb193-95"><a href="#cb193-95" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>active<span class="op">)</span> clear_rect<span class="op">(</span>x <span class="op">+</span> <span class="dv">13</span><span class="op">,</span> <span class="dv">7</span><span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">5</span><span class="op">);</span></span>
<span id="cb193-96"><a href="#cb193-96" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> draw_letter_A<span class="op">(</span>x <span class="op">+</span> <span class="dv">13</span><span class="op">,</span> <span class="dv">7</span><span class="op">);</span></span>
<span id="cb193-97"><a href="#cb193-97" aria-hidden="true" tabindex="-1"></a>        draw_digit<span class="op">(</span>x <span class="op">+</span> <span class="dv">13</span><span class="op">,</span> <span class="dv">15</span><span class="op">,</span> task_a_val<span class="op">);</span></span>
<span id="cb193-98"><a href="#cb193-98" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb193-99"><a href="#cb193-99" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>active<span class="op">)</span> clear_rect<span class="op">(</span>x <span class="op">+</span> <span class="dv">13</span><span class="op">,</span> <span class="dv">7</span><span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">5</span><span class="op">);</span></span>
<span id="cb193-100"><a href="#cb193-100" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> draw_letter_B<span class="op">(</span>x <span class="op">+</span> <span class="dv">13</span><span class="op">,</span> <span class="dv">7</span><span class="op">);</span></span>
<span id="cb193-101"><a href="#cb193-101" aria-hidden="true" tabindex="-1"></a>        draw_digit<span class="op">(</span>x <span class="op">+</span> <span class="dv">13</span><span class="op">,</span> <span class="dv">15</span><span class="op">,</span> task_b_val<span class="op">);</span></span>
<span id="cb193-102"><a href="#cb193-102" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb193-103"><a href="#cb193-103" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb193-104"><a href="#cb193-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-105"><a href="#cb193-105" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> draw_all<span class="op">()</span> <span class="op">{</span></span>
<span id="cb193-106"><a href="#cb193-106" aria-hidden="true" tabindex="-1"></a>    draw_task<span class="op">(</span><span class="dv">0</span><span class="op">,</span> current_task <span class="op">==</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb193-107"><a href="#cb193-107" aria-hidden="true" tabindex="-1"></a>    draw_task<span class="op">(</span><span class="dv">1</span><span class="op">,</span> current_task <span class="op">==</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb193-108"><a href="#cb193-108" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Fleche entre les taches</span></span>
<span id="cb193-109"><a href="#cb193-109" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>current_task <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb193-110"><a href="#cb193-110" aria-hidden="true" tabindex="-1"></a>        clear_rect<span class="op">(</span><span class="dv">32</span><span class="op">,</span> <span class="dv">12</span><span class="op">,</span> <span class="dv">8</span><span class="op">,</span> <span class="dv">6</span><span class="op">);</span></span>
<span id="cb193-111"><a href="#cb193-111" aria-hidden="true" tabindex="-1"></a>        draw_arrow<span class="op">(</span><span class="dv">32</span><span class="op">,</span> <span class="dv">12</span><span class="op">);</span></span>
<span id="cb193-112"><a href="#cb193-112" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb193-113"><a href="#cb193-113" aria-hidden="true" tabindex="-1"></a>        clear_rect<span class="op">(</span><span class="dv">32</span><span class="op">,</span> <span class="dv">12</span><span class="op">,</span> <span class="dv">8</span><span class="op">,</span> <span class="dv">6</span><span class="op">);</span></span>
<span id="cb193-114"><a href="#cb193-114" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Fleche inversee</span></span>
<span id="cb193-115"><a href="#cb193-115" aria-hidden="true" tabindex="-1"></a>        set_pixel<span class="op">(</span><span class="dv">36</span><span class="op">,</span> <span class="dv">14</span><span class="op">);</span></span>
<span id="cb193-116"><a href="#cb193-116" aria-hidden="true" tabindex="-1"></a>        set_pixel<span class="op">(</span><span class="dv">35</span><span class="op">,</span> <span class="dv">13</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">35</span><span class="op">,</span> <span class="dv">14</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">35</span><span class="op">,</span> <span class="dv">15</span><span class="op">);</span></span>
<span id="cb193-117"><a href="#cb193-117" aria-hidden="true" tabindex="-1"></a>        set_pixel<span class="op">(</span><span class="dv">34</span><span class="op">,</span> <span class="dv">12</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">34</span><span class="op">,</span> <span class="dv">14</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">34</span><span class="op">,</span> <span class="dv">16</span><span class="op">);</span></span>
<span id="cb193-118"><a href="#cb193-118" aria-hidden="true" tabindex="-1"></a>        set_pixel<span class="op">(</span><span class="dv">33</span><span class="op">,</span> <span class="dv">13</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">33</span><span class="op">,</span> <span class="dv">14</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">33</span><span class="op">,</span> <span class="dv">15</span><span class="op">);</span></span>
<span id="cb193-119"><a href="#cb193-119" aria-hidden="true" tabindex="-1"></a>        set_pixel<span class="op">(</span><span class="dv">32</span><span class="op">,</span> <span class="dv">14</span><span class="op">);</span></span>
<span id="cb193-120"><a href="#cb193-120" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb193-121"><a href="#cb193-121" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb193-122"><a href="#cb193-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-123"><a href="#cb193-123" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> step<span class="op">()</span> <span class="op">{</span></span>
<span id="cb193-124"><a href="#cb193-124" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>current_task <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb193-125"><a href="#cb193-125" aria-hidden="true" tabindex="-1"></a>        task_a_val <span class="op">=</span> task_a_val <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb193-126"><a href="#cb193-126" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>task_a_val <span class="op">&gt;</span> <span class="dv">3</span><span class="op">)</span> <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb193-127"><a href="#cb193-127" aria-hidden="true" tabindex="-1"></a>        current_task <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb193-128"><a href="#cb193-128" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb193-129"><a href="#cb193-129" aria-hidden="true" tabindex="-1"></a>        task_b_val <span class="op">=</span> task_b_val <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb193-130"><a href="#cb193-130" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>task_b_val <span class="op">&gt;</span> <span class="dv">3</span><span class="op">)</span> <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb193-131"><a href="#cb193-131" aria-hidden="true" tabindex="-1"></a>        current_task <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb193-132"><a href="#cb193-132" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb193-133"><a href="#cb193-133" aria-hidden="true" tabindex="-1"></a>    steps <span class="op">=</span> steps <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb193-134"><a href="#cb193-134" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb193-135"><a href="#cb193-135" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb193-136"><a href="#cb193-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-137"><a href="#cb193-137" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb193-138"><a href="#cb193-138" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> key<span class="op">;</span> <span class="dt">int</span> lk<span class="op">;</span> <span class="dt">int</span> t<span class="op">;</span> <span class="dt">int</span> running<span class="op">;</span></span>
<span id="cb193-139"><a href="#cb193-139" aria-hidden="true" tabindex="-1"></a>    lk <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> t <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> running <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb193-140"><a href="#cb193-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-141"><a href="#cb193-141" aria-hidden="true" tabindex="-1"></a>    draw_all<span class="op">();</span></span>
<span id="cb193-142"><a href="#cb193-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-143"><a href="#cb193-143" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>t <span class="op">&lt;</span> <span class="dv">100000</span> <span class="op">&amp;&amp;</span> running<span class="op">)</span> <span class="op">{</span></span>
<span id="cb193-144"><a href="#cb193-144" aria-hidden="true" tabindex="-1"></a>        key <span class="op">=</span> <span class="op">*</span>KEYBOARD<span class="op">;</span></span>
<span id="cb193-145"><a href="#cb193-145" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>key <span class="op">!=</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> key <span class="op">!=</span> lk<span class="op">)</span> <span class="op">{</span></span>
<span id="cb193-146"><a href="#cb193-146" aria-hidden="true" tabindex="-1"></a>            t <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb193-147"><a href="#cb193-147" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>key <span class="op">==</span> <span class="dv">32</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb193-148"><a href="#cb193-148" aria-hidden="true" tabindex="-1"></a>                running <span class="op">=</span> step<span class="op">();</span></span>
<span id="cb193-149"><a href="#cb193-149" aria-hidden="true" tabindex="-1"></a>                draw_all<span class="op">();</span></span>
<span id="cb193-150"><a href="#cb193-150" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb193-151"><a href="#cb193-151" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>key <span class="op">==</span> <span class="dv">13</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb193-152"><a href="#cb193-152" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> steps<span class="op">;</span></span>
<span id="cb193-153"><a href="#cb193-153" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb193-154"><a href="#cb193-154" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb193-155"><a href="#cb193-155" aria-hidden="true" tabindex="-1"></a>        lk <span class="op">=</span> key<span class="op">;</span></span>
<span id="cb193-156"><a href="#cb193-156" aria-hidden="true" tabindex="-1"></a>        t <span class="op">=</span> t <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb193-157"><a href="#cb193-157" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb193-158"><a href="#cb193-158" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Flash final</span></span>
<span id="cb193-159"><a href="#cb193-159" aria-hidden="true" tabindex="-1"></a>    fill_rect<span class="op">(</span><span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">80</span><span class="op">,</span> <span class="dv">30</span><span class="op">);</span></span>
<span id="cb193-160"><a href="#cb193-160" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> steps<span class="op">;</span></span>
<span id="cb193-161"><a href="#cb193-161" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.5.14" id="scheduler"><span class="header-section-number">2.5.14</span> Scheduler</h3>
<div class="sourceCode" id="cb194"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Scheduler Round-Robin Visuel - Solution</span></span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a><span class="co">// Cochez &quot;Capturer clavier&quot;, Espace pour chaque tick</span></span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> <span class="op">*</span>SCREEN <span class="op">=</span> <span class="op">(</span><span class="dt">int</span><span class="op">*)</span><span class="bn">0x00400000</span><span class="op">;</span></span>
<span id="cb194-5"><a href="#cb194-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> <span class="op">*</span>KEYBOARD <span class="op">=</span> <span class="op">(</span><span class="dt">int</span><span class="op">*)</span><span class="bn">0x00402600</span><span class="op">;</span></span>
<span id="cb194-6"><a href="#cb194-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-7"><a href="#cb194-7" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> proc_time<span class="op">[</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb194-8"><a href="#cb194-8" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> proc_state<span class="op">[</span><span class="dv">3</span><span class="op">];</span></span>
<span id="cb194-9"><a href="#cb194-9" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> current_proc <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb194-10"><a href="#cb194-10" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> quantum_left <span class="op">=</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb194-11"><a href="#cb194-11" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> switches <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb194-12"><a href="#cb194-12" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> ticks <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb194-13"><a href="#cb194-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-14"><a href="#cb194-14" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> set_pixel<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">)</span> <span class="op">{</span></span>
<span id="cb194-15"><a href="#cb194-15" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> <span class="op">*</span>ptr<span class="op">;</span> <span class="dt">int</span> bit_pos<span class="op">;</span></span>
<span id="cb194-16"><a href="#cb194-16" aria-hidden="true" tabindex="-1"></a>    ptr <span class="op">=</span> SCREEN <span class="op">+</span> <span class="op">(</span>y <span class="op">&lt;&lt;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span>y <span class="op">&lt;&lt;</span> <span class="dv">1</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span>x <span class="op">&gt;&gt;</span> <span class="dv">5</span><span class="op">);</span></span>
<span id="cb194-17"><a href="#cb194-17" aria-hidden="true" tabindex="-1"></a>    bit_pos <span class="op">=</span> <span class="op">((</span>x <span class="op">&gt;&gt;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">&amp;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">*</span> <span class="dv">8</span> <span class="op">+</span> <span class="dv">7</span> <span class="op">-</span> <span class="op">(</span>x <span class="op">&amp;</span> <span class="dv">7</span><span class="op">);</span></span>
<span id="cb194-18"><a href="#cb194-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span>ptr <span class="op">=</span> <span class="op">*</span>ptr <span class="op">|</span> <span class="op">(</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> bit_pos<span class="op">);</span></span>
<span id="cb194-19"><a href="#cb194-19" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb194-20"><a href="#cb194-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-21"><a href="#cb194-21" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> clear_rect<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">,</span> <span class="dt">int</span> w<span class="op">,</span> <span class="dt">int</span> h<span class="op">)</span> <span class="op">{</span></span>
<span id="cb194-22"><a href="#cb194-22" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i<span class="op">;</span> <span class="dt">int</span> j<span class="op">;</span> <span class="dt">int</span> px<span class="op">;</span> <span class="dt">int</span> py<span class="op">;</span> <span class="dt">int</span> <span class="op">*</span>ptr<span class="op">;</span> <span class="dt">int</span> bit_pos<span class="op">;</span></span>
<span id="cb194-23"><a href="#cb194-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> w<span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb194-24"><a href="#cb194-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span>j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> h<span class="op">;</span> j <span class="op">=</span> j <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb194-25"><a href="#cb194-25" aria-hidden="true" tabindex="-1"></a>            px <span class="op">=</span> x <span class="op">+</span> i<span class="op">;</span> py <span class="op">=</span> y <span class="op">+</span> j<span class="op">;</span></span>
<span id="cb194-26"><a href="#cb194-26" aria-hidden="true" tabindex="-1"></a>            ptr <span class="op">=</span> SCREEN <span class="op">+</span> <span class="op">(</span>py <span class="op">&lt;&lt;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span>py <span class="op">&lt;&lt;</span> <span class="dv">1</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span>px <span class="op">&gt;&gt;</span> <span class="dv">5</span><span class="op">);</span></span>
<span id="cb194-27"><a href="#cb194-27" aria-hidden="true" tabindex="-1"></a>            bit_pos <span class="op">=</span> <span class="op">((</span>px <span class="op">&gt;&gt;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">&amp;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">*</span> <span class="dv">8</span> <span class="op">+</span> <span class="dv">7</span> <span class="op">-</span> <span class="op">(</span>px <span class="op">&amp;</span> <span class="dv">7</span><span class="op">);</span></span>
<span id="cb194-28"><a href="#cb194-28" aria-hidden="true" tabindex="-1"></a>            <span class="op">*</span>ptr <span class="op">=</span> <span class="op">*</span>ptr <span class="op">&amp;</span> <span class="op">(</span><span class="bn">0xFFFFFFFF</span> <span class="op">^</span> <span class="op">(</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> bit_pos<span class="op">));</span></span>
<span id="cb194-29"><a href="#cb194-29" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb194-30"><a href="#cb194-30" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb194-31"><a href="#cb194-31" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb194-32"><a href="#cb194-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-33"><a href="#cb194-33" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> fill_rect<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">,</span> <span class="dt">int</span> w<span class="op">,</span> <span class="dt">int</span> h<span class="op">)</span> <span class="op">{</span></span>
<span id="cb194-34"><a href="#cb194-34" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i<span class="op">;</span> <span class="dt">int</span> j<span class="op">;</span></span>
<span id="cb194-35"><a href="#cb194-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> w<span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb194-36"><a href="#cb194-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span>j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> h<span class="op">;</span> j <span class="op">=</span> j <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb194-37"><a href="#cb194-37" aria-hidden="true" tabindex="-1"></a>            set_pixel<span class="op">(</span>x <span class="op">+</span> i<span class="op">,</span> y <span class="op">+</span> j<span class="op">);</span></span>
<span id="cb194-38"><a href="#cb194-38" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb194-39"><a href="#cb194-39" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb194-40"><a href="#cb194-40" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb194-41"><a href="#cb194-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-42"><a href="#cb194-42" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> draw_box<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">,</span> <span class="dt">int</span> w<span class="op">,</span> <span class="dt">int</span> h<span class="op">)</span> <span class="op">{</span></span>
<span id="cb194-43"><a href="#cb194-43" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i<span class="op">;</span></span>
<span id="cb194-44"><a href="#cb194-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> w<span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x <span class="op">+</span> i<span class="op">,</span> y<span class="op">);</span> set_pixel<span class="op">(</span>x <span class="op">+</span> i<span class="op">,</span> y <span class="op">+</span> h <span class="op">-</span> <span class="dv">1</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb194-45"><a href="#cb194-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> h<span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> i<span class="op">);</span> set_pixel<span class="op">(</span>x <span class="op">+</span> w <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> y <span class="op">+</span> i<span class="op">);</span> <span class="op">}</span></span>
<span id="cb194-46"><a href="#cb194-46" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb194-47"><a href="#cb194-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-48"><a href="#cb194-48" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> draw_digit<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">,</span> <span class="dt">int</span> d<span class="op">)</span> <span class="op">{</span></span>
<span id="cb194-49"><a href="#cb194-49" aria-hidden="true" tabindex="-1"></a>    clear_rect<span class="op">(</span>x<span class="op">,</span> y<span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">6</span><span class="op">);</span></span>
<span id="cb194-50"><a href="#cb194-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">!=</span> <span class="dv">1</span> <span class="op">&amp;&amp;</span> d <span class="op">!=</span> <span class="dv">4</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">);</span> <span class="op">}</span></span>
<span id="cb194-51"><a href="#cb194-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">==</span> <span class="dv">0</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">4</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">5</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">6</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">8</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">9</span><span class="op">)</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb194-52"><a href="#cb194-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">!=</span> <span class="dv">5</span> <span class="op">&amp;&amp;</span> d <span class="op">!=</span> <span class="dv">6</span><span class="op">)</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">+</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb194-53"><a href="#cb194-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">!=</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> d <span class="op">!=</span> <span class="dv">1</span> <span class="op">&amp;&amp;</span> d <span class="op">!=</span> <span class="dv">7</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb194-54"><a href="#cb194-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">==</span> <span class="dv">0</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">2</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">6</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">8</span><span class="op">)</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">3</span><span class="op">);</span></span>
<span id="cb194-55"><a href="#cb194-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">!=</span> <span class="dv">2</span><span class="op">)</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">+</span><span class="dv">3</span><span class="op">);</span></span>
<span id="cb194-56"><a href="#cb194-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">!=</span> <span class="dv">1</span> <span class="op">&amp;&amp;</span> d <span class="op">!=</span> <span class="dv">4</span> <span class="op">&amp;&amp;</span> d <span class="op">!=</span> <span class="dv">7</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">4</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">4</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">+</span><span class="dv">4</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb194-57"><a href="#cb194-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">1</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">3</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">4</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb194-58"><a href="#cb194-58" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb194-59"><a href="#cb194-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-60"><a href="#cb194-60" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> draw_P<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">)</span> <span class="op">{</span></span>
<span id="cb194-61"><a href="#cb194-61" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">);</span></span>
<span id="cb194-62"><a href="#cb194-62" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">1</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">+</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb194-63"><a href="#cb194-63" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span></span>
<span id="cb194-64"><a href="#cb194-64" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">3</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">4</span><span class="op">);</span></span>
<span id="cb194-65"><a href="#cb194-65" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb194-66"><a href="#cb194-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-67"><a href="#cb194-67" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> draw_proc<span class="op">(</span><span class="dt">int</span> idx<span class="op">,</span> <span class="dt">int</span> active<span class="op">)</span> <span class="op">{</span></span>
<span id="cb194-68"><a href="#cb194-68" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> x<span class="op">;</span> <span class="dt">int</span> y<span class="op">;</span> <span class="dt">int</span> t<span class="op">;</span> <span class="dt">int</span> i<span class="op">;</span></span>
<span id="cb194-69"><a href="#cb194-69" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> idx <span class="op">*</span> <span class="dv">32</span> <span class="op">+</span> <span class="dv">4</span><span class="op">;</span></span>
<span id="cb194-70"><a href="#cb194-70" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> <span class="dv">4</span><span class="op">;</span></span>
<span id="cb194-71"><a href="#cb194-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-72"><a href="#cb194-72" aria-hidden="true" tabindex="-1"></a>    clear_rect<span class="op">(</span>x<span class="op">,</span> y<span class="op">,</span> <span class="dv">28</span><span class="op">,</span> <span class="dv">24</span><span class="op">);</span></span>
<span id="cb194-73"><a href="#cb194-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-74"><a href="#cb194-74" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>active<span class="op">)</span> <span class="op">{</span></span>
<span id="cb194-75"><a href="#cb194-75" aria-hidden="true" tabindex="-1"></a>        fill_rect<span class="op">(</span>x<span class="op">,</span> y<span class="op">,</span> <span class="dv">28</span><span class="op">,</span> <span class="dv">24</span><span class="op">);</span></span>
<span id="cb194-76"><a href="#cb194-76" aria-hidden="true" tabindex="-1"></a>        clear_rect<span class="op">(</span>x <span class="op">+</span> <span class="dv">2</span><span class="op">,</span> y <span class="op">+</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">24</span><span class="op">,</span> <span class="dv">20</span><span class="op">);</span></span>
<span id="cb194-77"><a href="#cb194-77" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb194-78"><a href="#cb194-78" aria-hidden="true" tabindex="-1"></a>        draw_box<span class="op">(</span>x<span class="op">,</span> y<span class="op">,</span> <span class="dv">28</span><span class="op">,</span> <span class="dv">24</span><span class="op">);</span></span>
<span id="cb194-79"><a href="#cb194-79" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb194-80"><a href="#cb194-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-81"><a href="#cb194-81" aria-hidden="true" tabindex="-1"></a>    <span class="co">// P et numero</span></span>
<span id="cb194-82"><a href="#cb194-82" aria-hidden="true" tabindex="-1"></a>    draw_P<span class="op">(</span>x <span class="op">+</span> <span class="dv">4</span><span class="op">,</span> y <span class="op">+</span> <span class="dv">4</span><span class="op">);</span></span>
<span id="cb194-83"><a href="#cb194-83" aria-hidden="true" tabindex="-1"></a>    draw_digit<span class="op">(</span>x <span class="op">+</span> <span class="dv">10</span><span class="op">,</span> y <span class="op">+</span> <span class="dv">4</span><span class="op">,</span> idx<span class="op">);</span></span>
<span id="cb194-84"><a href="#cb194-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-85"><a href="#cb194-85" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Barre de temps restant</span></span>
<span id="cb194-86"><a href="#cb194-86" aria-hidden="true" tabindex="-1"></a>    t <span class="op">=</span> proc_time<span class="op">[</span>idx<span class="op">];</span></span>
<span id="cb194-87"><a href="#cb194-87" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>t <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb194-88"><a href="#cb194-88" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span>i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> t<span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb194-89"><a href="#cb194-89" aria-hidden="true" tabindex="-1"></a>            fill_rect<span class="op">(</span>x <span class="op">+</span> <span class="dv">4</span> <span class="op">+</span> i <span class="op">*</span> <span class="dv">5</span><span class="op">,</span> y <span class="op">+</span> <span class="dv">14</span><span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">6</span><span class="op">);</span></span>
<span id="cb194-90"><a href="#cb194-90" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb194-91"><a href="#cb194-91" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb194-92"><a href="#cb194-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-93"><a href="#cb194-93" aria-hidden="true" tabindex="-1"></a>    <span class="co">// X si termine</span></span>
<span id="cb194-94"><a href="#cb194-94" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>proc_state<span class="op">[</span>idx<span class="op">]</span> <span class="op">==</span> <span class="dv">2</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb194-95"><a href="#cb194-95" aria-hidden="true" tabindex="-1"></a>        set_pixel<span class="op">(</span>x <span class="op">+</span> <span class="dv">8</span><span class="op">,</span> y <span class="op">+</span> <span class="dv">14</span><span class="op">);</span> set_pixel<span class="op">(</span>x <span class="op">+</span> <span class="dv">12</span><span class="op">,</span> y <span class="op">+</span> <span class="dv">14</span><span class="op">);</span></span>
<span id="cb194-96"><a href="#cb194-96" aria-hidden="true" tabindex="-1"></a>        set_pixel<span class="op">(</span>x <span class="op">+</span> <span class="dv">9</span><span class="op">,</span> y <span class="op">+</span> <span class="dv">15</span><span class="op">);</span> set_pixel<span class="op">(</span>x <span class="op">+</span> <span class="dv">11</span><span class="op">,</span> y <span class="op">+</span> <span class="dv">15</span><span class="op">);</span></span>
<span id="cb194-97"><a href="#cb194-97" aria-hidden="true" tabindex="-1"></a>        set_pixel<span class="op">(</span>x <span class="op">+</span> <span class="dv">10</span><span class="op">,</span> y <span class="op">+</span> <span class="dv">16</span><span class="op">);</span></span>
<span id="cb194-98"><a href="#cb194-98" aria-hidden="true" tabindex="-1"></a>        set_pixel<span class="op">(</span>x <span class="op">+</span> <span class="dv">9</span><span class="op">,</span> y <span class="op">+</span> <span class="dv">17</span><span class="op">);</span> set_pixel<span class="op">(</span>x <span class="op">+</span> <span class="dv">11</span><span class="op">,</span> y <span class="op">+</span> <span class="dv">17</span><span class="op">);</span></span>
<span id="cb194-99"><a href="#cb194-99" aria-hidden="true" tabindex="-1"></a>        set_pixel<span class="op">(</span>x <span class="op">+</span> <span class="dv">8</span><span class="op">,</span> y <span class="op">+</span> <span class="dv">18</span><span class="op">);</span> set_pixel<span class="op">(</span>x <span class="op">+</span> <span class="dv">12</span><span class="op">,</span> y <span class="op">+</span> <span class="dv">18</span><span class="op">);</span></span>
<span id="cb194-100"><a href="#cb194-100" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb194-101"><a href="#cb194-101" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb194-102"><a href="#cb194-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-103"><a href="#cb194-103" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> draw_all<span class="op">()</span> <span class="op">{</span></span>
<span id="cb194-104"><a href="#cb194-104" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i<span class="op">;</span></span>
<span id="cb194-105"><a href="#cb194-105" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">3</span><span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb194-106"><a href="#cb194-106" aria-hidden="true" tabindex="-1"></a>        draw_proc<span class="op">(</span>i<span class="op">,</span> i <span class="op">==</span> current_proc <span class="op">&amp;&amp;</span> proc_state<span class="op">[</span>i<span class="op">]</span> <span class="op">!=</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb194-107"><a href="#cb194-107" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb194-108"><a href="#cb194-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-109"><a href="#cb194-109" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Quantum: Q=N</span></span>
<span id="cb194-110"><a href="#cb194-110" aria-hidden="true" tabindex="-1"></a>    clear_rect<span class="op">(</span><span class="dv">4</span><span class="op">,</span> <span class="dv">32</span><span class="op">,</span> <span class="dv">20</span><span class="op">,</span> <span class="dv">6</span><span class="op">);</span></span>
<span id="cb194-111"><a href="#cb194-111" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Q</span></span>
<span id="cb194-112"><a href="#cb194-112" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">5</span><span class="op">,</span> <span class="dv">32</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">6</span><span class="op">,</span> <span class="dv">32</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">7</span><span class="op">,</span> <span class="dv">32</span><span class="op">);</span></span>
<span id="cb194-113"><a href="#cb194-113" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">4</span><span class="op">,</span> <span class="dv">33</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">8</span><span class="op">,</span> <span class="dv">33</span><span class="op">);</span></span>
<span id="cb194-114"><a href="#cb194-114" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">4</span><span class="op">,</span> <span class="dv">34</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">8</span><span class="op">,</span> <span class="dv">34</span><span class="op">);</span></span>
<span id="cb194-115"><a href="#cb194-115" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">4</span><span class="op">,</span> <span class="dv">35</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">6</span><span class="op">,</span> <span class="dv">35</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">8</span><span class="op">,</span> <span class="dv">35</span><span class="op">);</span></span>
<span id="cb194-116"><a href="#cb194-116" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">5</span><span class="op">,</span> <span class="dv">36</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">6</span><span class="op">,</span> <span class="dv">36</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">8</span><span class="op">,</span> <span class="dv">36</span><span class="op">);</span></span>
<span id="cb194-117"><a href="#cb194-117" aria-hidden="true" tabindex="-1"></a>    draw_digit<span class="op">(</span><span class="dv">12</span><span class="op">,</span> <span class="dv">32</span><span class="op">,</span> quantum_left<span class="op">);</span></span>
<span id="cb194-118"><a href="#cb194-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-119"><a href="#cb194-119" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Switches: SW=N</span></span>
<span id="cb194-120"><a href="#cb194-120" aria-hidden="true" tabindex="-1"></a>    clear_rect<span class="op">(</span><span class="dv">30</span><span class="op">,</span> <span class="dv">32</span><span class="op">,</span> <span class="dv">30</span><span class="op">,</span> <span class="dv">6</span><span class="op">);</span></span>
<span id="cb194-121"><a href="#cb194-121" aria-hidden="true" tabindex="-1"></a>    <span class="co">// S</span></span>
<span id="cb194-122"><a href="#cb194-122" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">31</span><span class="op">,</span> <span class="dv">32</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">32</span><span class="op">,</span> <span class="dv">32</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">33</span><span class="op">,</span> <span class="dv">32</span><span class="op">);</span></span>
<span id="cb194-123"><a href="#cb194-123" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">30</span><span class="op">,</span> <span class="dv">33</span><span class="op">);</span></span>
<span id="cb194-124"><a href="#cb194-124" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">31</span><span class="op">,</span> <span class="dv">34</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">32</span><span class="op">,</span> <span class="dv">34</span><span class="op">);</span></span>
<span id="cb194-125"><a href="#cb194-125" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">33</span><span class="op">,</span> <span class="dv">35</span><span class="op">);</span></span>
<span id="cb194-126"><a href="#cb194-126" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">30</span><span class="op">,</span> <span class="dv">36</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">31</span><span class="op">,</span> <span class="dv">36</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">32</span><span class="op">,</span> <span class="dv">36</span><span class="op">);</span></span>
<span id="cb194-127"><a href="#cb194-127" aria-hidden="true" tabindex="-1"></a>    <span class="co">// W</span></span>
<span id="cb194-128"><a href="#cb194-128" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">36</span><span class="op">,</span> <span class="dv">32</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">40</span><span class="op">,</span> <span class="dv">32</span><span class="op">);</span></span>
<span id="cb194-129"><a href="#cb194-129" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">36</span><span class="op">,</span> <span class="dv">33</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">40</span><span class="op">,</span> <span class="dv">33</span><span class="op">);</span></span>
<span id="cb194-130"><a href="#cb194-130" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">36</span><span class="op">,</span> <span class="dv">34</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">38</span><span class="op">,</span> <span class="dv">34</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">40</span><span class="op">,</span> <span class="dv">34</span><span class="op">);</span></span>
<span id="cb194-131"><a href="#cb194-131" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">36</span><span class="op">,</span> <span class="dv">35</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">38</span><span class="op">,</span> <span class="dv">35</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">40</span><span class="op">,</span> <span class="dv">35</span><span class="op">);</span></span>
<span id="cb194-132"><a href="#cb194-132" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">37</span><span class="op">,</span> <span class="dv">36</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">39</span><span class="op">,</span> <span class="dv">36</span><span class="op">);</span></span>
<span id="cb194-133"><a href="#cb194-133" aria-hidden="true" tabindex="-1"></a>    draw_digit<span class="op">(</span><span class="dv">44</span><span class="op">,</span> <span class="dv">32</span><span class="op">,</span> switches<span class="op">);</span></span>
<span id="cb194-134"><a href="#cb194-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-135"><a href="#cb194-135" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Ticks: T=N</span></span>
<span id="cb194-136"><a href="#cb194-136" aria-hidden="true" tabindex="-1"></a>    clear_rect<span class="op">(</span><span class="dv">60</span><span class="op">,</span> <span class="dv">32</span><span class="op">,</span> <span class="dv">20</span><span class="op">,</span> <span class="dv">6</span><span class="op">);</span></span>
<span id="cb194-137"><a href="#cb194-137" aria-hidden="true" tabindex="-1"></a>    <span class="co">// T</span></span>
<span id="cb194-138"><a href="#cb194-138" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">60</span><span class="op">,</span> <span class="dv">32</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">61</span><span class="op">,</span> <span class="dv">32</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">62</span><span class="op">,</span> <span class="dv">32</span><span class="op">);</span></span>
<span id="cb194-139"><a href="#cb194-139" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">61</span><span class="op">,</span> <span class="dv">33</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">61</span><span class="op">,</span> <span class="dv">34</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">61</span><span class="op">,</span> <span class="dv">35</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">61</span><span class="op">,</span> <span class="dv">36</span><span class="op">);</span></span>
<span id="cb194-140"><a href="#cb194-140" aria-hidden="true" tabindex="-1"></a>    draw_digit<span class="op">(</span><span class="dv">66</span><span class="op">,</span> <span class="dv">32</span><span class="op">,</span> ticks<span class="op">);</span></span>
<span id="cb194-141"><a href="#cb194-141" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb194-142"><a href="#cb194-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-143"><a href="#cb194-143" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> find_next<span class="op">(</span><span class="dt">int</span> from<span class="op">)</span> <span class="op">{</span></span>
<span id="cb194-144"><a href="#cb194-144" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i<span class="op">;</span> <span class="dt">int</span> next<span class="op">;</span></span>
<span id="cb194-145"><a href="#cb194-145" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> <span class="dv">3</span><span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb194-146"><a href="#cb194-146" aria-hidden="true" tabindex="-1"></a>        next <span class="op">=</span> <span class="op">(</span>from <span class="op">+</span> i<span class="op">)</span> <span class="op">%</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb194-147"><a href="#cb194-147" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>proc_state<span class="op">[</span>next<span class="op">]</span> <span class="op">==</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> proc_time<span class="op">[</span>next<span class="op">]</span> <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> next<span class="op">;</span></span>
<span id="cb194-148"><a href="#cb194-148" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb194-149"><a href="#cb194-149" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> from<span class="op">;</span></span>
<span id="cb194-150"><a href="#cb194-150" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb194-151"><a href="#cb194-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-152"><a href="#cb194-152" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> tick<span class="op">()</span> <span class="op">{</span></span>
<span id="cb194-153"><a href="#cb194-153" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> next<span class="op">;</span> <span class="dt">int</span> all_done<span class="op">;</span></span>
<span id="cb194-154"><a href="#cb194-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-155"><a href="#cb194-155" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Verifier si tous termines</span></span>
<span id="cb194-156"><a href="#cb194-156" aria-hidden="true" tabindex="-1"></a>    all_done <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb194-157"><a href="#cb194-157" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>proc_state<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">!=</span> <span class="dv">2</span><span class="op">)</span> all_done <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb194-158"><a href="#cb194-158" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>proc_state<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">!=</span> <span class="dv">2</span><span class="op">)</span> all_done <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb194-159"><a href="#cb194-159" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>proc_state<span class="op">[</span><span class="dv">2</span><span class="op">]</span> <span class="op">!=</span> <span class="dv">2</span><span class="op">)</span> all_done <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb194-160"><a href="#cb194-160" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>all_done<span class="op">)</span> <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb194-161"><a href="#cb194-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-162"><a href="#cb194-162" aria-hidden="true" tabindex="-1"></a>    ticks <span class="op">=</span> ticks <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb194-163"><a href="#cb194-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-164"><a href="#cb194-164" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Executer processus courant</span></span>
<span id="cb194-165"><a href="#cb194-165" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>proc_time<span class="op">[</span>current_proc<span class="op">]</span> <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb194-166"><a href="#cb194-166" aria-hidden="true" tabindex="-1"></a>        proc_time<span class="op">[</span>current_proc<span class="op">]</span> <span class="op">=</span> proc_time<span class="op">[</span>current_proc<span class="op">]</span> <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb194-167"><a href="#cb194-167" aria-hidden="true" tabindex="-1"></a>        quantum_left <span class="op">=</span> quantum_left <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb194-168"><a href="#cb194-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-169"><a href="#cb194-169" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>proc_time<span class="op">[</span>current_proc<span class="op">]</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb194-170"><a href="#cb194-170" aria-hidden="true" tabindex="-1"></a>            proc_state<span class="op">[</span>current_proc<span class="op">]</span> <span class="op">=</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb194-171"><a href="#cb194-171" aria-hidden="true" tabindex="-1"></a>            quantum_left <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb194-172"><a href="#cb194-172" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb194-173"><a href="#cb194-173" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb194-174"><a href="#cb194-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-175"><a href="#cb194-175" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Context switch si quantum epuise</span></span>
<span id="cb194-176"><a href="#cb194-176" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>quantum_left <span class="op">&lt;=</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb194-177"><a href="#cb194-177" aria-hidden="true" tabindex="-1"></a>        next <span class="op">=</span> find_next<span class="op">(</span>current_proc<span class="op">);</span></span>
<span id="cb194-178"><a href="#cb194-178" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>next <span class="op">!=</span> current_proc<span class="op">)</span> <span class="op">{</span></span>
<span id="cb194-179"><a href="#cb194-179" aria-hidden="true" tabindex="-1"></a>            current_proc <span class="op">=</span> next<span class="op">;</span></span>
<span id="cb194-180"><a href="#cb194-180" aria-hidden="true" tabindex="-1"></a>            switches <span class="op">=</span> switches <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb194-181"><a href="#cb194-181" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb194-182"><a href="#cb194-182" aria-hidden="true" tabindex="-1"></a>        quantum_left <span class="op">=</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb194-183"><a href="#cb194-183" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb194-184"><a href="#cb194-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-185"><a href="#cb194-185" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb194-186"><a href="#cb194-186" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb194-187"><a href="#cb194-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-188"><a href="#cb194-188" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb194-189"><a href="#cb194-189" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> key<span class="op">;</span> <span class="dt">int</span> lk<span class="op">;</span> <span class="dt">int</span> t<span class="op">;</span> <span class="dt">int</span> running<span class="op">;</span></span>
<span id="cb194-190"><a href="#cb194-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-191"><a href="#cb194-191" aria-hidden="true" tabindex="-1"></a>    proc_time<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">3</span><span class="op">;</span> proc_time<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> proc_time<span class="op">[</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> <span class="dv">4</span><span class="op">;</span></span>
<span id="cb194-192"><a href="#cb194-192" aria-hidden="true" tabindex="-1"></a>    proc_state<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> proc_state<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> proc_state<span class="op">[</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb194-193"><a href="#cb194-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-194"><a href="#cb194-194" aria-hidden="true" tabindex="-1"></a>    lk <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> t <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> running <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb194-195"><a href="#cb194-195" aria-hidden="true" tabindex="-1"></a>    draw_all<span class="op">();</span></span>
<span id="cb194-196"><a href="#cb194-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-197"><a href="#cb194-197" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>t <span class="op">&lt;</span> <span class="dv">100000</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb194-198"><a href="#cb194-198" aria-hidden="true" tabindex="-1"></a>        key <span class="op">=</span> <span class="op">*</span>KEYBOARD<span class="op">;</span></span>
<span id="cb194-199"><a href="#cb194-199" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>key <span class="op">!=</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> key <span class="op">!=</span> lk<span class="op">)</span> <span class="op">{</span></span>
<span id="cb194-200"><a href="#cb194-200" aria-hidden="true" tabindex="-1"></a>            t <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb194-201"><a href="#cb194-201" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>key <span class="op">==</span> <span class="dv">32</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb194-202"><a href="#cb194-202" aria-hidden="true" tabindex="-1"></a>                running <span class="op">=</span> tick<span class="op">();</span></span>
<span id="cb194-203"><a href="#cb194-203" aria-hidden="true" tabindex="-1"></a>                draw_all<span class="op">();</span></span>
<span id="cb194-204"><a href="#cb194-204" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb194-205"><a href="#cb194-205" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>key <span class="op">==</span> <span class="dv">13</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb194-206"><a href="#cb194-206" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> switches<span class="op">;</span></span>
<span id="cb194-207"><a href="#cb194-207" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb194-208"><a href="#cb194-208" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb194-209"><a href="#cb194-209" aria-hidden="true" tabindex="-1"></a>        lk <span class="op">=</span> key<span class="op">;</span></span>
<span id="cb194-210"><a href="#cb194-210" aria-hidden="true" tabindex="-1"></a>        t <span class="op">=</span> t <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb194-211"><a href="#cb194-211" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb194-212"><a href="#cb194-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-213"><a href="#cb194-213" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> switches<span class="op">;</span></span>
<span id="cb194-214"><a href="#cb194-214" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.5.15" id="projet-1-mini-os-shell"><span class="header-section-number">2.5.15</span> Projet 1: Mini-OS Shell</h3>
<div class="sourceCode" id="cb195"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Mini-OS Shell - Solution</span></span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a><span class="co">// Cochez &quot;Capturer clavier&quot;</span></span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-4"><a href="#cb195-4" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> <span class="op">*</span>SCREEN <span class="op">=</span> <span class="op">(</span><span class="dt">int</span><span class="op">*)</span><span class="bn">0x00400000</span><span class="op">;</span></span>
<span id="cb195-5"><a href="#cb195-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> <span class="op">*</span>KEYBOARD <span class="op">=</span> <span class="op">(</span><span class="dt">int</span><span class="op">*)</span><span class="bn">0x00402600</span><span class="op">;</span></span>
<span id="cb195-6"><a href="#cb195-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-7"><a href="#cb195-7" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> set_pixel<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">)</span> <span class="op">{</span></span>
<span id="cb195-8"><a href="#cb195-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> <span class="op">*</span>ptr<span class="op">;</span> <span class="dt">int</span> bit_pos<span class="op">;</span></span>
<span id="cb195-9"><a href="#cb195-9" aria-hidden="true" tabindex="-1"></a>    ptr <span class="op">=</span> SCREEN <span class="op">+</span> <span class="op">(</span>y <span class="op">&lt;&lt;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span>y <span class="op">&lt;&lt;</span> <span class="dv">1</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span>x <span class="op">&gt;&gt;</span> <span class="dv">5</span><span class="op">);</span></span>
<span id="cb195-10"><a href="#cb195-10" aria-hidden="true" tabindex="-1"></a>    bit_pos <span class="op">=</span> <span class="op">((</span>x <span class="op">&gt;&gt;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">&amp;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">*</span> <span class="dv">8</span> <span class="op">+</span> <span class="dv">7</span> <span class="op">-</span> <span class="op">(</span>x <span class="op">&amp;</span> <span class="dv">7</span><span class="op">);</span></span>
<span id="cb195-11"><a href="#cb195-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span>ptr <span class="op">=</span> <span class="op">*</span>ptr <span class="op">|</span> <span class="op">(</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> bit_pos<span class="op">);</span></span>
<span id="cb195-12"><a href="#cb195-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb195-13"><a href="#cb195-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-14"><a href="#cb195-14" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> clear_screen<span class="op">()</span> <span class="op">{</span></span>
<span id="cb195-15"><a href="#cb195-15" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i<span class="op">;</span> <span class="dt">int</span> <span class="op">*</span>ptr<span class="op">;</span></span>
<span id="cb195-16"><a href="#cb195-16" aria-hidden="true" tabindex="-1"></a>    ptr <span class="op">=</span> SCREEN<span class="op">;</span></span>
<span id="cb195-17"><a href="#cb195-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">2400</span><span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb195-18"><a href="#cb195-18" aria-hidden="true" tabindex="-1"></a>        <span class="op">*</span>ptr <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb195-19"><a href="#cb195-19" aria-hidden="true" tabindex="-1"></a>        ptr <span class="op">=</span> ptr <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb195-20"><a href="#cb195-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb195-21"><a href="#cb195-21" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb195-22"><a href="#cb195-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-23"><a href="#cb195-23" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> draw_digit<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">,</span> <span class="dt">int</span> d<span class="op">)</span> <span class="op">{</span></span>
<span id="cb195-24"><a href="#cb195-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">!=</span> <span class="dv">1</span> <span class="op">&amp;&amp;</span> d <span class="op">!=</span> <span class="dv">4</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">);</span> <span class="op">}</span></span>
<span id="cb195-25"><a href="#cb195-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">==</span> <span class="dv">0</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">4</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">5</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">6</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">8</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">9</span><span class="op">)</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb195-26"><a href="#cb195-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">!=</span> <span class="dv">5</span> <span class="op">&amp;&amp;</span> d <span class="op">!=</span> <span class="dv">6</span><span class="op">)</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">+</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb195-27"><a href="#cb195-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">!=</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> d <span class="op">!=</span> <span class="dv">1</span> <span class="op">&amp;&amp;</span> d <span class="op">!=</span> <span class="dv">7</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb195-28"><a href="#cb195-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">==</span> <span class="dv">0</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">2</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">6</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">8</span><span class="op">)</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">3</span><span class="op">);</span></span>
<span id="cb195-29"><a href="#cb195-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">!=</span> <span class="dv">2</span><span class="op">)</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">+</span><span class="dv">3</span><span class="op">);</span></span>
<span id="cb195-30"><a href="#cb195-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">!=</span> <span class="dv">1</span> <span class="op">&amp;&amp;</span> d <span class="op">!=</span> <span class="dv">4</span> <span class="op">&amp;&amp;</span> d <span class="op">!=</span> <span class="dv">7</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">4</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">4</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">+</span><span class="dv">4</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb195-31"><a href="#cb195-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">1</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">3</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">4</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb195-32"><a href="#cb195-32" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb195-33"><a href="#cb195-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-34"><a href="#cb195-34" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> draw_plus<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">)</span> <span class="op">{</span></span>
<span id="cb195-35"><a href="#cb195-35" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">1</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">1</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">+</span><span class="dv">1</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span></span>
<span id="cb195-36"><a href="#cb195-36" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb195-37"><a href="#cb195-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-38"><a href="#cb195-38" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> draw_equal<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">)</span> <span class="op">{</span></span>
<span id="cb195-39"><a href="#cb195-39" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">);</span></span>
<span id="cb195-40"><a href="#cb195-40" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span></span>
<span id="cb195-41"><a href="#cb195-41" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb195-42"><a href="#cb195-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-43"><a href="#cb195-43" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> draw_H<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">)</span> <span class="op">{</span></span>
<span id="cb195-44"><a href="#cb195-44" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">1</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">3</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">4</span><span class="op">);</span></span>
<span id="cb195-45"><a href="#cb195-45" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span></span>
<span id="cb195-46"><a href="#cb195-46" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">+</span><span class="dv">1</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">+</span><span class="dv">3</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">+</span><span class="dv">4</span><span class="op">);</span></span>
<span id="cb195-47"><a href="#cb195-47" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb195-48"><a href="#cb195-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-49"><a href="#cb195-49" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> draw_I<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">)</span> <span class="op">{</span></span>
<span id="cb195-50"><a href="#cb195-50" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">);</span></span>
<span id="cb195-51"><a href="#cb195-51" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">1</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">3</span><span class="op">);</span></span>
<span id="cb195-52"><a href="#cb195-52" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">4</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">4</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">+</span><span class="dv">4</span><span class="op">);</span></span>
<span id="cb195-53"><a href="#cb195-53" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb195-54"><a href="#cb195-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-55"><a href="#cb195-55" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> draw_box<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">,</span> <span class="dt">int</span> w<span class="op">,</span> <span class="dt">int</span> h<span class="op">)</span> <span class="op">{</span></span>
<span id="cb195-56"><a href="#cb195-56" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i<span class="op">;</span></span>
<span id="cb195-57"><a href="#cb195-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> w<span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x <span class="op">+</span> i<span class="op">,</span> y<span class="op">);</span> set_pixel<span class="op">(</span>x <span class="op">+</span> i<span class="op">,</span> y <span class="op">+</span> h <span class="op">-</span> <span class="dv">1</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb195-58"><a href="#cb195-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> h<span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> i<span class="op">);</span> set_pixel<span class="op">(</span>x <span class="op">+</span> w <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> y <span class="op">+</span> i<span class="op">);</span> <span class="op">}</span></span>
<span id="cb195-59"><a href="#cb195-59" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb195-60"><a href="#cb195-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-61"><a href="#cb195-61" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> draw_menu<span class="op">()</span> <span class="op">{</span></span>
<span id="cb195-62"><a href="#cb195-62" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Titre: MENU</span></span>
<span id="cb195-63"><a href="#cb195-63" aria-hidden="true" tabindex="-1"></a>    <span class="co">// M</span></span>
<span id="cb195-64"><a href="#cb195-64" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">4</span><span class="op">,</span> <span class="dv">4</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">4</span><span class="op">,</span> <span class="dv">5</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">4</span><span class="op">,</span> <span class="dv">6</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">4</span><span class="op">,</span> <span class="dv">7</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">4</span><span class="op">,</span> <span class="dv">8</span><span class="op">);</span></span>
<span id="cb195-65"><a href="#cb195-65" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">5</span><span class="op">,</span> <span class="dv">5</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">6</span><span class="op">,</span> <span class="dv">6</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">7</span><span class="op">,</span> <span class="dv">5</span><span class="op">);</span></span>
<span id="cb195-66"><a href="#cb195-66" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">8</span><span class="op">,</span> <span class="dv">4</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">8</span><span class="op">,</span> <span class="dv">5</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">8</span><span class="op">,</span> <span class="dv">6</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">8</span><span class="op">,</span> <span class="dv">7</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">8</span><span class="op">,</span> <span class="dv">8</span><span class="op">);</span></span>
<span id="cb195-67"><a href="#cb195-67" aria-hidden="true" tabindex="-1"></a>    <span class="co">// E</span></span>
<span id="cb195-68"><a href="#cb195-68" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">11</span><span class="op">,</span> <span class="dv">4</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">12</span><span class="op">,</span> <span class="dv">4</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">13</span><span class="op">,</span> <span class="dv">4</span><span class="op">);</span></span>
<span id="cb195-69"><a href="#cb195-69" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">11</span><span class="op">,</span> <span class="dv">5</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">11</span><span class="op">,</span> <span class="dv">6</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">12</span><span class="op">,</span> <span class="dv">6</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">11</span><span class="op">,</span> <span class="dv">7</span><span class="op">);</span></span>
<span id="cb195-70"><a href="#cb195-70" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">11</span><span class="op">,</span> <span class="dv">8</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">12</span><span class="op">,</span> <span class="dv">8</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">13</span><span class="op">,</span> <span class="dv">8</span><span class="op">);</span></span>
<span id="cb195-71"><a href="#cb195-71" aria-hidden="true" tabindex="-1"></a>    <span class="co">// N</span></span>
<span id="cb195-72"><a href="#cb195-72" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">16</span><span class="op">,</span> <span class="dv">4</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">16</span><span class="op">,</span> <span class="dv">5</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">16</span><span class="op">,</span> <span class="dv">6</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">16</span><span class="op">,</span> <span class="dv">7</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">16</span><span class="op">,</span> <span class="dv">8</span><span class="op">);</span></span>
<span id="cb195-73"><a href="#cb195-73" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">17</span><span class="op">,</span> <span class="dv">5</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">18</span><span class="op">,</span> <span class="dv">6</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">19</span><span class="op">,</span> <span class="dv">7</span><span class="op">);</span></span>
<span id="cb195-74"><a href="#cb195-74" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">20</span><span class="op">,</span> <span class="dv">4</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">20</span><span class="op">,</span> <span class="dv">5</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">20</span><span class="op">,</span> <span class="dv">6</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">20</span><span class="op">,</span> <span class="dv">7</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">20</span><span class="op">,</span> <span class="dv">8</span><span class="op">);</span></span>
<span id="cb195-75"><a href="#cb195-75" aria-hidden="true" tabindex="-1"></a>    <span class="co">// U</span></span>
<span id="cb195-76"><a href="#cb195-76" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">23</span><span class="op">,</span> <span class="dv">4</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">23</span><span class="op">,</span> <span class="dv">5</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">23</span><span class="op">,</span> <span class="dv">6</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">23</span><span class="op">,</span> <span class="dv">7</span><span class="op">);</span></span>
<span id="cb195-77"><a href="#cb195-77" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">24</span><span class="op">,</span> <span class="dv">8</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">25</span><span class="op">,</span> <span class="dv">8</span><span class="op">);</span></span>
<span id="cb195-78"><a href="#cb195-78" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">26</span><span class="op">,</span> <span class="dv">4</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">26</span><span class="op">,</span> <span class="dv">5</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">26</span><span class="op">,</span> <span class="dv">6</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">26</span><span class="op">,</span> <span class="dv">7</span><span class="op">);</span></span>
<span id="cb195-79"><a href="#cb195-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-80"><a href="#cb195-80" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Option 1: CALC</span></span>
<span id="cb195-81"><a href="#cb195-81" aria-hidden="true" tabindex="-1"></a>    draw_box<span class="op">(</span><span class="dv">4</span><span class="op">,</span> <span class="dv">14</span><span class="op">,</span> <span class="dv">30</span><span class="op">,</span> <span class="dv">12</span><span class="op">);</span></span>
<span id="cb195-82"><a href="#cb195-82" aria-hidden="true" tabindex="-1"></a>    draw_digit<span class="op">(</span><span class="dv">8</span><span class="op">,</span> <span class="dv">17</span><span class="op">,</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb195-83"><a href="#cb195-83" aria-hidden="true" tabindex="-1"></a>    <span class="co">// C</span></span>
<span id="cb195-84"><a href="#cb195-84" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">15</span><span class="op">,</span> <span class="dv">17</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">16</span><span class="op">,</span> <span class="dv">17</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">17</span><span class="op">,</span> <span class="dv">17</span><span class="op">);</span></span>
<span id="cb195-85"><a href="#cb195-85" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">14</span><span class="op">,</span> <span class="dv">18</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">14</span><span class="op">,</span> <span class="dv">19</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">14</span><span class="op">,</span> <span class="dv">20</span><span class="op">);</span></span>
<span id="cb195-86"><a href="#cb195-86" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">15</span><span class="op">,</span> <span class="dv">21</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">16</span><span class="op">,</span> <span class="dv">21</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">17</span><span class="op">,</span> <span class="dv">21</span><span class="op">);</span></span>
<span id="cb195-87"><a href="#cb195-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-88"><a href="#cb195-88" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Option 2: COUNT</span></span>
<span id="cb195-89"><a href="#cb195-89" aria-hidden="true" tabindex="-1"></a>    draw_box<span class="op">(</span><span class="dv">4</span><span class="op">,</span> <span class="dv">28</span><span class="op">,</span> <span class="dv">30</span><span class="op">,</span> <span class="dv">12</span><span class="op">);</span></span>
<span id="cb195-90"><a href="#cb195-90" aria-hidden="true" tabindex="-1"></a>    draw_digit<span class="op">(</span><span class="dv">8</span><span class="op">,</span> <span class="dv">31</span><span class="op">,</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb195-91"><a href="#cb195-91" aria-hidden="true" tabindex="-1"></a>    <span class="co">// #</span></span>
<span id="cb195-92"><a href="#cb195-92" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">15</span><span class="op">,</span> <span class="dv">31</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">17</span><span class="op">,</span> <span class="dv">31</span><span class="op">);</span></span>
<span id="cb195-93"><a href="#cb195-93" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">14</span><span class="op">,</span> <span class="dv">32</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">15</span><span class="op">,</span> <span class="dv">32</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">16</span><span class="op">,</span> <span class="dv">32</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">17</span><span class="op">,</span> <span class="dv">32</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">18</span><span class="op">,</span> <span class="dv">32</span><span class="op">);</span></span>
<span id="cb195-94"><a href="#cb195-94" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">15</span><span class="op">,</span> <span class="dv">33</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">17</span><span class="op">,</span> <span class="dv">33</span><span class="op">);</span></span>
<span id="cb195-95"><a href="#cb195-95" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">14</span><span class="op">,</span> <span class="dv">34</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">15</span><span class="op">,</span> <span class="dv">34</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">16</span><span class="op">,</span> <span class="dv">34</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">17</span><span class="op">,</span> <span class="dv">34</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">18</span><span class="op">,</span> <span class="dv">34</span><span class="op">);</span></span>
<span id="cb195-96"><a href="#cb195-96" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">15</span><span class="op">,</span> <span class="dv">35</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">17</span><span class="op">,</span> <span class="dv">35</span><span class="op">);</span></span>
<span id="cb195-97"><a href="#cb195-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-98"><a href="#cb195-98" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Option 3: MSG</span></span>
<span id="cb195-99"><a href="#cb195-99" aria-hidden="true" tabindex="-1"></a>    draw_box<span class="op">(</span><span class="dv">4</span><span class="op">,</span> <span class="dv">42</span><span class="op">,</span> <span class="dv">30</span><span class="op">,</span> <span class="dv">12</span><span class="op">);</span></span>
<span id="cb195-100"><a href="#cb195-100" aria-hidden="true" tabindex="-1"></a>    draw_digit<span class="op">(</span><span class="dv">8</span><span class="op">,</span> <span class="dv">45</span><span class="op">,</span> <span class="dv">3</span><span class="op">);</span></span>
<span id="cb195-101"><a href="#cb195-101" aria-hidden="true" tabindex="-1"></a>    draw_H<span class="op">(</span><span class="dv">15</span><span class="op">,</span> <span class="dv">45</span><span class="op">);</span></span>
<span id="cb195-102"><a href="#cb195-102" aria-hidden="true" tabindex="-1"></a>    draw_I<span class="op">(</span><span class="dv">20</span><span class="op">,</span> <span class="dv">45</span><span class="op">);</span></span>
<span id="cb195-103"><a href="#cb195-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-104"><a href="#cb195-104" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Option 0: QUIT</span></span>
<span id="cb195-105"><a href="#cb195-105" aria-hidden="true" tabindex="-1"></a>    draw_box<span class="op">(</span><span class="dv">4</span><span class="op">,</span> <span class="dv">56</span><span class="op">,</span> <span class="dv">30</span><span class="op">,</span> <span class="dv">12</span><span class="op">);</span></span>
<span id="cb195-106"><a href="#cb195-106" aria-hidden="true" tabindex="-1"></a>    draw_digit<span class="op">(</span><span class="dv">8</span><span class="op">,</span> <span class="dv">59</span><span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb195-107"><a href="#cb195-107" aria-hidden="true" tabindex="-1"></a>    <span class="co">// X</span></span>
<span id="cb195-108"><a href="#cb195-108" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">15</span><span class="op">,</span> <span class="dv">59</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">19</span><span class="op">,</span> <span class="dv">59</span><span class="op">);</span></span>
<span id="cb195-109"><a href="#cb195-109" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">16</span><span class="op">,</span> <span class="dv">60</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">18</span><span class="op">,</span> <span class="dv">60</span><span class="op">);</span></span>
<span id="cb195-110"><a href="#cb195-110" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">17</span><span class="op">,</span> <span class="dv">61</span><span class="op">);</span></span>
<span id="cb195-111"><a href="#cb195-111" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">16</span><span class="op">,</span> <span class="dv">62</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">18</span><span class="op">,</span> <span class="dv">62</span><span class="op">);</span></span>
<span id="cb195-112"><a href="#cb195-112" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">15</span><span class="op">,</span> <span class="dv">63</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">19</span><span class="op">,</span> <span class="dv">63</span><span class="op">);</span></span>
<span id="cb195-113"><a href="#cb195-113" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb195-114"><a href="#cb195-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-115"><a href="#cb195-115" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> delay<span class="op">()</span> <span class="op">{</span></span>
<span id="cb195-116"><a href="#cb195-116" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i<span class="op">;</span></span>
<span id="cb195-117"><a href="#cb195-117" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">50000</span><span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span> <span class="op">}</span></span>
<span id="cb195-118"><a href="#cb195-118" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb195-119"><a href="#cb195-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-120"><a href="#cb195-120" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> wait_key<span class="op">()</span> <span class="op">{</span></span>
<span id="cb195-121"><a href="#cb195-121" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> k<span class="op">;</span></span>
<span id="cb195-122"><a href="#cb195-122" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span><span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb195-123"><a href="#cb195-123" aria-hidden="true" tabindex="-1"></a>        k <span class="op">=</span> <span class="op">*</span>KEYBOARD<span class="op">;</span></span>
<span id="cb195-124"><a href="#cb195-124" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>k <span class="op">!=</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">return</span><span class="op">;</span></span>
<span id="cb195-125"><a href="#cb195-125" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb195-126"><a href="#cb195-126" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb195-127"><a href="#cb195-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-128"><a href="#cb195-128" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> app_calc<span class="op">()</span> <span class="op">{</span></span>
<span id="cb195-129"><a href="#cb195-129" aria-hidden="true" tabindex="-1"></a>    clear_screen<span class="op">();</span></span>
<span id="cb195-130"><a href="#cb195-130" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Titre</span></span>
<span id="cb195-131"><a href="#cb195-131" aria-hidden="true" tabindex="-1"></a>    <span class="co">// C</span></span>
<span id="cb195-132"><a href="#cb195-132" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">5</span><span class="op">,</span> <span class="dv">4</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">6</span><span class="op">,</span> <span class="dv">4</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">7</span><span class="op">,</span> <span class="dv">4</span><span class="op">);</span></span>
<span id="cb195-133"><a href="#cb195-133" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">4</span><span class="op">,</span> <span class="dv">5</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">4</span><span class="op">,</span> <span class="dv">6</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">4</span><span class="op">,</span> <span class="dv">7</span><span class="op">);</span></span>
<span id="cb195-134"><a href="#cb195-134" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">5</span><span class="op">,</span> <span class="dv">8</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">6</span><span class="op">,</span> <span class="dv">8</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">7</span><span class="op">,</span> <span class="dv">8</span><span class="op">);</span></span>
<span id="cb195-135"><a href="#cb195-135" aria-hidden="true" tabindex="-1"></a>    <span class="co">// A</span></span>
<span id="cb195-136"><a href="#cb195-136" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">11</span><span class="op">,</span> <span class="dv">4</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">10</span><span class="op">,</span> <span class="dv">5</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">12</span><span class="op">,</span> <span class="dv">5</span><span class="op">);</span></span>
<span id="cb195-137"><a href="#cb195-137" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">10</span><span class="op">,</span> <span class="dv">6</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">11</span><span class="op">,</span> <span class="dv">6</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">12</span><span class="op">,</span> <span class="dv">6</span><span class="op">);</span></span>
<span id="cb195-138"><a href="#cb195-138" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">10</span><span class="op">,</span> <span class="dv">7</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">12</span><span class="op">,</span> <span class="dv">7</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">10</span><span class="op">,</span> <span class="dv">8</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">12</span><span class="op">,</span> <span class="dv">8</span><span class="op">);</span></span>
<span id="cb195-139"><a href="#cb195-139" aria-hidden="true" tabindex="-1"></a>    <span class="co">// L</span></span>
<span id="cb195-140"><a href="#cb195-140" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">15</span><span class="op">,</span> <span class="dv">4</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">15</span><span class="op">,</span> <span class="dv">5</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">15</span><span class="op">,</span> <span class="dv">6</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">15</span><span class="op">,</span> <span class="dv">7</span><span class="op">);</span></span>
<span id="cb195-141"><a href="#cb195-141" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">15</span><span class="op">,</span> <span class="dv">8</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">16</span><span class="op">,</span> <span class="dv">8</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">17</span><span class="op">,</span> <span class="dv">8</span><span class="op">);</span></span>
<span id="cb195-142"><a href="#cb195-142" aria-hidden="true" tabindex="-1"></a>    <span class="co">// C</span></span>
<span id="cb195-143"><a href="#cb195-143" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">21</span><span class="op">,</span> <span class="dv">4</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">22</span><span class="op">,</span> <span class="dv">4</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">23</span><span class="op">,</span> <span class="dv">4</span><span class="op">);</span></span>
<span id="cb195-144"><a href="#cb195-144" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">20</span><span class="op">,</span> <span class="dv">5</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">20</span><span class="op">,</span> <span class="dv">6</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">20</span><span class="op">,</span> <span class="dv">7</span><span class="op">);</span></span>
<span id="cb195-145"><a href="#cb195-145" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">21</span><span class="op">,</span> <span class="dv">8</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">22</span><span class="op">,</span> <span class="dv">8</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">23</span><span class="op">,</span> <span class="dv">8</span><span class="op">);</span></span>
<span id="cb195-146"><a href="#cb195-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-147"><a href="#cb195-147" aria-hidden="true" tabindex="-1"></a>    <span class="co">// 3 + 5 = 8</span></span>
<span id="cb195-148"><a href="#cb195-148" aria-hidden="true" tabindex="-1"></a>    draw_digit<span class="op">(</span><span class="dv">10</span><span class="op">,</span> <span class="dv">20</span><span class="op">,</span> <span class="dv">3</span><span class="op">);</span></span>
<span id="cb195-149"><a href="#cb195-149" aria-hidden="true" tabindex="-1"></a>    draw_plus<span class="op">(</span><span class="dv">16</span><span class="op">,</span> <span class="dv">20</span><span class="op">);</span></span>
<span id="cb195-150"><a href="#cb195-150" aria-hidden="true" tabindex="-1"></a>    draw_digit<span class="op">(</span><span class="dv">22</span><span class="op">,</span> <span class="dv">20</span><span class="op">,</span> <span class="dv">5</span><span class="op">);</span></span>
<span id="cb195-151"><a href="#cb195-151" aria-hidden="true" tabindex="-1"></a>    draw_equal<span class="op">(</span><span class="dv">28</span><span class="op">,</span> <span class="dv">20</span><span class="op">);</span></span>
<span id="cb195-152"><a href="#cb195-152" aria-hidden="true" tabindex="-1"></a>    draw_digit<span class="op">(</span><span class="dv">34</span><span class="op">,</span> <span class="dv">20</span><span class="op">,</span> <span class="dv">8</span><span class="op">);</span></span>
<span id="cb195-153"><a href="#cb195-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-154"><a href="#cb195-154" aria-hidden="true" tabindex="-1"></a>    wait_key<span class="op">();</span></span>
<span id="cb195-155"><a href="#cb195-155" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb195-156"><a href="#cb195-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-157"><a href="#cb195-157" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> app_count<span class="op">()</span> <span class="op">{</span></span>
<span id="cb195-158"><a href="#cb195-158" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i<span class="op">;</span></span>
<span id="cb195-159"><a href="#cb195-159" aria-hidden="true" tabindex="-1"></a>    clear_screen<span class="op">();</span></span>
<span id="cb195-160"><a href="#cb195-160" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Titre: COUNT</span></span>
<span id="cb195-161"><a href="#cb195-161" aria-hidden="true" tabindex="-1"></a>    <span class="co">// #</span></span>
<span id="cb195-162"><a href="#cb195-162" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">5</span><span class="op">,</span> <span class="dv">4</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">7</span><span class="op">,</span> <span class="dv">4</span><span class="op">);</span></span>
<span id="cb195-163"><a href="#cb195-163" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">4</span><span class="op">,</span> <span class="dv">5</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">5</span><span class="op">,</span> <span class="dv">5</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">6</span><span class="op">,</span> <span class="dv">5</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">7</span><span class="op">,</span> <span class="dv">5</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">8</span><span class="op">,</span> <span class="dv">5</span><span class="op">);</span></span>
<span id="cb195-164"><a href="#cb195-164" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">5</span><span class="op">,</span> <span class="dv">6</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">7</span><span class="op">,</span> <span class="dv">6</span><span class="op">);</span></span>
<span id="cb195-165"><a href="#cb195-165" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">4</span><span class="op">,</span> <span class="dv">7</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">5</span><span class="op">,</span> <span class="dv">7</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">6</span><span class="op">,</span> <span class="dv">7</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">7</span><span class="op">,</span> <span class="dv">7</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">8</span><span class="op">,</span> <span class="dv">7</span><span class="op">);</span></span>
<span id="cb195-166"><a href="#cb195-166" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">5</span><span class="op">,</span> <span class="dv">8</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">7</span><span class="op">,</span> <span class="dv">8</span><span class="op">);</span></span>
<span id="cb195-167"><a href="#cb195-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-168"><a href="#cb195-168" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">6</span><span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb195-169"><a href="#cb195-169" aria-hidden="true" tabindex="-1"></a>        draw_digit<span class="op">(</span><span class="dv">10</span> <span class="op">+</span> i <span class="op">*</span> <span class="dv">6</span><span class="op">,</span> <span class="dv">20</span><span class="op">,</span> i<span class="op">);</span></span>
<span id="cb195-170"><a href="#cb195-170" aria-hidden="true" tabindex="-1"></a>        delay<span class="op">();</span></span>
<span id="cb195-171"><a href="#cb195-171" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb195-172"><a href="#cb195-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-173"><a href="#cb195-173" aria-hidden="true" tabindex="-1"></a>    wait_key<span class="op">();</span></span>
<span id="cb195-174"><a href="#cb195-174" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb195-175"><a href="#cb195-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-176"><a href="#cb195-176" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> app_msg<span class="op">()</span> <span class="op">{</span></span>
<span id="cb195-177"><a href="#cb195-177" aria-hidden="true" tabindex="-1"></a>    clear_screen<span class="op">();</span></span>
<span id="cb195-178"><a href="#cb195-178" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Titre: MSG</span></span>
<span id="cb195-179"><a href="#cb195-179" aria-hidden="true" tabindex="-1"></a>    <span class="co">// M</span></span>
<span id="cb195-180"><a href="#cb195-180" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">4</span><span class="op">,</span> <span class="dv">4</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">4</span><span class="op">,</span> <span class="dv">5</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">4</span><span class="op">,</span> <span class="dv">6</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">4</span><span class="op">,</span> <span class="dv">7</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">4</span><span class="op">,</span> <span class="dv">8</span><span class="op">);</span></span>
<span id="cb195-181"><a href="#cb195-181" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">5</span><span class="op">,</span> <span class="dv">5</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">6</span><span class="op">,</span> <span class="dv">6</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">7</span><span class="op">,</span> <span class="dv">5</span><span class="op">);</span></span>
<span id="cb195-182"><a href="#cb195-182" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">8</span><span class="op">,</span> <span class="dv">4</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">8</span><span class="op">,</span> <span class="dv">5</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">8</span><span class="op">,</span> <span class="dv">6</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">8</span><span class="op">,</span> <span class="dv">7</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">8</span><span class="op">,</span> <span class="dv">8</span><span class="op">);</span></span>
<span id="cb195-183"><a href="#cb195-183" aria-hidden="true" tabindex="-1"></a>    <span class="co">// S</span></span>
<span id="cb195-184"><a href="#cb195-184" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">12</span><span class="op">,</span> <span class="dv">4</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">13</span><span class="op">,</span> <span class="dv">4</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">11</span><span class="op">,</span> <span class="dv">5</span><span class="op">);</span></span>
<span id="cb195-185"><a href="#cb195-185" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">12</span><span class="op">,</span> <span class="dv">6</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">13</span><span class="op">,</span> <span class="dv">7</span><span class="op">);</span></span>
<span id="cb195-186"><a href="#cb195-186" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">11</span><span class="op">,</span> <span class="dv">8</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">12</span><span class="op">,</span> <span class="dv">8</span><span class="op">);</span></span>
<span id="cb195-187"><a href="#cb195-187" aria-hidden="true" tabindex="-1"></a>    <span class="co">// G</span></span>
<span id="cb195-188"><a href="#cb195-188" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">17</span><span class="op">,</span> <span class="dv">4</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">18</span><span class="op">,</span> <span class="dv">4</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">19</span><span class="op">,</span> <span class="dv">4</span><span class="op">);</span></span>
<span id="cb195-189"><a href="#cb195-189" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">16</span><span class="op">,</span> <span class="dv">5</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">16</span><span class="op">,</span> <span class="dv">6</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">18</span><span class="op">,</span> <span class="dv">6</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">19</span><span class="op">,</span> <span class="dv">6</span><span class="op">);</span></span>
<span id="cb195-190"><a href="#cb195-190" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">16</span><span class="op">,</span> <span class="dv">7</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">19</span><span class="op">,</span> <span class="dv">7</span><span class="op">);</span></span>
<span id="cb195-191"><a href="#cb195-191" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">17</span><span class="op">,</span> <span class="dv">8</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">18</span><span class="op">,</span> <span class="dv">8</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">19</span><span class="op">,</span> <span class="dv">8</span><span class="op">);</span></span>
<span id="cb195-192"><a href="#cb195-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-193"><a href="#cb195-193" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Grand HI</span></span>
<span id="cb195-194"><a href="#cb195-194" aria-hidden="true" tabindex="-1"></a>    <span class="co">// H</span></span>
<span id="cb195-195"><a href="#cb195-195" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">10</span><span class="op">,</span> <span class="dv">18</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">10</span><span class="op">,</span> <span class="dv">19</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">10</span><span class="op">,</span> <span class="dv">20</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">10</span><span class="op">,</span> <span class="dv">21</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">10</span><span class="op">,</span> <span class="dv">22</span><span class="op">);</span></span>
<span id="cb195-196"><a href="#cb195-196" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">10</span><span class="op">,</span> <span class="dv">23</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">10</span><span class="op">,</span> <span class="dv">24</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">10</span><span class="op">,</span> <span class="dv">25</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">10</span><span class="op">,</span> <span class="dv">26</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">10</span><span class="op">,</span> <span class="dv">27</span><span class="op">);</span></span>
<span id="cb195-197"><a href="#cb195-197" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">11</span><span class="op">,</span> <span class="dv">22</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">12</span><span class="op">,</span> <span class="dv">22</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">13</span><span class="op">,</span> <span class="dv">22</span><span class="op">);</span></span>
<span id="cb195-198"><a href="#cb195-198" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">14</span><span class="op">,</span> <span class="dv">18</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">14</span><span class="op">,</span> <span class="dv">19</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">14</span><span class="op">,</span> <span class="dv">20</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">14</span><span class="op">,</span> <span class="dv">21</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">14</span><span class="op">,</span> <span class="dv">22</span><span class="op">);</span></span>
<span id="cb195-199"><a href="#cb195-199" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">14</span><span class="op">,</span> <span class="dv">23</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">14</span><span class="op">,</span> <span class="dv">24</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">14</span><span class="op">,</span> <span class="dv">25</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">14</span><span class="op">,</span> <span class="dv">26</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">14</span><span class="op">,</span> <span class="dv">27</span><span class="op">);</span></span>
<span id="cb195-200"><a href="#cb195-200" aria-hidden="true" tabindex="-1"></a>    <span class="co">// I</span></span>
<span id="cb195-201"><a href="#cb195-201" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">18</span><span class="op">,</span> <span class="dv">18</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">19</span><span class="op">,</span> <span class="dv">18</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">20</span><span class="op">,</span> <span class="dv">18</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">21</span><span class="op">,</span> <span class="dv">18</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">22</span><span class="op">,</span> <span class="dv">18</span><span class="op">);</span></span>
<span id="cb195-202"><a href="#cb195-202" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">20</span><span class="op">,</span> <span class="dv">19</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">20</span><span class="op">,</span> <span class="dv">20</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">20</span><span class="op">,</span> <span class="dv">21</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">20</span><span class="op">,</span> <span class="dv">22</span><span class="op">);</span></span>
<span id="cb195-203"><a href="#cb195-203" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">20</span><span class="op">,</span> <span class="dv">23</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">20</span><span class="op">,</span> <span class="dv">24</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">20</span><span class="op">,</span> <span class="dv">25</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">20</span><span class="op">,</span> <span class="dv">26</span><span class="op">);</span></span>
<span id="cb195-204"><a href="#cb195-204" aria-hidden="true" tabindex="-1"></a>    set_pixel<span class="op">(</span><span class="dv">18</span><span class="op">,</span> <span class="dv">27</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">19</span><span class="op">,</span> <span class="dv">27</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">20</span><span class="op">,</span> <span class="dv">27</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">21</span><span class="op">,</span> <span class="dv">27</span><span class="op">);</span> set_pixel<span class="op">(</span><span class="dv">22</span><span class="op">,</span> <span class="dv">27</span><span class="op">);</span></span>
<span id="cb195-205"><a href="#cb195-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-206"><a href="#cb195-206" aria-hidden="true" tabindex="-1"></a>    wait_key<span class="op">();</span></span>
<span id="cb195-207"><a href="#cb195-207" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb195-208"><a href="#cb195-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-209"><a href="#cb195-209" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb195-210"><a href="#cb195-210" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> key<span class="op">;</span> <span class="dt">int</span> lk<span class="op">;</span> <span class="dt">int</span> running<span class="op">;</span></span>
<span id="cb195-211"><a href="#cb195-211" aria-hidden="true" tabindex="-1"></a>    running <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb195-212"><a href="#cb195-212" aria-hidden="true" tabindex="-1"></a>    lk <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb195-213"><a href="#cb195-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-214"><a href="#cb195-214" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>running<span class="op">)</span> <span class="op">{</span></span>
<span id="cb195-215"><a href="#cb195-215" aria-hidden="true" tabindex="-1"></a>        clear_screen<span class="op">();</span></span>
<span id="cb195-216"><a href="#cb195-216" aria-hidden="true" tabindex="-1"></a>        draw_menu<span class="op">();</span></span>
<span id="cb195-217"><a href="#cb195-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-218"><a href="#cb195-218" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="op">(</span><span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb195-219"><a href="#cb195-219" aria-hidden="true" tabindex="-1"></a>            key <span class="op">=</span> <span class="op">*</span>KEYBOARD<span class="op">;</span></span>
<span id="cb195-220"><a href="#cb195-220" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>key <span class="op">!=</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> key <span class="op">!=</span> lk<span class="op">)</span> <span class="op">{</span></span>
<span id="cb195-221"><a href="#cb195-221" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="op">(</span>key <span class="op">==</span> <span class="dv">49</span><span class="op">)</span> <span class="op">{</span> app_calc<span class="op">();</span> <span class="cf">break</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb195-222"><a href="#cb195-222" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="op">(</span>key <span class="op">==</span> <span class="dv">50</span><span class="op">)</span> <span class="op">{</span> app_count<span class="op">();</span> <span class="cf">break</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb195-223"><a href="#cb195-223" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="op">(</span>key <span class="op">==</span> <span class="dv">51</span><span class="op">)</span> <span class="op">{</span> app_msg<span class="op">();</span> <span class="cf">break</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb195-224"><a href="#cb195-224" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="op">(</span>key <span class="op">==</span> <span class="dv">48</span><span class="op">)</span> <span class="op">{</span> running <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> <span class="cf">break</span><span class="op">;</span> <span class="op">}</span></span>
<span id="cb195-225"><a href="#cb195-225" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb195-226"><a href="#cb195-226" aria-hidden="true" tabindex="-1"></a>            lk <span class="op">=</span> key<span class="op">;</span></span>
<span id="cb195-227"><a href="#cb195-227" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb195-228"><a href="#cb195-228" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb195-229"><a href="#cb195-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-230"><a href="#cb195-230" aria-hidden="true" tabindex="-1"></a>    clear_screen<span class="op">();</span></span>
<span id="cb195-231"><a href="#cb195-231" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb195-232"><a href="#cb195-232" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h3 data-number="2.5.16" id="projet-2-task-manager"><span class="header-section-number">2.5.16</span> Projet 2: Task Manager</h3>
<div class="sourceCode" id="cb196"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Gestionnaire de Tâches - Solution</span></span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a><span class="co">// Cochez &quot;Capturer clavier&quot;</span></span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> <span class="op">*</span>SCREEN <span class="op">=</span> <span class="op">(</span><span class="dt">int</span><span class="op">*)</span><span class="bn">0x00400000</span><span class="op">;</span></span>
<span id="cb196-5"><a href="#cb196-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> <span class="op">*</span>KEYBOARD <span class="op">=</span> <span class="op">(</span><span class="dt">int</span><span class="op">*)</span><span class="bn">0x00402600</span><span class="op">;</span></span>
<span id="cb196-6"><a href="#cb196-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-7"><a href="#cb196-7" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> proc_work<span class="op">[</span><span class="dv">4</span><span class="op">];</span></span>
<span id="cb196-8"><a href="#cb196-8" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> proc_state<span class="op">[</span><span class="dv">4</span><span class="op">];</span></span>
<span id="cb196-9"><a href="#cb196-9" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> proc_done<span class="op">[</span><span class="dv">4</span><span class="op">];</span></span>
<span id="cb196-10"><a href="#cb196-10" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> current <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb196-11"><a href="#cb196-11" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> quantum_left <span class="op">=</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb196-12"><a href="#cb196-12" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> switches <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb196-13"><a href="#cb196-13" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> ticks <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb196-14"><a href="#cb196-14" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> auto_run <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb196-15"><a href="#cb196-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-16"><a href="#cb196-16" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> set_pixel<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">)</span> <span class="op">{</span></span>
<span id="cb196-17"><a href="#cb196-17" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> <span class="op">*</span>ptr<span class="op">;</span> <span class="dt">int</span> bit_pos<span class="op">;</span></span>
<span id="cb196-18"><a href="#cb196-18" aria-hidden="true" tabindex="-1"></a>    ptr <span class="op">=</span> SCREEN <span class="op">+</span> <span class="op">(</span>y <span class="op">&lt;&lt;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span>y <span class="op">&lt;&lt;</span> <span class="dv">1</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span>x <span class="op">&gt;&gt;</span> <span class="dv">5</span><span class="op">);</span></span>
<span id="cb196-19"><a href="#cb196-19" aria-hidden="true" tabindex="-1"></a>    bit_pos <span class="op">=</span> <span class="op">((</span>x <span class="op">&gt;&gt;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">&amp;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">*</span> <span class="dv">8</span> <span class="op">+</span> <span class="dv">7</span> <span class="op">-</span> <span class="op">(</span>x <span class="op">&amp;</span> <span class="dv">7</span><span class="op">);</span></span>
<span id="cb196-20"><a href="#cb196-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span>ptr <span class="op">=</span> <span class="op">*</span>ptr <span class="op">|</span> <span class="op">(</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> bit_pos<span class="op">);</span></span>
<span id="cb196-21"><a href="#cb196-21" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb196-22"><a href="#cb196-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-23"><a href="#cb196-23" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> clear_rect<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">,</span> <span class="dt">int</span> w<span class="op">,</span> <span class="dt">int</span> h<span class="op">)</span> <span class="op">{</span></span>
<span id="cb196-24"><a href="#cb196-24" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i<span class="op">;</span> <span class="dt">int</span> j<span class="op">;</span> <span class="dt">int</span> px<span class="op">;</span> <span class="dt">int</span> py<span class="op">;</span> <span class="dt">int</span> <span class="op">*</span>ptr<span class="op">;</span> <span class="dt">int</span> bit_pos<span class="op">;</span></span>
<span id="cb196-25"><a href="#cb196-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> w<span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb196-26"><a href="#cb196-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span>j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> h<span class="op">;</span> j <span class="op">=</span> j <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb196-27"><a href="#cb196-27" aria-hidden="true" tabindex="-1"></a>            px <span class="op">=</span> x <span class="op">+</span> i<span class="op">;</span> py <span class="op">=</span> y <span class="op">+</span> j<span class="op">;</span></span>
<span id="cb196-28"><a href="#cb196-28" aria-hidden="true" tabindex="-1"></a>            ptr <span class="op">=</span> SCREEN <span class="op">+</span> <span class="op">(</span>py <span class="op">&lt;&lt;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span>py <span class="op">&lt;&lt;</span> <span class="dv">1</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span>px <span class="op">&gt;&gt;</span> <span class="dv">5</span><span class="op">);</span></span>
<span id="cb196-29"><a href="#cb196-29" aria-hidden="true" tabindex="-1"></a>            bit_pos <span class="op">=</span> <span class="op">((</span>px <span class="op">&gt;&gt;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">&amp;</span> <span class="dv">3</span><span class="op">)</span> <span class="op">*</span> <span class="dv">8</span> <span class="op">+</span> <span class="dv">7</span> <span class="op">-</span> <span class="op">(</span>px <span class="op">&amp;</span> <span class="dv">7</span><span class="op">);</span></span>
<span id="cb196-30"><a href="#cb196-30" aria-hidden="true" tabindex="-1"></a>            <span class="op">*</span>ptr <span class="op">=</span> <span class="op">*</span>ptr <span class="op">&amp;</span> <span class="op">(</span><span class="bn">0xFFFFFFFF</span> <span class="op">^</span> <span class="op">(</span><span class="dv">1</span> <span class="op">&lt;&lt;</span> bit_pos<span class="op">));</span></span>
<span id="cb196-31"><a href="#cb196-31" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb196-32"><a href="#cb196-32" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb196-33"><a href="#cb196-33" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb196-34"><a href="#cb196-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-35"><a href="#cb196-35" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> fill_rect<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">,</span> <span class="dt">int</span> w<span class="op">,</span> <span class="dt">int</span> h<span class="op">)</span> <span class="op">{</span></span>
<span id="cb196-36"><a href="#cb196-36" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i<span class="op">;</span> <span class="dt">int</span> j<span class="op">;</span></span>
<span id="cb196-37"><a href="#cb196-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> w<span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb196-38"><a href="#cb196-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span>j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> h<span class="op">;</span> j <span class="op">=</span> j <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb196-39"><a href="#cb196-39" aria-hidden="true" tabindex="-1"></a>            set_pixel<span class="op">(</span>x <span class="op">+</span> i<span class="op">,</span> y <span class="op">+</span> j<span class="op">);</span></span>
<span id="cb196-40"><a href="#cb196-40" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb196-41"><a href="#cb196-41" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb196-42"><a href="#cb196-42" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb196-43"><a href="#cb196-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-44"><a href="#cb196-44" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> draw_box<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">,</span> <span class="dt">int</span> w<span class="op">,</span> <span class="dt">int</span> h<span class="op">)</span> <span class="op">{</span></span>
<span id="cb196-45"><a href="#cb196-45" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i<span class="op">;</span></span>
<span id="cb196-46"><a href="#cb196-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> w<span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x <span class="op">+</span> i<span class="op">,</span> y<span class="op">);</span> set_pixel<span class="op">(</span>x <span class="op">+</span> i<span class="op">,</span> y <span class="op">+</span> h <span class="op">-</span> <span class="dv">1</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb196-47"><a href="#cb196-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> h<span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y <span class="op">+</span> i<span class="op">);</span> set_pixel<span class="op">(</span>x <span class="op">+</span> w <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> y <span class="op">+</span> i<span class="op">);</span> <span class="op">}</span></span>
<span id="cb196-48"><a href="#cb196-48" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb196-49"><a href="#cb196-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-50"><a href="#cb196-50" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> draw_digit<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">,</span> <span class="dt">int</span> d<span class="op">)</span> <span class="op">{</span></span>
<span id="cb196-51"><a href="#cb196-51" aria-hidden="true" tabindex="-1"></a>    clear_rect<span class="op">(</span>x<span class="op">,</span> y<span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">6</span><span class="op">);</span></span>
<span id="cb196-52"><a href="#cb196-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">!=</span> <span class="dv">1</span> <span class="op">&amp;&amp;</span> d <span class="op">!=</span> <span class="dv">4</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">);</span> <span class="op">}</span></span>
<span id="cb196-53"><a href="#cb196-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">==</span> <span class="dv">0</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">4</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">5</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">6</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">8</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">9</span><span class="op">)</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb196-54"><a href="#cb196-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">!=</span> <span class="dv">5</span> <span class="op">&amp;&amp;</span> d <span class="op">!=</span> <span class="dv">6</span><span class="op">)</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">+</span><span class="dv">1</span><span class="op">);</span></span>
<span id="cb196-55"><a href="#cb196-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">!=</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> d <span class="op">!=</span> <span class="dv">1</span> <span class="op">&amp;&amp;</span> d <span class="op">!=</span> <span class="dv">7</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb196-56"><a href="#cb196-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">==</span> <span class="dv">0</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">2</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">6</span> <span class="op">||</span> d <span class="op">==</span> <span class="dv">8</span><span class="op">)</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">3</span><span class="op">);</span></span>
<span id="cb196-57"><a href="#cb196-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">!=</span> <span class="dv">2</span><span class="op">)</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">+</span><span class="dv">3</span><span class="op">);</span></span>
<span id="cb196-58"><a href="#cb196-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">!=</span> <span class="dv">1</span> <span class="op">&amp;&amp;</span> d <span class="op">!=</span> <span class="dv">4</span> <span class="op">&amp;&amp;</span> d <span class="op">!=</span> <span class="dv">7</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">,</span> y<span class="op">+</span><span class="dv">4</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">4</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">2</span><span class="op">,</span> y<span class="op">+</span><span class="dv">4</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb196-59"><a href="#cb196-59" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>d <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">1</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">2</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">3</span><span class="op">);</span> set_pixel<span class="op">(</span>x<span class="op">+</span><span class="dv">1</span><span class="op">,</span> y<span class="op">+</span><span class="dv">4</span><span class="op">);</span> <span class="op">}</span></span>
<span id="cb196-60"><a href="#cb196-60" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb196-61"><a href="#cb196-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-62"><a href="#cb196-62" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> draw_proc<span class="op">(</span><span class="dt">int</span> idx<span class="op">)</span> <span class="op">{</span></span>
<span id="cb196-63"><a href="#cb196-63" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> x<span class="op">;</span> <span class="dt">int</span> w<span class="op">;</span> <span class="dt">int</span> i<span class="op">;</span> <span class="dt">int</span> active<span class="op">;</span></span>
<span id="cb196-64"><a href="#cb196-64" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> idx <span class="op">*</span> <span class="dv">40</span> <span class="op">+</span> <span class="dv">4</span><span class="op">;</span></span>
<span id="cb196-65"><a href="#cb196-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-66"><a href="#cb196-66" aria-hidden="true" tabindex="-1"></a>    clear_rect<span class="op">(</span>x<span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">36</span><span class="op">,</span> <span class="dv">55</span><span class="op">);</span></span>
<span id="cb196-67"><a href="#cb196-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-68"><a href="#cb196-68" aria-hidden="true" tabindex="-1"></a>    active <span class="op">=</span> <span class="op">(</span>idx <span class="op">==</span> current <span class="op">&amp;&amp;</span> proc_state<span class="op">[</span>idx<span class="op">]</span> <span class="op">==</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb196-69"><a href="#cb196-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-70"><a href="#cb196-70" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Cadre - double si running</span></span>
<span id="cb196-71"><a href="#cb196-71" aria-hidden="true" tabindex="-1"></a>    draw_box<span class="op">(</span>x<span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">36</span><span class="op">,</span> <span class="dv">55</span><span class="op">);</span></span>
<span id="cb196-72"><a href="#cb196-72" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>active<span class="op">)</span> <span class="op">{</span></span>
<span id="cb196-73"><a href="#cb196-73" aria-hidden="true" tabindex="-1"></a>        draw_box<span class="op">(</span>x <span class="op">+</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">6</span><span class="op">,</span> <span class="dv">32</span><span class="op">,</span> <span class="dv">51</span><span class="op">);</span></span>
<span id="cb196-74"><a href="#cb196-74" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb196-75"><a href="#cb196-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-76"><a href="#cb196-76" aria-hidden="true" tabindex="-1"></a>    <span class="co">// P et numero (grand)</span></span>
<span id="cb196-77"><a href="#cb196-77" aria-hidden="true" tabindex="-1"></a>    fill_rect<span class="op">(</span>x <span class="op">+</span> <span class="dv">8</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">9</span><span class="op">);</span></span>
<span id="cb196-78"><a href="#cb196-78" aria-hidden="true" tabindex="-1"></a>    fill_rect<span class="op">(</span>x <span class="op">+</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb196-79"><a href="#cb196-79" aria-hidden="true" tabindex="-1"></a>    fill_rect<span class="op">(</span>x <span class="op">+</span> <span class="dv">14</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">5</span><span class="op">);</span></span>
<span id="cb196-80"><a href="#cb196-80" aria-hidden="true" tabindex="-1"></a>    fill_rect<span class="op">(</span>x <span class="op">+</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">14</span><span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb196-81"><a href="#cb196-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-82"><a href="#cb196-82" aria-hidden="true" tabindex="-1"></a>    draw_digit<span class="op">(</span>x <span class="op">+</span> <span class="dv">20</span><span class="op">,</span> <span class="dv">12</span><span class="op">,</span> idx<span class="op">);</span></span>
<span id="cb196-83"><a href="#cb196-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-84"><a href="#cb196-84" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Etat: R=Ready *=Run B=Block X=Done</span></span>
<span id="cb196-85"><a href="#cb196-85" aria-hidden="true" tabindex="-1"></a>    clear_rect<span class="op">(</span>x <span class="op">+</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">24</span><span class="op">,</span> <span class="dv">16</span><span class="op">,</span> <span class="dv">10</span><span class="op">);</span></span>
<span id="cb196-86"><a href="#cb196-86" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>proc_state<span class="op">[</span>idx<span class="op">]</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb196-87"><a href="#cb196-87" aria-hidden="true" tabindex="-1"></a>        <span class="co">// R</span></span>
<span id="cb196-88"><a href="#cb196-88" aria-hidden="true" tabindex="-1"></a>        fill_rect<span class="op">(</span>x <span class="op">+</span> <span class="dv">12</span><span class="op">,</span> <span class="dv">25</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">8</span><span class="op">);</span></span>
<span id="cb196-89"><a href="#cb196-89" aria-hidden="true" tabindex="-1"></a>        fill_rect<span class="op">(</span>x <span class="op">+</span> <span class="dv">14</span><span class="op">,</span> <span class="dv">25</span><span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb196-90"><a href="#cb196-90" aria-hidden="true" tabindex="-1"></a>        fill_rect<span class="op">(</span>x <span class="op">+</span> <span class="dv">18</span><span class="op">,</span> <span class="dv">25</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">4</span><span class="op">);</span></span>
<span id="cb196-91"><a href="#cb196-91" aria-hidden="true" tabindex="-1"></a>        fill_rect<span class="op">(</span>x <span class="op">+</span> <span class="dv">14</span><span class="op">,</span> <span class="dv">28</span><span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb196-92"><a href="#cb196-92" aria-hidden="true" tabindex="-1"></a>        fill_rect<span class="op">(</span>x <span class="op">+</span> <span class="dv">16</span><span class="op">,</span> <span class="dv">30</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">3</span><span class="op">);</span></span>
<span id="cb196-93"><a href="#cb196-93" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb196-94"><a href="#cb196-94" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>proc_state<span class="op">[</span>idx<span class="op">]</span> <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb196-95"><a href="#cb196-95" aria-hidden="true" tabindex="-1"></a>        <span class="co">// * etoile</span></span>
<span id="cb196-96"><a href="#cb196-96" aria-hidden="true" tabindex="-1"></a>        fill_rect<span class="op">(</span>x <span class="op">+</span> <span class="dv">14</span><span class="op">,</span> <span class="dv">26</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">6</span><span class="op">);</span></span>
<span id="cb196-97"><a href="#cb196-97" aria-hidden="true" tabindex="-1"></a>        fill_rect<span class="op">(</span>x <span class="op">+</span> <span class="dv">12</span><span class="op">,</span> <span class="dv">28</span><span class="op">,</span> <span class="dv">6</span><span class="op">,</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb196-98"><a href="#cb196-98" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb196-99"><a href="#cb196-99" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>proc_state<span class="op">[</span>idx<span class="op">]</span> <span class="op">==</span> <span class="dv">2</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb196-100"><a href="#cb196-100" aria-hidden="true" tabindex="-1"></a>        <span class="co">// B</span></span>
<span id="cb196-101"><a href="#cb196-101" aria-hidden="true" tabindex="-1"></a>        fill_rect<span class="op">(</span>x <span class="op">+</span> <span class="dv">12</span><span class="op">,</span> <span class="dv">25</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">8</span><span class="op">);</span></span>
<span id="cb196-102"><a href="#cb196-102" aria-hidden="true" tabindex="-1"></a>        fill_rect<span class="op">(</span>x <span class="op">+</span> <span class="dv">14</span><span class="op">,</span> <span class="dv">25</span><span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb196-103"><a href="#cb196-103" aria-hidden="true" tabindex="-1"></a>        fill_rect<span class="op">(</span>x <span class="op">+</span> <span class="dv">14</span><span class="op">,</span> <span class="dv">28</span><span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb196-104"><a href="#cb196-104" aria-hidden="true" tabindex="-1"></a>        fill_rect<span class="op">(</span>x <span class="op">+</span> <span class="dv">14</span><span class="op">,</span> <span class="dv">31</span><span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb196-105"><a href="#cb196-105" aria-hidden="true" tabindex="-1"></a>        fill_rect<span class="op">(</span>x <span class="op">+</span> <span class="dv">18</span><span class="op">,</span> <span class="dv">26</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb196-106"><a href="#cb196-106" aria-hidden="true" tabindex="-1"></a>        fill_rect<span class="op">(</span>x <span class="op">+</span> <span class="dv">18</span><span class="op">,</span> <span class="dv">29</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb196-107"><a href="#cb196-107" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb196-108"><a href="#cb196-108" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>proc_state<span class="op">[</span>idx<span class="op">]</span> <span class="op">==</span> <span class="dv">3</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb196-109"><a href="#cb196-109" aria-hidden="true" tabindex="-1"></a>        <span class="co">// X</span></span>
<span id="cb196-110"><a href="#cb196-110" aria-hidden="true" tabindex="-1"></a>        fill_rect<span class="op">(</span>x <span class="op">+</span> <span class="dv">12</span><span class="op">,</span> <span class="dv">25</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">2</span><span class="op">);</span> fill_rect<span class="op">(</span>x <span class="op">+</span> <span class="dv">18</span><span class="op">,</span> <span class="dv">25</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb196-111"><a href="#cb196-111" aria-hidden="true" tabindex="-1"></a>        fill_rect<span class="op">(</span>x <span class="op">+</span> <span class="dv">14</span><span class="op">,</span> <span class="dv">27</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">2</span><span class="op">);</span> fill_rect<span class="op">(</span>x <span class="op">+</span> <span class="dv">16</span><span class="op">,</span> <span class="dv">27</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb196-112"><a href="#cb196-112" aria-hidden="true" tabindex="-1"></a>        fill_rect<span class="op">(</span>x <span class="op">+</span> <span class="dv">14</span><span class="op">,</span> <span class="dv">29</span><span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb196-113"><a href="#cb196-113" aria-hidden="true" tabindex="-1"></a>        fill_rect<span class="op">(</span>x <span class="op">+</span> <span class="dv">12</span><span class="op">,</span> <span class="dv">31</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">2</span><span class="op">);</span> fill_rect<span class="op">(</span>x <span class="op">+</span> <span class="dv">18</span><span class="op">,</span> <span class="dv">31</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb196-114"><a href="#cb196-114" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb196-115"><a href="#cb196-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-116"><a href="#cb196-116" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Barre travail restant</span></span>
<span id="cb196-117"><a href="#cb196-117" aria-hidden="true" tabindex="-1"></a>    w <span class="op">=</span> proc_work<span class="op">[</span>idx<span class="op">];</span></span>
<span id="cb196-118"><a href="#cb196-118" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">4</span><span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb196-119"><a href="#cb196-119" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>i <span class="op">&lt;</span> w<span class="op">)</span> <span class="op">{</span></span>
<span id="cb196-120"><a href="#cb196-120" aria-hidden="true" tabindex="-1"></a>            fill_rect<span class="op">(</span>x <span class="op">+</span> <span class="dv">6</span> <span class="op">+</span> i <span class="op">*</span> <span class="dv">7</span><span class="op">,</span> <span class="dv">38</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">6</span><span class="op">);</span></span>
<span id="cb196-121"><a href="#cb196-121" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb196-122"><a href="#cb196-122" aria-hidden="true" tabindex="-1"></a>            draw_box<span class="op">(</span>x <span class="op">+</span> <span class="dv">6</span> <span class="op">+</span> i <span class="op">*</span> <span class="dv">7</span><span class="op">,</span> <span class="dv">38</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">6</span><span class="op">);</span></span>
<span id="cb196-123"><a href="#cb196-123" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb196-124"><a href="#cb196-124" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb196-125"><a href="#cb196-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-126"><a href="#cb196-126" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Compteur</span></span>
<span id="cb196-127"><a href="#cb196-127" aria-hidden="true" tabindex="-1"></a>    draw_digit<span class="op">(</span>x <span class="op">+</span> <span class="dv">15</span><span class="op">,</span> <span class="dv">50</span><span class="op">,</span> proc_done<span class="op">[</span>idx<span class="op">]</span> <span class="op">%</span> <span class="dv">10</span><span class="op">);</span></span>
<span id="cb196-128"><a href="#cb196-128" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb196-129"><a href="#cb196-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-130"><a href="#cb196-130" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> draw_info<span class="op">()</span> <span class="op">{</span></span>
<span id="cb196-131"><a href="#cb196-131" aria-hidden="true" tabindex="-1"></a>    clear_rect<span class="op">(</span><span class="dv">4</span><span class="op">,</span> <span class="dv">62</span><span class="op">,</span> <span class="dv">156</span><span class="op">,</span> <span class="dv">8</span><span class="op">);</span></span>
<span id="cb196-132"><a href="#cb196-132" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Q:</span></span>
<span id="cb196-133"><a href="#cb196-133" aria-hidden="true" tabindex="-1"></a>    fill_rect<span class="op">(</span><span class="dv">6</span><span class="op">,</span> <span class="dv">63</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">5</span><span class="op">);</span> fill_rect<span class="op">(</span><span class="dv">8</span><span class="op">,</span> <span class="dv">63</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">2</span><span class="op">);</span> fill_rect<span class="op">(</span><span class="dv">11</span><span class="op">,</span> <span class="dv">63</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">5</span><span class="op">);</span></span>
<span id="cb196-134"><a href="#cb196-134" aria-hidden="true" tabindex="-1"></a>    fill_rect<span class="op">(</span><span class="dv">8</span><span class="op">,</span> <span class="dv">66</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">2</span><span class="op">);</span> fill_rect<span class="op">(</span><span class="dv">10</span><span class="op">,</span> <span class="dv">67</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb196-135"><a href="#cb196-135" aria-hidden="true" tabindex="-1"></a>    draw_digit<span class="op">(</span><span class="dv">16</span><span class="op">,</span> <span class="dv">63</span><span class="op">,</span> quantum_left<span class="op">);</span></span>
<span id="cb196-136"><a href="#cb196-136" aria-hidden="true" tabindex="-1"></a>    <span class="co">// S:</span></span>
<span id="cb196-137"><a href="#cb196-137" aria-hidden="true" tabindex="-1"></a>    fill_rect<span class="op">(</span><span class="dv">30</span><span class="op">,</span> <span class="dv">63</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">2</span><span class="op">);</span> fill_rect<span class="op">(</span><span class="dv">28</span><span class="op">,</span> <span class="dv">65</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb196-138"><a href="#cb196-138" aria-hidden="true" tabindex="-1"></a>    fill_rect<span class="op">(</span><span class="dv">30</span><span class="op">,</span> <span class="dv">66</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">2</span><span class="op">);</span> fill_rect<span class="op">(</span><span class="dv">33</span><span class="op">,</span> <span class="dv">67</span><span class="op">,</span> <span class="dv">2</span><span class="op">,</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb196-139"><a href="#cb196-139" aria-hidden="true" tabindex="-1"></a>    fill_rect<span class="op">(</span><span class="dv">28</span><span class="op">,</span> <span class="dv">68</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb196-140"><a href="#cb196-140" aria-hidden="true" tabindex="-1"></a>    draw_digit<span class="op">(</span><span class="dv">38</span><span class="op">,</span> <span class="dv">63</span><span class="op">,</span> switches <span class="op">%</span> <span class="dv">10</span><span class="op">);</span></span>
<span id="cb196-141"><a href="#cb196-141" aria-hidden="true" tabindex="-1"></a>    <span class="co">// T:</span></span>
<span id="cb196-142"><a href="#cb196-142" aria-hidden="true" tabindex="-1"></a>    fill_rect<span class="op">(</span><span class="dv">52</span><span class="op">,</span> <span class="dv">63</span><span class="op">,</span> <span class="dv">7</span><span class="op">,</span> <span class="dv">2</span><span class="op">);</span> fill_rect<span class="op">(</span><span class="dv">54</span><span class="op">,</span> <span class="dv">65</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">4</span><span class="op">);</span></span>
<span id="cb196-143"><a href="#cb196-143" aria-hidden="true" tabindex="-1"></a>    draw_digit<span class="op">(</span><span class="dv">62</span><span class="op">,</span> <span class="dv">63</span><span class="op">,</span> ticks <span class="op">%</span> <span class="dv">10</span><span class="op">);</span></span>
<span id="cb196-144"><a href="#cb196-144" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb196-145"><a href="#cb196-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-146"><a href="#cb196-146" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> find_next<span class="op">(</span><span class="dt">int</span> from<span class="op">)</span> <span class="op">{</span></span>
<span id="cb196-147"><a href="#cb196-147" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i<span class="op">;</span> <span class="dt">int</span> next<span class="op">;</span></span>
<span id="cb196-148"><a href="#cb196-148" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> <span class="dv">4</span><span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb196-149"><a href="#cb196-149" aria-hidden="true" tabindex="-1"></a>        next <span class="op">=</span> <span class="op">(</span>from <span class="op">+</span> i<span class="op">)</span> <span class="op">%</span> <span class="dv">4</span><span class="op">;</span></span>
<span id="cb196-150"><a href="#cb196-150" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>proc_state<span class="op">[</span>next<span class="op">]</span> <span class="op">==</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> proc_work<span class="op">[</span>next<span class="op">]</span> <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> next<span class="op">;</span></span>
<span id="cb196-151"><a href="#cb196-151" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb196-152"><a href="#cb196-152" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> from<span class="op">;</span></span>
<span id="cb196-153"><a href="#cb196-153" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb196-154"><a href="#cb196-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-155"><a href="#cb196-155" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> all_done<span class="op">()</span> <span class="op">{</span></span>
<span id="cb196-156"><a href="#cb196-156" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i<span class="op">;</span></span>
<span id="cb196-157"><a href="#cb196-157" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">4</span><span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb196-158"><a href="#cb196-158" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>proc_state<span class="op">[</span>i<span class="op">]</span> <span class="op">!=</span> <span class="dv">3</span> <span class="op">&amp;&amp;</span> proc_state<span class="op">[</span>i<span class="op">]</span> <span class="op">!=</span> <span class="dv">2</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb196-159"><a href="#cb196-159" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>proc_work<span class="op">[</span>i<span class="op">]</span> <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb196-160"><a href="#cb196-160" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb196-161"><a href="#cb196-161" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb196-162"><a href="#cb196-162" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb196-163"><a href="#cb196-163" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb196-164"><a href="#cb196-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-165"><a href="#cb196-165" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> do_tick<span class="op">()</span> <span class="op">{</span></span>
<span id="cb196-166"><a href="#cb196-166" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> next<span class="op">;</span></span>
<span id="cb196-167"><a href="#cb196-167" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>all_done<span class="op">())</span> <span class="cf">return</span><span class="op">;</span></span>
<span id="cb196-168"><a href="#cb196-168" aria-hidden="true" tabindex="-1"></a>    ticks <span class="op">=</span> ticks <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb196-169"><a href="#cb196-169" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>proc_state<span class="op">[</span>current<span class="op">]</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> proc_state<span class="op">[</span>current<span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb196-170"><a href="#cb196-170" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>proc_state<span class="op">[</span>current<span class="op">]</span> <span class="op">==</span> <span class="dv">1</span> <span class="op">&amp;&amp;</span> proc_work<span class="op">[</span>current<span class="op">]</span> <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb196-171"><a href="#cb196-171" aria-hidden="true" tabindex="-1"></a>        proc_work<span class="op">[</span>current<span class="op">]</span> <span class="op">=</span> proc_work<span class="op">[</span>current<span class="op">]</span> <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb196-172"><a href="#cb196-172" aria-hidden="true" tabindex="-1"></a>        proc_done<span class="op">[</span>current<span class="op">]</span> <span class="op">=</span> proc_done<span class="op">[</span>current<span class="op">]</span> <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb196-173"><a href="#cb196-173" aria-hidden="true" tabindex="-1"></a>        quantum_left <span class="op">=</span> quantum_left <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb196-174"><a href="#cb196-174" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>proc_work<span class="op">[</span>current<span class="op">]</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb196-175"><a href="#cb196-175" aria-hidden="true" tabindex="-1"></a>            proc_state<span class="op">[</span>current<span class="op">]</span> <span class="op">=</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb196-176"><a href="#cb196-176" aria-hidden="true" tabindex="-1"></a>            quantum_left <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb196-177"><a href="#cb196-177" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb196-178"><a href="#cb196-178" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb196-179"><a href="#cb196-179" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>quantum_left <span class="op">&lt;=</span> <span class="dv">0</span> <span class="op">||</span> proc_state<span class="op">[</span>current<span class="op">]</span> <span class="op">==</span> <span class="dv">2</span> <span class="op">||</span> proc_state<span class="op">[</span>current<span class="op">]</span> <span class="op">==</span> <span class="dv">3</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb196-180"><a href="#cb196-180" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>proc_state<span class="op">[</span>current<span class="op">]</span> <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> proc_state<span class="op">[</span>current<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb196-181"><a href="#cb196-181" aria-hidden="true" tabindex="-1"></a>        next <span class="op">=</span> find_next<span class="op">(</span>current<span class="op">);</span></span>
<span id="cb196-182"><a href="#cb196-182" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>next <span class="op">!=</span> current<span class="op">)</span> <span class="op">{</span></span>
<span id="cb196-183"><a href="#cb196-183" aria-hidden="true" tabindex="-1"></a>            current <span class="op">=</span> next<span class="op">;</span></span>
<span id="cb196-184"><a href="#cb196-184" aria-hidden="true" tabindex="-1"></a>            switches <span class="op">=</span> switches <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb196-185"><a href="#cb196-185" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb196-186"><a href="#cb196-186" aria-hidden="true" tabindex="-1"></a>        quantum_left <span class="op">=</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb196-187"><a href="#cb196-187" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb196-188"><a href="#cb196-188" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb196-189"><a href="#cb196-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-190"><a href="#cb196-190" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> toggle_block<span class="op">(</span><span class="dt">int</span> idx<span class="op">)</span> <span class="op">{</span></span>
<span id="cb196-191"><a href="#cb196-191" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>proc_state<span class="op">[</span>idx<span class="op">]</span> <span class="op">==</span> <span class="dv">0</span> <span class="op">||</span> proc_state<span class="op">[</span>idx<span class="op">]</span> <span class="op">==</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb196-192"><a href="#cb196-192" aria-hidden="true" tabindex="-1"></a>        proc_state<span class="op">[</span>idx<span class="op">]</span> <span class="op">=</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb196-193"><a href="#cb196-193" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>idx <span class="op">==</span> current<span class="op">)</span> quantum_left <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb196-194"><a href="#cb196-194" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>proc_state<span class="op">[</span>idx<span class="op">]</span> <span class="op">==</span> <span class="dv">2</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb196-195"><a href="#cb196-195" aria-hidden="true" tabindex="-1"></a>        proc_state<span class="op">[</span>idx<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb196-196"><a href="#cb196-196" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb196-197"><a href="#cb196-197" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb196-198"><a href="#cb196-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-199"><a href="#cb196-199" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> draw_all<span class="op">()</span> <span class="op">{</span></span>
<span id="cb196-200"><a href="#cb196-200" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> i<span class="op">;</span></span>
<span id="cb196-201"><a href="#cb196-201" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span>i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">4</span><span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> draw_proc<span class="op">(</span>i<span class="op">);</span></span>
<span id="cb196-202"><a href="#cb196-202" aria-hidden="true" tabindex="-1"></a>    draw_info<span class="op">();</span></span>
<span id="cb196-203"><a href="#cb196-203" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb196-204"><a href="#cb196-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb196-205"><a href="#cb196-205" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb196-206"><a href="#cb196-206" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> key<span class="op">;</span> <span class="dt">int</span> lk<span class="op">;</span> <span class="dt">int</span> delay<span class="op">;</span></span>
<span id="cb196-207"><a href="#cb196-207" aria-hidden="true" tabindex="-1"></a>    proc_work<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">3</span><span class="op">;</span> proc_work<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> proc_work<span class="op">[</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> <span class="dv">4</span><span class="op">;</span> proc_work<span class="op">[</span><span class="dv">3</span><span class="op">]</span> <span class="op">=</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb196-208"><a href="#cb196-208" aria-hidden="true" tabindex="-1"></a>    proc_state<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> proc_state<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> proc_state<span class="op">[</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> proc_state<span class="op">[</span><span class="dv">3</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb196-209"><a href="#cb196-209" aria-hidden="true" tabindex="-1"></a>    proc_done<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> proc_done<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> proc_done<span class="op">[</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> proc_done<span class="op">[</span><span class="dv">3</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb196-210"><a href="#cb196-210" aria-hidden="true" tabindex="-1"></a>    lk <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> delay <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb196-211"><a href="#cb196-211" aria-hidden="true" tabindex="-1"></a>    draw_all<span class="op">();</span></span>
<span id="cb196-212"><a href="#cb196-212" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span><span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb196-213"><a href="#cb196-213" aria-hidden="true" tabindex="-1"></a>        key <span class="op">=</span> <span class="op">*</span>KEYBOARD<span class="op">;</span></span>
<span id="cb196-214"><a href="#cb196-214" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>key <span class="op">!=</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> key <span class="op">!=</span> lk<span class="op">)</span> <span class="op">{</span></span>
<span id="cb196-215"><a href="#cb196-215" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>key <span class="op">==</span> <span class="dv">32</span><span class="op">)</span> <span class="op">{</span> do_tick<span class="op">();</span> draw_all<span class="op">();</span> <span class="op">}</span></span>
<span id="cb196-216"><a href="#cb196-216" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>key <span class="op">==</span> <span class="dv">65</span><span class="op">)</span> <span class="op">{</span> auto_run <span class="op">=</span> <span class="dv">1</span> <span class="op">-</span> auto_run<span class="op">;</span> <span class="op">}</span></span>
<span id="cb196-217"><a href="#cb196-217" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>key <span class="op">==</span> <span class="dv">48</span><span class="op">)</span> <span class="op">{</span> toggle_block<span class="op">(</span><span class="dv">0</span><span class="op">);</span> draw_all<span class="op">();</span> <span class="op">}</span></span>
<span id="cb196-218"><a href="#cb196-218" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>key <span class="op">==</span> <span class="dv">49</span><span class="op">)</span> <span class="op">{</span> toggle_block<span class="op">(</span><span class="dv">1</span><span class="op">);</span> draw_all<span class="op">();</span> <span class="op">}</span></span>
<span id="cb196-219"><a href="#cb196-219" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>key <span class="op">==</span> <span class="dv">50</span><span class="op">)</span> <span class="op">{</span> toggle_block<span class="op">(</span><span class="dv">2</span><span class="op">);</span> draw_all<span class="op">();</span> <span class="op">}</span></span>
<span id="cb196-220"><a href="#cb196-220" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>key <span class="op">==</span> <span class="dv">51</span><span class="op">)</span> <span class="op">{</span> toggle_block<span class="op">(</span><span class="dv">3</span><span class="op">);</span> draw_all<span class="op">();</span> <span class="op">}</span></span>
<span id="cb196-221"><a href="#cb196-221" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>key <span class="op">==</span> <span class="dv">13</span><span class="op">)</span> <span class="cf">return</span> switches<span class="op">;</span></span>
<span id="cb196-222"><a href="#cb196-222" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb196-223"><a href="#cb196-223" aria-hidden="true" tabindex="-1"></a>        lk <span class="op">=</span> key<span class="op">;</span></span>
<span id="cb196-224"><a href="#cb196-224" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>auto_run<span class="op">)</span> <span class="op">{</span></span>
<span id="cb196-225"><a href="#cb196-225" aria-hidden="true" tabindex="-1"></a>            delay <span class="op">=</span> delay <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb196-226"><a href="#cb196-226" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">(</span>delay <span class="op">&gt;</span> <span class="dv">3000</span><span class="op">)</span> <span class="op">{</span> delay <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> do_tick<span class="op">();</span> draw_all<span class="op">();</span> <span class="op">}</span></span>
<span id="cb196-227"><a href="#cb196-227" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb196-228"><a href="#cb196-228" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb196-229"><a href="#cb196-229" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> switches<span class="op">;</span></span>
<span id="cb196-230"><a href="#cb196-230" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
</body>
</html>
