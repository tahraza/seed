<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Tahiry RAZAFINDRALAMBO" />
  <meta name="dcterms.date" content="2026-01-01" />
  <title>L'Architecture Codex</title>
  <style>
    html {
      font-family: DejaVu Serif;
      font-size: 11pt;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 12px;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      html {
        background-color: white;
      }
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    svg {
      height: auto;
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: DejaVu Sans Mono;
      font-size: 85%;
      margin: 0;
      hyphens: manual;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        background-color: #232629;
        color: #7a7c7d;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #7a7c7d;  padding-left: 4px; }
    div.sourceCode
      { color: #cfcfc2; background-color: #232629; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #cfcfc2; } /* Normal */
    code span.al { color: #95da4c; background-color: #4d1f24; font-weight: bold; } /* Alert */
    code span.an { color: #3f8058; } /* Annotation */
    code span.at { color: #2980b9; } /* Attribute */
    code span.bn { color: #f67400; } /* BaseN */
    code span.bu { color: #7f8c8d; } /* BuiltIn */
    code span.cf { color: #fdbc4b; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #3daee9; } /* Char */
    code span.cn { color: #27aeae; font-weight: bold; } /* Constant */
    code span.co { color: #7a7c7d; } /* Comment */
    code span.cv { color: #7f8c8d; } /* CommentVar */
    code span.do { color: #a43340; } /* Documentation */
    code span.dt { color: #2980b9; } /* DataType */
    code span.dv { color: #f67400; } /* DecVal */
    code span.er { color: #da4453; text-decoration: underline; } /* Error */
    code span.ex { color: #0099ff; font-weight: bold; } /* Extension */
    code span.fl { color: #f67400; } /* Float */
    code span.fu { color: #8e44ad; } /* Function */
    code span.im { color: #27ae60; } /* Import */
    code span.in { color: #c45b00; } /* Information */
    code span.kw { color: #cfcfc2; font-weight: bold; } /* Keyword */
    code span.op { color: #cfcfc2; } /* Operator */
    code span.ot { color: #27ae60; } /* Other */
    code span.pp { color: #27ae60; } /* Preprocessor */
    code span.re { color: #2980b9; background-color: #153042; } /* RegionMarker */
    code span.sc { color: #3daee9; } /* SpecialChar */
    code span.ss { color: #da4453; } /* SpecialString */
    code span.st { color: #f44f4f; } /* String */
    code span.va { color: #27aeae; } /* Variable */
    code span.vs { color: #da4453; } /* VerbatimString */
    code span.wa { color: #da4453; } /* Warning */
  </style>
</head>
<body>
<header id="title-block-header">
<h1 class="title">L'Architecture Codex</h1>
<p class="subtitle">De la Porte Logique au Système d’Exploitation
32-bits</p>
<p class="author">Tahiry RAZAFINDRALAMBO</p>
<p class="date">2026</p>
</header>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#larchitecture-codex-guide-de-létudiant"
id="toc-larchitecture-codex-guide-de-létudiant"><span
class="toc-section-number">1</span> L’Architecture Codex : Guide de
l’Étudiant</a>
<ul>
<li><a href="#table-des-matières" id="toc-table-des-matières"><span
class="toc-section-number">1.1</span> Table des Matières</a></li>
<li><a href="#comment-utiliser-ce-guide"
id="toc-comment-utiliser-ce-guide"><span
class="toc-section-number">1.2</span> Comment utiliser ce guide</a></li>
</ul></li>
<li><a href="#introduction" id="toc-introduction"><span
class="toc-section-number">2</span> Introduction</a>
<ul>
<li><a href="#le-mystère-de-lordinateur"
id="toc-le-mystère-de-lordinateur"><span
class="toc-section-number">2.1</span> Le Mystère de
l’Ordinateur</a></li>
<li><a href="#pourquoi-construire-un-ordinateur"
id="toc-pourquoi-construire-un-ordinateur"><span
class="toc-section-number">2.2</span> Pourquoi Construire un Ordinateur
?</a>
<ul>
<li><a href="#le-problème-de-la-boîte-noire"
id="toc-le-problème-de-la-boîte-noire"><span
class="toc-section-number">2.2.1</span> Le problème de la “boîte
noire”</a></li>
<li><a href="#lapproche-du-nand-au-tetris"
id="toc-lapproche-du-nand-au-tetris"><span
class="toc-section-number">2.2.2</span> L’approche “Du NAND au
Tetris”</a></li>
</ul></li>
<li><a href="#ce-que-vous-allez-construire"
id="toc-ce-que-vous-allez-construire"><span
class="toc-section-number">2.3</span> Ce que Vous Allez Construire</a>
<ul>
<li><a href="#la-beauté-de-labstraction"
id="toc-la-beauté-de-labstraction"><span
class="toc-section-number">2.3.1</span> La beauté de
l’abstraction</a></li>
</ul></li>
<li><a href="#larchitecture-codex-a32"
id="toc-larchitecture-codex-a32"><span
class="toc-section-number">2.4</span> L’Architecture Codex A32</a>
<ul>
<li><a href="#pourquoi-ces-changements"
id="toc-pourquoi-ces-changements"><span
class="toc-section-number">2.4.1</span> Pourquoi ces changements
?</a></li>
</ul></li>
<li><a href="#ce-que-vous-allez-apprendre"
id="toc-ce-que-vous-allez-apprendre"><span
class="toc-section-number">2.5</span> Ce que Vous Allez
Apprendre</a></li>
<li><a href="#vos-outils" id="toc-vos-outils"><span
class="toc-section-number">2.6</span> Vos Outils</a>
<ul>
<li><a href="#les-outils-en-ligne-de-commande"
id="toc-les-outils-en-ligne-de-commande"><span
class="toc-section-number">2.6.1</span> Les Outils en Ligne de
Commande</a></li>
<li><a href="#le-simulateur-web-recommandé"
id="toc-le-simulateur-web-recommandé"><span
class="toc-section-number">2.6.2</span> Le Simulateur Web
(Recommandé)</a></li>
<li><a href="#le-cpu-visualizer" id="toc-le-cpu-visualizer"><span
class="toc-section-number">2.6.3</span> Le CPU Visualizer</a></li>
</ul></li>
<li><a href="#comment-utiliser-ce-livre"
id="toc-comment-utiliser-ce-livre"><span
class="toc-section-number">2.7</span> Comment Utiliser ce Livre</a>
<ul>
<li><a href="#lapproche-recommandée"
id="toc-lapproche-recommandée"><span
class="toc-section-number">2.7.1</span> L’approche recommandée</a></li>
<li><a href="#si-vous-êtes-bloqué" id="toc-si-vous-êtes-bloqué"><span
class="toc-section-number">2.7.2</span> Si vous êtes bloqué</a></li>
</ul></li>
<li><a href="#la-grande-aventure-commence"
id="toc-la-grande-aventure-commence"><span
class="toc-section-number">2.8</span> La Grande Aventure
Commence</a></li>
</ul></li>
<li><a href="#logique-booléenne" id="toc-logique-booléenne"><span
class="toc-section-number">3</span> Logique Booléenne</a>
<ul>
<li><a href="#où-en-sommes-nous" id="toc-où-en-sommes-nous"><span
class="toc-section-number">3.1</span> Où en sommes-nous ?</a></li>
<li><a href="#pourquoi-le-binaire" id="toc-pourquoi-le-binaire"><span
class="toc-section-number">3.2</span> Pourquoi le Binaire ?</a>
<ul>
<li><a href="#la-question-fondamentale"
id="toc-la-question-fondamentale"><span
class="toc-section-number">3.2.1</span> La question
fondamentale</a></li>
<li><a href="#du-voltage-au-bit" id="toc-du-voltage-au-bit"><span
class="toc-section-number">3.2.2</span> Du voltage au bit</a></li>
<li><a href="#labstraction-qui-libère"
id="toc-labstraction-qui-libère"><span
class="toc-section-number">3.2.3</span> L’abstraction qui
libère</a></li>
</ul></li>
<li><a href="#la-porte-nand-notre-axiome"
id="toc-la-porte-nand-notre-axiome"><span
class="toc-section-number">3.3</span> La Porte NAND : Notre Axiome</a>
<ul>
<li><a href="#pourquoi-partir-du-nand"
id="toc-pourquoi-partir-du-nand"><span
class="toc-section-number">3.3.1</span> Pourquoi partir du NAND
?</a></li>
<li><a href="#table-de-vérité-nand" id="toc-table-de-vérité-nand"><span
class="toc-section-number">3.3.2</span> Table de Vérité NAND</a></li>
<li><a href="#symbole-graphique" id="toc-symbole-graphique"><span
class="toc-section-number">3.3.3</span> Symbole graphique</a></li>
</ul></li>
<li><a href="#construction-des-portes-élémentaires"
id="toc-construction-des-portes-élémentaires"><span
class="toc-section-number">3.4</span> Construction des Portes
Élémentaires</a>
<ul>
<li><a href="#a.-not-inverseur-linversion-de-la-réalité"
id="toc-a.-not-inverseur-linversion-de-la-réalité"><span
class="toc-section-number">3.4.1</span> A. NOT (Inverseur) — L’inversion
de la réalité</a></li>
<li><a href="#b.-and-et-la-conjonction"
id="toc-b.-and-et-la-conjonction"><span
class="toc-section-number">3.4.2</span> B. AND (Et) — La
conjonction</a></li>
<li><a href="#c.-or-ou-lalternative"
id="toc-c.-or-ou-lalternative"><span
class="toc-section-number">3.4.3</span> C. OR (Ou) —
L’alternative</a></li>
<li><a href="#d.-xor-ou-exclusif-la-différence"
id="toc-d.-xor-ou-exclusif-la-différence"><span
class="toc-section-number">3.4.4</span> D. XOR (Ou Exclusif) — La
différence</a></li>
<li><a href="#e.-multiplexeur-mux-laiguilleur"
id="toc-e.-multiplexeur-mux-laiguilleur"><span
class="toc-section-number">3.4.5</span> E. Multiplexeur (Mux) —
L’aiguilleur</a></li>
<li><a href="#f.-démultiplexeur-dmux-linverse-de-laiguilleur"
id="toc-f.-démultiplexeur-dmux-linverse-de-laiguilleur"><span
class="toc-section-number">3.4.6</span> F. Démultiplexeur (DMux) —
L’inverse de l’aiguilleur</a></li>
</ul></li>
<li><a href="#le-lien-avec-lordinateur-complet"
id="toc-le-lien-avec-lordinateur-complet"><span
class="toc-section-number">3.5</span> Le Lien avec l’Ordinateur
Complet</a>
<ul>
<li><a href="#du-nand-au-cpu-la-feuille-de-route"
id="toc-du-nand-au-cpu-la-feuille-de-route"><span
class="toc-section-number">3.5.1</span> Du NAND au CPU : La feuille de
route</a></li>
</ul></li>
<li><a href="#description-matérielle-codex-hdl"
id="toc-description-matérielle-codex-hdl"><span
class="toc-section-number">3.6</span> Description Matérielle (Codex
HDL)</a>
<ul>
<li><a href="#pourquoi-un-langage-de-description"
id="toc-pourquoi-un-langage-de-description"><span
class="toc-section-number">3.6.1</span> Pourquoi un langage de
description ?</a></li>
<li><a href="#structure-dun-fichier-.hdl"
id="toc-structure-dun-fichier-.hdl"><span
class="toc-section-number">3.6.2</span> Structure d’un fichier
<code>.hdl</code></a></li>
<li><a href="#vocabulaire-essentiel"
id="toc-vocabulaire-essentiel"><span
class="toc-section-number">3.6.3</span> Vocabulaire essentiel</a></li>
<li><a href="#règles-de-connexion" id="toc-règles-de-connexion"><span
class="toc-section-number">3.6.4</span> Règles de connexion</a></li>
<li><a href="#bus-vecteurs-de-bits" id="toc-bus-vecteurs-de-bits"><span
class="toc-section-number">3.6.5</span> Bus (Vecteurs de bits)</a></li>
<li><a href="#exemple-complet-xor-en-hdl"
id="toc-exemple-complet-xor-en-hdl"><span
class="toc-section-number">3.6.6</span> Exemple complet : XOR en
HDL</a></li>
</ul></li>
<li><a href="#exercices-pratiques" id="toc-exercices-pratiques"><span
class="toc-section-number">3.7</span> Exercices Pratiques</a>
<ul>
<li><a href="#exercices-sur-le-simulateur-web"
id="toc-exercices-sur-le-simulateur-web"><span
class="toc-section-number">3.7.1</span> Exercices sur le Simulateur
Web</a></li>
<li><a href="#comment-lancer-le-simulateur-web"
id="toc-comment-lancer-le-simulateur-web"><span
class="toc-section-number">3.7.2</span> Comment lancer le simulateur web
?</a></li>
<li><a href="#alternative-tests-en-ligne-de-commande"
id="toc-alternative-tests-en-ligne-de-commande"><span
class="toc-section-number">3.7.3</span> Alternative : Tests en ligne de
commande</a></li>
</ul></li>
<li><a href="#défis-supplémentaires"
id="toc-défis-supplémentaires"><span
class="toc-section-number">3.8</span> Défis Supplémentaires</a>
<ul>
<li><a href="#défi-1-minimiser-le-nombre-de-nand"
id="toc-défi-1-minimiser-le-nombre-de-nand"><span
class="toc-section-number">3.8.1</span> Défi 1 : Minimiser le nombre de
NAND</a></li>
<li><a href="#défi-2-implémenter-implies"
id="toc-défi-2-implémenter-implies"><span
class="toc-section-number">3.8.2</span> Défi 2 : Implémenter
IMPLIES</a></li>
<li><a href="#défi-3-mux-à-4-entrées"
id="toc-défi-3-mux-à-4-entrées"><span
class="toc-section-number">3.8.3</span> Défi 3 : Mux à 4
entrées</a></li>
</ul></li>
<li><a href="#ce-quil-faut-retenir" id="toc-ce-quil-faut-retenir"><span
class="toc-section-number">3.9</span> Ce qu’il faut retenir</a></li>
<li><a href="#auto-évaluation" id="toc-auto-évaluation"><span
class="toc-section-number">3.10</span> Auto-évaluation</a>
<ul>
<li><a href="#questions-de-compréhension"
id="toc-questions-de-compréhension"><span
class="toc-section-number">3.10.1</span> Questions de
compréhension</a></li>
<li><a href="#mini-défi-pratique" id="toc-mini-défi-pratique"><span
class="toc-section-number">3.10.2</span> Mini-défi pratique</a></li>
<li><a href="#checklist-de-validation"
id="toc-checklist-de-validation"><span
class="toc-section-number">3.10.3</span> Checklist de
validation</a></li>
</ul></li>
</ul></li>
<li><a href="#arithmétique-binaire" id="toc-arithmétique-binaire"><span
class="toc-section-number">4</span> Arithmétique Binaire</a>
<ul>
<li><a href="#où-en-sommes-nous-1" id="toc-où-en-sommes-nous-1"><span
class="toc-section-number">4.1</span> Où en sommes-nous ?</a></li>
<li><a href="#pourquoi-larithmétique-est-elle-si-importante"
id="toc-pourquoi-larithmétique-est-elle-si-importante"><span
class="toc-section-number">4.2</span> Pourquoi l’Arithmétique est-elle
si Importante ?</a>
<ul>
<li><a href="#au-cœur-de-tout-calcul"
id="toc-au-cœur-de-tout-calcul"><span
class="toc-section-number">4.2.1</span> Au cœur de tout calcul</a></li>
<li><a href="#ce-que-nous-allons-construire"
id="toc-ce-que-nous-allons-construire"><span
class="toc-section-number">4.2.2</span> Ce que nous allons
construire</a></li>
</ul></li>
<li><a href="#représentation-des-nombres"
id="toc-représentation-des-nombres"><span
class="toc-section-number">4.3</span> Représentation des Nombres</a>
<ul>
<li><a href="#le-système-binaire-base-2"
id="toc-le-système-binaire-base-2"><span
class="toc-section-number">4.3.1</span> Le Système Binaire (Base
2)</a></li>
<li><a href="#taille-des-nombres-dans-codex"
id="toc-taille-des-nombres-dans-codex"><span
class="toc-section-number">4.3.2</span> Taille des nombres dans
Codex</a></li>
<li><a href="#les-nombres-négatifs-le-complément-à-2"
id="toc-les-nombres-négatifs-le-complément-à-2"><span
class="toc-section-number">4.3.3</span> Les Nombres Négatifs : Le
Complément à 2</a></li>
<li><a href="#comment-obtenir-le-complément-à-2-la-valeur-négative"
id="toc-comment-obtenir-le-complément-à-2-la-valeur-négative"><span
class="toc-section-number">4.3.4</span> Comment obtenir le complément à
2 (la valeur négative) ?</a></li>
<li><a href="#pourquoi-le-complément-à-2-est-il-génial"
id="toc-pourquoi-le-complément-à-2-est-il-génial"><span
class="toc-section-number">4.3.5</span> Pourquoi le complément à 2
est-il génial ?</a></li>
</ul></li>
<li><a href="#laddition-binaire" id="toc-laddition-binaire"><span
class="toc-section-number">4.4</span> L’Addition Binaire</a>
<ul>
<li><a href="#les-règles-de-base-sur-1-bit"
id="toc-les-règles-de-base-sur-1-bit"><span
class="toc-section-number">4.4.1</span> Les règles de base (sur 1
bit)</a></li>
<li><a href="#exemple-daddition-sur-4-bits"
id="toc-exemple-daddition-sur-4-bits"><span
class="toc-section-number">4.4.2</span> Exemple d’addition sur 4
bits</a></li>
</ul></li>
<li><a href="#le-demi-additionneur-half-adder"
id="toc-le-demi-additionneur-half-adder"><span
class="toc-section-number">4.5</span> Le Demi-Additionneur (Half
Adder)</a>
<ul>
<li><a href="#table-de-vérité" id="toc-table-de-vérité"><span
class="toc-section-number">4.5.1</span> Table de vérité</a></li>
<li><a href="#linsight-clé" id="toc-linsight-clé"><span
class="toc-section-number">4.5.2</span> L’insight clé</a></li>
<li><a href="#schéma-du-circuit" id="toc-schéma-du-circuit"><span
class="toc-section-number">4.5.3</span> Schéma du circuit</a></li>
<li><a href="#limitation" id="toc-limitation"><span
class="toc-section-number">4.5.4</span> Limitation</a></li>
</ul></li>
<li><a href="#ladditionneur-complet-full-adder"
id="toc-ladditionneur-complet-full-adder"><span
class="toc-section-number">4.6</span> L’Additionneur Complet (Full
Adder)</a>
<ul>
<li><a href="#interface" id="toc-interface"><span
class="toc-section-number">4.6.1</span> Interface</a></li>
<li><a href="#table-de-vérité-1" id="toc-table-de-vérité-1"><span
class="toc-section-number">4.6.2</span> Table de vérité</a></li>
<li><a href="#comment-le-construire"
id="toc-comment-le-construire"><span
class="toc-section-number">4.6.3</span> Comment le construire ?</a></li>
</ul></li>
<li><a href="#ladditionneur-32-bits-ripple-carry-adder"
id="toc-ladditionneur-32-bits-ripple-carry-adder"><span
class="toc-section-number">4.7</span> L’Additionneur 32-bits (Ripple
Carry Adder)</a>
<ul>
<li><a href="#schéma-simplifié" id="toc-schéma-simplifié"><span
class="toc-section-number">4.7.1</span> Schéma simplifié</a></li>
<li><a href="#le-compromis-du-ripple-carry"
id="toc-le-compromis-du-ripple-carry"><span
class="toc-section-number">4.7.2</span> Le compromis du Ripple
Carry</a></li>
</ul></li>
<li><a href="#lalu-arithmetic-logic-unit"
id="toc-lalu-arithmetic-logic-unit"><span
class="toc-section-number">4.8</span> L’ALU (Arithmetic Logic Unit)</a>
<ul>
<li><a href="#pourquoi-combiner-arithmétique-et-logique"
id="toc-pourquoi-combiner-arithmétique-et-logique"><span
class="toc-section-number">4.8.1</span> Pourquoi combiner arithmétique
et logique ?</a></li>
<li><a href="#interface-de-lalu-codex"
id="toc-interface-de-lalu-codex"><span
class="toc-section-number">4.8.2</span> Interface de l’ALU
Codex</a></li>
<li><a href="#les-opérations-de-lalu"
id="toc-les-opérations-de-lalu"><span
class="toc-section-number">4.8.3</span> Les Opérations de l’ALU</a></li>
<li><a href="#comment-implémenter-la-soustraction"
id="toc-comment-implémenter-la-soustraction"><span
class="toc-section-number">4.8.4</span> Comment implémenter la
soustraction ?</a></li>
<li><a href="#les-drapeaux-flags" id="toc-les-drapeaux-flags"><span
class="toc-section-number">4.8.5</span> Les Drapeaux (Flags)</a></li>
<li><a href="#comment-calculer-les-drapeaux"
id="toc-comment-calculer-les-drapeaux"><span
class="toc-section-number">4.8.6</span> Comment calculer les drapeaux
?</a></li>
</ul></li>
<li><a href="#architecture-de-lalu" id="toc-architecture-de-lalu"><span
class="toc-section-number">4.9</span> Architecture de l’ALU</a></li>
<li><a href="#exercices-pratiques-1"
id="toc-exercices-pratiques-1"><span
class="toc-section-number">4.10</span> Exercices Pratiques</a>
<ul>
<li><a href="#exercices-sur-le-simulateur-web-1"
id="toc-exercices-sur-le-simulateur-web-1"><span
class="toc-section-number">4.10.1</span> Exercices sur le Simulateur
Web</a></li>
<li><a href="#conseils-pour-lalu" id="toc-conseils-pour-lalu"><span
class="toc-section-number">4.10.2</span> Conseils pour l’ALU</a></li>
<li><a href="#tests-en-ligne-de-commande"
id="toc-tests-en-ligne-de-commande"><span
class="toc-section-number">4.10.3</span> Tests en ligne de
commande</a></li>
</ul></li>
<li><a href="#défis-supplémentaires-1"
id="toc-défis-supplémentaires-1"><span
class="toc-section-number">4.11</span> Défis Supplémentaires</a>
<ul>
<li><a href="#défi-1-carry-lookahead"
id="toc-défi-1-carry-lookahead"><span
class="toc-section-number">4.11.1</span> Défi 1 : Carry
Lookahead</a></li>
<li><a href="#défi-2-multiplicateur"
id="toc-défi-2-multiplicateur"><span
class="toc-section-number">4.11.2</span> Défi 2 :
Multiplicateur</a></li>
<li><a href="#défi-3-comparateur" id="toc-défi-3-comparateur"><span
class="toc-section-number">4.11.3</span> Défi 3 : Comparateur</a></li>
</ul></li>
<li><a href="#le-lien-avec-le-cpu" id="toc-le-lien-avec-le-cpu"><span
class="toc-section-number">4.12</span> Le Lien avec le CPU</a></li>
<li><a href="#ce-quil-faut-retenir-1"
id="toc-ce-quil-faut-retenir-1"><span
class="toc-section-number">4.13</span> Ce qu’il faut retenir</a></li>
<li><a href="#auto-évaluation-1" id="toc-auto-évaluation-1"><span
class="toc-section-number">4.14</span> Auto-évaluation</a>
<ul>
<li><a href="#questions-de-compréhension-1"
id="toc-questions-de-compréhension-1"><span
class="toc-section-number">4.14.1</span> Questions de
compréhension</a></li>
<li><a href="#mini-défi-pratique-1" id="toc-mini-défi-pratique-1"><span
class="toc-section-number">4.14.2</span> Mini-défi pratique</a></li>
<li><a href="#checklist-de-validation-1"
id="toc-checklist-de-validation-1"><span
class="toc-section-number">4.14.3</span> Checklist de
validation</a></li>
</ul></li>
</ul></li>
<li><a href="#logique-séquentielle-et-mémoire"
id="toc-logique-séquentielle-et-mémoire"><span
class="toc-section-number">5</span> Logique Séquentielle et Mémoire</a>
<ul>
<li><a href="#où-en-sommes-nous-2" id="toc-où-en-sommes-nous-2"><span
class="toc-section-number">5.1</span> Où en sommes-nous ?</a></li>
<li><a href="#pourquoi-la-mémoire-est-elle-fondamentale"
id="toc-pourquoi-la-mémoire-est-elle-fondamentale"><span
class="toc-section-number">5.2</span> Pourquoi la Mémoire est-elle
Fondamentale ?</a>
<ul>
<li><a href="#le-problème-de-létat" id="toc-le-problème-de-létat"><span
class="toc-section-number">5.2.1</span> Le problème de l’état</a></li>
<li><a href="#ce-que-stocke-la-mémoire"
id="toc-ce-que-stocke-la-mémoire"><span
class="toc-section-number">5.2.2</span> Ce que stocke la
mémoire</a></li>
<li><a href="#combinatoire-vs-séquentiel"
id="toc-combinatoire-vs-séquentiel"><span
class="toc-section-number">5.2.3</span> Combinatoire vs
Séquentiel</a></li>
</ul></li>
<li><a href="#le-temps-et-lhorloge-clock"
id="toc-le-temps-et-lhorloge-clock"><span
class="toc-section-number">5.3</span> Le Temps et l’Horloge (Clock)</a>
<ul>
<li><a href="#le-problème-de-la-synchronisation"
id="toc-le-problème-de-la-synchronisation"><span
class="toc-section-number">5.3.1</span> Le problème de la
synchronisation</a></li>
<li><a href="#front-montant-rising-edge"
id="toc-front-montant-rising-edge"><span
class="toc-section-number">5.3.2</span> Front montant (Rising
Edge)</a></li>
<li><a href="#fréquence-dhorloge" id="toc-fréquence-dhorloge"><span
class="toc-section-number">5.3.3</span> Fréquence d’horloge</a></li>
</ul></li>
<li><a href="#la-bascule-d-d-flip-flop-dff"
id="toc-la-bascule-d-d-flip-flop-dff"><span
class="toc-section-number">5.4</span> La Bascule D (D Flip-Flop /
DFF)</a>
<ul>
<li><a href="#interface-1" id="toc-interface-1"><span
class="toc-section-number">5.4.1</span> Interface</a></li>
<li><a href="#comportement" id="toc-comportement"><span
class="toc-section-number">5.4.2</span> Comportement</a></li>
<li><a href="#pourquoi-est-ce-utile"
id="toc-pourquoi-est-ce-utile"><span
class="toc-section-number">5.4.3</span> Pourquoi est-ce utile ?</a></li>
<li><a href="#comment-fonctionne-une-dff-en-interne"
id="toc-comment-fonctionne-une-dff-en-interne"><span
class="toc-section-number">5.4.4</span> Comment fonctionne une DFF en
interne ?</a></li>
</ul></li>
<li><a href="#le-registre-1-bit-bit"
id="toc-le-registre-1-bit-bit"><span
class="toc-section-number">5.5</span> Le Registre 1-bit (Bit)</a>
<ul>
<li><a href="#le-problème" id="toc-le-problème"><span
class="toc-section-number">5.5.1</span> Le problème</a></li>
<li><a href="#la-solution-la-rétroaction"
id="toc-la-solution-la-rétroaction"><span
class="toc-section-number">5.5.2</span> La solution : la
rétroaction</a></li>
<li><a href="#cest-magique" id="toc-cest-magique"><span
class="toc-section-number">5.5.3</span> C’est magique !</a></li>
</ul></li>
<li><a href="#le-registre-32-bits" id="toc-le-registre-32-bits"><span
class="toc-section-number">5.6</span> Le Registre 32-bits</a>
<ul>
<li><a href="#du-bit-au-mot" id="toc-du-bit-au-mot"><span
class="toc-section-number">5.6.1</span> Du bit au mot</a></li>
<li><a href="#le-rôle-des-registres-dans-le-cpu"
id="toc-le-rôle-des-registres-dans-le-cpu"><span
class="toc-section-number">5.6.2</span> Le rôle des registres dans le
CPU</a></li>
</ul></li>
<li><a href="#la-ram-random-access-memory"
id="toc-la-ram-random-access-memory"><span
class="toc-section-number">5.7</span> La RAM (Random Access Memory)</a>
<ul>
<li><a href="#du-registre-à-la-mémoire"
id="toc-du-registre-à-la-mémoire"><span
class="toc-section-number">5.7.1</span> Du registre à la
mémoire</a></li>
<li><a href="#interface-de-la-ram" id="toc-interface-de-la-ram"><span
class="toc-section-number">5.7.2</span> Interface de la RAM</a></li>
<li><a href="#comment-ça-marche" id="toc-comment-ça-marche"><span
class="toc-section-number">5.7.3</span> Comment ça marche ?</a></li>
<li><a href="#exemple-ram8-8-mots-de-32-bits"
id="toc-exemple-ram8-8-mots-de-32-bits"><span
class="toc-section-number">5.7.4</span> Exemple : RAM8 (8 mots de 32
bits)</a></li>
<li><a href="#construction-hiérarchique-de-grandes-rams"
id="toc-construction-hiérarchique-de-grandes-rams"><span
class="toc-section-number">5.7.5</span> Construction hiérarchique de
grandes RAMs</a></li>
</ul></li>
<li><a href="#le-compteur-de-programme-pc"
id="toc-le-compteur-de-programme-pc"><span
class="toc-section-number">5.8</span> Le Compteur de Programme (PC)</a>
<ul>
<li><a href="#pourquoi-est-il-spécial"
id="toc-pourquoi-est-il-spécial"><span
class="toc-section-number">5.8.1</span> Pourquoi est-il spécial
?</a></li>
<li><a href="#les-trois-modes-du-pc"
id="toc-les-trois-modes-du-pc"><span
class="toc-section-number">5.8.2</span> Les trois modes du PC</a></li>
<li><a href="#schéma-simplifié-1" id="toc-schéma-simplifié-1"><span
class="toc-section-number">5.8.3</span> Schéma simplifié</a></li>
<li><a href="#le-lien-avec-lexécution-du-programme"
id="toc-le-lien-avec-lexécution-du-programme"><span
class="toc-section-number">5.8.4</span> Le lien avec l’exécution du
programme</a></li>
</ul></li>
<li><a href="#les-différents-types-de-mémoire"
id="toc-les-différents-types-de-mémoire"><span
class="toc-section-number">5.9</span> Les Différents Types de
Mémoire</a></li>
<li><a href="#exercices-pratiques-2"
id="toc-exercices-pratiques-2"><span
class="toc-section-number">5.10</span> Exercices Pratiques</a>
<ul>
<li><a href="#exercices-sur-le-simulateur-web-2"
id="toc-exercices-sur-le-simulateur-web-2"><span
class="toc-section-number">5.10.1</span> Exercices sur le Simulateur
Web</a></li>
<li><a href="#ordre-de-progression-recommandé"
id="toc-ordre-de-progression-recommandé"><span
class="toc-section-number">5.10.2</span> Ordre de progression
recommandé</a></li>
<li><a href="#prérequis" id="toc-prérequis"><span
class="toc-section-number">5.10.3</span> Prérequis</a></li>
<li><a href="#tests-en-ligne-de-commande-1"
id="toc-tests-en-ligne-de-commande-1"><span
class="toc-section-number">5.10.4</span> Tests en ligne de
commande</a></li>
</ul></li>
<li><a href="#défis-supplémentaires-2"
id="toc-défis-supplémentaires-2"><span
class="toc-section-number">5.11</span> Défis Supplémentaires</a>
<ul>
<li><a href="#défi-1-ram-avec-deux-ports-de-lecture"
id="toc-défi-1-ram-avec-deux-ports-de-lecture"><span
class="toc-section-number">5.11.1</span> Défi 1 : RAM avec deux ports de
lecture</a></li>
<li><a href="#défi-2-compteur-avec-valeur-maximale"
id="toc-défi-2-compteur-avec-valeur-maximale"><span
class="toc-section-number">5.11.2</span> Défi 2 : Compteur avec valeur
maximale</a></li>
<li><a href="#défi-3-registre-à-décalage-shift-register"
id="toc-défi-3-registre-à-décalage-shift-register"><span
class="toc-section-number">5.11.3</span> Défi 3 : Registre à décalage
(Shift Register)</a></li>
</ul></li>
<li><a href="#le-lien-avec-la-suite"
id="toc-le-lien-avec-la-suite"><span
class="toc-section-number">5.12</span> Le Lien avec la Suite</a></li>
<li><a href="#ce-quil-faut-retenir-2"
id="toc-ce-quil-faut-retenir-2"><span
class="toc-section-number">5.13</span> Ce qu’il faut retenir</a></li>
<li><a href="#auto-évaluation-2" id="toc-auto-évaluation-2"><span
class="toc-section-number">5.14</span> Auto-évaluation</a>
<ul>
<li><a href="#questions-de-compréhension-2"
id="toc-questions-de-compréhension-2"><span
class="toc-section-number">5.14.1</span> Questions de
compréhension</a></li>
<li><a href="#mini-défi-pratique-2" id="toc-mini-défi-pratique-2"><span
class="toc-section-number">5.14.2</span> Mini-défi pratique</a></li>
<li><a href="#checklist-de-validation-2"
id="toc-checklist-de-validation-2"><span
class="toc-section-number">5.14.3</span> Checklist de
validation</a></li>
</ul></li>
</ul></li>
<li><a href="#architecture-machine-isa-a32"
id="toc-architecture-machine-isa-a32"><span
class="toc-section-number">6</span> Architecture Machine (ISA A32)</a>
<ul>
<li><a href="#où-en-sommes-nous-3" id="toc-où-en-sommes-nous-3"><span
class="toc-section-number">6.1</span> Où en sommes-nous ?</a></li>
<li><a href="#quest-ce-quune-architecture"
id="toc-quest-ce-quune-architecture"><span
class="toc-section-number">6.2</span> Qu’est-ce qu’une Architecture
?</a>
<ul>
<li><a href="#le-contrat-fondamental"
id="toc-le-contrat-fondamental"><span
class="toc-section-number">6.2.1</span> Le contrat fondamental</a></li>
<li><a href="#codex-a32-une-architecture-risc-moderne"
id="toc-codex-a32-une-architecture-risc-moderne"><span
class="toc-section-number">6.2.2</span> Codex A32 : Une architecture
RISC moderne</a></li>
</ul></li>
<li><a href="#pourquoi-risc-larchitecture-loadstore"
id="toc-pourquoi-risc-larchitecture-loadstore"><span
class="toc-section-number">6.3</span> Pourquoi RISC ? L’architecture
Load/Store</a>
<ul>
<li><a href="#cisc-vs-risc" id="toc-cisc-vs-risc"><span
class="toc-section-number">6.3.1</span> CISC vs RISC</a></li>
<li><a href="#la-règle-dor-loadstore"
id="toc-la-règle-dor-loadstore"><span
class="toc-section-number">6.3.2</span> La règle d’or
Load/Store</a></li>
</ul></li>
<li><a href="#le-cycle-de-vie-dune-instruction"
id="toc-le-cycle-de-vie-dune-instruction"><span
class="toc-section-number">6.4</span> Le Cycle de Vie d’une
Instruction</a></li>
<li><a href="#les-registres-le-plan-de-travail"
id="toc-les-registres-le-plan-de-travail"><span
class="toc-section-number">6.5</span> Les Registres : Le Plan de
Travail</a>
<ul>
<li><a href="#vue-densemble" id="toc-vue-densemble"><span
class="toc-section-number">6.5.1</span> Vue d’ensemble</a></li>
<li><a href="#rôles-des-registres" id="toc-rôles-des-registres"><span
class="toc-section-number">6.5.2</span> Rôles des registres</a></li>
<li><a href="#le-cas-spécial-de-r15-pc"
id="toc-le-cas-spécial-de-r15-pc"><span
class="toc-section-number">6.5.3</span> Le cas spécial de R15
(PC)</a></li>
</ul></li>
<li><a href="#la-carte-mémoire-memory-map"
id="toc-la-carte-mémoire-memory-map"><span
class="toc-section-number">6.6</span> La Carte Mémoire (Memory Map)</a>
<ul>
<li><a href="#organisation-de-la-mémoire-codex"
id="toc-organisation-de-la-mémoire-codex"><span
class="toc-section-number">6.6.1</span> Organisation de la mémoire
Codex</a></li>
<li><a href="#le-memory-mapped-io-mmio"
id="toc-le-memory-mapped-io-mmio"><span
class="toc-section-number">6.6.2</span> Le Memory-Mapped I/O
(MMIO)</a></li>
</ul></li>
<li><a href="#le-format-des-instructions"
id="toc-le-format-des-instructions"><span
class="toc-section-number">6.7</span> Le Format des Instructions</a>
<ul>
<li><a href="#les-bits-de-condition-31-28"
id="toc-les-bits-de-condition-31-28"><span
class="toc-section-number">6.7.1</span> Les bits de condition
(31-28)</a></li>
<li><a href="#les-classes-dinstructions-27-25"
id="toc-les-classes-dinstructions-27-25"><span
class="toc-section-number">6.7.2</span> Les classes d’instructions
(27-25)</a></li>
</ul></li>
<li><a href="#les-instructions-en-détail"
id="toc-les-instructions-en-détail"><span
class="toc-section-number">6.8</span> Les Instructions en Détail</a>
<ul>
<li><a href="#a.-opérations-arithmétiques-et-logiques"
id="toc-a.-opérations-arithmétiques-et-logiques"><span
class="toc-section-number">6.8.1</span> A. Opérations Arithmétiques et
Logiques</a></li>
<li><a href="#b.-accès-mémoire-loadstore"
id="toc-b.-accès-mémoire-loadstore"><span
class="toc-section-number">6.8.2</span> B. Accès Mémoire
(Load/Store)</a></li>
<li><a href="#c.-branchements" id="toc-c.-branchements"><span
class="toc-section-number">6.8.3</span> C. Branchements</a></li>
</ul></li>
<li><a href="#la-pile-stack" id="toc-la-pile-stack"><span
class="toc-section-number">6.9</span> La Pile (Stack)</a>
<ul>
<li><a href="#fonctionnement" id="toc-fonctionnement"><span
class="toc-section-number">6.9.1</span> Fonctionnement</a></li>
<li><a href="#push-et-pop-manuel" id="toc-push-et-pop-manuel"><span
class="toc-section-number">6.9.2</span> Push et Pop (manuel)</a></li>
</ul></li>
<li><a href="#exemples-de-programmes"
id="toc-exemples-de-programmes"><span
class="toc-section-number">6.10</span> Exemples de Programmes</a>
<ul>
<li><a href="#exemple-1-somme-de-1-à-n"
id="toc-exemple-1-somme-de-1-à-n"><span
class="toc-section-number">6.10.1</span> Exemple 1 : Somme de 1 à
N</a></li>
<li><a href="#exemple-2-maximum-de-deux-nombres-avec-prédication"
id="toc-exemple-2-maximum-de-deux-nombres-avec-prédication"><span
class="toc-section-number">6.10.2</span> Exemple 2 : Maximum de deux
nombres (avec prédication)</a></li>
<li><a href="#exemple-3-dessiner-un-pixel"
id="toc-exemple-3-dessiner-un-pixel"><span
class="toc-section-number">6.10.3</span> Exemple 3 : Dessiner un
pixel</a></li>
</ul></li>
<li><a href="#gestion-des-erreurs-traps"
id="toc-gestion-des-erreurs-traps"><span
class="toc-section-number">6.11</span> Gestion des Erreurs
(Traps)</a></li>
<li><a href="#exercices-pratiques-3"
id="toc-exercices-pratiques-3"><span
class="toc-section-number">6.12</span> Exercices Pratiques</a>
<ul>
<li><a href="#exercices-sur-le-simulateur-web-3"
id="toc-exercices-sur-le-simulateur-web-3"><span
class="toc-section-number">6.12.1</span> Exercices sur le Simulateur
Web</a></li>
<li><a href="#tests-en-ligne-de-commande-2"
id="toc-tests-en-ligne-de-commande-2"><span
class="toc-section-number">6.12.2</span> Tests en ligne de
commande</a></li>
</ul></li>
<li><a href="#ce-quil-faut-retenir-3"
id="toc-ce-quil-faut-retenir-3"><span
class="toc-section-number">6.13</span> Ce qu’il faut retenir</a></li>
<li><a href="#auto-évaluation-3" id="toc-auto-évaluation-3"><span
class="toc-section-number">6.14</span> Auto-évaluation</a>
<ul>
<li><a href="#questions-de-compréhension-3"
id="toc-questions-de-compréhension-3"><span
class="toc-section-number">6.14.1</span> Questions de
compréhension</a></li>
<li><a href="#mini-défi-pratique-3" id="toc-mini-défi-pratique-3"><span
class="toc-section-number">6.14.2</span> Mini-défi pratique</a></li>
<li><a href="#checklist-de-validation-3"
id="toc-checklist-de-validation-3"><span
class="toc-section-number">6.14.3</span> Checklist de
validation</a></li>
</ul></li>
</ul></li>
<li><a href="#le-processeur-cpu" id="toc-le-processeur-cpu"><span
class="toc-section-number">7</span> Le Processeur (CPU)</a>
<ul>
<li><a href="#où-en-sommes-nous-4" id="toc-où-en-sommes-nous-4"><span
class="toc-section-number">7.1</span> Où en sommes-nous ?</a></li>
<li><a href="#deux-implémentations-du-cpu"
id="toc-deux-implémentations-du-cpu"><span
class="toc-section-number">7.2</span> Deux Implémentations du CPU</a>
<ul>
<li><a href="#cpu-mono-cycle-simulateur-rust"
id="toc-cpu-mono-cycle-simulateur-rust"><span
class="toc-section-number">7.2.1</span> CPU Mono-cycle (Simulateur
Rust)</a></li>
<li><a href="#cpu-pipeline-hdl" id="toc-cpu-pipeline-hdl"><span
class="toc-section-number">7.2.2</span> CPU Pipeline (HDL)</a></li>
<li><a href="#pourquoi-deux-implémentations"
id="toc-pourquoi-deux-implémentations"><span
class="toc-section-number">7.2.3</span> Pourquoi deux implémentations
?</a></li>
</ul></li>
<li><a href="#quest-ce-quun-cpu" id="toc-quest-ce-quun-cpu"><span
class="toc-section-number">7.3</span> Qu’est-ce qu’un CPU ?</a>
<ul>
<li><a href="#le-chef-dorchestre" id="toc-le-chef-dorchestre"><span
class="toc-section-number">7.3.1</span> Le chef d’orchestre</a></li>
<li><a href="#ce-que-nous-avons-construit-jusquici"
id="toc-ce-que-nous-avons-construit-jusquici"><span
class="toc-section-number">7.3.2</span> Ce que nous avons construit
jusqu’ici</a></li>
<li><a href="#ce-quil-reste-à-construire"
id="toc-ce-quil-reste-à-construire"><span
class="toc-section-number">7.3.3</span> Ce qu’il reste à
construire</a></li>
</ul></li>
<li><a href="#architecture-du-cpu-data-path"
id="toc-architecture-du-cpu-data-path"><span
class="toc-section-number">7.4</span> Architecture du CPU (Data
Path)</a>
<ul>
<li><a href="#les-flux-de-données" id="toc-les-flux-de-données"><span
class="toc-section-number">7.4.1</span> Les flux de données</a></li>
</ul></li>
<li><a href="#les-composants-du-cpu"
id="toc-les-composants-du-cpu"><span
class="toc-section-number">7.5</span> Les Composants du CPU</a>
<ul>
<li><a href="#le-compteur-de-programme-pc-1"
id="toc-le-compteur-de-programme-pc-1"><span
class="toc-section-number">7.5.1</span> 1. Le Compteur de Programme
(PC)</a></li>
<li><a href="#le-décodeur-decoder" id="toc-le-décodeur-decoder"><span
class="toc-section-number">7.5.2</span> 2. Le Décodeur
(Decoder)</a></li>
<li><a href="#lunité-de-contrôle-control"
id="toc-lunité-de-contrôle-control"><span
class="toc-section-number">7.5.3</span> 3. L’Unité de Contrôle
(Control)</a></li>
<li><a href="#le-vérificateur-de-condition-condcheck"
id="toc-le-vérificateur-de-condition-condcheck"><span
class="toc-section-number">7.5.4</span> 4. Le Vérificateur de Condition
(CondCheck)</a></li>
<li><a href="#le-banc-de-registres-regfile"
id="toc-le-banc-de-registres-regfile"><span
class="toc-section-number">7.5.5</span> 5. Le Banc de Registres
(RegFile)</a></li>
<li><a href="#les-multiplexeurs" id="toc-les-multiplexeurs"><span
class="toc-section-number">7.5.6</span> 6. Les Multiplexeurs</a></li>
</ul></li>
<li><a href="#le-cycle-dexécution-en-détail"
id="toc-le-cycle-dexécution-en-détail"><span
class="toc-section-number">7.6</span> Le Cycle d’Exécution en Détail</a>
<ul>
<li><a href="#phase-1-fetch-récupération"
id="toc-phase-1-fetch-récupération"><span
class="toc-section-number">7.6.1</span> Phase 1 : Fetch
(Récupération)</a></li>
<li><a href="#phase-2-decode-décodage"
id="toc-phase-2-decode-décodage"><span
class="toc-section-number">7.6.2</span> Phase 2 : Decode
(Décodage)</a></li>
<li><a href="#phase-3-register-read-lecture-des-registres"
id="toc-phase-3-register-read-lecture-des-registres"><span
class="toc-section-number">7.6.3</span> Phase 3 : Register Read (Lecture
des registres)</a></li>
<li><a href="#phase-4-execute-exécution"
id="toc-phase-4-execute-exécution"><span
class="toc-section-number">7.6.4</span> Phase 4 : Execute
(Exécution)</a></li>
<li><a href="#phase-5-memory-accès-mémoire"
id="toc-phase-5-memory-accès-mémoire"><span
class="toc-section-number">7.6.5</span> Phase 5 : Memory (Accès
mémoire)</a></li>
<li><a href="#phase-6-writeback-écriture"
id="toc-phase-6-writeback-écriture"><span
class="toc-section-number">7.6.6</span> Phase 6 : Writeback
(Écriture)</a></li>
<li><a href="#phase-7-pc-update" id="toc-phase-7-pc-update"><span
class="toc-section-number">7.6.7</span> Phase 7 : PC Update</a></li>
</ul></li>
<li><a href="#implémentation-du-cpu-en-hdl"
id="toc-implémentation-du-cpu-en-hdl"><span
class="toc-section-number">7.7</span> Implémentation du CPU en
HDL</a></li>
<li><a href="#exercices-pratiques-4"
id="toc-exercices-pratiques-4"><span
class="toc-section-number">7.8</span> Exercices Pratiques</a>
<ul>
<li><a href="#exercices-sur-le-simulateur-web-4"
id="toc-exercices-sur-le-simulateur-web-4"><span
class="toc-section-number">7.8.1</span> Exercices sur le Simulateur
Web</a></li>
<li><a href="#ordre-de-progression" id="toc-ordre-de-progression"><span
class="toc-section-number">7.8.2</span> Ordre de progression</a></li>
<li><a href="#tests-en-ligne-de-commande-3"
id="toc-tests-en-ligne-de-commande-3"><span
class="toc-section-number">7.8.3</span> Tests en ligne de
commande</a></li>
</ul></li>
<li><a href="#cpu-visualizer-loutil-interactif"
id="toc-cpu-visualizer-loutil-interactif"><span
class="toc-section-number">7.9</span> CPU Visualizer : L’Outil
Interactif</a>
<ul>
<li><a href="#accéder-au-visualizer"
id="toc-accéder-au-visualizer"><span
class="toc-section-number">7.9.1</span> Accéder au Visualizer</a></li>
<li><a href="#fonctionnalités-du-visualizer"
id="toc-fonctionnalités-du-visualizer"><span
class="toc-section-number">7.9.2</span> Fonctionnalités du
Visualizer</a></li>
<li><a href="#les-démos-intégrées" id="toc-les-démos-intégrées"><span
class="toc-section-number">7.9.3</span> Les Démos Intégrées</a></li>
<li><a href="#contrôles" id="toc-contrôles"><span
class="toc-section-number">7.9.4</span> Contrôles</a></li>
<li><a href="#charger-votre-propre-code"
id="toc-charger-votre-propre-code"><span
class="toc-section-number">7.9.5</span> Charger Votre Propre
Code</a></li>
<li><a href="#exercice-pratique" id="toc-exercice-pratique"><span
class="toc-section-number">7.9.6</span> Exercice Pratique</a></li>
</ul></li>
<li><a href="#conseils-de-débogage" id="toc-conseils-de-débogage"><span
class="toc-section-number">7.10</span> Conseils de Débogage</a>
<ul>
<li><a href="#le-pc-reste-à-0" id="toc-le-pc-reste-à-0"><span
class="toc-section-number">7.10.1</span> Le PC reste à 0 ?</a></li>
<li><a href="#les-branchements-ne-marchent-pas"
id="toc-les-branchements-ne-marchent-pas"><span
class="toc-section-number">7.10.2</span> Les branchements ne marchent
pas ?</a></li>
<li><a href="#rien-ne-sécrit-dans-les-registres"
id="toc-rien-ne-sécrit-dans-les-registres"><span
class="toc-section-number">7.10.3</span> Rien ne s’écrit dans les
registres ?</a></li>
<li><a href="#ldrstr-ne-fonctionne-pas"
id="toc-ldrstr-ne-fonctionne-pas"><span
class="toc-section-number">7.10.4</span> LDR/STR ne fonctionne pas
?</a></li>
</ul></li>
<li><a href="#aller-plus-loin-le-cpu-pipeline"
id="toc-aller-plus-loin-le-cpu-pipeline"><span
class="toc-section-number">7.11</span> Aller Plus Loin : Le CPU
Pipeline</a>
<ul>
<li><a href="#pourquoi-le-cpu-single-cycle-est-lent"
id="toc-pourquoi-le-cpu-single-cycle-est-lent"><span
class="toc-section-number">7.11.1</span> Pourquoi le CPU Single-Cycle
est Lent</a></li>
<li><a href="#le-pipeline-à-5-étages"
id="toc-le-pipeline-à-5-étages"><span
class="toc-section-number">7.11.2</span> Le Pipeline à 5 Étages</a></li>
<li><a href="#visualisation-du-pipeline-en-action"
id="toc-visualisation-du-pipeline-en-action"><span
class="toc-section-number">7.11.3</span> Visualisation du Pipeline en
Action</a></li>
<li><a href="#les-registres-de-pipeline"
id="toc-les-registres-de-pipeline"><span
class="toc-section-number">7.11.4</span> Les Registres de
Pipeline</a></li>
<li><a href="#les-aléas-hazards" id="toc-les-aléas-hazards"><span
class="toc-section-number">7.11.5</span> Les Aléas (Hazards)</a></li>
<li><a href="#architecture-complète-du-cpu-pipeline"
id="toc-architecture-complète-du-cpu-pipeline"><span
class="toc-section-number">7.11.6</span> Architecture Complète du CPU
Pipeline</a></li>
<li><a href="#exercices-pratiques-projet-6"
id="toc-exercices-pratiques-projet-6"><span
class="toc-section-number">7.11.7</span> Exercices Pratiques : Projet
6</a></li>
<li><a href="#comment-tester-le-cpu-pipeline-hdl"
id="toc-comment-tester-le-cpu-pipeline-hdl"><span
class="toc-section-number">7.11.8</span> Comment Tester le CPU Pipeline
HDL</a></li>
<li><a href="#résumé-pipeline-vs-single-cycle"
id="toc-résumé-pipeline-vs-single-cycle"><span
class="toc-section-number">7.11.9</span> Résumé : Pipeline vs
Single-Cycle</a></li>
<li><a href="#pour-aller-encore-plus-loin"
id="toc-pour-aller-encore-plus-loin"><span
class="toc-section-number">7.11.10</span> Pour Aller Encore Plus
Loin</a></li>
</ul></li>
<li><a href="#le-lien-avec-la-suite-1"
id="toc-le-lien-avec-la-suite-1"><span
class="toc-section-number">7.12</span> Le Lien avec la Suite</a>
<ul>
<li><a href="#le-parcours-complet" id="toc-le-parcours-complet"><span
class="toc-section-number">7.12.1</span> Le parcours complet</a></li>
</ul></li>
<li><a href="#ce-quil-faut-retenir-4"
id="toc-ce-quil-faut-retenir-4"><span
class="toc-section-number">7.13</span> Ce qu’il faut retenir</a></li>
<li><a href="#auto-évaluation-4" id="toc-auto-évaluation-4"><span
class="toc-section-number">7.14</span> Auto-évaluation</a>
<ul>
<li><a href="#questions-de-compréhension-4"
id="toc-questions-de-compréhension-4"><span
class="toc-section-number">7.14.1</span> Questions de
compréhension</a></li>
<li><a href="#mini-défi-pratique-4" id="toc-mini-défi-pratique-4"><span
class="toc-section-number">7.14.2</span> Mini-défi pratique</a></li>
<li><a href="#checklist-de-validation-4"
id="toc-checklist-de-validation-4"><span
class="toc-section-number">7.14.3</span> Checklist de
validation</a></li>
</ul></li>
</ul></li>
<li><a href="#lassembleur" id="toc-lassembleur"><span
class="toc-section-number">8</span> L’Assembleur</a>
<ul>
<li><a href="#où-en-sommes-nous-5" id="toc-où-en-sommes-nous-5"><span
class="toc-section-number">8.1</span> Où en sommes-nous ?</a></li>
<li><a href="#le-rôle-de-lassembleur"
id="toc-le-rôle-de-lassembleur"><span
class="toc-section-number">8.2</span> Le Rôle de l’Assembleur</a>
<ul>
<li><a href="#du-texte-au-binaire" id="toc-du-texte-au-binaire"><span
class="toc-section-number">8.2.1</span> Du texte au binaire</a></li>
<li><a href="#les-trois-tâches-de-lassembleur"
id="toc-les-trois-tâches-de-lassembleur"><span
class="toc-section-number">8.2.2</span> Les trois tâches de
l’assembleur</a></li>
</ul></li>
<li><a href="#la-stratégie-des-deux-passes"
id="toc-la-stratégie-des-deux-passes"><span
class="toc-section-number">8.3</span> La Stratégie des Deux Passes</a>
<ul>
<li><a href="#pourquoi-deux-passes" id="toc-pourquoi-deux-passes"><span
class="toc-section-number">8.3.1</span> Pourquoi deux passes ?</a></li>
<li><a href="#passe-1-construction-de-la-table-des-symboles"
id="toc-passe-1-construction-de-la-table-des-symboles"><span
class="toc-section-number">8.3.2</span> Passe 1 : Construction de la
Table des Symboles</a></li>
<li><a href="#passe-2-génération-du-code"
id="toc-passe-2-génération-du-code"><span
class="toc-section-number">8.3.3</span> Passe 2 : Génération du
Code</a></li>
</ul></li>
<li><a href="#sections-et-directives"
id="toc-sections-et-directives"><span
class="toc-section-number">8.4</span> Sections et Directives</a>
<ul>
<li><a href="#les-sections" id="toc-les-sections"><span
class="toc-section-number">8.4.1</span> Les Sections</a></li>
<li><a href="#les-directives" id="toc-les-directives"><span
class="toc-section-number">8.4.2</span> Les Directives</a></li>
</ul></li>
<li><a href="#exemple-dencodage" id="toc-exemple-dencodage"><span
class="toc-section-number">8.5</span> Exemple d’Encodage</a>
<ul>
<li><a href="#étape-1-identifier-linstruction"
id="toc-étape-1-identifier-linstruction"><span
class="toc-section-number">8.5.1</span> Étape 1 : Identifier
l’instruction</a></li>
<li><a href="#étape-2-déterminer-la-classe"
id="toc-étape-2-déterminer-la-classe"><span
class="toc-section-number">8.5.2</span> Étape 2 : Déterminer la
classe</a></li>
<li><a href="#étape-3-assembler-les-bits"
id="toc-étape-3-assembler-les-bits"><span
class="toc-section-number">8.5.3</span> Étape 3 : Assembler les
bits</a></li>
</ul></li>
<li><a href="#la-gestion-des-grandes-constantes"
id="toc-la-gestion-des-grandes-constantes"><span
class="toc-section-number">8.6</span> La Gestion des Grandes
Constantes</a>
<ul>
<li><a href="#le-problème-1" id="toc-le-problème-1"><span
class="toc-section-number">8.6.1</span> Le problème</a></li>
<li><a href="#la-solution-le-literal-pool"
id="toc-la-solution-le-literal-pool"><span
class="toc-section-number">8.6.2</span> La solution : Le Literal
Pool</a></li>
</ul></li>
<li><a href="#exercices-pratiques-5"
id="toc-exercices-pratiques-5"><span
class="toc-section-number">8.7</span> Exercices Pratiques</a>
<ul>
<li><a href="#exercices-sur-le-simulateur-web-5"
id="toc-exercices-sur-le-simulateur-web-5"><span
class="toc-section-number">8.7.1</span> Exercices sur le Simulateur
Web</a></li>
<li><a href="#exercice-manuel-encodage"
id="toc-exercice-manuel-encodage"><span
class="toc-section-number">8.7.2</span> Exercice manuel :
Encodage</a></li>
<li><a href="#exercice-table-des-symboles"
id="toc-exercice-table-des-symboles"><span
class="toc-section-number">8.7.3</span> Exercice : Table des
symboles</a></li>
<li><a href="#utilisation-de-loutil-cli"
id="toc-utilisation-de-loutil-cli"><span
class="toc-section-number">8.7.4</span> Utilisation de l’outil
CLI</a></li>
</ul></li>
<li><a href="#ce-quil-faut-retenir-5"
id="toc-ce-quil-faut-retenir-5"><span
class="toc-section-number">8.8</span> Ce qu’il faut retenir</a></li>
<li><a href="#auto-évaluation-5" id="toc-auto-évaluation-5"><span
class="toc-section-number">8.9</span> Auto-évaluation</a>
<ul>
<li><a href="#questions-de-compréhension-5"
id="toc-questions-de-compréhension-5"><span
class="toc-section-number">8.9.1</span> Questions de
compréhension</a></li>
<li><a href="#mini-défi-pratique-5" id="toc-mini-défi-pratique-5"><span
class="toc-section-number">8.9.2</span> Mini-défi pratique</a></li>
<li><a href="#checklist-de-validation-5"
id="toc-checklist-de-validation-5"><span
class="toc-section-number">8.9.3</span> Checklist de validation</a></li>
</ul></li>
</ul></li>
<li><a href="#construction-du-compilateur"
id="toc-construction-du-compilateur"><span
class="toc-section-number">9</span> Construction du Compilateur</a>
<ul>
<li><a href="#où-en-sommes-nous-6" id="toc-où-en-sommes-nous-6"><span
class="toc-section-number">9.1</span> Où en sommes-nous ?</a></li>
<li><a href="#le-rôle-du-compilateur"
id="toc-le-rôle-du-compilateur"><span
class="toc-section-number">9.2</span> Le Rôle du Compilateur</a>
<ul>
<li><a href="#pourquoi-un-compilateur"
id="toc-pourquoi-un-compilateur"><span
class="toc-section-number">9.2.1</span> Pourquoi un compilateur
?</a></li>
<li><a href="#les-étapes-de-compilation"
id="toc-les-étapes-de-compilation"><span
class="toc-section-number">9.2.2</span> Les étapes de
compilation</a></li>
</ul></li>
<li><a href="#les-phases-du-compilateur"
id="toc-les-phases-du-compilateur"><span
class="toc-section-number">9.3</span> Les Phases du Compilateur</a>
<ul>
<li><a href="#phase-1-lexer-analyse-lexicale"
id="toc-phase-1-lexer-analyse-lexicale"><span
class="toc-section-number">9.3.1</span> Phase 1 : Lexer (Analyse
Lexicale)</a></li>
<li><a href="#phase-2-parser-analyse-syntaxique"
id="toc-phase-2-parser-analyse-syntaxique"><span
class="toc-section-number">9.3.2</span> Phase 2 : Parser (Analyse
Syntaxique)</a></li>
<li><a href="#phase-3-génération-de-code"
id="toc-phase-3-génération-de-code"><span
class="toc-section-number">9.3.3</span> Phase 3 : Génération de
Code</a></li>
</ul></li>
<li><a href="#compilation-des-structures-de-contrôle"
id="toc-compilation-des-structures-de-contrôle"><span
class="toc-section-number">9.4</span> Compilation des Structures de
Contrôle</a>
<ul>
<li><a href="#variables-locales" id="toc-variables-locales"><span
class="toc-section-number">9.4.1</span> Variables locales</a></li>
<li><a href="#expressions" id="toc-expressions"><span
class="toc-section-number">9.4.2</span> Expressions</a></li>
<li><a href="#if-else" id="toc-if-else"><span
class="toc-section-number">9.4.3</span> If / Else</a></li>
<li><a href="#boucle-while" id="toc-boucle-while"><span
class="toc-section-number">9.4.4</span> Boucle While</a></li>
<li><a href="#boucle-for" id="toc-boucle-for"><span
class="toc-section-number">9.4.5</span> Boucle For</a></li>
</ul></li>
<li><a href="#compilation-des-fonctions"
id="toc-compilation-des-fonctions"><span
class="toc-section-number">9.5</span> Compilation des Fonctions</a>
<ul>
<li><a href="#convention-dappel" id="toc-convention-dappel"><span
class="toc-section-number">9.5.1</span> Convention d’appel</a></li>
<li><a href="#prologue-et-épilogue" id="toc-prologue-et-épilogue"><span
class="toc-section-number">9.5.2</span> Prologue et Épilogue</a></li>
<li><a href="#appel-de-fonction" id="toc-appel-de-fonction"><span
class="toc-section-number">9.5.3</span> Appel de fonction</a></li>
</ul></li>
<li><a href="#le-compilateur-c32" id="toc-le-compilateur-c32"><span
class="toc-section-number">9.6</span> Le Compilateur C32</a>
<ul>
<li><a href="#utilisation" id="toc-utilisation"><span
class="toc-section-number">9.6.1</span> Utilisation</a></li>
<li><a href="#exemple-complet" id="toc-exemple-complet"><span
class="toc-section-number">9.6.2</span> Exemple complet</a></li>
</ul></li>
<li><a href="#construisez-votre-propre-compilateur"
id="toc-construisez-votre-propre-compilateur"><span
class="toc-section-number">9.7</span> Construisez Votre Propre
Compilateur !</a>
<ul>
<li><a href="#phase-1-lexer-analyse-lexicale-1"
id="toc-phase-1-lexer-analyse-lexicale-1"><span
class="toc-section-number">9.7.1</span> Phase 1 : Lexer (Analyse
Lexicale)</a></li>
<li><a href="#phase-2-parser-analyse-syntaxique-1"
id="toc-phase-2-parser-analyse-syntaxique-1"><span
class="toc-section-number">9.7.2</span> Phase 2 : Parser (Analyse
Syntaxique)</a></li>
<li><a href="#phase-3-émission-asm-génération-de-code"
id="toc-phase-3-émission-asm-génération-de-code"><span
class="toc-section-number">9.7.3</span> Phase 3 : Émission ASM
(Génération de Code)</a></li>
<li><a href="#phase-4-codegen-expressions"
id="toc-phase-4-codegen-expressions"><span
class="toc-section-number">9.7.4</span> Phase 4 : CodeGen
Expressions</a></li>
<li><a href="#phase-5-structures-de-contrôle"
id="toc-phase-5-structures-de-contrôle"><span
class="toc-section-number">9.7.5</span> Phase 5 : Structures de
Contrôle</a></li>
<li><a href="#phase-6-fonctions" id="toc-phase-6-fonctions"><span
class="toc-section-number">9.7.6</span> Phase 6 : Fonctions</a></li>
<li><a href="#phase-7-projet-final" id="toc-phase-7-projet-final"><span
class="toc-section-number">9.7.7</span> Phase 7 : Projet Final</a></li>
<li><a href="#techniques-clés" id="toc-techniques-clés"><span
class="toc-section-number">9.7.8</span> Techniques Clés</a></li>
</ul></li>
<li><a href="#exercices-pratiques-6"
id="toc-exercices-pratiques-6"><span
class="toc-section-number">9.8</span> Exercices Pratiques</a>
<ul>
<li><a href="#exercices-sur-le-simulateur-web-6"
id="toc-exercices-sur-le-simulateur-web-6"><span
class="toc-section-number">9.8.1</span> Exercices sur le Simulateur
Web</a></li>
<li><a href="#exercice-traduire-manuellement"
id="toc-exercice-traduire-manuellement"><span
class="toc-section-number">9.8.2</span> Exercice : Traduire
manuellement</a></li>
</ul></li>
<li><a href="#ce-quil-faut-retenir-6"
id="toc-ce-quil-faut-retenir-6"><span
class="toc-section-number">9.9</span> Ce qu’il faut retenir</a></li>
<li><a href="#auto-évaluation-6" id="toc-auto-évaluation-6"><span
class="toc-section-number">9.10</span> Auto-évaluation</a>
<ul>
<li><a href="#questions-de-compréhension-6"
id="toc-questions-de-compréhension-6"><span
class="toc-section-number">9.10.1</span> Questions de
compréhension</a></li>
<li><a href="#mini-défi-pratique-6" id="toc-mini-défi-pratique-6"><span
class="toc-section-number">9.10.2</span> Mini-défi pratique</a></li>
<li><a href="#checklist-de-validation-6"
id="toc-checklist-de-validation-6"><span
class="toc-section-number">9.10.3</span> Checklist de
validation</a></li>
</ul></li>
</ul></li>
<li><a href="#langage-de-haut-niveau-c32"
id="toc-langage-de-haut-niveau-c32"><span
class="toc-section-number">10</span> Langage de Haut Niveau (C32)</a>
<ul>
<li><a href="#où-en-sommes-nous-7" id="toc-où-en-sommes-nous-7"><span
class="toc-section-number">10.1</span> Où en sommes-nous ?</a></li>
<li><a href="#pourquoi-un-langage-de-haut-niveau"
id="toc-pourquoi-un-langage-de-haut-niveau"><span
class="toc-section-number">10.2</span> Pourquoi un Langage de Haut
Niveau ?</a>
<ul>
<li><a href="#le-problème-de-lassembleur"
id="toc-le-problème-de-lassembleur"><span
class="toc-section-number">10.2.1</span> Le problème de
l’assembleur</a></li>
<li><a href="#labstraction" id="toc-labstraction"><span
class="toc-section-number">10.2.2</span> L’abstraction</a></li>
</ul></li>
<li><a href="#spécification-du-langage-c32"
id="toc-spécification-du-langage-c32"><span
class="toc-section-number">10.3</span> Spécification du Langage C32</a>
<ul>
<li><a href="#les-types-de-données" id="toc-les-types-de-données"><span
class="toc-section-number">10.3.1</span> Les Types de Données</a></li>
<li><a href="#variables" id="toc-variables"><span
class="toc-section-number">10.3.2</span> Variables</a></li>
<li><a href="#portée-des-variables" id="toc-portée-des-variables"><span
class="toc-section-number">10.3.3</span> Portée des variables</a></li>
</ul></li>
<li><a href="#opérateurs" id="toc-opérateurs"><span
class="toc-section-number">10.4</span> Opérateurs</a>
<ul>
<li><a href="#arithmétiques" id="toc-arithmétiques"><span
class="toc-section-number">10.4.1</span> Arithmétiques</a></li>
<li><a href="#comparaison" id="toc-comparaison"><span
class="toc-section-number">10.4.2</span> Comparaison</a></li>
<li><a href="#logiques" id="toc-logiques"><span
class="toc-section-number">10.4.3</span> Logiques</a></li>
<li><a href="#binaires" id="toc-binaires"><span
class="toc-section-number">10.4.4</span> Binaires</a></li>
</ul></li>
<li><a href="#structures-de-contrôle"
id="toc-structures-de-contrôle"><span
class="toc-section-number">10.5</span> Structures de Contrôle</a>
<ul>
<li><a href="#if-else-1" id="toc-if-else-1"><span
class="toc-section-number">10.5.1</span> If / Else</a></li>
<li><a href="#while" id="toc-while"><span
class="toc-section-number">10.5.2</span> While</a></li>
<li><a href="#for" id="toc-for"><span
class="toc-section-number">10.5.3</span> For</a></li>
<li><a href="#do-while" id="toc-do-while"><span
class="toc-section-number">10.5.4</span> Do-While</a></li>
</ul></li>
<li><a href="#fonctions" id="toc-fonctions"><span
class="toc-section-number">10.6</span> Fonctions</a>
<ul>
<li><a href="#définition" id="toc-définition"><span
class="toc-section-number">10.6.1</span> Définition</a></li>
<li><a href="#appel" id="toc-appel"><span
class="toc-section-number">10.6.2</span> Appel</a></li>
<li><a href="#récursion" id="toc-récursion"><span
class="toc-section-number">10.6.3</span> Récursion</a></li>
</ul></li>
<li><a href="#pointeurs-et-tableaux"
id="toc-pointeurs-et-tableaux"><span
class="toc-section-number">10.7</span> Pointeurs et Tableaux</a>
<ul>
<li><a href="#pointeurs" id="toc-pointeurs"><span
class="toc-section-number">10.7.1</span> Pointeurs</a></li>
<li><a href="#tableaux" id="toc-tableaux"><span
class="toc-section-number">10.7.2</span> Tableaux</a></li>
<li><a href="#lien-entre-pointeurs-et-tableaux"
id="toc-lien-entre-pointeurs-et-tableaux"><span
class="toc-section-number">10.7.3</span> Lien entre pointeurs et
tableaux</a></li>
</ul></li>
<li><a href="#accès-au-matériel-mmio"
id="toc-accès-au-matériel-mmio"><span
class="toc-section-number">10.8</span> Accès au Matériel (MMIO)</a>
<ul>
<li><a href="#lécran" id="toc-lécran"><span
class="toc-section-number">10.8.1</span> L’écran</a></li>
<li><a href="#le-clavier" id="toc-le-clavier"><span
class="toc-section-number">10.8.2</span> Le clavier</a></li>
</ul></li>
<li><a href="#exemple-complet-1" id="toc-exemple-complet-1"><span
class="toc-section-number">10.9</span> Exemple Complet</a></li>
<li><a href="#exercices-pratiques-7"
id="toc-exercices-pratiques-7"><span
class="toc-section-number">10.10</span> Exercices Pratiques</a>
<ul>
<li><a href="#exercices-sur-le-simulateur-web-7"
id="toc-exercices-sur-le-simulateur-web-7"><span
class="toc-section-number">10.10.1</span> Exercices sur le Simulateur
Web</a></li>
<li><a href="#défis-suggérés" id="toc-défis-suggérés"><span
class="toc-section-number">10.10.2</span> Défis suggérés</a></li>
</ul></li>
<li><a href="#les-structures-structs"
id="toc-les-structures-structs"><span
class="toc-section-number">10.11</span> Les Structures (Structs)</a>
<ul>
<li><a href="#définition-dune-structure"
id="toc-définition-dune-structure"><span
class="toc-section-number">10.11.1</span> Définition d’une
structure</a></li>
<li><a href="#utilisation-1" id="toc-utilisation-1"><span
class="toc-section-number">10.11.2</span> Utilisation</a></li>
<li><a href="#pointeur-vers-structure"
id="toc-pointeur-vers-structure"><span
class="toc-section-number">10.11.3</span> Pointeur vers
structure</a></li>
<li><a href="#exemple-complet-2" id="toc-exemple-complet-2"><span
class="toc-section-number">10.11.4</span> Exemple complet</a></li>
<li><a href="#structures-imbriquées"
id="toc-structures-imbriquées"><span
class="toc-section-number">10.11.5</span> Structures imbriquées</a></li>
</ul></li>
<li><a href="#limitations-du-c32" id="toc-limitations-du-c32"><span
class="toc-section-number">10.12</span> Limitations du C32</a></li>
<li><a href="#ce-quil-faut-retenir-7"
id="toc-ce-quil-faut-retenir-7"><span
class="toc-section-number">10.13</span> Ce qu’il faut retenir</a></li>
<li><a href="#auto-évaluation-7" id="toc-auto-évaluation-7"><span
class="toc-section-number">10.14</span> Auto-évaluation</a>
<ul>
<li><a href="#questions-de-compréhension-7"
id="toc-questions-de-compréhension-7"><span
class="toc-section-number">10.14.1</span> Questions de
compréhension</a></li>
<li><a href="#mini-défi-pratique-7" id="toc-mini-défi-pratique-7"><span
class="toc-section-number">10.14.2</span> Mini-défi pratique</a></li>
<li><a href="#checklist-de-validation-7"
id="toc-checklist-de-validation-7"><span
class="toc-section-number">10.14.3</span> Checklist de
validation</a></li>
</ul></li>
</ul></li>
<li><a href="#système-dexploitation"
id="toc-système-dexploitation"><span
class="toc-section-number">11</span> Système d’Exploitation</a>
<ul>
<li><a href="#où-en-sommes-nous-8" id="toc-où-en-sommes-nous-8"><span
class="toc-section-number">11.1</span> Où en sommes-nous ?</a></li>
<li><a href="#quest-ce-quun-système-dexploitation"
id="toc-quest-ce-quun-système-dexploitation"><span
class="toc-section-number">11.2</span> Qu’est-ce qu’un Système
d’Exploitation ?</a>
<ul>
<li><a href="#la-hiérarchie-logicielle"
id="toc-la-hiérarchie-logicielle"><span
class="toc-section-number">11.2.1</span> La hiérarchie
logicielle</a></li>
<li><a href="#ce-que-fait-un-os" id="toc-ce-que-fait-un-os"><span
class="toc-section-number">11.2.2</span> Ce que fait un OS</a></li>
</ul></li>
<li><a href="#gestion-de-la-mémoire-le-tas-heap"
id="toc-gestion-de-la-mémoire-le-tas-heap"><span
class="toc-section-number">11.3</span> Gestion de la Mémoire (Le Tas /
Heap)</a>
<ul>
<li><a href="#le-problème-2" id="toc-le-problème-2"><span
class="toc-section-number">11.3.1</span> Le problème</a></li>
<li><a href="#lallocateur-bump-simple"
id="toc-lallocateur-bump-simple"><span
class="toc-section-number">11.3.2</span> L’allocateur “Bump”
(Simple)</a></li>
<li><a href="#lallocateur-par-liste-chaînée-avancé"
id="toc-lallocateur-par-liste-chaînée-avancé"><span
class="toc-section-number">11.3.3</span> L’allocateur par Liste Chaînée
(Avancé)</a></li>
</ul></li>
<li><a href="#bibliothèque-graphique"
id="toc-bibliothèque-graphique"><span
class="toc-section-number">11.4</span> Bibliothèque Graphique</a>
<ul>
<li><a href="#le-problème-3" id="toc-le-problème-3"><span
class="toc-section-number">11.4.1</span> Le problème</a></li>
<li><a href="#les-fonctions-graphiques"
id="toc-les-fonctions-graphiques"><span
class="toc-section-number">11.4.2</span> Les fonctions
graphiques</a></li>
<li><a href="#lalgorithme-de-bresenham"
id="toc-lalgorithme-de-bresenham"><span
class="toc-section-number">11.4.3</span> L’algorithme de
Bresenham</a></li>
</ul></li>
<li><a href="#entrées-sorties" id="toc-entrées-sorties"><span
class="toc-section-number">11.5</span> Entrées / Sorties</a>
<ul>
<li><a href="#printf-simplifié" id="toc-printf-simplifié"><span
class="toc-section-number">11.5.1</span> Printf simplifié</a></li>
<li><a href="#lecture-du-clavier" id="toc-lecture-du-clavier"><span
class="toc-section-number">11.5.2</span> Lecture du clavier</a></li>
</ul></li>
<li><a href="#interruptions-et-timer-concepts"
id="toc-interruptions-et-timer-concepts"><span
class="toc-section-number">11.6</span> Interruptions et Timer
(Concepts)</a>
<ul>
<li><a href="#le-problème-du-polling"
id="toc-le-problème-du-polling"><span
class="toc-section-number">11.6.1</span> Le problème du polling</a></li>
<li><a href="#les-interruptions" id="toc-les-interruptions"><span
class="toc-section-number">11.6.2</span> Les interruptions</a></li>
</ul></li>
<li><a href="#applications-démo" id="toc-applications-démo"><span
class="toc-section-number">11.7</span> Applications Démo</a>
<ul>
<li><a href="#compiler-et-exécuter-une-démo"
id="toc-compiler-et-exécuter-une-démo"><span
class="toc-section-number">11.7.1</span> Compiler et exécuter une
démo</a></li>
</ul></li>
<li><a href="#exercices-pratiques-8"
id="toc-exercices-pratiques-8"><span
class="toc-section-number">11.8</span> Exercices Pratiques</a>
<ul>
<li><a href="#exercices-sur-le-simulateur-web-8"
id="toc-exercices-sur-le-simulateur-web-8"><span
class="toc-section-number">11.8.1</span> Exercices sur le Simulateur
Web</a></li>
<li><a href="#défis-suggérés-1" id="toc-défis-suggérés-1"><span
class="toc-section-number">11.8.2</span> Défis suggérés</a></li>
</ul></li>
<li><a href="#le-parcours-complet-1"
id="toc-le-parcours-complet-1"><span
class="toc-section-number">11.9</span> Le Parcours Complet</a></li>
<li><a href="#ce-quil-faut-retenir-8"
id="toc-ce-quil-faut-retenir-8"><span
class="toc-section-number">11.10</span> Ce qu’il faut retenir</a></li>
<li><a href="#félicitations" id="toc-félicitations"><span
class="toc-section-number">11.11</span> Félicitations !</a></li>
<li><a href="#auto-évaluation-8" id="toc-auto-évaluation-8"><span
class="toc-section-number">11.12</span> Auto-évaluation</a>
<ul>
<li><a href="#questions-de-compréhension-8"
id="toc-questions-de-compréhension-8"><span
class="toc-section-number">11.12.1</span> Questions de
compréhension</a></li>
<li><a href="#réflexion-finale" id="toc-réflexion-finale"><span
class="toc-section-number">11.12.2</span> Réflexion finale</a></li>
<li><a href="#checklist-de-validation-finale"
id="toc-checklist-de-validation-finale"><span
class="toc-section-number">11.12.3</span> Checklist de validation
finale</a></li>
</ul></li>
</ul></li>
<li><a href="#annexe-tous-les-exercices"
id="toc-annexe-tous-les-exercices"><span
class="toc-section-number">12</span> Annexe : Tous les Exercices</a>
<ul>
<li><a href="#a.-exercices-hdl-portes-logiques"
id="toc-a.-exercices-hdl-portes-logiques"><span
class="toc-section-number">12.1</span> A. Exercices HDL (Portes
Logiques)</a>
<ul>
<li><a href="#projet-1-portes-de-base"
id="toc-projet-1-portes-de-base"><span
class="toc-section-number">12.1.1</span> Projet 1 : Portes de
Base</a></li>
<li><a href="#projet-2-arithmetique"
id="toc-projet-2-arithmetique"><span
class="toc-section-number">12.1.2</span> Projet 2 :
Arithmetique</a></li>
<li><a href="#projet-3-memoire" id="toc-projet-3-memoire"><span
class="toc-section-number">12.1.3</span> Projet 3 : Memoire</a></li>
<li><a href="#projet-5-cpu" id="toc-projet-5-cpu"><span
class="toc-section-number">12.1.4</span> Projet 5 : CPU</a></li>
<li><a href="#projet-6-cpu-pipeline-avance"
id="toc-projet-6-cpu-pipeline-avance"><span
class="toc-section-number">12.1.5</span> Projet 6 : CPU Pipeline
(Avance)</a></li>
<li><a href="#projet-7-cache-l1" id="toc-projet-7-cache-l1"><span
class="toc-section-number">12.1.6</span> Projet 7 : Cache L1</a></li>
</ul></li>
<li><a href="#b.-exercices-assembleur-a32"
id="toc-b.-exercices-assembleur-a32"><span
class="toc-section-number">12.2</span> B. Exercices Assembleur A32</a>
<ul>
<li><a href="#bases" id="toc-bases"><span
class="toc-section-number">12.2.1</span> Bases</a></li>
<li><a href="#controle-de-flux" id="toc-controle-de-flux"><span
class="toc-section-number">12.2.2</span> Controle de Flux</a></li>
<li><a href="#memoire" id="toc-memoire"><span
class="toc-section-number">12.2.3</span> Memoire</a></li>
<li><a href="#structures" id="toc-structures"><span
class="toc-section-number">12.2.4</span> Structures</a></li>
<li><a href="#fonctions-1" id="toc-fonctions-1"><span
class="toc-section-number">12.2.5</span> Fonctions</a></li>
<li><a href="#entreessorties" id="toc-entreessorties"><span
class="toc-section-number">12.2.6</span> Entrees/Sorties</a></li>
<li><a href="#ecran-320x240-1-bitpixel"
id="toc-ecran-320x240-1-bitpixel"><span
class="toc-section-number">12.2.7</span> Ecran (320x240, 1
bit/pixel)</a></li>
<li><a href="#jeux-interactifs" id="toc-jeux-interactifs"><span
class="toc-section-number">12.2.8</span> Jeux Interactifs</a></li>
<li><a href="#cache-patterns-dacces-memoire"
id="toc-cache-patterns-dacces-memoire"><span
class="toc-section-number">12.2.9</span> Cache (Patterns d’Acces
Memoire)</a></li>
</ul></li>
<li><a href="#c.-exercices-c32" id="toc-c.-exercices-c32"><span
class="toc-section-number">12.3</span> C. Exercices C32</a>
<ul>
<li><a href="#bases-1" id="toc-bases-1"><span
class="toc-section-number">12.3.1</span> Bases</a></li>
<li><a href="#conditions" id="toc-conditions"><span
class="toc-section-number">12.3.2</span> Conditions</a></li>
<li><a href="#boucles" id="toc-boucles"><span
class="toc-section-number">12.3.3</span> Boucles</a></li>
<li><a href="#fonctions-2" id="toc-fonctions-2"><span
class="toc-section-number">12.3.4</span> Fonctions</a></li>
<li><a href="#tableaux-1" id="toc-tableaux-1"><span
class="toc-section-number">12.3.5</span> Tableaux</a></li>
<li><a href="#pointeurs-1" id="toc-pointeurs-1"><span
class="toc-section-number">12.3.6</span> Pointeurs</a></li>
<li><a href="#operations-binaires" id="toc-operations-binaires"><span
class="toc-section-number">12.3.7</span> Operations Binaires</a></li>
<li><a href="#recursion" id="toc-recursion"><span
class="toc-section-number">12.3.8</span> Recursion</a></li>
<li><a href="#algorithmes-avances" id="toc-algorithmes-avances"><span
class="toc-section-number">12.3.9</span> Algorithmes Avances</a></li>
<li><a href="#structures-1" id="toc-structures-1"><span
class="toc-section-number">12.3.10</span> Structures</a></li>
<li><a href="#cache-patterns-dacces-memoire-1"
id="toc-cache-patterns-dacces-memoire-1"><span
class="toc-section-number">12.3.11</span> Cache (Patterns d’Acces
Memoire)</a></li>
<li><a href="#entreessorties-1" id="toc-entreessorties-1"><span
class="toc-section-number">12.3.12</span> Entrees/Sorties</a></li>
<li><a href="#projets-avances" id="toc-projets-avances"><span
class="toc-section-number">12.3.13</span> Projets Avances</a></li>
</ul></li>
<li><a href="#d.-construction-du-compilateur"
id="toc-d.-construction-du-compilateur"><span
class="toc-section-number">12.4</span> D. Construction du
Compilateur</a>
<ul>
<li><a href="#phase-1-lexer" id="toc-phase-1-lexer"><span
class="toc-section-number">12.4.1</span> Phase 1 : Lexer</a></li>
<li><a href="#phase-2-parser" id="toc-phase-2-parser"><span
class="toc-section-number">12.4.2</span> Phase 2 : Parser</a></li>
<li><a href="#phase-3-emission-asm" id="toc-phase-3-emission-asm"><span
class="toc-section-number">12.4.3</span> Phase 3 : Emission ASM</a></li>
<li><a href="#phase-4-codegen-expressions-1"
id="toc-phase-4-codegen-expressions-1"><span
class="toc-section-number">12.4.4</span> Phase 4 : CodeGen
Expressions</a></li>
<li><a href="#phase-5-structures-de-controle"
id="toc-phase-5-structures-de-controle"><span
class="toc-section-number">12.4.5</span> Phase 5 : Structures de
Controle</a></li>
<li><a href="#phase-6-fonctions-1" id="toc-phase-6-fonctions-1"><span
class="toc-section-number">12.4.6</span> Phase 6 : Fonctions</a></li>
<li><a href="#phase-7-projet-final-1"
id="toc-phase-7-projet-final-1"><span
class="toc-section-number">12.4.7</span> Phase 7 : Projet Final</a></li>
</ul></li>
<li><a href="#e.-systeme-dexploitation"
id="toc-e.-systeme-dexploitation"><span
class="toc-section-number">12.5</span> E. Systeme d’Exploitation</a>
<ul>
<li><a href="#initialisation" id="toc-initialisation"><span
class="toc-section-number">12.5.1</span> Initialisation</a></li>
<li><a href="#gestion-memoire" id="toc-gestion-memoire"><span
class="toc-section-number">12.5.2</span> Gestion Memoire</a></li>
<li><a href="#drivers" id="toc-drivers"><span
class="toc-section-number">12.5.3</span> Drivers</a></li>
<li><a href="#console-et-clavier" id="toc-console-et-clavier"><span
class="toc-section-number">12.5.4</span> Console et Clavier</a></li>
<li><a href="#shell-et-applications"
id="toc-shell-et-applications"><span
class="toc-section-number">12.5.5</span> Shell et Applications</a></li>
<li><a href="#multitache" id="toc-multitache"><span
class="toc-section-number">12.5.6</span> Multitache</a></li>
<li><a href="#projets-os" id="toc-projets-os"><span
class="toc-section-number">12.5.7</span> Projets OS</a></li>
</ul></li>
<li><a href="#conseils-pour-les-exercices"
id="toc-conseils-pour-les-exercices"><span
class="toc-section-number">12.6</span> Conseils pour les
Exercices</a></li>
</ul></li>
<li><a href="#lart-du-débogage" id="toc-lart-du-débogage"><span
class="toc-section-number">13</span> L’Art du Débogage</a>
<ul>
<li><a href="#pourquoi-ce-chapitre" id="toc-pourquoi-ce-chapitre"><span
class="toc-section-number">13.1</span> Pourquoi ce Chapitre ?</a></li>
<li><a href="#comprendre-les-messages-derreur"
id="toc-comprendre-les-messages-derreur"><span
class="toc-section-number">13.2</span> 1. Comprendre les Messages
d’Erreur</a>
<ul>
<li><a href="#codes-derreur-du-projet-codex"
id="toc-codes-derreur-du-projet-codex"><span
class="toc-section-number">13.2.1</span> Codes d’Erreur du Projet
Codex</a></li>
<li><a href="#erreurs-dassemblage-e1xxx"
id="toc-erreurs-dassemblage-e1xxx"><span
class="toc-section-number">13.2.2</span> Erreurs d’Assemblage
(E1xxx)</a></li>
<li><a href="#erreurs-de-compilation-e2xxx"
id="toc-erreurs-de-compilation-e2xxx"><span
class="toc-section-number">13.2.3</span> Erreurs de Compilation
(E2xxx)</a></li>
<li><a href="#erreurs-de-liaison-e3xxx"
id="toc-erreurs-de-liaison-e3xxx"><span
class="toc-section-number">13.2.4</span> Erreurs de Liaison
(E3xxx)</a></li>
</ul></li>
<li><a href="#utiliser-le-simulateur-pas-à-pas"
id="toc-utiliser-le-simulateur-pas-à-pas"><span
class="toc-section-number">13.3</span> 2. Utiliser le Simulateur
Pas-à-Pas</a>
<ul>
<li><a href="#le-visualiseur-cpu" id="toc-le-visualiseur-cpu"><span
class="toc-section-number">13.3.1</span> Le Visualiseur CPU</a></li>
<li><a href="#méthodologie-de-débogage-pas-à-pas"
id="toc-méthodologie-de-débogage-pas-à-pas"><span
class="toc-section-number">13.3.2</span> Méthodologie de Débogage
Pas-à-Pas</a></li>
<li><a href="#exemple-pratique" id="toc-exemple-pratique"><span
class="toc-section-number">13.3.3</span> Exemple Pratique</a></li>
</ul></li>
<li><a href="#erreurs-courantes-et-solutions"
id="toc-erreurs-courantes-et-solutions"><span
class="toc-section-number">13.4</span> 3. Erreurs Courantes et
Solutions</a>
<ul>
<li><a href="#assembleur" id="toc-assembleur"><span
class="toc-section-number">13.4.1</span> 3.1 Assembleur</a></li>
<li><a href="#compilateur-c32" id="toc-compilateur-c32"><span
class="toc-section-number">13.4.2</span> 3.2 Compilateur C32</a></li>
<li><a href="#hdl" id="toc-hdl"><span
class="toc-section-number">13.4.3</span> 3.3 HDL</a></li>
</ul></li>
<li><a href="#méthodologie-systématique"
id="toc-méthodologie-systématique"><span
class="toc-section-number">13.5</span> 4. Méthodologie Systématique</a>
<ul>
<li><a href="#la-méthode-scientifique-du-débogage"
id="toc-la-méthode-scientifique-du-débogage"><span
class="toc-section-number">13.5.1</span> La Méthode Scientifique du
Débogage</a></li>
<li><a href="#la-technique-de-la-bissection"
id="toc-la-technique-de-la-bissection"><span
class="toc-section-number">13.5.2</span> La Technique de la
Bissection</a></li>
<li><a href="#ajouter-des-traces" id="toc-ajouter-des-traces"><span
class="toc-section-number">13.5.3</span> Ajouter des Traces</a></li>
</ul></li>
<li><a href="#erreurs-de-traps-et-leur-diagnostic"
id="toc-erreurs-de-traps-et-leur-diagnostic"><span
class="toc-section-number">13.6</span> 5. Erreurs de Traps et leur
Diagnostic</a>
<ul>
<li><a href="#types-de-traps" id="toc-types-de-traps"><span
class="toc-section-number">13.6.1</span> Types de Traps</a></li>
<li><a href="#déboguer-un-mem_fault"
id="toc-déboguer-un-mem_fault"><span
class="toc-section-number">13.6.2</span> Déboguer un MEM_FAULT</a></li>
</ul></li>
<li><a href="#checklist-de-débogage"
id="toc-checklist-de-débogage"><span
class="toc-section-number">13.7</span> 6. Checklist de Débogage</a>
<ul>
<li><a href="#assembleur-1" id="toc-assembleur-1"><span
class="toc-section-number">13.7.1</span> Assembleur</a></li>
<li><a href="#c32" id="toc-c32"><span
class="toc-section-number">13.7.2</span> C32</a></li>
<li><a href="#hdl-1" id="toc-hdl-1"><span
class="toc-section-number">13.7.3</span> HDL</a></li>
</ul></li>
<li><a href="#exercices-de-débogage"
id="toc-exercices-de-débogage"><span
class="toc-section-number">13.8</span> 7. Exercices de Débogage</a>
<ul>
<li><a href="#exercice-1-trouvez-le-bug"
id="toc-exercice-1-trouvez-le-bug"><span
class="toc-section-number">13.8.1</span> Exercice 1 : Trouvez le
bug</a></li>
<li><a href="#exercice-2-trouvez-le-bug"
id="toc-exercice-2-trouvez-le-bug"><span
class="toc-section-number">13.8.2</span> Exercice 2 : Trouvez le
bug</a></li>
<li><a href="#exercice-3-trouvez-le-bug"
id="toc-exercice-3-trouvez-le-bug"><span
class="toc-section-number">13.8.3</span> Exercice 3 : Trouvez le
bug</a></li>
</ul></li>
<li><a href="#ce-quil-faut-retenir-9"
id="toc-ce-quil-faut-retenir-9"><span
class="toc-section-number">13.9</span> Ce qu’il faut retenir</a></li>
</ul></li>
<li><a href="#le-cache-pourquoi-votre-ordinateur-semble-rapide"
id="toc-le-cache-pourquoi-votre-ordinateur-semble-rapide"><span
class="toc-section-number">14</span> Le Cache : Pourquoi Votre
Ordinateur Semble Rapide</a>
<ul>
<li><a href="#le-problème-la-ram-est-lente"
id="toc-le-problème-la-ram-est-lente"><span
class="toc-section-number">14.1</span> Le Problème : La RAM est Lente
!</a>
<ul>
<li><a href="#la-hiérarchie-mémoire"
id="toc-la-hiérarchie-mémoire"><span
class="toc-section-number">14.1.1</span> La Hiérarchie Mémoire</a></li>
<li><a href="#lécart-de-vitesse-visualisé"
id="toc-lécart-de-vitesse-visualisé"><span
class="toc-section-number">14.1.2</span> L’écart de vitesse
visualisé</a></li>
</ul></li>
<li><a href="#la-solution-le-principe-de-localité"
id="toc-la-solution-le-principe-de-localité"><span
class="toc-section-number">14.2</span> La Solution : Le Principe de
Localité</a>
<ul>
<li><a href="#localité-temporelle" id="toc-localité-temporelle"><span
class="toc-section-number">14.2.1</span> Localité Temporelle</a></li>
<li><a href="#localité-spatiale" id="toc-localité-spatiale"><span
class="toc-section-number">14.2.2</span> Localité Spatiale</a></li>
</ul></li>
<li><a href="#comment-fonctionne-le-cache"
id="toc-comment-fonctionne-le-cache"><span
class="toc-section-number">14.3</span> Comment Fonctionne le Cache ?</a>
<ul>
<li><a href="#les-lignes-de-cache" id="toc-les-lignes-de-cache"><span
class="toc-section-number">14.3.1</span> Les Lignes de Cache</a></li>
<li><a href="#structure-dune-ligne-de-cache"
id="toc-structure-dune-ligne-de-cache"><span
class="toc-section-number">14.3.2</span> Structure d’une Ligne de
Cache</a></li>
<li><a href="#découpage-dune-adresse"
id="toc-découpage-dune-adresse"><span
class="toc-section-number">14.3.3</span> Découpage d’une
Adresse</a></li>
<li><a href="#structure-complète-du-cache"
id="toc-structure-complète-du-cache"><span
class="toc-section-number">14.3.4</span> Structure Complète du
Cache</a></li>
</ul></li>
<li><a href="#hit-ou-miss-que-se-passe-t-il"
id="toc-hit-ou-miss-que-se-passe-t-il"><span
class="toc-section-number">14.4</span> Hit ou Miss : Que se passe-t-il
?</a>
<ul>
<li><a href="#scénario-1-cache-hit-succès"
id="toc-scénario-1-cache-hit-succès"><span
class="toc-section-number">14.4.1</span> Scénario 1 : Cache HIT
(Succès)</a></li>
<li><a href="#scénario-2-cache-miss-échec"
id="toc-scénario-2-cache-miss-échec"><span
class="toc-section-number">14.4.2</span> Scénario 2 : Cache MISS
(Échec)</a></li>
<li><a href="#diagramme-de-flux-complet"
id="toc-diagramme-de-flux-complet"><span
class="toc-section-number">14.4.3</span> Diagramme de Flux
Complet</a></li>
</ul></li>
<li><a href="#politiques-décriture" id="toc-politiques-décriture"><span
class="toc-section-number">14.5</span> Politiques d’Écriture</a>
<ul>
<li><a href="#write-through-écriture-directe"
id="toc-write-through-écriture-directe"><span
class="toc-section-number">14.5.1</span> Write-Through (Écriture
Directe)</a></li>
<li><a href="#write-back-écriture-différée"
id="toc-write-back-écriture-différée"><span
class="toc-section-number">14.5.2</span> Write-Back (Écriture
Différée)</a></li>
</ul></li>
<li><a href="#impact-sur-vos-programmes"
id="toc-impact-sur-vos-programmes"><span
class="toc-section-number">14.6</span> Impact sur vos Programmes</a>
<ul>
<li><a href="#parcours-de-tableaux-2d-lordre-compte"
id="toc-parcours-de-tableaux-2d-lordre-compte"><span
class="toc-section-number">14.6.1</span> Parcours de Tableaux 2D :
L’Ordre Compte !</a></li>
<li><a href="#parcours-row-major-en-ligne---efficace"
id="toc-parcours-row-major-en-ligne---efficace"><span
class="toc-section-number">14.6.2</span> Parcours Row-Major (En Ligne) -
EFFICACE</a></li>
<li><a href="#parcours-column-major-en-colonne---inefficace"
id="toc-parcours-column-major-en-colonne---inefficace"><span
class="toc-section-number">14.6.3</span> Parcours Column-Major (En
Colonne) - INEFFICACE</a></li>
<li><a href="#comparaison-visuelle" id="toc-comparaison-visuelle"><span
class="toc-section-number">14.6.4</span> Comparaison Visuelle</a></li>
<li><a href="#technique-du-blocking"
id="toc-technique-du-blocking"><span
class="toc-section-number">14.6.5</span> Technique du Blocking</a></li>
</ul></li>
<li><a href="#implémentation-hdl-du-cache"
id="toc-implémentation-hdl-du-cache"><span
class="toc-section-number">14.7</span> Implémentation HDL du Cache</a>
<ul>
<li><a href="#architecture-globale" id="toc-architecture-globale"><span
class="toc-section-number">14.7.1</span> Architecture Globale</a></li>
<li><a href="#machine-à-états-du-contrôleur"
id="toc-machine-à-états-du-contrôleur"><span
class="toc-section-number">14.7.2</span> Machine à États du
Contrôleur</a></li>
<li><a href="#wordselect-sélection-du-mot"
id="toc-wordselect-sélection-du-mot"><span
class="toc-section-number">14.7.3</span> WordSelect : Sélection du
Mot</a></li>
</ul></li>
<li><a href="#statistiques-et-performance"
id="toc-statistiques-et-performance"><span
class="toc-section-number">14.8</span> Statistiques et Performance</a>
<ul>
<li><a href="#calcul-du-hit-rate" id="toc-calcul-du-hit-rate"><span
class="toc-section-number">14.8.1</span> Calcul du Hit Rate</a></li>
</ul></li>
<li><a href="#visualiser-le-cache-avec-le-cpu-visualizer"
id="toc-visualiser-le-cache-avec-le-cpu-visualizer"><span
class="toc-section-number">14.9</span> Visualiser le Cache avec le CPU
Visualizer</a>
<ul>
<li><a href="#accéder-au-visualizer-1"
id="toc-accéder-au-visualizer-1"><span
class="toc-section-number">14.9.1</span> Accéder au Visualizer</a></li>
<li><a href="#la-démo-cache" id="toc-la-démo-cache"><span
class="toc-section-number">14.9.2</span> La Démo “Cache”</a></li>
<li><a href="#ce-que-vous-verrez" id="toc-ce-que-vous-verrez"><span
class="toc-section-number">14.9.3</span> Ce que vous verrez</a></li>
<li><a href="#exercice-pratique-1" id="toc-exercice-pratique-1"><span
class="toc-section-number">14.9.4</span> Exercice Pratique</a></li>
</ul></li>
<li><a href="#exercices" id="toc-exercices"><span
class="toc-section-number">14.10</span> Exercices</a>
<ul>
<li><a href="#exercices-hdl" id="toc-exercices-hdl"><span
class="toc-section-number">14.10.1</span> Exercices HDL</a></li>
<li><a href="#exercices-assembleur-a32"
id="toc-exercices-assembleur-a32"><span
class="toc-section-number">14.10.2</span> Exercices Assembleur
A32</a></li>
<li><a href="#exercices-c32" id="toc-exercices-c32"><span
class="toc-section-number">14.10.3</span> Exercices C32</a></li>
</ul></li>
<li><a href="#résumé-visuel" id="toc-résumé-visuel"><span
class="toc-section-number">14.11</span> Résumé Visuel</a></li>
<li><a href="#points-clés-à-retenir"
id="toc-points-clés-à-retenir"><span
class="toc-section-number">14.12</span> Points Clés à Retenir</a></li>
<li><a href="#auto-évaluation-9" id="toc-auto-évaluation-9"><span
class="toc-section-number">14.13</span> Auto-évaluation</a>
<ul>
<li><a href="#questions-de-compréhension-9"
id="toc-questions-de-compréhension-9"><span
class="toc-section-number">14.13.1</span> Questions de
compréhension</a></li>
<li><a href="#mini-défi-pratique-8" id="toc-mini-défi-pratique-8"><span
class="toc-section-number">14.13.2</span> Mini-défi pratique</a></li>
<li><a href="#checklist-de-validation-8"
id="toc-checklist-de-validation-8"><span
class="toc-section-number">14.13.3</span> Checklist de
validation</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
<h1 data-number="1" id="larchitecture-codex-guide-de-létudiant"><span
class="header-section-number">1</span> L’Architecture Codex : Guide de
l’Étudiant</h1>
<p>Ce livre vous guide pas à pas dans la construction d’un ordinateur
complet, moderne et 32-bits, à partir de rien : des portes logiques
jusqu’au système d’exploitation.</p>
<h2 data-number="1.1" id="table-des-matières"><span
class="header-section-number">1.1</span> Table des Matières</h2>
<ol type="1">
<li><strong><a href="00_introduction.md">Introduction</a></strong>
<ul>
<li>La philosophie du projet.</li>
<li>L’architecture Codex A32.</li>
<li>Présentation des outils.</li>
</ul></li>
<li><strong><a href="01_logique_booleenne.md">Chapitre 1 : Logique
Booléenne</a></strong>
<ul>
<li>L’abstraction binaire.</li>
<li>Les portes logiques fondamentales (Nand, And, Or, Xor).</li>
<li><em>Exercices :</em> Implémentation dans
<code>hdl_lib/01_gates</code>.</li>
</ul></li>
<li><strong><a href="02_arithmetique.md">Chapitre 2 : Arithmétique
Binaire</a></strong> <em>(À venir)</em>
<ul>
<li>Représentation des nombres (Complément à 2).</li>
<li>Additionneurs et ALU (Arithmetic Logic Unit).</li>
<li><em>Exercices :</em> <code>hdl_lib/03_arith</code>.</li>
</ul></li>
<li><strong><a href="03_memoire.md">Chapitre 3 : Logique Séquentielle et
Mémoire</a></strong> <em>(À venir)</em>
<ul>
<li>Le temps et l’horloge.</li>
<li>Flip-Flops, Registres et RAM.</li>
<li><em>Exercices :</em> <code>hdl_lib/04_seq</code> &amp;
<code>02_multibit</code>.</li>
</ul></li>
<li><strong><a href="04_architecture.md">Chapitre 4 : Architecture
Machine (ISA A32)</a></strong> <em>(À venir)</em>
<ul>
<li>Le jeu d’instructions A32-Lite.</li>
<li>Registres, adressage et structure.</li>
<li><em>Référence :</em> <code>SPECS.md</code>.</li>
</ul></li>
<li><strong><a href="05_cpu.md">Chapitre 5 : Le Processeur
(CPU)</a></strong> <em>(À venir)</em>
<ul>
<li>Implémentation du chemin de données (Data Path).</li>
<li>Logique de contrôle.</li>
<li><em>Exercices :</em> <code>hdl_lib/05_cpu</code>.</li>
</ul></li>
<li><strong><a href="06_assembleur.md">Chapitre 6 :
L’Assembleur</a></strong> <em>(À venir)</em>
<ul>
<li>Traduction symbolique vers binaire.</li>
<li>Gestion des symboles et des labels.</li>
<li><em>Outils :</em> <code>a32_asm</code>.</li>
</ul></li>
<li><strong><a href="07_compilateur.md">Chapitre 7 : Construction du
Compilateur</a></strong> <em>(À venir)</em>
<ul>
<li>Analyse lexicale et syntaxique (Parsing).</li>
<li>Génération de code pour pile.</li>
<li><em>Outils :</em> <code>c32_cli</code>.</li>
</ul></li>
<li><strong><a href="08_langage.md">Chapitre 8 : Langage de Haut Niveau
(C32)</a></strong> <em>(À venir)</em>
<ul>
<li>Syntaxe du langage C32.</li>
<li>Structures de contrôle et types.</li>
</ul></li>
<li><strong><a href="09_os.md">Chapitre 9 : Système
d’Exploitation</a></strong> <em>(À venir)</em>
<ul>
<li>Gestion de la mémoire (Heap).</li>
<li>Entrées/Sorties (Clavier, Écran).</li>
<li><em>Exercices :</em> <code>os_lib</code>.</li>
</ul></li>
</ol>
<h2 data-number="1.2" id="comment-utiliser-ce-guide"><span
class="header-section-number">1.2</span> Comment utiliser ce guide</h2>
<p>Chaque chapitre commence par une <strong>Théorie</strong>, expliquant
les concepts fondamentaux. Ensuite, la section
<strong>Implémentation</strong> détaille ce que vous devez construire,
en faisant référence aux dossiers du projet.</p>
<blockquote>
<p><strong>Note :</strong> Ce projet utilise Rust pour l’outillage, mais
votre travail consistera principalement à écrire du HDL (Hardware
Description Language), de l’assembleur A32 et du C32.</p>
</blockquote>
<h1 data-number="2" id="introduction"><span
class="header-section-number">2</span> Introduction</h1>
<p>Bienvenue dans le projet <strong>Codex</strong>. Si vous lisez ceci,
c’est que vous avez l’ambition de comprendre comment fonctionnent les
ordinateurs — non pas en lisant des théories abstraites, mais en en
construisant un vous-même, de zéro.</p>
<h2 data-number="2.1" id="le-mystère-de-lordinateur"><span
class="header-section-number">2.1</span> Le Mystère de l’Ordinateur</h2>
<p>Prenez un instant pour réfléchir à ce qui se passe quand vous tapez
une lettre sur votre clavier :</p>
<ol type="1">
<li>Vos doigts appuient sur une touche physique</li>
<li>Un signal électrique est envoyé</li>
<li>Ce signal est transformé en code numérique</li>
<li>Le processeur le détecte et l’interprète</li>
<li>Un programme décide quoi faire de cette information</li>
<li>Des pixels s’allument sur votre écran pour afficher la lettre</li>
</ol>
<p>Entre votre doigt et le pixel, il y a des <strong>dizaines de couches
d’abstraction</strong>. Chaque couche fait confiance à celle en dessous
et simplifie la vie de celle au-dessus.</p>
<p>Ce livre va vous faire traverser <strong>toutes ces couches</strong>,
de la plus basse (les portes logiques) à la plus haute (les
applications).</p>
<h2 data-number="2.2" id="pourquoi-construire-un-ordinateur"><span
class="header-section-number">2.2</span> Pourquoi Construire un
Ordinateur ?</h2>
<h3 data-number="2.2.1" id="le-problème-de-la-boîte-noire"><span
class="header-section-number">2.2.1</span> Le problème de la “boîte
noire”</h3>
<p>Dans notre vie quotidienne, l’ordinateur est une “boîte noire”. Nous
tapons sur un clavier, touchons un écran, et la magie opère. En tant
qu’ingénieurs logiciels, nous travaillons souvent sur des couches
d’abstraction très élevées (Python, Java, React).</p>
<p>Cette abstraction est une bénédiction pour la productivité, mais elle
crée un <strong>fossé de compréhension</strong>. Combien de développeurs
savent vraiment : - Comment le processeur exécute leur code ? - Pourquoi
certaines opérations sont rapides et d’autres lentes ? - Ce qui se passe
quand on écrit <code>x = 5</code> ? - Comment une image apparaît à
l’écran ?</p>
<h3 data-number="2.2.2" id="lapproche-du-nand-au-tetris"><span
class="header-section-number">2.2.2</span> L’approche “Du NAND au
Tetris”</h3>
<p>Ce projet a pour but de <strong>briser l’abstraction</strong>. Nous
allons descendre au niveau le plus bas — la porte logique — et remonter
couche par couche jusqu’à pouvoir jouer à un jeu vidéo écrit dans un
langage de haut niveau sur notre propre machine.</p>
<p>À la fin de ce parcours, quand vous verrez du code s’exécuter, vous
saurez <strong>exactement</strong> ce qui se passe dans la machine. Ce
n’est plus de la magie — c’est de l’ingénierie que vous maîtrisez.</p>
<h2 data-number="2.3" id="ce-que-vous-allez-construire"><span
class="header-section-number">2.3</span> Ce que Vous Allez
Construire</h2>
<p>Voici les couches que nous allons traverser, de bas en haut :</p>
<figure>
<img src="images/architecture-stack.svg"
alt="Les 8 couches d’abstraction" />
<figcaption aria-hidden="true">Les 8 couches d’abstraction</figcaption>
</figure>
<h3 data-number="2.3.1" id="la-beauté-de-labstraction"><span
class="header-section-number">2.3.1</span> La beauté de
l’abstraction</h3>
<p>Chaque couche a une propriété remarquable : <strong>elle n’a besoin
de connaître que la couche juste en dessous</strong>.</p>
<ul>
<li>Le programmeur C32 n’a pas besoin de savoir comment fonctionne
l’ALU</li>
<li>L’ALU n’a pas besoin de savoir qu’elle va être utilisée pour un jeu
vidéo</li>
<li>La porte NAND ne “sait” pas qu’elle fait partie d’un ordinateur</li>
</ul>
<p>Cette séparation des préoccupations est ce qui rend possible la
construction de systèmes complexes.</p>
<h2 data-number="2.4" id="larchitecture-codex-a32"><span
class="header-section-number">2.4</span> L’Architecture Codex A32</h2>
<p>L’ordinateur <strong>Codex</strong> est conçu pour être à la fois
pédagogique et réaliste. Il s’inspire des architectures ARM modernes
tout en restant accessible.</p>
<p>Comparé aux architectures pédagogiques classiques plus simples (comme
Hack), Codex offre :</p>
<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Caractéristique</th>
<th style="text-align: left;">Hack (Original)</th>
<th style="text-align: left;">Codex (Ce projet)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Architecture</strong></td>
<td style="text-align: left;">16-bits</td>
<td style="text-align: left;"><strong>32-bits</strong></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Registres</strong></td>
<td style="text-align: left;">2 (A et D)</td>
<td style="text-align: left;"><strong>16 (R0-R15)</strong> style
ARM</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Mémoire</strong></td>
<td style="text-align: left;">Séparée (Harvard)</td>
<td style="text-align: left;"><strong>Unifiée</strong> (Von
Neumann)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Instructions</strong></td>
<td style="text-align: left;">Simple, propriétaire</td>
<td style="text-align: left;"><strong>RISC moderne</strong>
(Load/Store)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Écran</strong></td>
<td style="text-align: left;">Monochrome fixe</td>
<td style="text-align: left;"><strong>320×240 monochrome</strong></td>
</tr>
</tbody>
</table>
<h3 data-number="2.4.1" id="pourquoi-ces-changements"><span
class="header-section-number">2.4.1</span> Pourquoi ces changements
?</h3>
<ol type="1">
<li><p><strong>32 bits</strong> : C’est la taille standard des machines
modernes (avant 64 bits). Cela permet d’adresser 4 Go de mémoire et de
manipuler des nombres plus grands.</p></li>
<li><p><strong>16 registres</strong> : Les processeurs ARM (smartphones,
Raspberry Pi) utilisent aussi des registres R0-R15. Comprendre Codex,
c’est comprendre ARM.</p></li>
<li><p><strong>Architecture RISC</strong> : Les instructions sont
simples et régulières. Le CPU fait une chose à la fois, mais le fait
vite.</p></li>
<li><p><strong>Load/Store</strong> : Le CPU ne calcule jamais
directement en mémoire. Il charge d’abord les données dans des
registres, calcule, puis stocke le résultat. C’est plus simple à
implémenter et à comprendre.</p></li>
</ol>
<h2 data-number="2.5" id="ce-que-vous-allez-apprendre"><span
class="header-section-number">2.5</span> Ce que Vous Allez
Apprendre</h2>
<p>À la fin de ce livre, vous saurez :</p>
<p><strong>Au niveau matériel :</strong> - Comment construire des portes
logiques à partir de NAND - Comment un additionneur transforme des bits
en nombres - Comment la mémoire “se souvient” des données - Comment le
CPU orchestre tout cela</p>
<p><strong>Au niveau logiciel :</strong> - Comment l’assembleur traduit
les mnémoniques en binaire - Comment un compilateur transforme du code
lisible en instructions - Comment un OS simplifie l’accès au matériel -
Comment une application utilise toutes ces couches</p>
<p><strong>Au niveau conceptuel :</strong> - Pourquoi les ordinateurs
utilisent le binaire - Comment l’abstraction permet de gérer la
complexité - Pourquoi certaines opérations sont “coûteuses” - Comment le
même matériel peut faire des choses très différentes</p>
<h2 data-number="2.6" id="vos-outils"><span
class="header-section-number">2.6</span> Vos Outils</h2>
<p>Le projet est fourni avec une suite d’outils performants :</p>
<h3 data-number="2.6.1" id="les-outils-en-ligne-de-commande"><span
class="header-section-number">2.6.1</span> Les Outils en Ligne de
Commande</h3>
<table>
<colgroup>
<col style="width: 31%" />
<col style="width: 27%" />
<col style="width: 40%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Outil</th>
<th style="text-align: left;">Rôle</th>
<th style="text-align: left;">Exemple</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>hdl_cli</code></td>
<td style="text-align: left;">Simule vos circuits HDL</td>
<td style="text-align: left;"><code>hdl_cli test Not.hdl</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>a32_cli</code></td>
<td style="text-align: left;">Assemble le code A32 → binaire</td>
<td
style="text-align: left;"><code>a32_cli prog.s -o prog.bin</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>c32_cli</code></td>
<td style="text-align: left;">Compile le code C32 → assembleur</td>
<td style="text-align: left;"><code>c32_cli prog.c -o prog.s</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>a32_runner</code></td>
<td style="text-align: left;">Exécute le code binaire</td>
<td style="text-align: left;"><code>a32_runner prog.bin</code></td>
</tr>
</tbody>
</table>
<h3 data-number="2.6.2" id="le-simulateur-web-recommandé"><span
class="header-section-number">2.6.2</span> Le Simulateur Web
(Recommandé)</h3>
<p>Pour une expérience plus visuelle et interactive, utilisez le
<strong>Simulateur Web</strong>. Il vous permet de : - Écrire et tester
votre HDL directement dans le navigateur - Voir l’état des signaux en
temps réel avec des chronogrammes - Compiler et exécuter du code C et
Assembleur - Visualiser l’écran, les registres et la mémoire</p>
<p>Pour le lancer :</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> web</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> install</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> run dev</span></code></pre></div>
<p>Ouvrez ensuite votre navigateur à l’adresse indiquée (généralement
<code>http://localhost:5173</code>).</p>
<h3 data-number="2.6.3" id="le-cpu-visualizer"><span
class="header-section-number">2.6.3</span> Le CPU Visualizer</h3>
<p>Le <strong>CPU Visualizer</strong> est un outil pédagogique
spécialement conçu pour comprendre le fonctionnement du processeur. Il
affiche en temps réel :</p>
<ul>
<li><strong>Le pipeline</strong> : Les 5 étapes d’exécution (Fetch,
Decode, Execute, Memory, Writeback) s’illuminent au fur et à mesure</li>
<li><strong>Les registres</strong> : R0-R15 avec mise en évidence des
modifications</li>
<li><strong>Les flags</strong> : N, Z, C, V avec animations lors des
changements</li>
<li><strong>Le code source</strong> : Coloration syntaxique et
surlignage de la ligne en cours d’exécution</li>
<li><strong>Le cache</strong> : Statistiques (hits/misses) et contenu
des lignes cache</li>
</ul>
<p>Accédez-y depuis le menu principal du Simulateur Web ou directement
via <code>/visualizer.html</code>.</p>
<p><strong>7 démos intégrées</strong> vous permettent d’explorer
différents concepts : 1. Addition simple 2. Boucles et branchements 3.
Accès mémoire (LDR/STR) 4. Conditions et prédication 5. Tableaux 6.
Flags CPU 7. Comportement du cache</p>
<h2 data-number="2.7" id="comment-utiliser-ce-livre"><span
class="header-section-number">2.7</span> Comment Utiliser ce Livre</h2>
<h3 data-number="2.7.1" id="lapproche-recommandée"><span
class="header-section-number">2.7.1</span> L’approche recommandée</h3>
<ol type="1">
<li><strong>Lisez chaque chapitre en entier</strong> avant de commencer
les exercices</li>
<li><strong>Faites les exercices dans l’ordre</strong> — chaque exercice
prépare le suivant</li>
<li><strong>Ne regardez pas les solutions</strong> avant d’avoir
vraiment essayé</li>
<li><strong>Utilisez le simulateur web</strong> pour visualiser ce qui
se passe</li>
<li><strong>Reliez toujours à l’ensemble</strong> — demandez-vous “où
cela s’insère-t-il ?”</li>
</ol>
<h3 data-number="2.7.2" id="si-vous-êtes-bloqué"><span
class="header-section-number">2.7.2</span> Si vous êtes bloqué</h3>
<ul>
<li>Relisez la section correspondante du chapitre</li>
<li>Vérifiez que vous avez bien compris les exercices précédents</li>
<li>Utilisez le débogueur visuel du simulateur web</li>
<li>Les erreurs les plus fréquentes sont des problèmes de câblage
(mauvaises connexions)</li>
</ul>
<h2 data-number="2.8" id="la-grande-aventure-commence"><span
class="header-section-number">2.8</span> La Grande Aventure
Commence</h2>
<p>Vous êtes sur le point d’entreprendre un voyage fascinant. Chaque
chapitre vous rapprochera un peu plus de la compréhension totale de la
machine.</p>
<p>Quand vous aurez terminé, vous regarderez votre ordinateur
différemment. Ce ne sera plus une boîte noire mystérieuse, mais une
symphonie d’abstractions que vous pouvez comprendre, modifier, et même
reconstruire.</p>
<p>Prêt ? Passons à la première brique élémentaire : la logique
booléenne.</p>
<hr />
<p><strong>Rappel important</strong> : Chaque chapitre de ce livre
construit sur les précédents. Résistez à la tentation de sauter des
étapes — la compréhension profonde vient de la construction
progressive.</p>
<h1 data-number="3" id="logique-booléenne"><span
class="header-section-number">3</span> Logique Booléenne</h1>
<blockquote>
<p>“Au commencement était le NAND.”</p>
</blockquote>
<p>Tout ordinateur numérique, aussi complexe soit-il, est construit à
partir de concepts incroyablement simples : le Vrai (<code>1</code>) et
le Faux (<code>0</code>). Ce chapitre traite de la construction de
portes logiques élémentaires à partir d’une brique fondamentale : la
porte NAND.</p>
<hr />
<h2 data-number="3.1" id="où-en-sommes-nous"><span
class="header-section-number">3.1</span> Où en sommes-nous ?</h2>
<figure>
<img src="images/architecture-stack.svg"
alt="Position dans l’architecture" />
<figcaption aria-hidden="true">Position dans l’architecture</figcaption>
</figure>
<p><em>Nous sommes à la Couche 0 : La Porte NAND - Notre axiome de
départ</em></p>
<p>Nous commençons tout en bas de la pyramide. C’est ici que nous posons
les fondations de tout l’édifice. Chaque porte que vous construirez dans
ce chapitre sera utilisée dans les chapitres suivants pour construire
des circuits de plus en plus complexes, jusqu’au CPU complet.</p>
<hr />
<h2 data-number="3.2" id="pourquoi-le-binaire"><span
class="header-section-number">3.2</span> Pourquoi le Binaire ?</h2>
<h3 data-number="3.2.1" id="la-question-fondamentale"><span
class="header-section-number">3.2.1</span> La question fondamentale</h3>
<p>Avant de construire des portes logiques, posons-nous une question
essentielle : <strong>pourquoi les ordinateurs utilisent-ils le binaire
(0 et 1) plutôt que le système décimal (0-9) que nous utilisons au
quotidien ?</strong></p>
<p>La réponse est d’ordre <strong>physique et pratique</strong> :</p>
<ol type="1">
<li><p><strong>Fiabilité</strong> : Distinguer entre deux états (tension
haute/basse, courant/pas courant) est beaucoup plus fiable que de
distinguer entre dix niveaux différents. Le bruit électrique peut
facilement transformer un “7” en “8”, mais rarement un “1” en
“0”.</p></li>
<li><p><strong>Simplicité</strong> : Les circuits qui ne gèrent que deux
états sont beaucoup plus simples à concevoir et à fabriquer. Un
transistor peut facilement agir comme un interrupteur (on/off).</p></li>
<li><p><strong>Universalité</strong> : George Boole a prouvé au 19ème
siècle que toute la logique peut être exprimée avec seulement deux
valeurs : Vrai et Faux.</p></li>
</ol>
<h3 data-number="3.2.2" id="du-voltage-au-bit"><span
class="header-section-number">3.2.2</span> Du voltage au bit</h3>
<p>Dans le monde physique, nos ordinateurs utilisent des tensions
électriques :</p>
<table>
<thead>
<tr class="header">
<th>Tension</th>
<th>Signification logique</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0V - 0.8V</td>
<td><code>0</code> (Faux)</td>
</tr>
<tr class="even">
<td>2.4V - 3.3V</td>
<td><code>1</code> (Vrai)</td>
</tr>
</tbody>
</table>
<p>La zone entre 0.8V et 2.4V est une “zone interdite” — les circuits
sont conçus pour ne jamais s’y trouver de manière stable. C’est cette
séparation nette qui rend le binaire si robuste.</p>
<h3 data-number="3.2.3" id="labstraction-qui-libère"><span
class="header-section-number">3.2.3</span> L’abstraction qui libère</h3>
<p>En tant qu’architectes système, nous n’avons pas besoin de penser aux
voltages, aux électrons, ou aux transistors. Nous travaillons avec des
<strong>abstractions</strong> : - Un <strong>bit</strong> peut valoir 0
ou 1 - Une <strong>fonction booléenne</strong> transforme des bits en
d’autres bits</p>
<p>C’est la première de nombreuses couches d’abstraction que nous allons
traverser. Chaque couche nous permet de penser à un niveau supérieur
sans nous soucier des détails de la couche inférieure.</p>
<hr />
<h2 data-number="3.3" id="la-porte-nand-notre-axiome"><span
class="header-section-number">3.3</span> La Porte NAND : Notre
Axiome</h2>
<h3 data-number="3.3.1" id="pourquoi-partir-du-nand"><span
class="header-section-number">3.3.1</span> Pourquoi partir du NAND
?</h3>
<p>Il existe de nombreuses portes logiques (AND, OR, NOT, XOR…), mais
nous choisissons de tout construire à partir d’une seule : la porte
<strong>NAND</strong> (Not-AND).</p>
<p>Pourquoi ce choix ?</p>
<ol type="1">
<li><p><strong>Complétude fonctionnelle</strong> : Le NAND est dit
“fonctionnellement complet” — on peut construire TOUTES les autres
portes logiques à partir de NAND uniquement. C’est mathématiquement
prouvé !</p></li>
<li><p><strong>Réalité industrielle</strong> : La technologie CMOS
(Complementary Metal-Oxide-Semiconductor), utilisée dans tous les
processeurs modernes, implémente naturellement les portes NAND de
manière très efficace — seulement 4 transistors.</p></li>
<li><p><strong>Pédagogie</strong> : Partir d’une seule brique force à
comprendre comment les abstractions se construisent les unes sur les
autres.</p></li>
</ol>
<h3 data-number="3.3.2" id="table-de-vérité-nand"><span
class="header-section-number">3.3.2</span> Table de Vérité NAND</h3>
<p>La porte NAND prend deux entrées (A et B) et produit une sortie. Son
comportement :</p>
<table>
<thead>
<tr class="header">
<th>A</th>
<th>B</th>
<th style="text-align: center;">NAND(A, B)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>0</td>
<td style="text-align: center;"><strong>1</strong></td>
</tr>
<tr class="even">
<td>0</td>
<td>1</td>
<td style="text-align: center;"><strong>1</strong></td>
</tr>
<tr class="odd">
<td>1</td>
<td>0</td>
<td style="text-align: center;"><strong>1</strong></td>
</tr>
<tr class="even">
<td>1</td>
<td>1</td>
<td style="text-align: center;"><strong>0</strong></td>
</tr>
</tbody>
</table>
<p><strong>Règle simple</strong> : Le résultat est <code>0</code>
<em>seulement si</em> A <strong>et</strong> B sont tous les deux à
<code>1</code>. Dans tous les autres cas, c’est <code>1</code>.</p>
<p>Le nom “NAND” vient de “Not-AND” : c’est l’inverse exact d’une porte
AND.</p>
<h3 data-number="3.3.3" id="symbole-graphique"><span
class="header-section-number">3.3.3</span> Symbole graphique</h3>
<figure>
<img src="images/nand.svg" alt="Porte NAND" />
<figcaption aria-hidden="true">Porte NAND</figcaption>
</figure>
<p><em>Le petit cercle (○) indique l’inversion</em></p>
<hr />
<h2 data-number="3.4" id="construction-des-portes-élémentaires"><span
class="header-section-number">3.4</span> Construction des Portes
Élémentaires</h2>
<p>Votre mission dans ce chapitre est de construire les portes
suivantes, en utilisant <strong>uniquement</strong> des NAND (et les
portes que vous aurez déjà créées).</p>
<h3 data-number="3.4.1"
id="a.-not-inverseur-linversion-de-la-réalité"><span
class="header-section-number">3.4.1</span> A. NOT (Inverseur) —
L’inversion de la réalité</h3>
<p><strong>Rôle dans l’ordinateur</strong> : L’inverseur est
fondamental. Il permet de créer des conditions négatives (“si PAS
égal…”), de complémenter des nombres (pour la soustraction), et
d’implémenter des bascules (pour la mémoire).</p>
<p><strong>Spécification</strong> :</p>
<table>
<thead>
<tr class="header">
<th>in</th>
<th>out</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>1</td>
</tr>
<tr class="even">
<td>1</td>
<td>0</td>
</tr>
</tbody>
</table>
<p><strong>Le défi</strong> : Comment utiliser une porte NAND (qui prend
2 entrées) pour n’en traiter qu’une seule ?</p>
<p><strong>L’astuce</strong> : Connectez le même signal aux deux entrées
!</p>
<figure>
<img src="images/not-from-nand.svg"
alt="NOT construit à partir de NAND" />
<figcaption aria-hidden="true">NOT construit à partir de
NAND</figcaption>
</figure>
<p>Vérifions avec la table de vérité :</p>
<ul>
<li>Si <code>in = 0</code> : NAND(0, 0) = 1 OK</li>
<li>Si <code>in = 1</code> : NAND(1, 1) = 0 OK</li>
</ul>
<p>C’est exactement le comportement NOT !</p>
<hr />
<h3 data-number="3.4.2" id="b.-and-et-la-conjonction"><span
class="header-section-number">3.4.2</span> B. AND (Et) — La
conjonction</h3>
<p><strong>Rôle dans l’ordinateur</strong> : La porte AND est
essentielle pour : - Extraire des bits spécifiques d’un nombre
(masquage) - Vérifier que TOUTES les conditions sont vraies - Contrôler
le passage de données (avec un signal d’activation)</p>
<p><strong>Spécification</strong> :</p>
<table>
<thead>
<tr class="header">
<th>A</th>
<th>B</th>
<th style="text-align: center;">AND(A, B)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td>0</td>
<td>1</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td>1</td>
<td>0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td>1</td>
<td>1</td>
<td style="text-align: center;">1</td>
</tr>
</tbody>
</table>
<p><strong>La sortie vaut 1 seulement si A ET B valent 1.</strong></p>
<p><strong>L’insight</strong> : Le NAND est un “Not-AND”. Si on inverse
le résultat d’un NAND… on obtient un AND !</p>
<figure>
<img src="images/and-from-nand.svg"
alt="AND construit à partir de NAND et NOT" />
<figcaption aria-hidden="true">AND construit à partir de NAND et
NOT</figcaption>
</figure>
<p>Formule : <code>AND(A, B) = NOT(NAND(A, B))</code></p>
<hr />
<h3 data-number="3.4.3" id="c.-or-ou-lalternative"><span
class="header-section-number">3.4.3</span> C. OR (Ou) —
L’alternative</h3>
<p><strong>Rôle dans l’ordinateur</strong> : La porte OR permet de : -
Combiner plusieurs signaux de contrôle - Vérifier qu’AU MOINS UNE
condition est vraie - Créer des priorités (interruptions, erreurs)</p>
<p><strong>Spécification</strong> :</p>
<table>
<thead>
<tr class="header">
<th>A</th>
<th>B</th>
<th style="text-align: center;">OR(A, B)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td>0</td>
<td>1</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td>1</td>
<td>0</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td>1</td>
<td>1</td>
<td style="text-align: center;">1</td>
</tr>
</tbody>
</table>
<p><strong>La sortie vaut 1 si au moins une entrée vaut 1.</strong></p>
<p><strong>Le Théorème de De Morgan</strong> : Ce théorème fondamental
nous donne la clé :</p>
<pre><code>A OR B = NOT( (NOT A) AND (NOT B) )</code></pre>
<p>En utilisant uniquement des NAND :</p>
<pre><code>A OR B = (NOT A) NAND (NOT B)</code></pre>
<figure>
<img src="images/or-from-nand.svg"
alt="OR construit à partir de NOT et NAND" />
<figcaption aria-hidden="true">OR construit à partir de NOT et
NAND</figcaption>
</figure>
<hr />
<h3 data-number="3.4.4" id="d.-xor-ou-exclusif-la-différence"><span
class="header-section-number">3.4.4</span> D. XOR (Ou Exclusif) — La
différence</h3>
<p><strong>Rôle dans l’ordinateur</strong> : XOR est crucial pour : -
<strong>L’addition binaire</strong> : XOR calcule la somme de deux bits
(sans la retenue) - <strong>La comparaison</strong> : XOR détecte si
deux bits sont différents - <strong>Le cryptage</strong> : XOR est au
cœur de nombreux algorithmes de chiffrement - <strong>La détection
d’erreurs</strong> : Calcul de parité</p>
<p><strong>Spécification</strong> :</p>
<table>
<thead>
<tr class="header">
<th>A</th>
<th>B</th>
<th style="text-align: center;">XOR(A, B)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td>0</td>
<td>1</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td>1</td>
<td>0</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td>1</td>
<td>1</td>
<td style="text-align: center;">0</td>
</tr>
</tbody>
</table>
<p><strong>La sortie vaut 1 si les entrées sont
<em>différentes</em>.</strong></p>
<p><strong>Formule algébrique</strong> :</p>
<pre><code>XOR(A, B) = (A AND NOT B) OR (NOT A AND B)</code></pre>
<p>En mots : “A est vrai et B est faux” OU “A est faux et B est
vrai”.</p>
<hr />
<h3 data-number="3.4.5" id="e.-multiplexeur-mux-laiguilleur"><span
class="header-section-number">3.4.5</span> E. Multiplexeur (Mux) —
L’aiguilleur</h3>
<p><strong>Rôle dans l’ordinateur</strong> : Le multiplexeur est l’un
des composants les plus importants ! Il permet de :</p>
<ul>
<li><strong>Choisir entre plusieurs sources de données</strong> : Comme
un aiguillage de train</li>
<li><strong>Implémenter les conditions</strong> :
<code>if (sel) then b else a</code></li>
<li><strong>Construire la mémoire</strong> : Sélectionner quelle cellule
lire</li>
</ul>
<p><strong>Spécification</strong> :</p>
<ul>
<li>Si <code>sel == 0</code> alors <code>out = a</code></li>
<li>Si <code>sel == 1</code> alors <code>out = b</code></li>
</ul>
<figure>
<img src="images/mux.svg" alt="Multiplexeur" />
<figcaption aria-hidden="true">Multiplexeur</figcaption>
</figure>
<p><strong>L’insight</strong> : On peut voir le Mux comme : “soit (a ET
non-sel) soit (b ET sel)”.</p>
<pre><code>out = (a AND NOT sel) OR (b AND sel)</code></pre>
<p><strong>Pourquoi le Mux est-il si important ?</strong></p>
<p>Imaginez que vous construisez un CPU. À chaque cycle, le CPU doit
choisir :</p>
<ul>
<li>D’où vient l’opérande ? De la mémoire ou d’un registre ?</li>
<li>Où va le résultat ? Vers la mémoire ou un registre ?</li>
<li>Quelle instruction exécuter ?</li>
</ul>
<p>Chacun de ces choix est implémenté par un multiplexeur !</p>
<hr />
<h3 data-number="3.4.6"
id="f.-démultiplexeur-dmux-linverse-de-laiguilleur"><span
class="header-section-number">3.4.6</span> F. Démultiplexeur (DMux) —
L’inverse de l’aiguilleur</h3>
<p><strong>Rôle dans l’ordinateur</strong> : Le DMux fait l’inverse du
Mux — il prend UNE entrée et la dirige vers UNE des sorties possibles.
Utile pour :</p>
<ul>
<li><strong>L’adressage mémoire</strong> : Activer la bonne cellule</li>
<li><strong>La distribution de signaux</strong> : Envoyer une commande
au bon périphérique</li>
</ul>
<p><strong>Spécification</strong> :</p>
<ul>
<li>Si <code>sel == 0</code> alors <code>a = in, b = 0</code></li>
<li>Si <code>sel == 1</code> alors <code>a = 0, b = in</code></li>
</ul>
<figure>
<img src="images/dmux.svg" alt="Démultiplexeur" />
<figcaption aria-hidden="true">Démultiplexeur</figcaption>
</figure>
<hr />
<h2 data-number="3.5" id="le-lien-avec-lordinateur-complet"><span
class="header-section-number">3.5</span> Le Lien avec l’Ordinateur
Complet</h2>
<p>Prenons du recul. Pourquoi construisons-nous ces portes ?</p>
<h3 data-number="3.5.1" id="du-nand-au-cpu-la-feuille-de-route"><span
class="header-section-number">3.5.1</span> Du NAND au CPU : La feuille
de route</h3>
<pre><code>CHAPITRE 1 (Ici)     CHAPITRE 2          CHAPITRE 3         CHAPITRE 5
     ↓                    ↓                   ↓                  ↓
   NAND             Half Adder            DFF (Flip-Flop)       CPU
     ↓                    ↓                   ↓                  ↓
NOT, AND, OR  →    Full Adder      →    Registres      →    Ordinateur
XOR, Mux, DMux          ↓                   ↓                complet !
                      ALU              RAM (Mémoire)</code></pre>
<p><strong>Chaque porte a un rôle précis</strong> :</p>
<ul>
<li><strong>NOT</strong> : Permet la soustraction (via le complément à
2)</li>
<li><strong>AND</strong> : Masquage de bits, conditions ET</li>
<li><strong>OR</strong> : Combinaison de signaux, conditions OU</li>
<li><strong>XOR</strong> : Addition bit à bit, comparaisons</li>
<li><strong>Mux</strong> : Tous les choix du CPU (quelle donnée ? quelle
opération ?)</li>
<li><strong>DMux</strong> : Adressage mémoire, routage des
résultats</li>
</ul>
<p>Quand vous jouerez à un jeu sur votre ordinateur Codex au Chapitre 9,
chaque pixel affiché à l’écran aura été calculé par des millions
d’opérations utilisant ces portes élémentaires !</p>
<hr />
<h2 data-number="3.6" id="description-matérielle-codex-hdl"><span
class="header-section-number">3.6</span> Description Matérielle (Codex
HDL)</h2>
<p>Pour décrire nos circuits, nous utilisons un langage appelé
<strong>HDL</strong> (Hardware Description Language). C’est un langage
<strong>déclaratif</strong> : on décrit QUELS composants existent et
COMMENT ils sont connectés, pas DANS QUEL ORDRE les exécuter.</p>
<h3 data-number="3.6.1" id="pourquoi-un-langage-de-description"><span
class="header-section-number">3.6.1</span> Pourquoi un langage de
description ?</h3>
<p>En électronique réelle, on dessine des schémas. Mais les schémas
deviennent illisibles pour des circuits complexes (un CPU contient des
millions de portes !). Le HDL permet de :</p>
<ol type="1">
<li><strong>Décrire</strong> des circuits de manière textuelle</li>
<li><strong>Simuler</strong> leur comportement avant fabrication</li>
<li><strong>Synthétiser</strong> le circuit vers du matériel réel</li>
</ol>
<p>Notre HDL est inspiré du <strong>VHDL</strong> (Very High-Speed
Integrated Circuit HDL), utilisé dans l’industrie.</p>
<h3 data-number="3.6.2" id="structure-dun-fichier-.hdl"><span
class="header-section-number">3.6.2</span> Structure d’un fichier
<code>.hdl</code></h3>
<p>Un fichier HDL se compose de deux parties :</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- ============================================================</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co">-- 1. L&#39;ENTITÉ : L&#39;interface externe (les &quot;broches&quot; de la puce)</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">-- ============================================================</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="cf">entity</span> <span class="dv">NomDeLaPuce</span> <span class="kw">is</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">port</span>(</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;     <span class="co">-- Entrée de 1 bit</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    b <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;     <span class="co">-- Autre entrée</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>     <span class="co">-- Sortie (pas de point-virgule sur la dernière)</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="cf">end entity;</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co">-- ============================================================</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co">-- 2. L&#39;ARCHITECTURE : Le contenu interne (le câblage)</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co">-- ============================================================</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">rtl</span> <span class="kw">of</span> <span class="fu">NomDeLaPuce</span> <span class="kw">is</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Déclaration des composants utilisés</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">Nand</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; b <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; y <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Déclaration des signaux internes (fils)</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> fil_interne <span class="ot">:</span> <span class="dt">bit</span>;</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Instanciation et connexion des composants</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u1</span><span class="ot">:</span> <span class="kw">Nand</span> <span class="kw">port</span> <span class="kw">map</span> (a <span class="ot">=&gt;</span> a<span class="ot">,</span> b <span class="ot">=&gt;</span> b<span class="ot">,</span> y <span class="ot">=&gt;</span> fil_interne);</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Assignation directe (optionnel)</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;=</span> fil_interne;</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a><span class="cf">end architecture;</span></span></code></pre></div>
<h3 data-number="3.6.3" id="vocabulaire-essentiel"><span
class="header-section-number">3.6.3</span> Vocabulaire essentiel</h3>
<table>
<thead>
<tr class="header">
<th>Terme</th>
<th>Signification</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>entity</code></td>
<td>L’interface externe — quelles sont les entrées/sorties</td>
</tr>
<tr class="even">
<td><code>architecture</code></td>
<td>Le contenu — comment c’est câblé à l’intérieur</td>
</tr>
<tr class="odd">
<td><code>component</code></td>
<td>Une puce qu’on veut utiliser (il faut la déclarer)</td>
</tr>
<tr class="even">
<td><code>signal</code></td>
<td>Un fil interne (pour connecter des composants entre eux)</td>
</tr>
<tr class="odd">
<td><code>port map</code></td>
<td>“Brancher” les fils aux broches d’un composant</td>
</tr>
<tr class="even">
<td><code>=&gt;</code></td>
<td>“est connecté à” (broche =&gt; signal)</td>
</tr>
<tr class="odd">
<td><code>&lt;=</code></td>
<td>Assignation (sortie &lt;= signal)</td>
</tr>
</tbody>
</table>
<h3 data-number="3.6.4" id="règles-de-connexion"><span
class="header-section-number">3.6.4</span> Règles de connexion</h3>
<ol type="1">
<li><strong>À gauche du <code>=&gt;</code></strong> : Le nom de la
broche du composant que vous utilisez</li>
<li><strong>À droite du <code>=&gt;</code></strong> : Le signal de VOTRE
architecture que vous y connectez</li>
<li><strong>Les signaux doivent être déclarés</strong> avant le
<code>begin</code></li>
<li><strong>Chaque instance a un nom unique</strong> (<code>u1</code>,
<code>u2</code>, etc.)</li>
</ol>
<h3 data-number="3.6.5" id="bus-vecteurs-de-bits"><span
class="header-section-number">3.6.5</span> Bus (Vecteurs de bits)</h3>
<p>Pour manipuler plusieurs bits simultanément (ex: un nombre de 32
bits), on utilise <code>bits(MSB downto LSB)</code> :</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Un bus de 32 bits</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>data_bus <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">31</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co">-- Accéder à un bit spécifique</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>data_bus(<span class="dv">0</span>)   <span class="co">-- Le bit de poids faible (LSB)</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>data_bus(<span class="dv">31</span>)  <span class="co">-- Le bit de poids fort (MSB)</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co">-- Extraire une tranche</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>data_bus(<span class="dv">7</span> <span class="ot">downto</span> <span class="dv">0</span>)  <span class="co">-- Les 8 bits de poids faible</span></span></code></pre></div>
<h3 data-number="3.6.6" id="exemple-complet-xor-en-hdl"><span
class="header-section-number">3.6.6</span> Exemple complet : XOR en
HDL</h3>
<div class="sourceCode" id="cb9"><pre
class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- La porte XOR : sortie = 1 si les entrées sont différentes</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co">-- XOR(a,b) = (a AND NOT b) OR (NOT a AND b)</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="cf">entity</span> <span class="dv">Xor2</span> <span class="kw">is</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">port</span>(</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    a <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    b <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="cf">end entity;</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">rtl</span> <span class="kw">of</span> <span class="fu">Xor2</span> <span class="kw">is</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Composants utilisés</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">Inv</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; y <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">And2</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; b <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; y <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">component</span> <span class="dv">Or2</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">port</span>(a <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; b <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; y <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">end component;</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Signaux internes</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> not_a<span class="ot">,</span> not_b <span class="ot">:</span> <span class="dt">bit</span>;  <span class="co">-- Les inversions de a et b</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> w1<span class="ot">,</span> w2 <span class="ot">:</span> <span class="dt">bit</span>;        <span class="co">-- Résultats intermédiaires</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- NOT a et NOT b</span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_nota</span><span class="ot">:</span> <span class="fu">Inv</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a<span class="ot">,</span> y <span class="ot">=&gt;</span> not_a);</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_notb</span><span class="ot">:</span> <span class="fu">Inv</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> b<span class="ot">,</span> y <span class="ot">=&gt;</span> not_b);</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- (a AND NOT b)</span></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_and1</span><span class="ot">:</span> <span class="fu">And2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> a<span class="ot">,</span> b <span class="ot">=&gt;</span> not_b<span class="ot">,</span> y <span class="ot">=&gt;</span> w1);</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- (NOT a AND b)</span></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_and2</span><span class="ot">:</span> <span class="fu">And2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> not_a<span class="ot">,</span> b <span class="ot">=&gt;</span> b<span class="ot">,</span> y <span class="ot">=&gt;</span> w2);</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Résultat final : OR des deux termes</span></span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_or</span><span class="ot">:</span> <span class="fu">Or2</span> <span class="kw">port map </span>(a <span class="ot">=&gt;</span> w1<span class="ot">,</span> b <span class="ot">=&gt;</span> w2<span class="ot">,</span> y <span class="ot">=&gt;</span> y);</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a><span class="cf">end architecture;</span></span></code></pre></div>
<hr />
<h2 data-number="3.7" id="exercices-pratiques"><span
class="header-section-number">3.7</span> Exercices Pratiques</h2>
<h3 data-number="3.7.1" id="exercices-sur-le-simulateur-web"><span
class="header-section-number">3.7.1</span> Exercices sur le Simulateur
Web</h3>
<p>Le <strong>Simulateur Web</strong> vous permet de construire et
tester vos portes de manière interactive. Lancez-le et allez dans la
section <strong>HDL Progression</strong>.</p>
<table>
<thead>
<tr class="header">
<th>Exercice</th>
<th>Description</th>
<th style="text-align: center;">Difficulté</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>Inv</code></td>
<td>Inverseur (NOT) — Votre première porte</td>
<td style="text-align: center;">[*]</td>
</tr>
<tr class="even">
<td><code>And2</code></td>
<td>Porte AND à 2 entrées</td>
<td style="text-align: center;">[*]</td>
</tr>
<tr class="odd">
<td><code>Or2</code></td>
<td>Porte OR à 2 entrées</td>
<td style="text-align: center;">[*]</td>
</tr>
<tr class="even">
<td><code>Xor2</code></td>
<td>Porte XOR (Ou exclusif)</td>
<td style="text-align: center;">[**]</td>
</tr>
<tr class="odd">
<td><code>Mux</code></td>
<td>Multiplexeur 2 vers 1</td>
<td style="text-align: center;">[**]</td>
</tr>
<tr class="even">
<td><code>DMux</code></td>
<td>Démultiplexeur 1 vers 2</td>
<td style="text-align: center;">[**]</td>
</tr>
</tbody>
</table>
<p><strong>Pour chaque exercice</strong> :</p>
<ol type="1">
<li>Lisez la spécification et la table de vérité</li>
<li>Réfléchissez à comment combiner les portes disponibles</li>
<li>Écrivez votre code HDL</li>
<li>Testez — le simulateur vous montrera un chronogramme des
signaux</li>
<li>Si un test échoue, analysez quelle entrée produit le mauvais
résultat</li>
</ol>
<h3 data-number="3.7.2" id="comment-lancer-le-simulateur-web"><span
class="header-section-number">3.7.2</span> Comment lancer le simulateur
web ?</h3>
<div class="sourceCode" id="cb10"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> web</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> install    <span class="co"># (première fois uniquement)</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> run dev</span></code></pre></div>
<p>Puis ouvrez votre navigateur à l’adresse indiquée (généralement
<code>http://localhost:5173</code>).</p>
<h3 data-number="3.7.3"
id="alternative-tests-en-ligne-de-commande"><span
class="header-section-number">3.7.3</span> Alternative : Tests en ligne
de commande</h3>
<p>Si vous préférez travailler dans les fichiers du répertoire
<code>hdl_lib/01_gates/</code> :</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tester une porte spécifique</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> run <span class="at">-p</span> hdl_cli <span class="at">--</span> test hdl_lib/01_gates/Not.hdl</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Tester toutes les portes du projet 1</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> run <span class="at">-p</span> hdl_cli <span class="at">--</span> test hdl_lib/01_gates/</span></code></pre></div>
<hr />
<h2 data-number="3.8" id="défis-supplémentaires"><span
class="header-section-number">3.8</span> Défis Supplémentaires</h2>
<h3 data-number="3.8.1" id="défi-1-minimiser-le-nombre-de-nand"><span
class="header-section-number">3.8.1</span> Défi 1 : Minimiser le nombre
de NAND</h3>
<p>Construisez la porte XOR en utilisant <strong>seulement 4 portes
NAND</strong> (c’est le minimum théorique !). La solution classique en
utilise 5.</p>
<h3 data-number="3.8.2" id="défi-2-implémenter-implies"><span
class="header-section-number">3.8.2</span> Défi 2 : Implémenter
IMPLIES</h3>
<p>La fonction “implication” (<code>A → B</code>) vaut FAUX seulement si
A est VRAI et B est FAUX.</p>
<table>
<thead>
<tr class="header">
<th>A</th>
<th>B</th>
<th style="text-align: center;">A → B</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>0</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td>0</td>
<td>1</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td>1</td>
<td>0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td>1</td>
<td>1</td>
<td style="text-align: center;">1</td>
</tr>
</tbody>
</table>
<p>Construisez cette porte en utilisant les portes élémentaires.</p>
<h3 data-number="3.8.3" id="défi-3-mux-à-4-entrées"><span
class="header-section-number">3.8.3</span> Défi 3 : Mux à 4 entrées</h3>
<p>Construisez un Mux qui choisit parmi 4 entrées (<code>a</code>,
<code>b</code>, <code>c</code>, <code>d</code>) avec 2 bits de sélection
(<code>sel[1:0]</code>).</p>
<hr />
<h2 data-number="3.9" id="ce-quil-faut-retenir"><span
class="header-section-number">3.9</span> Ce qu’il faut retenir</h2>
<ol type="1">
<li><strong>Le binaire simplifie</strong> : Deux états sont plus fiables
que dix</li>
<li><strong>NAND est universel</strong> : Toutes les portes peuvent être
construites à partir de NAND</li>
<li><strong>L’abstraction est puissante</strong> : On construit des
couches les unes sur les autres</li>
<li><strong>Chaque porte a un rôle</strong> :
<ul>
<li>NOT → Inversion, complément</li>
<li>AND → Masquage, condition “et”</li>
<li>OR → Combinaison, condition “ou”</li>
<li>XOR → Addition, comparaison</li>
<li>Mux → Choix, sélection</li>
<li>DMux → Routage, adressage</li>
</ul></li>
</ol>
<p><strong>Prochaine étape</strong> : Au Chapitre 2, nous utiliserons
ces portes pour construire des circuits qui font de
l’<strong>arithmétique</strong> — addition, soustraction, et une ALU
(Unité Arithmétique et Logique) complète.</p>
<hr />
<p><strong>Conseil</strong> : Ne passez pas au chapitre suivant avant
d’avoir réussi tous les exercices de ce chapitre. Chaque porte que vous
construisez sera réutilisée dans les chapitres suivants !</p>
<hr />
<h2 data-number="3.10" id="auto-évaluation"><span
class="header-section-number">3.10</span> Auto-évaluation</h2>
<p>Testez votre compréhension avant de passer au chapitre suivant.</p>
<h3 data-number="3.10.1" id="questions-de-compréhension"><span
class="header-section-number">3.10.1</span> Questions de
compréhension</h3>
<p><strong>Q1.</strong> Pourquoi les ordinateurs utilisent-ils le
binaire plutôt que le décimal ?</p>
<p><strong>Q2.</strong> Pourquoi dit-on que NAND est une porte
“universelle” ?</p>
<p><strong>Q3.</strong> Quelle est la sortie de <code>XOR(1, 1)</code> ?
Et de <code>XOR(0, 1)</code> ?</p>
<p><strong>Q4.</strong> Un multiplexeur (MUX) a 2 entrées de données
<code>a</code> et <code>b</code>, et un signal de sélection
<code>sel</code>. Si <code>sel = 1</code>, quelle entrée est transmise
en sortie ?</p>
<p><strong>Q5.</strong> Combien de portes NAND faut-il au minimum pour
construire un inverseur (NOT) ?</p>
<h3 data-number="3.10.2" id="mini-défi-pratique"><span
class="header-section-number">3.10.2</span> Mini-défi pratique</h3>
<p>Complétez cette table de vérité pour la fonction
<code>F(a, b) = AND(OR(a, b), NOT(a))</code> :</p>
<table>
<thead>
<tr class="header">
<th>a</th>
<th>b</th>
<th>OR(a,b)</th>
<th>NOT(a)</th>
<th>F</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>0</td>
<td>?</td>
<td>?</td>
<td>?</td>
</tr>
<tr class="even">
<td>0</td>
<td>1</td>
<td>?</td>
<td>?</td>
<td>?</td>
</tr>
<tr class="odd">
<td>1</td>
<td>0</td>
<td>?</td>
<td>?</td>
<td>?</td>
</tr>
<tr class="even">
<td>1</td>
<td>1</td>
<td>?</td>
<td>?</td>
<td>?</td>
</tr>
</tbody>
</table>
<p><em>Les solutions se trouvent dans le document
<strong>Codex_Solutions</strong>.</em></p>
<h3 data-number="3.10.3" id="checklist-de-validation"><span
class="header-section-number">3.10.3</span> Checklist de validation</h3>
<p>Avant de passer au chapitre 2, assurez-vous de pouvoir :</p>
<ul class="task-list">
<li><label><input type="checkbox" />Expliquer pourquoi NAND est
universel</label></li>
<li><label><input type="checkbox" />Construire NOT, AND, OR à partir de
NAND</label></li>
<li><label><input type="checkbox" />Lire et écrire une table de
vérité</label></li>
<li><label><input type="checkbox" />Comprendre le rôle du MUX
(sélection) et du DMUX (routage)</label></li>
<li><label><input type="checkbox" />Écrire du code HDL simple avec
<code>port map</code></label></li>
</ul>
<h1 data-number="4" id="arithmétique-binaire"><span
class="header-section-number">4</span> Arithmétique Binaire</h1>
<blockquote>
<p>“Les mathématiques sont le langage avec lequel Dieu a écrit
l’univers.” — Galilée</p>
</blockquote>
<p>Dans le chapitre précédent, nous avons appris à manipuler des bits
individuels avec des portes logiques. Mais un ordinateur doit savoir
compter ! Comment passer de simples portes logiques à une calculatrice
capable d’additionner des nombres à 32 bits ?</p>
<hr />
<h2 data-number="4.1" id="où-en-sommes-nous-1"><span
class="header-section-number">4.1</span> Où en sommes-nous ?</h2>
<figure>
<img src="images/architecture-stack.svg"
alt="Position dans l’architecture" />
<figcaption aria-hidden="true">Position dans l’architecture</figcaption>
</figure>
<p><em>Nous sommes à la Couche 1 : Logique Matérielle (Portes logiques -
ALU, RAM, CPU)</em></p>
<p>Nous sommes toujours dans la couche matérielle, mais nous montons
d’un niveau. Nous allons combiner les portes logiques du Chapitre 1 pour
construire des circuits arithmétiques, culminant avec
l’<strong>ALU</strong> (Arithmetic Logic Unit) — le composant qui
effectue TOUS les calculs du processeur.</p>
<hr />
<h2 data-number="4.2"
id="pourquoi-larithmétique-est-elle-si-importante"><span
class="header-section-number">4.2</span> Pourquoi l’Arithmétique
est-elle si Importante ?</h2>
<h3 data-number="4.2.1" id="au-cœur-de-tout-calcul"><span
class="header-section-number">4.2.1</span> Au cœur de tout calcul</h3>
<p>Regardez ce que fait un ordinateur :</p>
<ul>
<li><strong>Afficher une image</strong> : Calculer la couleur de chaque
pixel (additions, multiplications)</li>
<li><strong>Jouer un son</strong> : Mélanger des formes d’onde
(additions)</li>
<li><strong>Naviguer sur le web</strong> : Calculer des checksums,
décompresser des données</li>
<li><strong>Exécuter un programme</strong> : Calculer l’adresse de la
prochaine instruction (addition)</li>
</ul>
<p>Même les opérations les plus “abstraites” se réduisent finalement à
des opérations arithmétiques sur des nombres binaires. L’ALU que vous
allez construire est le moteur qui fait tourner TOUT.</p>
<h3 data-number="4.2.2" id="ce-que-nous-allons-construire"><span
class="header-section-number">4.2.2</span> Ce que nous allons
construire</h3>
<figure>
<img src="images/build-roadmap.svg"
alt="Feuille de route : des portes à l’ALU" />
<figcaption aria-hidden="true">Feuille de route : des portes à
l’ALU</figcaption>
</figure>
<p>À la fin de ce chapitre, vous aurez construit une ALU capable
d’effectuer : - Addition et soustraction - ET, OU, XOR logiques -
Comparaisons (via les drapeaux)</p>
<hr />
<h2 data-number="4.3" id="représentation-des-nombres"><span
class="header-section-number">4.3</span> Représentation des Nombres</h2>
<h3 data-number="4.3.1" id="le-système-binaire-base-2"><span
class="header-section-number">4.3.1</span> Le Système Binaire (Base
2)</h3>
<p>Avant de construire des additionneurs, comprenons comment les nombres
sont représentés.</p>
<p>En décimal (base 10), chaque position représente une puissance de 10
:</p>
<pre><code>  4   2   7
  ↓   ↓   ↓
10² 10¹ 10⁰  →  4×100 + 2×10 + 7×1 = 427</code></pre>
<p>En binaire (base 2), chaque position représente une puissance de 2
:</p>
<pre><code>Position :   3    2    1    0
Poids    :  2³   2²   2¹   2⁰
Valeur   :   8    4    2    1

Exemple : 1011₂ = 1×8 + 0×4 + 1×2 + 1×1 = 11₁₀</code></pre>
<h3 data-number="4.3.2" id="taille-des-nombres-dans-codex"><span
class="header-section-number">4.3.2</span> Taille des nombres dans
Codex</h3>
<p>Notre ordinateur Codex travaille sur <strong>32 bits</strong>. Cela
signifie : - <strong>Plage non-signée</strong> : 0 à 2³² - 1 = 4 294 967
295 (≈ 4 milliards) - <strong>Plage signée</strong> : -2 147 483 648 à 2
147 483 647 (≈ ±2 milliards)</p>
<p>C’est suffisant pour : - Adresser 4 Go de mémoire (chaque octet a une
adresse unique) - Représenter des coordonnées d’écran, des scores de
jeux, des compteurs</p>
<h3 data-number="4.3.3"
id="les-nombres-négatifs-le-complément-à-2"><span
class="header-section-number">4.3.3</span> Les Nombres Négatifs : Le
Complément à 2</h3>
<p>Comment représenter des nombres négatifs avec seulement des 0 et des
1 ?</p>
<p><strong>Le problème</strong> : On pourrait utiliser un bit de signe
(0 = positif, 1 = négatif), mais alors on aurait besoin de circuits
différents pour l’addition et la soustraction, et on aurait deux
représentations du zéro (+0 et -0).</p>
<p><strong>La solution brillante</strong> : Le <strong>Complément à
2</strong>.</p>
<p>Le bit le plus à gauche (bit 31, le MSB) est le “bit de signe” : -
<code>0</code> → le nombre est positif ou nul - <code>1</code> → le
nombre est négatif</p>
<p>Mais attention, ce n’est pas un simple bit de signe ! Le système est
conçu pour que <strong>l’addition fonctionne de la même manière</strong>
que le nombre soit positif ou négatif.</p>
<h3 data-number="4.3.4"
id="comment-obtenir-le-complément-à-2-la-valeur-négative"><span
class="header-section-number">4.3.4</span> Comment obtenir le complément
à 2 (la valeur négative) ?</h3>
<p>Pour obtenir -X à partir de X : 1. <strong>Inverser</strong> tous les
bits de X (0→1, 1→0) 2. <strong>Ajouter 1</strong> au résultat</p>
<p><strong>Exemple sur 4 bits</strong> : Calculons -5</p>
<pre><code>  5 en binaire :   0101
  Inversion    :   1010
  Ajouter 1    : + 0001
                 ──────
  -5           :   1011</code></pre>
<p><strong>Vérification</strong> : 5 + (-5) devrait donner 0</p>
<pre><code>    0101   (5)
  + 1011   (-5)
  ──────
   10000   → Les 4 bits de poids faible sont 0000 OK
            (La retenue &quot;1&quot; est ignorée car on travaille sur 4 bits)</code></pre>
<h3 data-number="4.3.5"
id="pourquoi-le-complément-à-2-est-il-génial"><span
class="header-section-number">4.3.5</span> Pourquoi le complément à 2
est-il génial ?</h3>
<ol type="1">
<li><strong>Un seul zéro</strong> : 0000 est le seul zéro (pas de +0 et
-0)</li>
<li><strong>L’addition fonctionne universellement</strong> : Le même
circuit additionne les positifs et les négatifs</li>
<li><strong>La soustraction devient une addition</strong> : A - B = A +
(-B) = A + NOT(B) + 1</li>
</ol>
<p>C’est grâce au complément à 2 que notre ALU peut être relativement
simple !</p>
<hr />
<h2 data-number="4.4" id="laddition-binaire"><span
class="header-section-number">4.4</span> L’Addition Binaire</h2>
<p>L’addition binaire suit les mêmes règles que l’addition décimale
qu’on apprend à l’école : on additionne colonne par colonne, de droite à
gauche, en propageant les retenues.</p>
<h3 data-number="4.4.1" id="les-règles-de-base-sur-1-bit"><span
class="header-section-number">4.4.1</span> Les règles de base (sur 1
bit)</h3>
<pre><code>0 + 0 = 0  (pas de retenue)
0 + 1 = 1  (pas de retenue)
1 + 0 = 1  (pas de retenue)
1 + 1 = 10 (c&#39;est-à-dire 0 avec une retenue de 1)</code></pre>
<h3 data-number="4.4.2" id="exemple-daddition-sur-4-bits"><span
class="header-section-number">4.4.2</span> Exemple d’addition sur 4
bits</h3>
<p>Calculons 5 + 3 = 8 :</p>
<pre><code>  Retenues :   1 1 1
              ─────
     5     :   0 1 0 1
  +  3     : + 0 0 1 1
            ─────────
     8     :   1 0 0 0</code></pre>
<p>Détail colonne par colonne (de droite à gauche) :</p>
<ul>
<li>Colonne 0 : 1 + 1 = 0, retenue 1</li>
<li>Colonne 1 : 0 + 1 + 1(retenue) = 0, retenue 1</li>
<li>Colonne 2 : 1 + 0 + 1(retenue) = 0, retenue 1</li>
<li>Colonne 3 : 0 + 0 + 1(retenue) = 1</li>
</ul>
<p>Résultat : 1000₂ = 8₁₀ OK</p>
<hr />
<h2 data-number="4.5" id="le-demi-additionneur-half-adder"><span
class="header-section-number">4.5</span> Le Demi-Additionneur (Half
Adder)</h2>
<p>Le demi-additionneur est le circuit le plus simple pour additionner
deux bits. Il produit : - <strong>sum</strong> : La somme (bit de poids
faible) - <strong>carry</strong> : La retenue (bit de poids fort)</p>
<h3 data-number="4.5.1" id="table-de-vérité"><span
class="header-section-number">4.5.1</span> Table de vérité</h3>
<table>
<thead>
<tr class="header">
<th>a</th>
<th>b</th>
<th style="text-align: center;">sum</th>
<th style="text-align: center;">carry</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td>0</td>
<td>1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td>1</td>
<td>0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td>1</td>
<td>1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
</tr>
</tbody>
</table>
<h3 data-number="4.5.2" id="linsight-clé"><span
class="header-section-number">4.5.2</span> L’insight clé</h3>
<p>Regardez attentivement les colonnes : - <strong>sum</strong>
correspond exactement à <strong>XOR(a, b)</strong> — différent = 1,
identique = 0 - <strong>carry</strong> correspond exactement à
<strong>AND(a, b)</strong> — les deux à 1 = retenue</p>
<p>C’est pour cela que nous avons construit XOR et AND au Chapitre 1
!</p>
<h3 data-number="4.5.3" id="schéma-du-circuit"><span
class="header-section-number">4.5.3</span> Schéma du circuit</h3>
<figure>
<img src="images/half-adder.svg" alt="Demi-additionneur" />
<figcaption aria-hidden="true">Demi-additionneur</figcaption>
</figure>
<h3 data-number="4.5.4" id="limitation"><span
class="header-section-number">4.5.4</span> Limitation</h3>
<p>Le demi-additionneur ne peut pas recevoir de retenue d’une colonne
précédente. Il ne fonctionne donc que pour le bit de poids faible (la
première colonne).</p>
<hr />
<h2 data-number="4.6" id="ladditionneur-complet-full-adder"><span
class="header-section-number">4.6</span> L’Additionneur Complet (Full
Adder)</h2>
<p>Pour additionner des nombres de plusieurs bits, chaque colonne (sauf
la première) doit pouvoir accepter une retenue venant de la colonne
précédente.</p>
<h3 data-number="4.6.1" id="interface"><span
class="header-section-number">4.6.1</span> Interface</h3>
<figure>
<img src="images/full-adder.svg" alt="Additionneur complet" />
<figcaption aria-hidden="true">Additionneur complet</figcaption>
</figure>
<h3 data-number="4.6.2" id="table-de-vérité-1"><span
class="header-section-number">4.6.2</span> Table de vérité</h3>
<table>
<thead>
<tr class="header">
<th>a</th>
<th>b</th>
<th style="text-align: center;">cin</th>
<th style="text-align: center;">sum</th>
<th style="text-align: center;">cout</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td>0</td>
<td>0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td>0</td>
<td>1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td>0</td>
<td>1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td>1</td>
<td>0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td>1</td>
<td>0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td>1</td>
<td>1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td>1</td>
<td>1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
</tr>
</tbody>
</table>
<h3 data-number="4.6.3" id="comment-le-construire"><span
class="header-section-number">4.6.3</span> Comment le construire ?</h3>
<p>Un Full Adder peut être construit avec <strong>deux Half Adders et
une porte OR</strong> :</p>
<ol type="1">
<li>Le premier Half Adder additionne <code>a</code> et
<code>b</code></li>
<li>Le second Half Adder additionne le résultat avec
<code>cin</code></li>
<li>Si l’un des deux Half Adders produit une retenue, on a une retenue
finale</li>
</ol>
<figure>
<img src="images/full-adder-construction.svg"
alt="Construction du Full Adder" />
<figcaption aria-hidden="true">Construction du Full Adder</figcaption>
</figure>
<p>Formules :</p>
<ul>
<li><code>s1 = XOR(a, b)</code></li>
<li><code>sum = XOR(s1, cin)</code></li>
<li><code>c1 = AND(a, b)</code></li>
<li><code>c2 = AND(s1, cin)</code></li>
<li><code>cout = OR(c1, c2)</code></li>
</ul>
<hr />
<h2 data-number="4.7"
id="ladditionneur-32-bits-ripple-carry-adder"><span
class="header-section-number">4.7</span> L’Additionneur 32-bits (Ripple
Carry Adder)</h2>
<p>Pour additionner des nombres de 32 bits, nous connectons 32 Full
Adders en cascade. La retenue de sortie de chaque additionneur devient
la retenue d’entrée du suivant.</p>
<h3 data-number="4.7.1" id="schéma-simplifié"><span
class="header-section-number">4.7.1</span> Schéma simplifié</h3>
<figure>
<img src="images/ripple-carry-adder.svg"
alt="Additionneur 32 bits à propagation de retenue" />
<figcaption aria-hidden="true">Additionneur 32 bits à propagation de
retenue</figcaption>
</figure>
<p><strong>Note</strong> : Le premier Full Adder (position 0) a une
retenue d’entrée de 0 pour une addition normale. Mais on peut y injecter
un 1 pour implémenter la soustraction (A + NOT(B) + 1).</p>
<h3 data-number="4.7.2" id="le-compromis-du-ripple-carry"><span
class="header-section-number">4.7.2</span> Le compromis du Ripple
Carry</h3>
<p><strong>Avantage</strong> : Très simple à comprendre et à
implémenter.</p>
<p><strong>Inconvénient</strong> : Les retenues se propagent d’un bout à
l’autre. Pour 32 bits, la retenue doit traverser 32 étages. C’est lent
!</p>
<p>Dans les vrais processeurs, on utilise des techniques comme le “Carry
Lookahead Adder” pour accélérer la propagation. Mais pour notre projet
pédagogique, le Ripple Carry est parfait.</p>
<hr />
<h2 data-number="4.8" id="lalu-arithmetic-logic-unit"><span
class="header-section-number">4.8</span> L’ALU (Arithmetic Logic
Unit)</h2>
<p>L’ALU est le <strong>cœur calculatoire</strong> du processeur. C’est
elle qui effectue TOUTES les opérations arithmétiques et logiques.</p>
<h3 data-number="4.8.1"
id="pourquoi-combiner-arithmétique-et-logique"><span
class="header-section-number">4.8.1</span> Pourquoi combiner
arithmétique et logique ?</h3>
<p>Plutôt que d’avoir des circuits séparés pour l’addition, la
soustraction, le AND, le OR, etc., l’ALU combine tout en un seul
composant. Un signal de contrôle (<code>op</code>) lui dit quelle
opération effectuer.</p>
<h3 data-number="4.8.2" id="interface-de-lalu-codex"><span
class="header-section-number">4.8.2</span> Interface de l’ALU Codex</h3>
<figure>
<img src="images/alu-interface.svg" alt="Interface de l’ALU" />
<figcaption aria-hidden="true">Interface de l’ALU</figcaption>
</figure>
<h3 data-number="4.8.3" id="les-opérations-de-lalu"><span
class="header-section-number">4.8.3</span> Les Opérations de l’ALU</h3>
<p>Le signal <code>op</code> (4 bits) définit l’opération à effectuer
:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">op (binaire)</th>
<th style="text-align: center;">Nom</th>
<th style="text-align: center;">Opération</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0000</td>
<td style="text-align: center;">AND</td>
<td style="text-align: center;"><code>a &amp; b</code></td>
<td style="text-align: left;">ET logique bit à bit</td>
</tr>
<tr class="even">
<td style="text-align: center;">0001</td>
<td style="text-align: center;">EOR</td>
<td style="text-align: center;"><code>a ^ b</code></td>
<td style="text-align: left;">OU exclusif bit à bit</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0010</td>
<td style="text-align: center;">SUB</td>
<td style="text-align: center;"><code>a - b</code></td>
<td style="text-align: left;">Soustraction</td>
</tr>
<tr class="even">
<td style="text-align: center;">0011</td>
<td style="text-align: center;">ADD</td>
<td style="text-align: center;"><code>a + b</code></td>
<td style="text-align: left;">Addition</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0100</td>
<td style="text-align: center;">ORR</td>
<td style="text-align: center;"><code>a \| b</code></td>
<td style="text-align: left;">OU logique bit à bit</td>
</tr>
<tr class="even">
<td style="text-align: center;">0101</td>
<td style="text-align: center;">MOV</td>
<td style="text-align: center;"><code>b</code></td>
<td style="text-align: left;">Copie de b (ignore a)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0110</td>
<td style="text-align: center;">MVN</td>
<td style="text-align: center;"><code>~b</code></td>
<td style="text-align: left;">Inversion de b (NOT)</td>
</tr>
</tbody>
</table>
<h3 data-number="4.8.4" id="comment-implémenter-la-soustraction"><span
class="header-section-number">4.8.4</span> Comment implémenter la
soustraction ?</h3>
<p>Grâce au complément à 2, la soustraction devient une addition :</p>
<pre><code>A - B = A + (-B) = A + (NOT B) + 1</code></pre>
<p>En pratique :</p>
<ol type="1">
<li>Inverser tous les bits de B (avec des portes NOT)</li>
<li>Additionner A et NOT(B) avec une retenue d’entrée de 1</li>
</ol>
<p>C’est pour cela que notre additionneur a une entrée <code>cin</code>
!</p>
<h3 data-number="4.8.5" id="les-drapeaux-flags"><span
class="header-section-number">4.8.5</span> Les Drapeaux (Flags)</h3>
<p>Les drapeaux sont des informations supplémentaires sur le résultat
:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">Drapeau</th>
<th style="text-align: left;">Nom</th>
<th style="text-align: left;">Signification</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>N</strong></td>
<td style="text-align: left;">Negative</td>
<td style="text-align: left;">1 si le résultat est négatif (bit 31 =
1)</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Z</strong></td>
<td style="text-align: left;">Zero</td>
<td style="text-align: left;">1 si le résultat est exactement 0</td>
</tr>
<tr class="odd">
<td style="text-align: center;"><strong>C</strong></td>
<td style="text-align: left;">Carry</td>
<td style="text-align: left;">1 s’il y a eu une retenue (dépassement
non-signé)</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>V</strong></td>
<td style="text-align: left;">Overflow</td>
<td style="text-align: left;">1 s’il y a eu un dépassement signé</td>
</tr>
</tbody>
</table>
<p><strong>À quoi servent ces drapeaux ?</strong></p>
<p>Ils permettent au CPU de prendre des décisions :</p>
<ul>
<li><code>BEQ</code> (Branch if Equal) teste si Z = 1</li>
<li><code>BLT</code> (Branch if Less Than) teste une combinaison de N et
V</li>
<li><code>BCS</code> (Branch if Carry Set) teste si C = 1</li>
</ul>
<p>Sans les drapeaux, il serait impossible d’implémenter les conditions
<code>if</code>, les boucles <code>while</code>, etc. !</p>
<h3 data-number="4.8.6" id="comment-calculer-les-drapeaux"><span
class="header-section-number">4.8.6</span> Comment calculer les drapeaux
?</h3>
<ul>
<li><strong>N (Negative)</strong> : C’est simplement le bit 31 du
résultat</li>
<li><strong>Z (Zero)</strong> : NOR de tous les bits du résultat (tous à
0 ?)</li>
<li><strong>C (Carry)</strong> : La retenue de sortie de
l’additionneur</li>
<li><strong>V (Overflow)</strong> : Se produit quand :
<ul>
<li>Deux positifs donnent un négatif</li>
<li>Deux négatifs donnent un positif</li>
<li>Formule : <code>V = (a[31] == b[31]) AND (a[31] != y[31])</code>
(pour l’addition)</li>
</ul></li>
</ul>
<hr />
<h2 data-number="4.9" id="architecture-de-lalu"><span
class="header-section-number">4.9</span> Architecture de l’ALU</h2>
<p>Voici comment l’ALU est structurée en interne :</p>
<figure>
<img src="images/alu-architecture.svg" alt="Architecture de l’ALU" />
<figcaption aria-hidden="true">Architecture de l’ALU</figcaption>
</figure>
<p>L’idée clé : calculer TOUS les résultats possibles en parallèle, puis
utiliser un multiplexeur pour sélectionner le bon selon
<code>op</code>.</p>
<hr />
<h2 data-number="4.10" id="exercices-pratiques-1"><span
class="header-section-number">4.10</span> Exercices Pratiques</h2>
<h3 data-number="4.10.1" id="exercices-sur-le-simulateur-web-1"><span
class="header-section-number">4.10.1</span> Exercices sur le Simulateur
Web</h3>
<p>Lancez le <strong>Simulateur Web</strong> et allez dans <strong>HDL
Progression</strong> → <strong>Projet 3 : Arithmétique</strong>.</p>
<table>
<thead>
<tr class="header">
<th>Exercice</th>
<th>Description</th>
<th style="text-align: center;">Difficulté</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>HalfAdder</code></td>
<td>Demi-additionneur (XOR + AND)</td>
<td style="text-align: center;">[*]</td>
</tr>
<tr class="even">
<td><code>FullAdder</code></td>
<td>Additionneur complet (2 Half Adders + OR)</td>
<td style="text-align: center;">[**]</td>
</tr>
<tr class="odd">
<td><code>Add16</code></td>
<td>Additionneur 16 bits en cascade</td>
<td style="text-align: center;">[**]</td>
</tr>
<tr class="even">
<td><code>Inc16</code></td>
<td>Incrémenteur (+1) — cas spécial utile</td>
<td style="text-align: center;">[*]</td>
</tr>
<tr class="odd">
<td><code>Sub16</code></td>
<td>Soustracteur (via complément à 2)</td>
<td style="text-align: center;">[**]</td>
</tr>
<tr class="even">
<td><code>ALU</code></td>
<td>L’ALU complète avec drapeaux</td>
<td style="text-align: center;">[***]</td>
</tr>
</tbody>
</table>
<h3 data-number="4.10.2" id="conseils-pour-lalu"><span
class="header-section-number">4.10.2</span> Conseils pour l’ALU</h3>
<ol type="1">
<li><p><strong>Commencez par les opérations simples</strong> : AND, OR,
XOR sont juste des portes appliquées bit à bit</p></li>
<li><p><strong>Pour la soustraction</strong> :</p>
<pre><code>sub = a + (NOT b) + 1</code></pre>
<p>Utilisez un inverseur sur b et une retenue d’entrée de 1</p></li>
<li><p><strong>Utilisez les Mux</strong> : Un Mux4Way ou Mux8Way
sélectionne parmi plusieurs résultats</p></li>
<li><p><strong>Les drapeaux</strong> :</p>
<ul>
<li>N : bit 31 du résultat</li>
<li>Z : tous les bits sont à 0 ? (utilisez un grand OR puis NOT)</li>
<li>C : retenue de sortie de l’additionneur</li>
<li>V : comparez les signes des entrées et du résultat</li>
</ul></li>
</ol>
<h3 data-number="4.10.3" id="tests-en-ligne-de-commande"><span
class="header-section-number">4.10.3</span> Tests en ligne de
commande</h3>
<div class="sourceCode" id="cb20"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tester le Half Adder</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> run <span class="at">-p</span> hdl_cli <span class="at">--</span> test hdl_lib/03_arith/HalfAdder.hdl</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Tester l&#39;ALU complète</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> run <span class="at">-p</span> hdl_cli <span class="at">--</span> test hdl_lib/03_arith/ALU.hdl</span></code></pre></div>
<hr />
<h2 data-number="4.11" id="défis-supplémentaires-1"><span
class="header-section-number">4.11</span> Défis Supplémentaires</h2>
<h3 data-number="4.11.1" id="défi-1-carry-lookahead"><span
class="header-section-number">4.11.1</span> Défi 1 : Carry
Lookahead</h3>
<p>Le Ripple Carry est lent car les retenues se propagent
séquentiellement. Implémentez un “Carry Lookahead Adder” sur 4 bits qui
calcule les retenues en parallèle.</p>
<h3 data-number="4.11.2" id="défi-2-multiplicateur"><span
class="header-section-number">4.11.2</span> Défi 2 : Multiplicateur</h3>
<p>Construisez un circuit qui multiplie deux nombres de 4 bits. Indice :
la multiplication est une série d’additions décalées.</p>
<h3 data-number="4.11.3" id="défi-3-comparateur"><span
class="header-section-number">4.11.3</span> Défi 3 : Comparateur</h3>
<p>Construisez un circuit qui compare deux nombres 32 bits et produit
trois sorties :</p>
<p>/bin/bash: ligne 1: q : commande introuvable - <code>eq</code> : a ==
b - <code>gt</code> : a &gt; b</p>
<p>Indice : Vous pouvez utiliser la soustraction et regarder les
drapeaux !</p>
<hr />
<h2 data-number="4.12" id="le-lien-avec-le-cpu"><span
class="header-section-number">4.12</span> Le Lien avec le CPU</h2>
<p>L’ALU que vous venez de construire sera utilisée à CHAQUE cycle
d’horloge du CPU :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Instruction</th>
<th style="text-align: left;">Utilisation de l’ALU</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>ADD R1, R2, R3</code></td>
<td style="text-align: left;">Additionne R2 et R3, stocke dans R1</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>SUB R1, R2, R3</code></td>
<td style="text-align: left;">Soustrait R3 de R2</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>CMP R1, R2</code></td>
<td style="text-align: left;">Soustrait et met à jour les drapeaux (sans
stocker)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>AND R1, R2, R3</code></td>
<td style="text-align: left;">ET logique</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>LDR R1, [R2]</code></td>
<td style="text-align: left;">Calcule l’adresse mémoire (R2 +
offset)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>B label</code></td>
<td style="text-align: left;">Calcule la nouvelle adresse (PC +
offset)</td>
</tr>
</tbody>
</table>
<p>Même les sauts conditionnels (<code>BEQ</code>, <code>BNE</code>,
etc.) dépendent des drapeaux produits par l’ALU !</p>
<hr />
<h2 data-number="4.13" id="ce-quil-faut-retenir-1"><span
class="header-section-number">4.13</span> Ce qu’il faut retenir</h2>
<ol type="1">
<li><p><strong>Le binaire est naturel pour les circuits</strong> :
Addition = XOR pour le bit, AND pour la retenue</p></li>
<li><p><strong>Le complément à 2 est magique</strong> : Un seul
additionneur pour addition ET soustraction</p></li>
<li><p><strong>L’ALU est le cœur du calcul</strong> : Toutes les
opérations passent par elle</p></li>
<li><p><strong>Les drapeaux permettent les décisions</strong> : Sans
eux, pas de <code>if</code>, pas de boucles</p></li>
<li><p><strong>La hiérarchie continue</strong> :</p>
<ul>
<li>Portes → Half Adder → Full Adder → Additionneur 32-bits → ALU</li>
</ul></li>
</ol>
<p><strong>Prochaine étape</strong> : Au Chapitre 3, nous aborderons la
<strong>mémoire</strong>. Comment l’ordinateur peut-il “se souvenir” de
données ? Nous construirons des flip-flops, des registres, et de la
RAM.</p>
<hr />
<p><strong>Conseil</strong> : L’ALU est l’un des composants les plus
complexes du projet. Prenez le temps de bien comprendre chaque étape. Si
vous avez réussi l’ALU, le reste du projet sera beaucoup plus accessible
!</p>
<hr />
<h2 data-number="4.14" id="auto-évaluation-1"><span
class="header-section-number">4.14</span> Auto-évaluation</h2>
<p>Testez votre compréhension avant de passer au chapitre suivant.</p>
<h3 data-number="4.14.1" id="questions-de-compréhension-1"><span
class="header-section-number">4.14.1</span> Questions de
compréhension</h3>
<p><strong>Q1.</strong> Dans un Half Adder, quelle porte logique calcule
le bit de somme ? Et la retenue ?</p>
<p><strong>Q2.</strong> Quelle est la représentation en complément à 2
de -1 sur 8 bits ?</p>
<p><strong>Q3.</strong> Comment l’ALU effectue-t-elle une soustraction A
- B ?</p>
<p><strong>Q4.</strong> Que signifient les drapeaux N, Z, C, V ?</p>
<p><strong>Q5.</strong> Pourquoi <code>CMP R1, R2</code> n’a pas besoin
de registre destination ?</p>
<h3 data-number="4.14.2" id="mini-défi-pratique-1"><span
class="header-section-number">4.14.2</span> Mini-défi pratique</h3>
<p>Calculez mentalement le résultat de ces opérations sur 8 bits :</p>
<table>
<thead>
<tr class="header">
<th>Opération</th>
<th>A (hex)</th>
<th>B (hex)</th>
<th>Résultat</th>
<th>Drapeaux</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>ADD</td>
<td>0x7F</td>
<td>0x01</td>
<td>?</td>
<td>N=? Z=? V=?</td>
</tr>
<tr class="even">
<td>ADD</td>
<td>0xFF</td>
<td>0x01</td>
<td>?</td>
<td>N=? Z=? C=?</td>
</tr>
<tr class="odd">
<td>SUB</td>
<td>0x05</td>
<td>0x05</td>
<td>?</td>
<td>Z=?</td>
</tr>
</tbody>
</table>
<p><em>Les solutions se trouvent dans le document
<strong>Codex_Solutions</strong>.</em></p>
<h3 data-number="4.14.3" id="checklist-de-validation-1"><span
class="header-section-number">4.14.3</span> Checklist de validation</h3>
<p>Avant de passer au chapitre 3, assurez-vous de pouvoir :</p>
<ul class="task-list">
<li><label><input type="checkbox" />Expliquer la différence entre Half
Adder et Full Adder</label></li>
<li><label><input type="checkbox" />Convertir un nombre négatif en
complément à 2</label></li>
<li><label><input type="checkbox" />Expliquer comment la soustraction
utilise l’addition</label></li>
<li><label><input type="checkbox" />Décrire le rôle de chaque drapeau
(N, Z, C, V)</label></li>
<li><label><input type="checkbox" />Implémenter un additionneur 32 bits
en chaînant des Full Adders</label></li>
</ul>
<h1 data-number="5" id="logique-séquentielle-et-mémoire"><span
class="header-section-number">5</span> Logique Séquentielle et
Mémoire</h1>
<blockquote>
<p>“Le temps est ce qui empêche tout d’arriver en même temps.” — John
Wheeler</p>
</blockquote>
<p>Jusqu’à présent, nos circuits étaient <strong>combinatoires</strong>
: la sortie dépendait uniquement des entrées instantanées, comme une
fonction mathématique pure <code>y = f(x)</code>. Si vous coupez le
courant, ils “oublient” tout.</p>
<p>Pour construire un véritable ordinateur, nous devons pouvoir
<strong>stocker de l’information</strong> et la récupérer plus tard.
C’est le rôle de la <strong>logique séquentielle</strong>.</p>
<hr />
<h2 data-number="5.1" id="où-en-sommes-nous-2"><span
class="header-section-number">5.1</span> Où en sommes-nous ?</h2>
<figure>
<img src="images/architecture-stack.svg"
alt="Position dans l’architecture" />
<figcaption aria-hidden="true">Position dans l’architecture</figcaption>
</figure>
<p><em>Nous sommes à la Couche 1 : Logique Matérielle (Portes - ALU -
MEMOIRE - CPU)</em></p>
<p>Nous continuons à construire la couche matérielle. Après les portes
logiques (Chapitre 1) et l’ALU (Chapitre 2), nous abordons maintenant la
<strong>mémoire</strong> — le composant qui permet à l’ordinateur de “se
souvenir”.</p>
<hr />
<h2 data-number="5.2"
id="pourquoi-la-mémoire-est-elle-fondamentale"><span
class="header-section-number">5.2</span> Pourquoi la Mémoire est-elle
Fondamentale ?</h2>
<h3 data-number="5.2.1" id="le-problème-de-létat"><span
class="header-section-number">5.2.1</span> Le problème de l’état</h3>
<p>Imaginez un programme simple :</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> x <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span></code></pre></div>
<p>Pour exécuter cette instruction, l’ordinateur doit : 1.
<strong>Lire</strong> la valeur actuelle de <code>x</code> 2.
<strong>Calculer</strong> <code>x + 1</code> (avec l’ALU) 3.
<strong>Écrire</strong> le résultat dans <code>x</code></p>
<p>Sans mémoire, il n’y a pas de “valeur actuelle de x” à lire. Sans
mémoire, le résultat du calcul disparaît immédiatement après avoir été
produit.</p>
<h3 data-number="5.2.2" id="ce-que-stocke-la-mémoire"><span
class="header-section-number">5.2.2</span> Ce que stocke la mémoire</h3>
<p>Un ordinateur en fonctionnement stocke : - <strong>Le
programme</strong> : Les instructions à exécuter (le code machine) -
<strong>Les données</strong> : Les variables, les tableaux, les objets -
<strong>L’état du CPU</strong> : Les registres, le compteur de programme
- <strong>La pile d’appels</strong> : Pour les fonctions et les
retours</p>
<p>Toutes ces informations vivent dans différentes formes de
mémoire.</p>
<h3 data-number="5.2.3" id="combinatoire-vs-séquentiel"><span
class="header-section-number">5.2.3</span> Combinatoire vs
Séquentiel</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Circuits Combinatoires</th>
<th style="text-align: left;">Circuits Séquentiels</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Sortie = f(entrées)</td>
<td style="text-align: left;">Sortie = f(entrées, <strong>état
précédent</strong>)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pas de mémoire</td>
<td style="text-align: left;">A de la mémoire</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pas d’horloge</td>
<td style="text-align: left;">Synchronisé par une horloge</td>
</tr>
<tr class="even">
<td style="text-align: left;">Exemples : AND, OR, ALU</td>
<td style="text-align: left;">Exemples : Registres, RAM, CPU</td>
</tr>
</tbody>
</table>
<hr />
<h2 data-number="5.3" id="le-temps-et-lhorloge-clock"><span
class="header-section-number">5.3</span> Le Temps et l’Horloge
(Clock)</h2>
<h3 data-number="5.3.1" id="le-problème-de-la-synchronisation"><span
class="header-section-number">5.3.1</span> Le problème de la
synchronisation</h3>
<p>Dans un circuit combinatoire, les signaux se propagent à travers les
portes avec un léger délai. Si on essaie de lire un résultat avant qu’il
soit stable, on obtient des valeurs incorrectes.</p>
<p><strong>La solution</strong> : L’<strong>horloge</strong>
(<code>clk</code>).</p>
<p>L’horloge est un signal qui oscille perpétuellement entre 0 et 1 à
une fréquence fixe :</p>
<figure>
<img src="images/clock-signal.svg" alt="Signal d’horloge" />
<figcaption aria-hidden="true">Signal d’horloge</figcaption>
</figure>
<h3 data-number="5.3.2" id="front-montant-rising-edge"><span
class="header-section-number">5.3.2</span> Front montant (Rising
Edge)</h3>
<p>Le moment crucial est le <strong>front montant</strong> : le passage
de 0 à 1.</p>
<p>Dans le système Codex, les changements d’état se produisent sur le
front montant. Cela signifie :</p>
<ul>
<li>Pendant que l’horloge est à 0, les circuits combinatoires
calculent</li>
<li>Quand l’horloge passe à 1, les résultats sont capturés dans les
registres</li>
</ul>
<p>C’est comme dire : “Tout le monde calcule… et maintenant, on fige les
résultats !”</p>
<h3 data-number="5.3.3" id="fréquence-dhorloge"><span
class="header-section-number">5.3.3</span> Fréquence d’horloge</h3>
<p>La fréquence de l’horloge détermine la vitesse du processeur :</p>
<ul>
<li>Un processeur à 1 GHz = 1 milliard de cycles par seconde</li>
<li>À chaque cycle, le CPU peut exécuter (une partie d’)une
instruction</li>
</ul>
<p>Plus vite bat l’horloge, plus l’ordinateur est rapide — mais aussi
plus il chauffe !</p>
<hr />
<h2 data-number="5.4" id="la-bascule-d-d-flip-flop-dff"><span
class="header-section-number">5.4</span> La Bascule D (D Flip-Flop /
DFF)</h2>
<p>La <strong>DFF</strong> (Data Flip-Flop) est l’atome de la mémoire.
C’est le plus petit circuit capable de mémoriser un bit.</p>
<h3 data-number="5.4.1" id="interface-1"><span
class="header-section-number">5.4.1</span> Interface</h3>
<figure>
<img src="images/dff.svg" alt="Bascule D (DFF)" />
<figcaption aria-hidden="true">Bascule D (DFF)</figcaption>
</figure>
<ul>
<li><code>d</code> : La donnée à mémoriser (entrée)</li>
<li><code>q</code> : La donnée mémorisée (sortie)</li>
<li><code>clk</code> : L’horloge (parfois implicite)</li>
</ul>
<h3 data-number="5.4.2" id="comportement"><span
class="header-section-number">5.4.2</span> Comportement</h3>
<p><strong>Règle fondamentale</strong> : <code>q(t) = d(t-1)</code></p>
<p>La sortie à l’instant <em>t</em> est égale à ce qu’était l’entrée au
cycle précédent.</p>
<figure>
<img src="images/clock-timing.svg" alt="Signal d’horloge et DFF" />
<figcaption aria-hidden="true">Signal d’horloge et DFF</figcaption>
</figure>
<h3 data-number="5.4.3" id="pourquoi-est-ce-utile"><span
class="header-section-number">5.4.3</span> Pourquoi est-ce utile ?</h3>
<p>La DFF introduit un <strong>délai d’un cycle</strong>. Ce délai
permet : 1. De stocker une valeur pour le prochain cycle 2. De casser
les boucles (éviter les oscillations infinies) 3. De synchroniser tous
les composants sur l’horloge</p>
<h3 data-number="5.4.4" id="comment-fonctionne-une-dff-en-interne"><span
class="header-section-number">5.4.4</span> Comment fonctionne une DFF en
interne ?</h3>
<p>Une DFF peut être construite à partir de deux verrous (latches) en
série, eux-mêmes construits à partir de portes NAND. C’est un sujet
fascinant mais hors de notre scope — nous considérons la DFF comme une
primitive fournie par le simulateur.</p>
<hr />
<h2 data-number="5.5" id="le-registre-1-bit-bit"><span
class="header-section-number">5.5</span> Le Registre 1-bit (Bit)</h2>
<p>La DFF mémorise pendant UN cycle, puis elle prend la nouvelle valeur
d’entrée. Comment garder une valeur <strong>indéfiniment</strong> ?</p>
<h3 data-number="5.5.1" id="le-problème"><span
class="header-section-number">5.5.1</span> Le problème</h3>
<p>On veut un circuit qui :</p>
<ul>
<li>Si <code>load = 1</code> : stocke la nouvelle valeur
<code>in</code></li>
<li>Si <code>load = 0</code> : conserve l’ancienne valeur</li>
</ul>
<h3 data-number="5.5.2" id="la-solution-la-rétroaction"><span
class="header-section-number">5.5.2</span> La solution : la
rétroaction</h3>
<p>On utilise un <strong>Mux</strong> pour choisir entre :</p>
<ul>
<li>L’ancienne valeur (sortie de la DFF)</li>
<li>La nouvelle valeur (<code>in</code>)</li>
</ul>
<figure>
<img src="images/bit-register.svg"
alt="Registre 1-bit avec rétroaction" />
<figcaption aria-hidden="true">Registre 1-bit avec
rétroaction</figcaption>
</figure>
<p><strong>Fonctionnement</strong> :</p>
<ul>
<li>Si <code>load = 0</code> : Le Mux sélectionne la sortie de la DFF.
La DFF ré-enregistre sa propre valeur. La valeur est
<strong>maintenue</strong>.</li>
<li>Si <code>load = 1</code> : Le Mux sélectionne <code>in</code>. La
DFF enregistre la nouvelle valeur.</li>
</ul>
<h3 data-number="5.5.3" id="cest-magique"><span
class="header-section-number">5.5.3</span> C’est magique !</h3>
<p>Cette petite boucle de rétroaction transforme un délai d’un cycle en
une mémoire permanente. C’est le principe fondamental de toute mémoire
électronique.</p>
<hr />
<h2 data-number="5.6" id="le-registre-32-bits"><span
class="header-section-number">5.6</span> Le Registre 32-bits</h2>
<h3 data-number="5.6.1" id="du-bit-au-mot"><span
class="header-section-number">5.6.1</span> Du bit au mot</h3>
<p>Un registre 32-bits est simplement <strong>32 registres 1-bit en
parallèle</strong>, partageant le même signal <code>load</code>.</p>
<figure>
<img src="images/register32.svg" alt="Registre 32 bits" />
<figcaption aria-hidden="true">Registre 32 bits</figcaption>
</figure>
<p>Quand <code>load = 1</code>, les 32 bits sont capturés simultanément.
C’est atomique.</p>
<h3 data-number="5.6.2" id="le-rôle-des-registres-dans-le-cpu"><span
class="header-section-number">5.6.2</span> Le rôle des registres dans le
CPU</h3>
<p>Le CPU Codex dispose de <strong>16 registres</strong> nommés R0 à R15
:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">Registre</th>
<th style="text-align: left;">Rôle typique</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">R0-R12</td>
<td style="text-align: left;">Registres généraux (calculs,
variables)</td>
</tr>
<tr class="even">
<td style="text-align: center;">R13 (SP)</td>
<td style="text-align: left;">Stack Pointer (pointeur de pile)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">R14 (LR)</td>
<td style="text-align: left;">Link Register (adresse de retour)</td>
</tr>
<tr class="even">
<td style="text-align: center;">R15 (PC)</td>
<td style="text-align: left;">Program Counter (adresse de l’instruction
courante)</td>
</tr>
</tbody>
</table>
<p>Les registres sont la mémoire la plus rapide du CPU — ils sont
directement connectés à l’ALU et peuvent être lus/écrits en un seul
cycle.</p>
<hr />
<h2 data-number="5.7" id="la-ram-random-access-memory"><span
class="header-section-number">5.7</span> La RAM (Random Access
Memory)</h2>
<h3 data-number="5.7.1" id="du-registre-à-la-mémoire"><span
class="header-section-number">5.7.1</span> Du registre à la mémoire</h3>
<p>Un registre stocke UN mot de 32 bits. Pour stocker des millions de
mots, nous construisons une <strong>RAM</strong> (Random Access
Memory).</p>
<p>“Random Access” signifie qu’on peut accéder à n’importe quelle
cellule directement, sans parcourir les autres. Contrairement à une
bande magnétique où il faut rembobiner !</p>
<h3 data-number="5.7.2" id="interface-de-la-ram"><span
class="header-section-number">5.7.2</span> Interface de la RAM</h3>
<figure>
<img src="images/ram-interface.svg" alt="Interface de la RAM" />
<figcaption aria-hidden="true">Interface de la RAM</figcaption>
</figure>
<ul>
<li><code>in</code> : La donnée à écrire</li>
<li><code>address</code> : L’adresse de la cellule à lire/écrire</li>
<li><code>load</code> : Si 1, écrire <code>in</code> à
<code>address</code>. Si 0, ne rien écrire.</li>
<li><code>out</code> : La valeur stockée à <code>address</code>
(toujours disponible en lecture)</li>
</ul>
<h3 data-number="5.7.3" id="comment-ça-marche"><span
class="header-section-number">5.7.3</span> Comment ça marche ?</h3>
<p>La RAM utilise les composants que nous avons construits :</p>
<ol type="1">
<li><strong>DMux</strong> (Démultiplexeur) : Route le signal
<code>load</code> vers UN SEUL registre — celui correspondant à
l’adresse</li>
<li><strong>Registres</strong> : Stockent les données</li>
<li><strong>Mux</strong> (Multiplexeur) : Sélectionne la sortie du
registre correspondant à l’adresse</li>
</ol>
<h3 data-number="5.7.4" id="exemple-ram8-8-mots-de-32-bits"><span
class="header-section-number">5.7.4</span> Exemple : RAM8 (8 mots de 32
bits)</h3>
<figure>
<img src="images/ram8-architecture.svg" alt="Architecture RAM8" />
<figcaption aria-hidden="true">Architecture RAM8</figcaption>
</figure>
<h3 data-number="5.7.5"
id="construction-hiérarchique-de-grandes-rams"><span
class="header-section-number">5.7.5</span> Construction hiérarchique de
grandes RAMs</h3>
<p>Comment construire une RAM64 (64 mots) à partir de RAM8 ?</p>
<pre><code>address[5:0] = address[5:3] (3 bits supérieurs) + address[2:0] (3 bits inférieurs)
               ↓                                  ↓
        Sélectionne laquelle des 8 RAM8    Sélectionne le mot dans cette RAM8</code></pre>
<p>On utilise 8 RAM8 :</p>
<ul>
<li>Les 3 bits de poids fort (<code>address[5:3]</code>) choisissent
<strong>quelle RAM8</strong></li>
<li>Les 3 bits de poids faible (<code>address[2:0]</code>) choisissent
<strong>quel mot dans la RAM8</strong></li>
</ul>
<p>C’est un pattern récursif qui permet de construire des mémoires de
n’importe quelle taille !</p>
<hr />
<h2 data-number="5.8" id="le-compteur-de-programme-pc"><span
class="header-section-number">5.8</span> Le Compteur de Programme
(PC)</h2>
<p>Le <strong>Program Counter</strong> (PC) est peut-être le registre le
plus important du CPU. Il contient l’adresse de la prochaine instruction
à exécuter.</p>
<h3 data-number="5.8.1" id="pourquoi-est-il-spécial"><span
class="header-section-number">5.8.1</span> Pourquoi est-il spécial
?</h3>
<p>Après chaque instruction, le PC doit passer à l’instruction suivante.
Mais parfois :</p>
<ul>
<li>On veut <strong>sauter</strong> à une autre adresse (boucles,
conditions)</li>
<li>On veut <strong>revenir à 0</strong> (redémarrage)</li>
</ul>
<h3 data-number="5.8.2" id="les-trois-modes-du-pc"><span
class="header-section-number">5.8.2</span> Les trois modes du PC</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">Priorité</th>
<th style="text-align: left;">Mode</th>
<th style="text-align: left;">Condition</th>
<th style="text-align: left;">Action</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">1</td>
<td style="text-align: left;"><strong>Reset</strong></td>
<td style="text-align: left;"><code>reset = 1</code></td>
<td style="text-align: left;"><code>PC ← 0</code></td>
</tr>
<tr class="even">
<td style="text-align: center;">2</td>
<td style="text-align: left;"><strong>Jump</strong></td>
<td style="text-align: left;"><code>load = 1</code></td>
<td style="text-align: left;"><code>PC ← in</code></td>
</tr>
<tr class="odd">
<td style="text-align: center;">3</td>
<td style="text-align: left;"><strong>Increment</strong></td>
<td style="text-align: left;"><code>inc = 1</code></td>
<td style="text-align: left;"><code>PC ← PC + 1</code></td>
</tr>
<tr class="even">
<td style="text-align: center;">4</td>
<td style="text-align: left;"><strong>Hold</strong></td>
<td style="text-align: left;">sinon</td>
<td style="text-align: left;"><code>PC ← PC</code></td>
</tr>
</tbody>
</table>
<h3 data-number="5.8.3" id="schéma-simplifié-1"><span
class="header-section-number">5.8.3</span> Schéma simplifié</h3>
<figure>
<img src="images/pc-register.svg" alt="Compteur de programme (PC)" />
<figcaption aria-hidden="true">Compteur de programme (PC)</figcaption>
</figure>
<h3 data-number="5.8.4" id="le-lien-avec-lexécution-du-programme"><span
class="header-section-number">5.8.4</span> Le lien avec l’exécution du
programme</h3>
<p>À chaque cycle d’horloge :</p>
<ol type="1">
<li>Le CPU lit l’instruction à l’adresse <code>PC</code></li>
<li>Il décode et exécute l’instruction</li>
<li>Il met à jour le PC (incrément ou saut)</li>
<li>Le cycle recommence</li>
</ol>
<p>C’est le cœur battant de l’ordinateur !</p>
<hr />
<h2 data-number="5.9" id="les-différents-types-de-mémoire"><span
class="header-section-number">5.9</span> Les Différents Types de
Mémoire</h2>
<p>Dans un vrai ordinateur, il y a plusieurs niveaux de mémoire :</p>
<figure>
<img src="images/memory-hierarchy.svg"
alt="Pyramide de la hiérarchie mémoire" />
<figcaption aria-hidden="true">Pyramide de la hiérarchie
mémoire</figcaption>
</figure>
<p>Plus on monte dans la pyramide :</p>
<ul>
<li>Plus c’est rapide</li>
<li>Plus c’est cher par octet</li>
<li>Plus la capacité est faible</li>
</ul>
<p>Dans le Codex, nous implémentons les registres et la RAM. Les caches
et les disques sont des concepts plus avancés.</p>
<hr />
<h2 data-number="5.10" id="exercices-pratiques-2"><span
class="header-section-number">5.10</span> Exercices Pratiques</h2>
<h3 data-number="5.10.1" id="exercices-sur-le-simulateur-web-2"><span
class="header-section-number">5.10.1</span> Exercices sur le Simulateur
Web</h3>
<p>Lancez le <strong>Simulateur Web</strong> et allez dans <strong>HDL
Progression</strong> → <strong>Projet 4 : Séquentiel</strong>.</p>
<table>
<colgroup>
<col style="width: 28%" />
<col style="width: 37%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr class="header">
<th>Exercice</th>
<th>Description</th>
<th style="text-align: center;">Difficulté</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>DFF1</code></td>
<td>Bascule D (fournie comme primitive)</td>
<td style="text-align: center;">—</td>
</tr>
<tr class="even">
<td><code>BitReg</code></td>
<td>Registre 1-bit (Mux + DFF)</td>
<td style="text-align: center;">[*]</td>
</tr>
<tr class="odd">
<td><code>Register16</code></td>
<td>Registre 16-bits (16 BitReg en parallèle)</td>
<td style="text-align: center;">[*]</td>
</tr>
<tr class="even">
<td><code>PC</code></td>
<td>Compteur de programme avec reset/load/inc</td>
<td style="text-align: center;">[**]</td>
</tr>
<tr class="odd">
<td><code>RAM8</code></td>
<td>RAM de 8 mots (DMux + 8 Registres + Mux)</td>
<td style="text-align: center;">[**]</td>
</tr>
<tr class="even">
<td><code>RAM64</code></td>
<td>RAM de 64 mots (8 RAM8)</td>
<td style="text-align: center;">[**]</td>
</tr>
<tr class="odd">
<td><code>RegFile</code></td>
<td>Banc de registres (lecture double, écriture simple)</td>
<td style="text-align: center;">[***]</td>
</tr>
</tbody>
</table>
<h3 data-number="5.10.2" id="ordre-de-progression-recommandé"><span
class="header-section-number">5.10.2</span> Ordre de progression
recommandé</h3>
<ol type="1">
<li><strong>BitReg</strong> : La brique de base. Un Mux et une DFF.</li>
<li><strong>Register16</strong> : 16 BitReg en parallèle. Vérifiez que
tous les bits sont synchronisés.</li>
<li><strong>PC</strong> : Attention à la priorité ! reset &gt; load &gt;
inc &gt; hold</li>
<li><strong>RAM8</strong> : Utilisez DMux8Way et Mux8Way16</li>
<li><strong>RAM64</strong> : Composition de 8 RAM8</li>
</ol>
<h3 data-number="5.10.3" id="prérequis"><span
class="header-section-number">5.10.3</span> Prérequis</h3>
<p>Avant de construire les RAMs, assurez-vous d’avoir terminé les
composants multi-bits du Projet 2 : - <code>Mux8Way16</code> :
Sélectionne parmi 8 entrées de 16 bits - <code>DMux8Way</code> :
Distribue 1 entrée vers 8 sorties</p>
<h3 data-number="5.10.4" id="tests-en-ligne-de-commande-1"><span
class="header-section-number">5.10.4</span> Tests en ligne de
commande</h3>
<div class="sourceCode" id="cb23"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tester le registre 1-bit</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> run <span class="at">-p</span> hdl_cli <span class="at">--</span> test hdl_lib/04_seq/BitReg.hdl</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Tester la RAM8</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> run <span class="at">-p</span> hdl_cli <span class="at">--</span> test hdl_lib/04_seq/RAM8.hdl</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Tester le PC</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> run <span class="at">-p</span> hdl_cli <span class="at">--</span> test hdl_lib/04_seq/PC.hdl</span></code></pre></div>
<hr />
<h2 data-number="5.11" id="défis-supplémentaires-2"><span
class="header-section-number">5.11</span> Défis Supplémentaires</h2>
<h3 data-number="5.11.1"
id="défi-1-ram-avec-deux-ports-de-lecture"><span
class="header-section-number">5.11.1</span> Défi 1 : RAM avec deux ports
de lecture</h3>
<p>Construisez une RAM qui permet de lire DEUX adresses différentes
simultanément (utile pour le CPU qui doit lire deux opérandes).</p>
<h3 data-number="5.11.2" id="défi-2-compteur-avec-valeur-maximale"><span
class="header-section-number">5.11.2</span> Défi 2 : Compteur avec
valeur maximale</h3>
<p>Modifiez le PC pour qu’il s’arrête à une valeur maximale au lieu de
continuer à compter (overflow protection).</p>
<h3 data-number="5.11.3"
id="défi-3-registre-à-décalage-shift-register"><span
class="header-section-number">5.11.3</span> Défi 3 : Registre à décalage
(Shift Register)</h3>
<p>Construisez un registre où les bits se décalent d’une position à
chaque cycle. Utilisé pour : - Les communications série - La
multiplication/division par 2 - Les générateurs de nombres
aléatoires</p>
<hr />
<h2 data-number="5.12" id="le-lien-avec-la-suite"><span
class="header-section-number">5.12</span> Le Lien avec la Suite</h2>
<p>La mémoire que vous venez de construire sera utilisée partout dans
l’ordinateur :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Composant</th>
<th style="text-align: left;">Utilisation de la mémoire</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Registres R0-R15</strong></td>
<td style="text-align: left;">16 registres 32-bits pour les calculs</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>RAM</strong></td>
<td style="text-align: left;">Stockage du programme et des données</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>PC</strong></td>
<td style="text-align: left;">Adresse de l’instruction courante</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Pile (Stack)</strong></td>
<td style="text-align: left;">Zone de RAM pour les appels de
fonction</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Écran</strong></td>
<td style="text-align: left;">Zone de RAM mappée aux pixels (MMIO)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Clavier</strong></td>
<td style="text-align: left;">Registre mappé en mémoire (MMIO)</td>
</tr>
</tbody>
</table>
<p>Au Chapitre 4, nous verrons comment le CPU accède à la mémoire et aux
périphériques via le <strong>Memory-Mapped I/O</strong> (MMIO).</p>
<hr />
<h2 data-number="5.13" id="ce-quil-faut-retenir-2"><span
class="header-section-number">5.13</span> Ce qu’il faut retenir</h2>
<ol type="1">
<li><p><strong>L’horloge synchronise tout</strong> : Les changements se
font sur le front montant</p></li>
<li><p><strong>La DFF est l’atome de mémoire</strong> :
<code>q(t) = d(t-1)</code></p></li>
<li><p><strong>La rétroaction crée la persistance</strong> : Mux + DFF =
mémoire permanente</p></li>
<li><p><strong>La RAM est un tableau de registres</strong> : Accès par
adresse</p></li>
<li><p><strong>Le PC guide l’exécution</strong> : Il pointe vers
l’instruction courante</p></li>
<li><p><strong>Hiérarchie de mémoire</strong> :</p>
<ul>
<li>Registres → Cache → RAM → Disque</li>
<li>Rapidité vs Capacité</li>
</ul></li>
</ol>
<p><strong>Prochaine étape</strong> : Au Chapitre 4, nous définissons
l’<strong>Architecture Machine</strong> (ISA). C’est le “contrat” entre
le matériel et le logiciel : quelles instructions le CPU comprend-il ?
Comment accède-t-il à la mémoire ?</p>
<hr />
<p><strong>Conseil</strong> : Prenez le temps de bien comprendre la
boucle de rétroaction du registre 1-bit. C’est un concept fondamental
qui revient constamment en informatique !</p>
<hr />
<h2 data-number="5.14" id="auto-évaluation-2"><span
class="header-section-number">5.14</span> Auto-évaluation</h2>
<p>Testez votre compréhension avant de passer au chapitre suivant.</p>
<h3 data-number="5.14.1" id="questions-de-compréhension-2"><span
class="header-section-number">5.14.1</span> Questions de
compréhension</h3>
<p><strong>Q1.</strong> Quelle est la différence fondamentale entre un
circuit combinatoire et un circuit séquentiel ?</p>
<p><strong>Q2.</strong> Pourquoi le signal <code>load</code> est-il
nécessaire dans un registre ?</p>
<p><strong>Q3.</strong> Comment fonctionne l’adressage dans une RAM de 8
mots ?</p>
<p><strong>Q4.</strong> Le PC (Program Counter) a plusieurs modes :
reset, load, inc, hold. Dans quel ordre de priorité fonctionnent-ils
?</p>
<p><strong>Q5.</strong> Pourquoi la RAM est-elle plus lente que les
registres ?</p>
<h3 data-number="5.14.2" id="mini-défi-pratique-2"><span
class="header-section-number">5.14.2</span> Mini-défi pratique</h3>
<p>Dessinez le schéma bloc d’un registre 1-bit avec les composants
suivants : - 1 MUX 2-vers-1 - 1 DFF</p>
<p>Indice : La sortie du DFF retourne vers une entrée du MUX.</p>
<p><em>Les solutions se trouvent dans le document
<strong>Codex_Solutions</strong>.</em></p>
<h3 data-number="5.14.3" id="checklist-de-validation-2"><span
class="header-section-number">5.14.3</span> Checklist de validation</h3>
<p>Avant de passer au chapitre 4, assurez-vous de pouvoir :</p>
<ul class="task-list">
<li><label><input type="checkbox" />Expliquer pourquoi l’horloge est
nécessaire (synchronisation)</label></li>
<li><label><input type="checkbox" />Décrire le comportement d’une DFF :
<code>q(t) = d(t-1)</code></label></li>
<li><label><input type="checkbox" />Construire un registre 1-bit avec
MUX + DFF</label></li>
<li><label><input type="checkbox" />Expliquer comment RAM8 utilise DMux
et Mux pour l’adressage</label></li>
<li><label><input type="checkbox" />Décrire les priorités du PC (reset
&gt; load &gt; inc &gt; hold)</label></li>
</ul>
<h1 data-number="6" id="architecture-machine-isa-a32"><span
class="header-section-number">6</span> Architecture Machine (ISA
A32)</h1>
<blockquote>
<p>“Le langage est la limite de mon monde.” — Wittgenstein</p>
</blockquote>
<p>Nous avons maintenant des portes logiques, des additionneurs, et de
la mémoire. Mais comment <strong>commander</strong> tout cela ? C’est le
rôle de l’<strong>Architecture de Jeu d’Instructions</strong> (ISA -
Instruction Set Architecture).</p>
<p>L’ISA est le <strong>contrat</strong> entre le matériel et le
logiciel. C’est la liste de toutes les instructions que le CPU sait
exécuter.</p>
<hr />
<h2 data-number="6.1" id="où-en-sommes-nous-3"><span
class="header-section-number">6.1</span> Où en sommes-nous ?</h2>
<figure>
<img src="images/architecture-stack.svg"
alt="Position dans l’architecture" />
<figcaption aria-hidden="true">Position dans l’architecture</figcaption>
</figure>
<p><em>Nous sommes à la Couche 2 : Architecture Machine (ISA) - Le
contrat entre matériel et logiciel</em></p>
<p>Ce chapitre marque une transition importante. Nous quittons
temporairement le monde du matériel pour définir
<strong>l’interface</strong> entre matériel et logiciel. L’ISA que nous
définissons ici sera :</p>
<ul>
<li><strong>Implémentée</strong> par le CPU au Chapitre 5</li>
<li><strong>Utilisée</strong> par l’assembleur au Chapitre 6</li>
<li><strong>Ciblée</strong> par le compilateur au Chapitre 7</li>
</ul>
<hr />
<h2 data-number="6.2" id="quest-ce-quune-architecture"><span
class="header-section-number">6.2</span> Qu’est-ce qu’une Architecture
?</h2>
<h3 data-number="6.2.1" id="le-contrat-fondamental"><span
class="header-section-number">6.2.1</span> Le contrat fondamental</h3>
<p>L’architecture d’un processeur définit :</p>
<ol type="1">
<li><strong>Les registres</strong> : Combien ? Quelle taille ? Quel rôle
?</li>
<li><strong>Les instructions</strong> : Quelles opérations le CPU
peut-il faire ?</li>
<li><strong>L’encodage</strong> : Comment les instructions sont-elles
représentées en binaire ?</li>
<li><strong>Le modèle mémoire</strong> : Comment le CPU voit-il la
mémoire ?</li>
</ol>
<p>C’est un <strong>contrat</strong> :</p>
<ul>
<li>Le matériel <strong>promet</strong> d’exécuter les instructions
comme spécifié</li>
<li>Le logiciel <strong>s’engage</strong> à n’utiliser que les
instructions définies</li>
</ul>
<h3 data-number="6.2.2"
id="codex-a32-une-architecture-risc-moderne"><span
class="header-section-number">6.2.2</span> Codex A32 : Une architecture
RISC moderne</h3>
<p>L’architecture <strong>Codex A32</strong> est inspirée de ARM,
l’architecture qui équipe la plupart des smartphones et le Raspberry Pi.
Elle est :</p>
<ul>
<li><strong>RISC</strong> (Reduced Instruction Set Computer) :
Instructions simples et rapides</li>
<li><strong>32 bits</strong> : Registres et adresses sur 32 bits</li>
<li><strong>Load/Store</strong> : Le CPU ne calcule jamais directement
en mémoire</li>
</ul>
<hr />
<h2 data-number="6.3" id="pourquoi-risc-larchitecture-loadstore"><span
class="header-section-number">6.3</span> Pourquoi RISC ? L’architecture
Load/Store</h2>
<h3 data-number="6.3.1" id="cisc-vs-risc"><span
class="header-section-number">6.3.1</span> CISC vs RISC</h3>
<table>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">CISC (x86, Intel)</th>
<th style="text-align: left;">RISC (ARM, Codex)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Instructions complexes</td>
<td style="text-align: left;">Instructions simples</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>ADD [mem], reg</code> possible</td>
<td style="text-align: left;">Calcul uniquement entre registres</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Vitesse variable par instruction</td>
<td style="text-align: left;">1 instruction ≈ 1 cycle</td>
</tr>
<tr class="even">
<td style="text-align: left;">Plus facile à programmer directement</td>
<td style="text-align: left;">Plus facile à implémenter en matériel</td>
</tr>
</tbody>
</table>
<h3 data-number="6.3.2" id="la-règle-dor-loadstore"><span
class="header-section-number">6.3.2</span> La règle d’or Load/Store</h3>
<p>En architecture RISC, le CPU ne peut <strong>jamais</strong> calculer
directement sur la mémoire. Toute opération suit le schéma :</p>
<pre><code>1. LOAD  : Charger les données de la mémoire vers les registres
2. COMPUTE : Effectuer le calcul dans les registres
3. STORE : Stocker le résultat de retour en mémoire</code></pre>
<p><strong>Exemple</strong> : Incrémenter une variable en mémoire</p>
<div class="sourceCode" id="cb25"><pre
class="sourceCode asm"><code class="sourceCode fasm"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>LDR R0<span class="op">,</span> <span class="op">[</span>R1<span class="op">]</span>      <span class="co">; 1. Charger la valeur depuis l&#39;adresse R1</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="bu">ADD</span> R0<span class="op">,</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">1</span>    <span class="co">; 2. Ajouter 1</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="bu">STR</span> R0<span class="op">,</span> <span class="op">[</span>R1<span class="op">]</span>      <span class="co">; 3. Stocker le résultat</span></span></code></pre></div>
<p>En x86 (CISC), on pourrait écrire <code>ADD [mem], 1</code> en une
seule instruction. Mais le CPU RISC est plus simple à construire et peut
aller plus vite.</p>
<hr />
<h2 data-number="6.4" id="le-cycle-de-vie-dune-instruction"><span
class="header-section-number">6.4</span> Le Cycle de Vie d’une
Instruction</h2>
<p>Chaque instruction traverse trois phases :</p>
<figure>
<img src="images/fetch-decode-execute.svg"
alt="Cycle Fetch-Decode-Execute" />
<figcaption aria-hidden="true">Cycle Fetch-Decode-Execute</figcaption>
</figure>
<ol type="1">
<li><strong>Fetch</strong> (Récupération)
<ul>
<li>Le CPU lit l’instruction à l’adresse contenue dans PC</li>
<li>PC est incrémenté pour pointer vers l’instruction suivante</li>
</ul></li>
<li><strong>Decode</strong> (Décodage)
<ul>
<li>Les 32 bits de l’instruction sont analysés</li>
<li>Le CPU identifie : quel opération ? quels registres ? quelle valeur
immédiate ?</li>
</ul></li>
<li><strong>Execute</strong> (Exécution)
<ul>
<li>L’ALU effectue le calcul</li>
<li>Le résultat est stocké dans le registre de destination</li>
<li>Si c’est un branchement, PC peut être modifié</li>
</ul></li>
</ol>
<hr />
<h2 data-number="6.5" id="les-registres-le-plan-de-travail"><span
class="header-section-number">6.5</span> Les Registres : Le Plan de
Travail</h2>
<p>Le CPU dispose de <strong>16 registres</strong> de 32 bits, nommés R0
à R15.</p>
<h3 data-number="6.5.1" id="vue-densemble"><span
class="header-section-number">6.5.1</span> Vue d’ensemble</h3>
<figure>
<img src="images/register-bank.svg" alt="Banc de registres" />
<figcaption aria-hidden="true">Banc de registres</figcaption>
</figure>
<h3 data-number="6.5.2" id="rôles-des-registres"><span
class="header-section-number">6.5.2</span> Rôles des registres</h3>
<table>
<colgroup>
<col style="width: 27%" />
<col style="width: 18%" />
<col style="width: 54%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Registre</th>
<th style="text-align: left;">Alias</th>
<th style="text-align: left;">Rôle conventionnel</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>R0-R3</strong></td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">Arguments des fonctions et valeurs de
retour</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>R4-R11</strong></td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">Variables locales (préservées par les
fonctions)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>R12</strong></td>
<td style="text-align: left;">IP</td>
<td style="text-align: left;">Registre temporaire (Intra-Procedure
call)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>R13</strong></td>
<td style="text-align: left;"><strong>SP</strong></td>
<td style="text-align: left;">Stack Pointer — Pointe vers le sommet de
la pile</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>R14</strong></td>
<td style="text-align: left;"><strong>LR</strong></td>
<td style="text-align: left;">Link Register — Adresse de retour après
<code>BL</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>R15</strong></td>
<td style="text-align: left;"><strong>PC</strong></td>
<td style="text-align: left;">Program Counter — Adresse de l’instruction
courante</td>
</tr>
</tbody>
</table>
<h3 data-number="6.5.3" id="le-cas-spécial-de-r15-pc"><span
class="header-section-number">6.5.3</span> Le cas spécial de R15
(PC)</h3>
<p>Le PC est accessible comme n’importe quel registre. Si vous écrivez
dedans, vous forcez un saut !</p>
<div class="sourceCode" id="cb26"><pre
class="sourceCode asm"><code class="sourceCode fasm"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="bu">MOV</span> PC<span class="op">,</span> <span class="kw">R14</span>    <span class="co">; Équivalent à &quot;return&quot; : saute à l&#39;adresse dans LR</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="bu">ADD</span> PC<span class="op">,</span> PC<span class="op">,</span> <span class="op">#</span><span class="dv">8</span> <span class="co">; Saute de 8 octets plus loin</span></span></code></pre></div>
<p>C’est puissant mais dangereux — une erreur de calcul et le CPU saute
n’importe où !</p>
<hr />
<h2 data-number="6.6" id="la-carte-mémoire-memory-map"><span
class="header-section-number">6.6</span> La Carte Mémoire (Memory
Map)</h2>
<p>La mémoire est un espace linéaire de 4 Go (2³² octets), mais toutes
les adresses ne sont pas utilisables.</p>
<h3 data-number="6.6.1" id="organisation-de-la-mémoire-codex"><span
class="header-section-number">6.6.1</span> Organisation de la mémoire
Codex</h3>
<figure>
<img src="images/memory-map.svg" alt="Carte mémoire Codex" />
<figcaption aria-hidden="true">Carte mémoire Codex</figcaption>
</figure>
<h3 data-number="6.6.2" id="le-memory-mapped-io-mmio"><span
class="header-section-number">6.6.2</span> Le Memory-Mapped I/O
(MMIO)</h3>
<p>En Codex (comme en ARM), les périphériques sont accessibles
<strong>comme de la mémoire</strong>. Il n’y a pas d’instructions
spéciales <code>IN</code>/<code>OUT</code>.</p>
<p><strong>L’écran</strong> :</p>
<ul>
<li>Adresse : <code>0x00400000</code> à <code>0x00402580</code></li>
<li>Format : 1 bit par pixel, 40 octets par ligne</li>
<li>Écrire un <code>1</code> à un bit = pixel blanc</li>
</ul>
<p><strong>Le clavier</strong> :</p>
<ul>
<li>Adresse : <code>0x00402600</code></li>
<li>Lire cette adresse donne le code ASCII de la touche pressée (ou
0)</li>
</ul>
<p><strong>Exemple</strong> : Allumer le premier pixel</p>
<div class="sourceCode" id="cb27"><pre
class="sourceCode asm"><code class="sourceCode fasm"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>LDR R0<span class="op">,</span> <span class="op">=</span><span class="bn">0x00400000</span>   <span class="co">; Adresse de l&#39;écran</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="bu">MOV</span> R1<span class="op">,</span> <span class="op">#</span><span class="bn">0x80</span>         <span class="co">; Bit 7 = premier pixel de la ligne</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>STRB R1<span class="op">,</span> <span class="op">[</span>R0<span class="op">]</span>         <span class="co">; Écrire un octet</span></span></code></pre></div>
<hr />
<h2 data-number="6.7" id="le-format-des-instructions"><span
class="header-section-number">6.7</span> Le Format des Instructions</h2>
<p>Chaque instruction est encodée sur <strong>32 bits</strong>. La
structure générale :</p>
<pre><code>31   28 27   25 24                                             0
┌──────┬───────┬───────────────────────────────────────────────┐
│ Cond │ Class │              Données de l&#39;instruction         │
└──────┴───────┴───────────────────────────────────────────────┘</code></pre>
<h3 data-number="6.7.1" id="les-bits-de-condition-31-28"><span
class="header-section-number">6.7.1</span> Les bits de condition
(31-28)</h3>
<p><strong>Fonctionnalité unique de ARM/Codex</strong> : Toute
instruction peut être conditionnelle !</p>
<p>Au lieu de :</p>
<div class="sourceCode" id="cb29"><pre
class="sourceCode asm"><code class="sourceCode fasm"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="bu">CMP</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">0</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>BNE skip</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="bu">MOV</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">1</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="fu">skip:</span></span></code></pre></div>
<p>On peut écrire :</p>
<div class="sourceCode" id="cb30"><pre
class="sourceCode asm"><code class="sourceCode fasm"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="bu">CMP</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">0</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="bu">MOV</span><span class="op">.</span>EQ R1<span class="op">,</span> <span class="op">#</span><span class="dv">1</span>   <span class="co">; Exécuté SEULEMENT si Z=1 (égal)</span></span></code></pre></div>
<table>
<thead>
<tr class="header">
<th style="text-align: center;">Code</th>
<th style="text-align: left;">Suffixe</th>
<th style="text-align: left;">Condition</th>
<th style="text-align: left;">Signification</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0000</td>
<td style="text-align: left;">EQ</td>
<td style="text-align: left;">Z = 1</td>
<td style="text-align: left;">Égal (Equal)</td>
</tr>
<tr class="even">
<td style="text-align: center;">0001</td>
<td style="text-align: left;">NE</td>
<td style="text-align: left;">Z = 0</td>
<td style="text-align: left;">Différent (Not Equal)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">0010</td>
<td style="text-align: left;">CS/HS</td>
<td style="text-align: left;">C = 1</td>
<td style="text-align: left;">Retenue (Carry Set)</td>
</tr>
<tr class="even">
<td style="text-align: center;">0011</td>
<td style="text-align: left;">CC/LO</td>
<td style="text-align: left;">C = 0</td>
<td style="text-align: left;">Pas de retenue (Carry Clear)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1010</td>
<td style="text-align: left;">GE</td>
<td style="text-align: left;">N = V</td>
<td style="text-align: left;">Plus grand ou égal (signé)</td>
</tr>
<tr class="even">
<td style="text-align: center;">1011</td>
<td style="text-align: left;">LT</td>
<td style="text-align: left;">N ≠ V</td>
<td style="text-align: left;">Plus petit (signé)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1100</td>
<td style="text-align: left;">GT</td>
<td style="text-align: left;">Z=0 et N=V</td>
<td style="text-align: left;">Plus grand (signé)</td>
</tr>
<tr class="even">
<td style="text-align: center;">1101</td>
<td style="text-align: left;">LE</td>
<td style="text-align: left;">Z=1 ou N≠V</td>
<td style="text-align: left;">Plus petit ou égal (signé)</td>
</tr>
<tr class="odd">
<td style="text-align: center;">1110</td>
<td style="text-align: left;">AL</td>
<td style="text-align: left;">(toujours)</td>
<td style="text-align: left;">Toujours exécuter (défaut)</td>
</tr>
</tbody>
</table>
<h3 data-number="6.7.2" id="les-classes-dinstructions-27-25"><span
class="header-section-number">6.7.2</span> Les classes d’instructions
(27-25)</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Bits 27-25</th>
<th style="text-align: left;">Classe</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">000</td>
<td style="text-align: left;">Data Processing (reg)</td>
<td style="text-align: left;">Opérations ALU avec registre</td>
</tr>
<tr class="even">
<td style="text-align: left;">001</td>
<td style="text-align: left;">Data Processing (imm)</td>
<td style="text-align: left;">Opérations ALU avec immédiat</td>
</tr>
<tr class="odd">
<td style="text-align: left;">010</td>
<td style="text-align: left;">Load/Store</td>
<td style="text-align: left;">Accès mémoire (LDR, STR)</td>
</tr>
<tr class="even">
<td style="text-align: left;">011</td>
<td style="text-align: left;">Branch</td>
<td style="text-align: left;">Branchements (B, BL)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">100</td>
<td style="text-align: left;">Block Transfer</td>
<td style="text-align: left;">Push/Pop multiple (LDM, STM)</td>
</tr>
<tr class="even">
<td style="text-align: left;">111</td>
<td style="text-align: left;">System</td>
<td style="text-align: left;">Instructions système (SVC, HALT)</td>
</tr>
</tbody>
</table>
<hr />
<h2 data-number="6.8" id="les-instructions-en-détail"><span
class="header-section-number">6.8</span> Les Instructions en Détail</h2>
<h3 data-number="6.8.1"
id="a.-opérations-arithmétiques-et-logiques"><span
class="header-section-number">6.8.1</span> A. Opérations Arithmétiques
et Logiques</h3>
<p><strong>Format général</strong> :
<code>OP{cond}{S} Rd, Rn, Operand2</code></p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Instruction</th>
<th style="text-align: left;">Opération</th>
<th style="text-align: left;">Exemple</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>ADD</code></td>
<td style="text-align: left;">Addition</td>
<td style="text-align: left;"><code>ADD R1, R2, R3</code> → R1 = R2 +
R3</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>SUB</code></td>
<td style="text-align: left;">Soustraction</td>
<td style="text-align: left;"><code>SUB R1, R2, #5</code> → R1 = R2 -
5</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>AND</code></td>
<td style="text-align: left;">ET logique</td>
<td style="text-align: left;"><code>AND R1, R2, R3</code> → R1 = R2
&amp; R3</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>ORR</code></td>
<td style="text-align: left;">OU logique</td>
<td style="text-align: left;"><code>ORR R1, R2, R3</code> → R1 = R2 |
R3</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>EOR</code></td>
<td style="text-align: left;">XOR</td>
<td style="text-align: left;"><code>EOR R1, R2, R3</code> → R1 = R2 ^
R3</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>MOV</code></td>
<td style="text-align: left;">Copie</td>
<td style="text-align: left;"><code>MOV R1, R2</code> → R1 = R2</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>MVN</code></td>
<td style="text-align: left;">Copie inversée</td>
<td style="text-align: left;"><code>MVN R1, R2</code> → R1 = ~R2</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>CMP</code></td>
<td style="text-align: left;">Comparaison</td>
<td style="text-align: left;"><code>CMP R1, R2</code> → met à jour les
flags</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>TST</code></td>
<td style="text-align: left;">Test bits</td>
<td style="text-align: left;"><code>TST R1, R2</code> → AND sans
stocker</td>
</tr>
</tbody>
</table>
<p><strong>Le suffixe <code>S</code></strong> : Ajouter <code>S</code>
met à jour les drapeaux NZCV.</p>
<div class="sourceCode" id="cb31"><pre
class="sourceCode asm"><code class="sourceCode fasm"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>ADDS R1<span class="op">,</span> R2<span class="op">,</span> R3   <span class="co">; Met à jour les flags</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="bu">ADD</span> R1<span class="op">,</span> R2<span class="op">,</span> R3    <span class="co">; Ne touche pas aux flags</span></span></code></pre></div>
<h3 data-number="6.8.2" id="b.-accès-mémoire-loadstore"><span
class="header-section-number">6.8.2</span> B. Accès Mémoire
(Load/Store)</h3>
<p><strong>Format général</strong> :
<code>LDR/STR{B} Rd, [Rn, #offset]</code></p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Instruction</th>
<th style="text-align: left;">Action</th>
<th style="text-align: left;">Exemple</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>LDR</code></td>
<td style="text-align: left;">Charger 32 bits</td>
<td style="text-align: left;"><code>LDR R0, [R1]</code> → R0 =
MEM[R1]</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>STR</code></td>
<td style="text-align: left;">Stocker 32 bits</td>
<td style="text-align: left;"><code>STR R0, [R1]</code> → MEM[R1] =
R0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>LDRB</code></td>
<td style="text-align: left;">Charger 8 bits</td>
<td style="text-align: left;"><code>LDRB R0, [R1]</code> → R0 = MEM[R1]
(1 octet)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>STRB</code></td>
<td style="text-align: left;">Stocker 8 bits</td>
<td style="text-align: left;"><code>STRB R0, [R1]</code> → MEM[R1] = R0
(1 octet)</td>
</tr>
</tbody>
</table>
<p><strong>Modes d’adressage</strong> :</p>
<div class="sourceCode" id="cb32"><pre
class="sourceCode asm"><code class="sourceCode fasm"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>LDR R0<span class="op">,</span> <span class="op">[</span>R1<span class="op">]</span>        <span class="co">; Simple : adresse = R1</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>LDR R0<span class="op">,</span> <span class="op">[</span>R1<span class="op">,</span> <span class="op">#</span><span class="dv">4</span><span class="op">]</span>    <span class="co">; Offset : adresse = R1 + 4</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>LDR R0<span class="op">,</span> <span class="op">[</span>R1<span class="op">,</span> R2<span class="op">]</span>    <span class="co">; Registre : adresse = R1 + R2</span></span></code></pre></div>
<h3 data-number="6.8.3" id="c.-branchements"><span
class="header-section-number">6.8.3</span> C. Branchements</h3>
<p><strong>Format</strong> : <code>B{cond} label</code> ou
<code>BL{cond} label</code></p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Instruction</th>
<th style="text-align: left;">Action</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>B label</code></td>
<td style="text-align: left;">Saut inconditionnel</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>BL label</code></td>
<td style="text-align: left;">Branch with Link (appel de fonction)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>B.EQ label</code></td>
<td style="text-align: left;">Saut si égal (Z=1)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>B.NE label</code></td>
<td style="text-align: left;">Saut si différent (Z=0)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>B.LT label</code></td>
<td style="text-align: left;">Saut si plus petit (signé)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>B.GT label</code></td>
<td style="text-align: left;">Saut si plus grand (signé)</td>
</tr>
</tbody>
</table>
<p><strong>Le mystère de <code>BL</code></strong> :</p>
<div class="sourceCode" id="cb33"><pre
class="sourceCode asm"><code class="sourceCode fasm"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">main:</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    BL ma_fonction    <span class="co">; 1. Sauvegarde PC+4 dans LR</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>                      <span class="co">; 2. Saute à ma_fonction</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">; ... (on revient ici après le retour)</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ma_fonction:</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">; ... faire quelque chose ...</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> PC<span class="op">,</span> LR        <span class="co">; Retour : saute à l&#39;adresse dans LR</span></span></code></pre></div>
<hr />
<h2 data-number="6.9" id="la-pile-stack"><span
class="header-section-number">6.9</span> La Pile (Stack)</h2>
<p>La pile est une zone de mémoire utilisée pour : - Sauvegarder les
registres - Stocker les variables locales - Passer des arguments aux
fonctions</p>
<h3 data-number="6.9.1" id="fonctionnement"><span
class="header-section-number">6.9.1</span> Fonctionnement</h3>
<p>La pile <strong>grandit vers le bas</strong> (des adresses hautes
vers les basses) :</p>
<pre><code>       Adresses hautes
           │
           ▼
┌──────────────────┐
│  (données)       │
├──────────────────┤
│  (données)       │
├──────────────────┤ ← SP (Stack Pointer)
│                  │
│   (espace libre) │
│                  │
└──────────────────┘
       Adresses basses</code></pre>
<h3 data-number="6.9.2" id="push-et-pop-manuel"><span
class="header-section-number">6.9.2</span> Push et Pop (manuel)</h3>
<p>Codex n’a pas d’instructions <code>PUSH</code>/<code>POP</code>
natives. On les simule :</p>
<div class="sourceCode" id="cb35"><pre
class="sourceCode asm"><code class="sourceCode fasm"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">; PUSH R0 (empiler R0)</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="bu">SUB</span> <span class="kw">SP</span><span class="op">,</span> <span class="kw">SP</span><span class="op">,</span> <span class="op">#</span><span class="dv">4</span>     <span class="co">; Faire de la place (pile descend)</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="bu">STR</span> R0<span class="op">,</span> <span class="op">[</span><span class="kw">SP</span><span class="op">]</span>       <span class="co">; Stocker R0 au sommet</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="co">; POP R0 (dépiler dans R0)</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>LDR R0<span class="op">,</span> <span class="op">[</span><span class="kw">SP</span><span class="op">]</span>       <span class="co">; Lire depuis le sommet</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="bu">ADD</span> <span class="kw">SP</span><span class="op">,</span> <span class="kw">SP</span><span class="op">,</span> <span class="op">#</span><span class="dv">4</span>     <span class="co">; Libérer l&#39;espace</span></span></code></pre></div>
<hr />
<h2 data-number="6.10" id="exemples-de-programmes"><span
class="header-section-number">6.10</span> Exemples de Programmes</h2>
<h3 data-number="6.10.1" id="exemple-1-somme-de-1-à-n"><span
class="header-section-number">6.10.1</span> Exemple 1 : Somme de 1 à
N</h3>
<div class="sourceCode" id="cb36"><pre
class="sourceCode asm"><code class="sourceCode fasm"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">; Calcule 1 + 2 + ... + 10</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>.text</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>.global _start</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="fu">_start:</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">0</span>       <span class="co">; sum = 0</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">1</span>       <span class="co">; i = 1</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="fu">loop:</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">CMP</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">10</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>    BGT done         <span class="co">; si i &gt; 10, sortir</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R0<span class="op">,</span> R0<span class="op">,</span> R1   <span class="co">; sum += i</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R1<span class="op">,</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">1</span>   <span class="co">; i++</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>    B loop</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a><span class="fu">done:</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">; R0 contient 55</span></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>    HALT</span></code></pre></div>
<h3 data-number="6.10.2"
id="exemple-2-maximum-de-deux-nombres-avec-prédication"><span
class="header-section-number">6.10.2</span> Exemple 2 : Maximum de deux
nombres (avec prédication)</h3>
<div class="sourceCode" id="cb37"><pre
class="sourceCode asm"><code class="sourceCode fasm"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co">; R2 = max(R0, R1) sans branchement</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="bu">CMP</span> R0<span class="op">,</span> R1</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="bu">MOV</span><span class="op">.</span>GE R2<span class="op">,</span> R0     <span class="co">; Si R0 &gt;= R1, R2 = R0</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="bu">MOV</span><span class="op">.</span>LT R2<span class="op">,</span> R1     <span class="co">; Si R0 &lt; R1, R2 = R1</span></span></code></pre></div>
<h3 data-number="6.10.3" id="exemple-3-dessiner-un-pixel"><span
class="header-section-number">6.10.3</span> Exemple 3 : Dessiner un
pixel</h3>
<div class="sourceCode" id="cb38"><pre
class="sourceCode asm"><code class="sourceCode fasm"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">; Allumer le pixel (10, 20)</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="co">; Adresse = 0x00400000 + (y * 40) + (x / 8)</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="co">; Bit = 7 - (x % 8)</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>LDR R0<span class="op">,</span> <span class="op">=</span><span class="bn">0x00400000</span>  <span class="co">; Base de l&#39;écran</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="bu">MOV</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">20</span>          <span class="co">; y = 20</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="bu">MOV</span> R2<span class="op">,</span> <span class="op">#</span><span class="dv">40</span>          <span class="co">; octets par ligne</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="bu">MUL</span> R1<span class="op">,</span> R1<span class="op">,</span> R2       <span class="co">; offset_y = y * 40</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="bu">ADD</span> R0<span class="op">,</span> R0<span class="op">,</span> R1       <span class="co">; adresse_ligne</span></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="bu">MOV</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">10</span>          <span class="co">; x = 10</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="bu">MOV</span> R2<span class="op">,</span> R1<span class="op">,</span> LSR <span class="op">#</span><span class="dv">3</span>   <span class="co">; x / 8</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a><span class="bu">ADD</span> R0<span class="op">,</span> R0<span class="op">,</span> R2       <span class="co">; adresse finale</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a><span class="bu">AND</span> R1<span class="op">,</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">7</span>       <span class="co">; x % 8</span></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>RSB R1<span class="op">,</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">7</span>       <span class="co">; 7 - (x % 8)</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a><span class="bu">MOV</span> R2<span class="op">,</span> <span class="op">#</span><span class="dv">1</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a><span class="bu">LSL</span> R2<span class="op">,</span> R2<span class="op">,</span> R1       <span class="co">; masque = 1 &lt;&lt; bit_pos</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>LDRB R3<span class="op">,</span> <span class="op">[</span>R0<span class="op">]</span>        <span class="co">; Lire l&#39;octet actuel</span></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>ORR R3<span class="op">,</span> R3<span class="op">,</span> R2       <span class="co">; Allumer le bit</span></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a>STRB R3<span class="op">,</span> <span class="op">[</span>R0<span class="op">]</span>        <span class="co">; Écrire l&#39;octet</span></span></code></pre></div>
<hr />
<h2 data-number="6.11" id="gestion-des-erreurs-traps"><span
class="header-section-number">6.11</span> Gestion des Erreurs
(Traps)</h2>
<p>Si le CPU rencontre une situation invalide, il déclenche une
<strong>trap</strong> :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Trap</th>
<th style="text-align: left;">Cause</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>ILLEGAL</code></td>
<td style="text-align: left;">Instruction invalide (opcode inconnu)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>MEM_FAULT</code></td>
<td style="text-align: left;">Accès à une adresse non mappée</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>MISALIGNED</code></td>
<td style="text-align: left;">Accès 32-bits à une adresse non alignée
(ex: 0x3)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>DIV_ZERO</code></td>
<td style="text-align: left;">Division par zéro</td>
</tr>
</tbody>
</table>
<hr />
<h2 data-number="6.12" id="exercices-pratiques-3"><span
class="header-section-number">6.12</span> Exercices Pratiques</h2>
<h3 data-number="6.12.1" id="exercices-sur-le-simulateur-web-3"><span
class="header-section-number">6.12.1</span> Exercices sur le Simulateur
Web</h3>
<p>Lancez le <strong>Simulateur Web</strong> et allez dans <strong>A32
Assembly</strong>.</p>
<table>
<thead>
<tr class="header">
<th>Exercice</th>
<th>Description</th>
<th style="text-align: center;">Difficulté</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>Hello World</code></td>
<td>Afficher du texte</td>
<td style="text-align: center;">[*]</td>
</tr>
<tr class="even">
<td><code>Addition</code></td>
<td>Additionner deux registres</td>
<td style="text-align: center;">[*]</td>
</tr>
<tr class="odd">
<td><code>Soustraction</code></td>
<td>Soustraire avec le drapeau</td>
<td style="text-align: center;">[*]</td>
</tr>
<tr class="even">
<td><code>Logique</code></td>
<td>Opérations AND, OR, XOR</td>
<td style="text-align: center;">[*]</td>
</tr>
<tr class="odd">
<td><code>Conditions</code></td>
<td>Utiliser les branches conditionnelles</td>
<td style="text-align: center;">[**]</td>
</tr>
<tr class="even">
<td><code>Boucles</code></td>
<td>Implémenter une boucle while</td>
<td style="text-align: center;">[**]</td>
</tr>
<tr class="odd">
<td><code>Multiplication</code></td>
<td>Multiplier par additions successives</td>
<td style="text-align: center;">[**]</td>
</tr>
<tr class="even">
<td><code>Fibonacci</code></td>
<td>Calculer la suite de Fibonacci</td>
<td style="text-align: center;">[**]</td>
</tr>
<tr class="odd">
<td><code>Tableaux</code></td>
<td>Parcourir un tableau en mémoire</td>
<td style="text-align: center;">[**]</td>
</tr>
<tr class="even">
<td><code>Maximum Tableau</code></td>
<td>Trouver le max dans un tableau</td>
<td style="text-align: center;">[***]</td>
</tr>
<tr class="odd">
<td><code>Fonctions</code></td>
<td>Appeler des fonctions avec BL</td>
<td style="text-align: center;">[***]</td>
</tr>
<tr class="even">
<td><code>Pixel</code></td>
<td>Allumer un pixel à l’écran</td>
<td style="text-align: center;">[**]</td>
</tr>
<tr class="odd">
<td><code>Ligne</code></td>
<td>Dessiner une ligne</td>
<td style="text-align: center;">[***]</td>
</tr>
<tr class="even">
<td><code>Rectangle</code></td>
<td>Dessiner un rectangle</td>
<td style="text-align: center;">[***]</td>
</tr>
<tr class="odd">
<td><code>Lire un Caractère</code></td>
<td>Lire le clavier</td>
<td style="text-align: center;">[**]</td>
</tr>
</tbody>
</table>
<h3 data-number="6.12.2" id="tests-en-ligne-de-commande-2"><span
class="header-section-number">6.12.2</span> Tests en ligne de
commande</h3>
<div class="sourceCode" id="cb39"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assembler un fichier</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> run <span class="at">-p</span> a32_cli <span class="at">--</span> assemble mon_prog.s <span class="at">-o</span> mon_prog.bin</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Exécuter un binaire</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> run <span class="at">-p</span> a32_runner <span class="at">--</span> mon_prog.bin</span></code></pre></div>
<hr />
<h2 data-number="6.13" id="ce-quil-faut-retenir-3"><span
class="header-section-number">6.13</span> Ce qu’il faut retenir</h2>
<ol type="1">
<li><p><strong>L’ISA est un contrat</strong> : Entre le matériel et le
logiciel</p></li>
<li><p><strong>RISC = Simple</strong> : Load, Compute, Store — jamais de
calcul direct en mémoire</p></li>
<li><p><strong>16 registres</strong> : R0-R12 généraux, R13=SP, R14=LR,
R15=PC</p></li>
<li><p><strong>Tout est conditionnel</strong> : <code>ADD.EQ</code>,
<code>MOV.GT</code> évitent les branchements</p></li>
<li><p><strong>Memory-Mapped I/O</strong> : L’écran et le clavier sont
des adresses mémoire</p></li>
<li><p><strong>Le cycle Fetch-Decode-Execute</strong> : Le cœur battant
du CPU</p></li>
</ol>
<p><strong>Prochaine étape</strong> : Au Chapitre 5, nous construirons
le CPU qui <strong>implémente</strong> cette architecture. Vous verrez
comment les circuits du Chapitre 1-3 sont combinés pour exécuter ces
instructions.</p>
<hr />
<p><strong>Conseil</strong> : Passez du temps sur le simulateur web à
écrire des programmes en assembleur. Comprendre l’assembleur vous aidera
énormément à comprendre le compilateur plus tard !</p>
<hr />
<h2 data-number="6.14" id="auto-évaluation-3"><span
class="header-section-number">6.14</span> Auto-évaluation</h2>
<p>Testez votre compréhension avant de passer au chapitre suivant.</p>
<h3 data-number="6.14.1" id="questions-de-compréhension-3"><span
class="header-section-number">6.14.1</span> Questions de
compréhension</h3>
<p><strong>Q1.</strong> Qu’est-ce qu’une architecture RISC et pourquoi
A32 en est une ?</p>
<p><strong>Q2.</strong> Pourquoi y a-t-il 16 registres (R0-R15) et pas 8
ou 32 ?</p>
<p><strong>Q3.</strong> Que font les registres spéciaux R13, R14, R15
?</p>
<p><strong>Q4.</strong> Comment fonctionne l’exécution conditionnelle
(ex: <code>ADD.EQ</code>) ?</p>
<p><strong>Q5.</strong> Qu’est-ce que le Memory-Mapped I/O (MMIO) ?</p>
<h3 data-number="6.14.2" id="mini-défi-pratique-3"><span
class="header-section-number">6.14.2</span> Mini-défi pratique</h3>
<p>Écrivez un programme assembleur qui : 1. Met 10 dans R0 2. Met 3 dans
R1 3. Calcule R0 - R1 et stocke dans R2 4. Si le résultat est positif,
met 1 dans R3, sinon 0</p>
<p><em>Les solutions se trouvent dans le document
<strong>Codex_Solutions</strong>.</em></p>
<h3 data-number="6.14.3" id="checklist-de-validation-3"><span
class="header-section-number">6.14.3</span> Checklist de validation</h3>
<p>Avant de passer au chapitre 5, assurez-vous de pouvoir :</p>
<ul class="task-list">
<li><label><input type="checkbox" />Expliquer la différence entre RISC
et CISC</label></li>
<li><label><input type="checkbox" />Décrire le rôle de chaque registre
spécial (SP, LR, PC)</label></li>
<li><label><input type="checkbox" />Écrire un programme simple en
assembleur A32</label></li>
<li><label><input type="checkbox" />Utiliser les conditions (EQ, NE, GT,
LT, etc.)</label></li>
<li><label><input type="checkbox" />Expliquer le cycle
Fetch-Decode-Execute</label></li>
</ul>
<h1 data-number="7" id="le-processeur-cpu"><span
class="header-section-number">7</span> Le Processeur (CPU)</h1>
<blockquote>
<p>“Si vous ne pouvez pas le construire, vous ne le comprenez pas.” —
Richard Feynman</p>
</blockquote>
<p>C’est le grand moment. Nous allons assembler toutes les pièces du
puzzle — portes logiques, ALU, registres, mémoire — pour construire le
<strong>cœur de l’ordinateur</strong> : le CPU A32.</p>
<hr />
<h2 data-number="7.1" id="où-en-sommes-nous-4"><span
class="header-section-number">7.1</span> Où en sommes-nous ?</h2>
<figure>
<img src="images/architecture-stack.svg"
alt="Position dans l’architecture" />
<figcaption aria-hidden="true">Position dans l’architecture</figcaption>
</figure>
<p><em>Nous sommes à la Couche 1 : CPU - L’Aboutissement (ALU + RAM +
Registres)</em></p>
<p>Ce chapitre est le <strong>point culminant</strong> de tout le
travail matériel. Après ce chapitre, vous aurez construit un ordinateur
complet capable d’exécuter du vrai code !</p>
<hr />
<h2 data-number="7.2" id="deux-implémentations-du-cpu"><span
class="header-section-number">7.2</span> Deux Implémentations du
CPU</h2>
<p>Le projet Codex propose <strong>deux implémentations</strong> du CPU
A32, chacune avec un objectif pédagogique différent :</p>
<h3 data-number="7.2.1" id="cpu-mono-cycle-simulateur-rust"><span
class="header-section-number">7.2.1</span> CPU Mono-cycle (Simulateur
Rust)</h3>
<p>Le <strong>simulateur Rust</strong> (<code>a32_core</code>)
implémente un CPU <strong>mono-cycle</strong> :</p>
<figure>
<img src="images/cpu-monocycle.svg" alt="CPU Mono-cycle" />
<figcaption aria-hidden="true">CPU Mono-cycle</figcaption>
</figure>
<p><em>Chaque instruction traverse TOUTES les étapes en UN
cycle</em></p>
<p><strong>Utilisé par :</strong></p>
<ul>
<li>Le <strong>CPU Visualizer</strong> (interface web)</li>
<li>Le <strong>runner</strong> (<code>a32_runner</code>)</li>
<li>L’<strong>IDE web</strong> (exécution des programmes)</li>
<li>Les <strong>tests</strong> C32 et A32</li>
</ul>
<p><strong>Avantages :</strong> Simple à comprendre, facile à déboguer,
comportement prévisible.</p>
<h3 data-number="7.2.2" id="cpu-pipeline-hdl"><span
class="header-section-number">7.2.2</span> CPU Pipeline (HDL)</h3>
<p>Le <strong>CPU en HDL</strong>
(<code>hdl_lib/05_cpu/CPU_Pipeline.hdl</code>) implémente un vrai
<strong>pipeline 5 étages</strong> :</p>
<figure>
<img src="images/cpu-pipeline.svg" alt="CPU Pipeline 5 étages" />
<figcaption aria-hidden="true">CPU Pipeline 5 étages</figcaption>
</figure>
<p><strong>Composants HDL :</strong></p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Fichier</th>
<th style="text-align: left;">Rôle</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>IF_ID_Reg.hdl</code></td>
<td style="text-align: left;">Registre pipeline IF→ID</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>ID_EX_Reg.hdl</code></td>
<td style="text-align: left;">Registre pipeline ID→EX</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>EX_MEM_Reg.hdl</code></td>
<td style="text-align: left;">Registre pipeline EX→MEM</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>MEM_WB_Reg.hdl</code></td>
<td style="text-align: left;">Registre pipeline MEM→WB</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>HazardDetect.hdl</code></td>
<td style="text-align: left;">Détection des hazards (stall)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>ForwardUnit.hdl</code></td>
<td style="text-align: left;">Bypass/forwarding des données</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>CPU_Pipeline.hdl</code></td>
<td style="text-align: left;">CPU complet assemblé</td>
</tr>
</tbody>
</table>
<p><strong>Utilisé par :</strong></p>
<ul>
<li>Les <strong>exercices HDL</strong> (apprentissage hardware)</li>
<li>Le <strong>simulateur HDL</strong> (<code>hdl_cli</code>)</li>
</ul>
<p><strong>Avantages :</strong> Réaliste, montre les vrais défis du
design CPU (hazards, forwarding, stalls).</p>
<h3 data-number="7.2.3" id="pourquoi-deux-implémentations"><span
class="header-section-number">7.2.3</span> Pourquoi deux implémentations
?</h3>
<table>
<colgroup>
<col style="width: 18%" />
<col style="width: 44%" />
<col style="width: 37%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Aspect</th>
<th style="text-align: left;">Mono-cycle (Rust)</th>
<th style="text-align: left;">Pipeline (HDL)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Objectif</strong></td>
<td style="text-align: left;">Exécuter des programmes</td>
<td style="text-align: left;">Apprendre le hardware</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Complexité</strong></td>
<td style="text-align: left;">Simple</td>
<td style="text-align: left;">Réaliste</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Performance</strong></td>
<td style="text-align: left;">1 instr/cycle</td>
<td style="text-align: left;">Jusqu’à 1 instr/cycle (avec hazards)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Hazards</strong></td>
<td style="text-align: left;">Aucun</td>
<td style="text-align: left;">Gérés (stall + forward)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Utilisation</strong></td>
<td style="text-align: left;">IDE, tests, visualizer</td>
<td style="text-align: left;">Exercices HDL</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>Note :</strong> Le CPU Visualizer affiche les étapes (Fetch,
Decode, Execute, Memory, Writeback) de manière
<strong>pédagogique</strong>, mais l’exécution sous-jacente est
mono-cycle. Pour voir un vrai pipeline avec hazards et forwarding,
utilisez le simulateur HDL avec <code>CPU_Pipeline.hdl</code>.</p>
</blockquote>
<hr />
<h2 data-number="7.3" id="quest-ce-quun-cpu"><span
class="header-section-number">7.3</span> Qu’est-ce qu’un CPU ?</h2>
<h3 data-number="7.3.1" id="le-chef-dorchestre"><span
class="header-section-number">7.3.1</span> Le chef d’orchestre</h3>
<p>Le CPU (Central Processing Unit) est le composant qui :</p>
<ol type="1">
<li><strong>Lit</strong> les instructions depuis la mémoire</li>
<li><strong>Décode</strong> ces instructions pour comprendre quoi
faire</li>
<li><strong>Exécute</strong> les opérations (calculs, accès mémoire,
branchements)</li>
<li><strong>Répète</strong> à l’infini (jusqu’à HALT)</li>
</ol>
<p>C’est une machine à états qui exécute une instruction après l’autre,
inlassablement.</p>
<h3 data-number="7.3.2" id="ce-que-nous-avons-construit-jusquici"><span
class="header-section-number">7.3.2</span> Ce que nous avons construit
jusqu’ici</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Chapitre</th>
<th style="text-align: left;">Composant</th>
<th style="text-align: left;">Rôle dans le CPU</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">Portes logiques</td>
<td style="text-align: left;">Briques de base de tout circuit</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">ALU</td>
<td style="text-align: left;">Effectue les calculs (ADD, SUB, AND…)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: left;">Registres</td>
<td style="text-align: left;">Stockent les données du CPU (R0-R15)</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: left;">PC</td>
<td style="text-align: left;">Pointe vers l’instruction courante</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: left;">RAM</td>
<td style="text-align: left;">Stocke le programme et les données</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: left;">ISA</td>
<td style="text-align: left;">Définit les instructions à supporter</td>
</tr>
</tbody>
</table>
<h3 data-number="7.3.3" id="ce-quil-reste-à-construire"><span
class="header-section-number">7.3.3</span> Ce qu’il reste à
construire</h3>
<ul>
<li><strong>Décodeur</strong> : Analyse les bits de l’instruction</li>
<li><strong>Unité de contrôle</strong> : Décide quoi activer</li>
<li><strong>Multiplexeurs de données</strong> : Routent les données
entre composants</li>
<li><strong>Le CPU lui-même</strong> : L’assemblage final</li>
</ul>
<hr />
<h2 data-number="7.4" id="architecture-du-cpu-data-path"><span
class="header-section-number">7.4</span> Architecture du CPU (Data
Path)</h2>
<p>Voici le schéma complet du CPU. Chaque flèche est un fil (ou un bus
de 32 fils). Chaque boîte est un composant que vous avez construit ou
que vous allez construire.</p>
<figure>
<img src="images/cpu-datapath.svg"
alt="Architecture du CPU (Data Path)" />
<figcaption aria-hidden="true">Architecture du CPU (Data
Path)</figcaption>
</figure>
<h3 data-number="7.4.1" id="les-flux-de-données"><span
class="header-section-number">7.4.1</span> Les flux de données</h3>
<ol type="1">
<li><strong>Fetch</strong> : PC → Mémoire Instructions → Instruction (32
bits)</li>
<li><strong>Decode</strong> : Instruction → Décodeur → (Rd, Rn, Rm, Imm,
opcode)</li>
<li><strong>Register Read</strong> : Rn, Rm → Banc de Registres →
Valeurs</li>
<li><strong>Execute</strong> : Valeurs → ALU → Résultat</li>
<li><strong>Memory</strong> : Résultat → Mémoire Données (si
LDR/STR)</li>
<li><strong>Writeback</strong> : Résultat → Registre Rd</li>
</ol>
<hr />
<h2 data-number="7.5" id="les-composants-du-cpu"><span
class="header-section-number">7.5</span> Les Composants du CPU</h2>
<h3 data-number="7.5.1" id="le-compteur-de-programme-pc-1"><span
class="header-section-number">7.5.1</span> 1. Le Compteur de Programme
(PC)</h3>
<p>Vous l’avez déjà construit au Chapitre 3 ! Le PC contient l’adresse
de l’instruction courante.</p>
<p><strong>Modes de fonctionnement</strong> :</p>
<ul>
<li><code>inc = 1</code> : PC ← PC + 4 (instruction suivante)</li>
<li><code>load = 1</code> : PC ← adresse de branchement</li>
<li><code>reset = 1</code> : PC ← 0 (redémarrage)</li>
</ul>
<h3 data-number="7.5.2" id="le-décodeur-decoder"><span
class="header-section-number">7.5.2</span> 2. Le Décodeur (Decoder)</h3>
<p>Le décodeur est un circuit <strong>purement combinatoire</strong> qui
“découpe” les 32 bits de l’instruction.</p>
<figure>
<img src="images/decoder.svg" alt="Le décodeur d’instructions" />
<figcaption aria-hidden="true">Le décodeur d’instructions</figcaption>
</figure>
<p><strong>Sorties du décodeur</strong> :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Signal</th>
<th style="text-align: left;">Bits</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>cond</code></td>
<td style="text-align: left;">31-28</td>
<td style="text-align: left;">Code de condition (EQ, NE, LT…)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>class</code></td>
<td style="text-align: left;">27-25</td>
<td style="text-align: left;">Classe d’instruction (ALU, MEM,
BRANCH)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>op</code></td>
<td style="text-align: left;">24-21</td>
<td style="text-align: left;">Opération ALU (ADD, SUB, AND…)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>S</code></td>
<td style="text-align: left;">20</td>
<td style="text-align: left;">Mettre à jour les drapeaux ?</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>Rn</code></td>
<td style="text-align: left;">19-16</td>
<td style="text-align: left;">Registre source 1</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>Rd</code></td>
<td style="text-align: left;">15-12</td>
<td style="text-align: left;">Registre destination</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>Rm</code></td>
<td style="text-align: left;">3-0</td>
<td style="text-align: left;">Registre source 2</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>imm12</code></td>
<td style="text-align: left;">11-0</td>
<td style="text-align: left;">Valeur immédiate (12 bits)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>imm24</code></td>
<td style="text-align: left;">23-0</td>
<td style="text-align: left;">Offset de branchement (24 bits)</td>
</tr>
</tbody>
</table>
<p>Le décodeur ne fait que du <strong>câblage</strong> — il ne calcule
rien, il ne fait que router les bits vers les bonnes sorties.</p>
<h3 data-number="7.5.3" id="lunité-de-contrôle-control"><span
class="header-section-number">7.5.3</span> 3. L’Unité de Contrôle
(Control)</h3>
<p>L’unité de contrôle est le <strong>chef d’orchestre</strong>. Elle
regarde la classe et l’opcode, et décide quels signaux activer.</p>
<figure>
<img src="images/control-unit.svg" alt="Unité de contrôle" />
<figcaption aria-hidden="true">Unité de contrôle</figcaption>
</figure>
<p><strong>Exemples de signaux de contrôle</strong> :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Instruction</th>
<th style="text-align: center;">reg_write</th>
<th style="text-align: center;">mem_read</th>
<th style="text-align: center;">mem_write</th>
<th style="text-align: center;">alu_src</th>
<th style="text-align: center;">branch</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ADD</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0 (reg)</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">ADD #imm</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1 (imm)</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LDR</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1 (imm)</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">STR</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">1</td>
<td style="text-align: center;">1 (imm)</td>
<td style="text-align: center;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">B</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">X</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">CMP</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
<td style="text-align: center;">0</td>
</tr>
</tbody>
</table>
<h3 data-number="7.5.4"
id="le-vérificateur-de-condition-condcheck"><span
class="header-section-number">7.5.4</span> 4. Le Vérificateur de
Condition (CondCheck)</h3>
<p>Ce petit circuit vérifie si la condition est satisfaite.</p>
<p><strong>Entrées</strong> :</p>
<ul>
<li><code>cond</code> : Le code de condition (4 bits, ex: 0000 =
EQ)</li>
<li><code>flags</code> : Les drapeaux NZCV</li>
</ul>
<p><strong>Sortie</strong> :</p>
<ul>
<li><code>ok</code> : 1 si la condition est vraie, 0 sinon</li>
</ul>
<pre><code>  cond = 0000 (EQ) et Z = 1  →  ok = 1
  cond = 0000 (EQ) et Z = 0  →  ok = 0
  cond = 1110 (AL)           →  ok = 1 (toujours)</code></pre>
<p><strong>Pourquoi est-ce important ?</strong></p>
<p>Si <code>ok = 0</code>, l’instruction est “annulée” — on n’écrit pas
dans le registre, on ne fait pas le branchement. C’est la
<strong>prédication</strong> en action !</p>
<h3 data-number="7.5.5" id="le-banc-de-registres-regfile"><span
class="header-section-number">7.5.5</span> 5. Le Banc de Registres
(RegFile)</h3>
<p>Vous l’avez construit au Chapitre 3 (RAM8, RAM16…). Le banc de
registres est une RAM spéciale avec :</p>
<ul>
<li><strong>2 ports de lecture</strong> : Lire Rn ET Rm
simultanément</li>
<li><strong>1 port d’écriture</strong> : Écrire dans Rd</li>
</ul>
<figure>
<img src="images/register-bank-interface.svg"
alt="Interface du banc de registres" />
<figcaption aria-hidden="true">Interface du banc de
registres</figcaption>
</figure>
<h3 data-number="7.5.6" id="les-multiplexeurs"><span
class="header-section-number">7.5.6</span> 6. Les Multiplexeurs</h3>
<p>Les multiplexeurs routent les données entre les composants :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Mux</th>
<th style="text-align: left;">Choix</th>
<th style="text-align: left;">Signification</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>ALU_src</strong></td>
<td style="text-align: left;">0: Rm, 1: Imm</td>
<td style="text-align: left;">Deuxième opérande de l’ALU</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Writeback</strong></td>
<td style="text-align: left;">0: ALU, 1: MEM</td>
<td style="text-align: left;">Source de la valeur à écrire</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>PC_src</strong></td>
<td style="text-align: left;">0: PC+4, 1: Branch</td>
<td style="text-align: left;">Prochaine valeur du PC</td>
</tr>
</tbody>
</table>
<hr />
<h2 data-number="7.6" id="le-cycle-dexécution-en-détail"><span
class="header-section-number">7.6</span> Le Cycle d’Exécution en
Détail</h2>
<p>Notre CPU est <strong>single-cycle</strong> : chaque instruction
s’exécute en un seul cycle d’horloge.</p>
<h3 data-number="7.6.1" id="phase-1-fetch-récupération"><span
class="header-section-number">7.6.1</span> Phase 1 : Fetch
(Récupération)</h3>
<pre><code>PC ──► Mémoire Instructions ──► instruction (32 bits)</code></pre>
<p>Le PC envoie son adresse à la mémoire d’instructions. La mémoire
renvoie les 32 bits de l’instruction.</p>
<h3 data-number="7.6.2" id="phase-2-decode-décodage"><span
class="header-section-number">7.6.2</span> Phase 2 : Decode
(Décodage)</h3>
<pre><code>instruction ──► Décodeur ──► cond, class, op, Rn, Rd, Rm, imm
                   │
                   └──► Unité de Contrôle ──► signaux</code></pre>
<p>Le décodeur découpe l’instruction. L’unité de contrôle décide quoi
activer.</p>
<h3 data-number="7.6.3"
id="phase-3-register-read-lecture-des-registres"><span
class="header-section-number">7.6.3</span> Phase 3 : Register Read
(Lecture des registres)</h3>
<pre><code>Rn, Rm ──► Banc de Registres ──► Data_A, Data_B</code></pre>
<p>Les valeurs des registres sources sont lues.</p>
<h3 data-number="7.6.4" id="phase-4-execute-exécution"><span
class="header-section-number">7.6.4</span> Phase 4 : Execute
(Exécution)</h3>
<pre><code>Data_A ──────────────────┐
                         ├──► ALU ──► Résultat, Flags
Data_B ou Imm ──► MUX ───┘</code></pre>
<p>L’ALU effectue l’opération. Les drapeaux sont mis à jour (si
S=1).</p>
<h3 data-number="7.6.5" id="phase-5-memory-accès-mémoire"><span
class="header-section-number">7.6.5</span> Phase 5 : Memory (Accès
mémoire)</h3>
<pre><code>                    ┌─── Si LDR : MEM[addr] → valeur
Résultat (adresse) ─┤
                    └─── Si STR : valeur → MEM[addr]</code></pre>
<p>Pour les instructions LDR/STR, on accède à la mémoire de données.</p>
<h3 data-number="7.6.6" id="phase-6-writeback-écriture"><span
class="header-section-number">7.6.6</span> Phase 6 : Writeback
(Écriture)</h3>
<pre><code>Résultat (ALU ou MEM) ──► MUX ──► Banc de Registres ──► Rd</code></pre>
<p>Si <code>reg_write = 1</code> ET <code>cond_ok = 1</code>, on écrit
dans le registre destination.</p>
<h3 data-number="7.6.7" id="phase-7-pc-update"><span
class="header-section-number">7.6.7</span> Phase 7 : PC Update</h3>
<pre><code>        ┌─── Si branch : PC + (offset × 4)
PC+4 ───┤
        └─── Sinon : PC + 4</code></pre>
<p>Le PC est mis à jour pour le prochain cycle.</p>
<hr />
<h2 data-number="7.7" id="implémentation-du-cpu-en-hdl"><span
class="header-section-number">7.7</span> Implémentation du CPU en
HDL</h2>
<p>Voici un squelette de l’architecture du CPU :</p>
<div class="sourceCode" id="cb48"><pre
class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="cf">entity</span> <span class="dv">CPU</span> <span class="kw">is</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">port</span>(</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>    clk      <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    reset    <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>;</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">-- Interface mémoire</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>    instr    <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">31</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>    mem_in   <span class="ot">:</span> <span class="kw">in</span> bits(<span class="dv">31</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>    pc_out   <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">31</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>    mem_addr <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">31</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>    mem_out  <span class="ot">:</span> <span class="kw">out</span> bits(<span class="dv">31</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>    mem_we   <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>  );</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a><span class="cf">end entity;</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">rtl</span> <span class="kw">of</span> <span class="fu">CPU</span> <span class="kw">is</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Signaux internes</span></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> pc<span class="ot">,</span> pc_next <span class="ot">:</span> bits(<span class="dv">31</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> cond<span class="ot">,</span> op <span class="ot">:</span> bits(<span class="dv">3</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> rd<span class="ot">,</span> rn<span class="ot">,</span> rm <span class="ot">:</span> bits(<span class="dv">3</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> imm12 <span class="ot">:</span> bits(<span class="dv">11</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> data_a<span class="ot">,</span> data_b<span class="ot">,</span> alu_result <span class="ot">:</span> bits(<span class="dv">31</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> reg_write<span class="ot">,</span> mem_read<span class="ot">,</span> mem_write<span class="ot">,</span> alu_src<span class="ot">,</span> branch <span class="ot">:</span> <span class="dt">bit</span>;</span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> n_flag<span class="ot">,</span> z_flag<span class="ot">,</span> c_flag<span class="ot">,</span> v_flag<span class="ot">,</span> cond_ok <span class="ot">:</span> <span class="dt">bit</span>;</span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Instanciation des composants</span></span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_decoder</span><span class="ot">:</span> <span class="fu">Decoder</span> <span class="kw">port map </span>(<span class="ot">...</span>);</span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_control</span><span class="ot">:</span> <span class="fu">Control</span> <span class="kw">port map </span>(<span class="ot">...</span>);</span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_condcheck</span><span class="ot">:</span> <span class="fu">CondCheck</span> <span class="kw">port map </span>(<span class="ot">...</span>);</span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_regfile</span><span class="ot">:</span> <span class="fu">RegFile</span> <span class="kw">port map </span>(<span class="ot">...</span>);</span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_alu</span><span class="ot">:</span> <span class="fu">ALU</span> <span class="kw">port map </span>(<span class="ot">...</span>);</span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a>  <span class="dv">u_pc</span><span class="ot">:</span> <span class="fu">PC</span> <span class="kw">port map </span>(<span class="ot">...</span>);</span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Multiplexeurs</span></span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a>  alu_b <span class="ot">&lt;=</span> imm12 <span class="kw">when</span> alu_src <span class="ot">=</span> <span class="bn">&#39;1&#39;</span> <span class="kw">else</span> data_b;</span>
<span id="cb48-36"><a href="#cb48-36" aria-hidden="true" tabindex="-1"></a>  writeback <span class="ot">&lt;=</span> mem_in <span class="kw">when</span> mem_read <span class="ot">=</span> <span class="bn">&#39;1&#39;</span> <span class="kw">else</span> alu_result;</span>
<span id="cb48-37"><a href="#cb48-37" aria-hidden="true" tabindex="-1"></a>  pc_next <span class="ot">&lt;=</span> branch_addr <span class="kw">when</span> (branch <span class="kw">and</span> cond_ok) <span class="ot">=</span> <span class="bn">&#39;1&#39;</span> <span class="kw">else</span> pc_plus_4;</span>
<span id="cb48-38"><a href="#cb48-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-39"><a href="#cb48-39" aria-hidden="true" tabindex="-1"></a><span class="cf">end architecture;</span></span></code></pre></div>
<hr />
<h2 data-number="7.8" id="exercices-pratiques-4"><span
class="header-section-number">7.8</span> Exercices Pratiques</h2>
<h3 data-number="7.8.1" id="exercices-sur-le-simulateur-web-4"><span
class="header-section-number">7.8.1</span> Exercices sur le Simulateur
Web</h3>
<p>Lancez le <strong>Simulateur Web</strong> et allez dans <strong>HDL
Progression</strong> → <strong>Projet 5 : CPU</strong>.</p>
<table>
<thead>
<tr class="header">
<th>Exercice</th>
<th>Description</th>
<th style="text-align: center;">Difficulté</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>Decoder</code></td>
<td>Découper l’instruction en champs</td>
<td style="text-align: center;">[**]</td>
</tr>
<tr class="even">
<td><code>CondCheck</code></td>
<td>Vérifier les conditions (EQ, NE, LT…)</td>
<td style="text-align: center;">[**]</td>
</tr>
<tr class="odd">
<td><code>Control</code></td>
<td>Générer les signaux de contrôle</td>
<td style="text-align: center;">[***]</td>
</tr>
<tr class="even">
<td><code>CPU</code></td>
<td>L’assemblage final !</td>
<td style="text-align: center;">[****]</td>
</tr>
</tbody>
</table>
<h3 data-number="7.8.2" id="ordre-de-progression"><span
class="header-section-number">7.8.2</span> Ordre de progression</h3>
<ol type="1">
<li><strong>Decoder</strong> : Commencez par là. C’est du pur câblage.
<ul>
<li>Utilisez la syntaxe <code>instr(31 downto 28)</code> pour extraire
les bits</li>
</ul></li>
<li><strong>CondCheck</strong> : Table de vérité des conditions
<ul>
<li>EQ : Z = 1</li>
<li>NE : Z = 0</li>
<li>LT : N ≠ V</li>
<li>etc.</li>
</ul></li>
<li><strong>Control</strong> : La logique de commande
<ul>
<li>Pour chaque classe d’instruction, décidez les signaux</li>
<li>Attention aux cas spéciaux (CMP ne fait pas reg_write)</li>
</ul></li>
<li><strong>CPU</strong> : L’assemblage final
<ul>
<li>Suivez le schéma du data path</li>
<li>N’oubliez pas les multiplexeurs !</li>
</ul></li>
</ol>
<h3 data-number="7.8.3" id="tests-en-ligne-de-commande-3"><span
class="header-section-number">7.8.3</span> Tests en ligne de
commande</h3>
<div class="sourceCode" id="cb49"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tester le décodeur</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> run <span class="at">-p</span> hdl_cli <span class="at">--</span> test hdl_lib/05_cpu/Decoder.hdl</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Tester le CPU complet</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> run <span class="at">-p</span> hdl_cli <span class="at">--</span> test hdl_lib/05_cpu/CPU.hdl</span></code></pre></div>
<hr />
<h2 data-number="7.9" id="cpu-visualizer-loutil-interactif"><span
class="header-section-number">7.9</span> CPU Visualizer : L’Outil
Interactif</h2>
<p>Pour mieux comprendre comment le CPU exécute les instructions, le
projet inclut un <strong>CPU Visualizer</strong> interactif. C’est un
outil web qui vous permet de voir en temps réel le fonctionnement du
processeur.</p>
<h3 data-number="7.9.1" id="accéder-au-visualizer"><span
class="header-section-number">7.9.1</span> Accéder au Visualizer</h3>
<ol type="1">
<li>Lancez le serveur web :</li>
</ol>
<div class="sourceCode" id="cb50"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> web</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> install</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> run dev</span></code></pre></div>
<ol start="2" type="1">
<li><p>Ouvrez votre navigateur à l’adresse indiquée (généralement
<code>http://localhost:5173</code>)</p></li>
<li><p>Cliquez sur <strong>CPU Visualizer</strong> dans la barre de
navigation</p></li>
</ol>
<h3 data-number="7.9.2" id="fonctionnalités-du-visualizer"><span
class="header-section-number">7.9.2</span> Fonctionnalités du
Visualizer</h3>
<h4 data-number="7.9.2.1" id="vue-pipeline"><span
class="header-section-number">7.9.2.1</span> Vue Pipeline</h4>
<p>Le Visualizer affiche les <strong>5 étapes du cycle
d’exécution</strong> :</p>
<figure>
<img src="images/pipeline-view.svg"
alt="Vue Pipeline - Étapes d’exécution" />
<figcaption aria-hidden="true">Vue Pipeline - Étapes
d’exécution</figcaption>
</figure>
<p>Chaque étape s’illumine en jaune quand elle est active, vous
permettant de suivre la progression de l’instruction.</p>
<h4 data-number="7.9.2.2" id="panneau-registres"><span
class="header-section-number">7.9.2.2</span> Panneau Registres</h4>
<p>Affiche les <strong>16 registres</strong> (R0-R15) avec les alias
:</p>
<ul>
<li><strong>SP</strong> (R13) : Stack Pointer</li>
<li><strong>LR</strong> (R14) : Link Register</li>
<li><strong>PC</strong> (R15) : Program Counter</li>
</ul>
<p>Les registres modifiés s’illuminent en vert pendant un instant.</p>
<h4 data-number="7.9.2.3" id="panneau-flags-cpsr"><span
class="header-section-number">7.9.2.3</span> Panneau Flags (CPSR)</h4>
<p>Les 4 drapeaux du processeur sont affichés :</p>
<ul>
<li><strong>N</strong> (Negative) : Le résultat est négatif</li>
<li><strong>Z</strong> (Zero) : Le résultat est zéro</li>
<li><strong>C</strong> (Carry) : Retenue/emprunt</li>
<li><strong>V</strong> (Overflow) : Débordement signé</li>
</ul>
<p>Les flags changent de couleur quand ils sont actifs.</p>
<h4 data-number="7.9.2.4" id="panneau-code-source"><span
class="header-section-number">7.9.2.4</span> Panneau Code Source</h4>
<p>Affiche le code assembleur avec :</p>
<ul>
<li><strong>Coloration syntaxique</strong> : Instructions, registres,
nombres, commentaires</li>
<li><strong>Surlignage de la ligne courante</strong> : La ligne en cours
d’exécution est mise en évidence en jaune</li>
<li><strong>Défilement automatique</strong> : Le code défile pour suivre
l’exécution</li>
</ul>
<h4 data-number="7.9.2.5" id="panneau-mémoire-et-cache"><span
class="header-section-number">7.9.2.5</span> Panneau Mémoire et
Cache</h4>
<p>Affiche :</p>
<ul>
<li><strong>Vue mémoire</strong> : Les octets en mémoire autour du
PC</li>
<li><strong>Statistiques cache</strong> : Hits, Misses, Taux de
réussite</li>
<li><strong>Contenu du cache L1</strong> : Lignes valides avec tag et
données</li>
<li><strong>Indicateur HIT/MISS</strong> : Flash vert pour hit, rouge
pour miss</li>
</ul>
<h3 data-number="7.9.3" id="les-démos-intégrées"><span
class="header-section-number">7.9.3</span> Les Démos Intégrées</h3>
<p>Le Visualizer inclut 7 démos prêtes à l’emploi :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Demo</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">Concept illustré</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>1. Addition</strong></td>
<td style="text-align: left;">5 + 3 = 8</td>
<td style="text-align: left;">Instructions ALU basiques</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>2. Boucle</strong></td>
<td style="text-align: left;">Somme 1-5</td>
<td style="text-align: left;">Branchements conditionnels</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>3. Mémoire</strong></td>
<td style="text-align: left;">LDR/STR</td>
<td style="text-align: left;">Accès mémoire</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>4. Condition</strong></td>
<td style="text-align: left;">Valeur absolue</td>
<td style="text-align: left;">Prédication</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>5. Tableau</strong></td>
<td style="text-align: left;">Somme tableau</td>
<td style="text-align: left;">Boucle + mémoire</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>6. Flags</strong></td>
<td style="text-align: left;">N, Z, C, V</td>
<td style="text-align: left;">Drapeaux CPU</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>7. Cache</strong></td>
<td style="text-align: left;">Parcours mémoire</td>
<td style="text-align: left;">Cache hits/misses</td>
</tr>
</tbody>
</table>
<h3 data-number="7.9.4" id="contrôles"><span
class="header-section-number">7.9.4</span> Contrôles</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Bouton</th>
<th style="text-align: left;">Raccourci</th>
<th style="text-align: left;">Action</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Reset</strong></td>
<td style="text-align: left;">Ctrl+R</td>
<td style="text-align: left;">Remet le CPU à zéro</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Step</strong></td>
<td style="text-align: left;">N, F10</td>
<td style="text-align: left;">Exécute une instruction</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Play/Pause</strong></td>
<td style="text-align: left;">Espace</td>
<td style="text-align: left;">Lance/arrête l’exécution continue</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Vitesse</strong></td>
<td style="text-align: left;">Slider</td>
<td style="text-align: left;">Ajuste la vitesse d’exécution</td>
</tr>
</tbody>
</table>
<h3 data-number="7.9.5" id="charger-votre-propre-code"><span
class="header-section-number">7.9.5</span> Charger Votre Propre
Code</h3>
<ol type="1">
<li>Cliquez sur <strong>Charger fichier</strong></li>
<li>Sélectionnez un fichier <code>.asm</code>, <code>.a32</code> ou
<code>.a32b</code></li>
<li>Le code est assemblé et chargé automatiquement</li>
</ol>
<h3 data-number="7.9.6" id="exercice-pratique"><span
class="header-section-number">7.9.6</span> Exercice Pratique</h3>
<p>Utilisez le Visualizer pour observer ces comportements :</p>
<ol type="1">
<li><p><strong>Suivez une addition</strong> : Chargez la démo “Addition”
et observez comment ADD lit deux registres et écrit le résultat</p></li>
<li><p><strong>Observez un branchement</strong> : Chargez la démo
“Boucle” et regardez comment B.LE revient au début de la boucle</p></li>
<li><p><strong>Analysez le cache</strong> : Chargez la démo “Cache” et
observez les miss au premier parcours, puis les hits au second</p></li>
</ol>
<hr />
<h2 data-number="7.10" id="conseils-de-débogage"><span
class="header-section-number">7.10</span> Conseils de Débogage</h2>
<h3 data-number="7.10.1" id="le-pc-reste-à-0"><span
class="header-section-number">7.10.1</span> Le PC reste à 0 ?</h3>
<ul>
<li>Vérifiez que <code>inc = 1</code> par défaut</li>
<li>Vérifiez que le reset n’est pas bloqué</li>
</ul>
<h3 data-number="7.10.2" id="les-branchements-ne-marchent-pas"><span
class="header-section-number">7.10.2</span> Les branchements ne marchent
pas ?</h3>
<ul>
<li>L’offset dans l’instruction est en mots (× 4 pour avoir des
octets)</li>
<li>Vérifiez que <code>cond_ok</code> est correct</li>
<li>Vérifiez le calcul de l’adresse de branchement</li>
</ul>
<h3 data-number="7.10.3" id="rien-ne-sécrit-dans-les-registres"><span
class="header-section-number">7.10.3</span> Rien ne s’écrit dans les
registres ?</h3>
<ul>
<li><code>reg_write</code> doit être à 1</li>
<li><code>cond_ok</code> doit être à 1</li>
<li>Le registre destination ne doit pas être R15 (géré à part)</li>
</ul>
<h3 data-number="7.10.4" id="ldrstr-ne-fonctionne-pas"><span
class="header-section-number">7.10.4</span> LDR/STR ne fonctionne pas
?</h3>
<ul>
<li>Vérifiez le calcul de l’adresse (base + offset)</li>
<li>Vérifiez les signaux <code>mem_read</code> et
<code>mem_write</code></li>
<li>Attention à l’alignement (adresses multiples de 4)</li>
</ul>
<hr />
<h2 data-number="7.11" id="aller-plus-loin-le-cpu-pipeline"><span
class="header-section-number">7.11</span> Aller Plus Loin : Le CPU
Pipeline</h2>
<p>Le CPU single-cycle que nous avons construit est simple et
pédagogique. Mais dans le monde réel, il serait <strong>très
lent</strong>. Les vrais processeurs utilisent une technique appelée
<strong>pipeline</strong> pour être beaucoup plus rapides.</p>
<p>Cette section explique en détail ce qu’est un pipeline, pourquoi il
est nécessaire, et comment le construire.</p>
<hr />
<h3 data-number="7.11.1"
id="pourquoi-le-cpu-single-cycle-est-lent"><span
class="header-section-number">7.11.1</span> Pourquoi le CPU Single-Cycle
est Lent</h3>
<h4 data-number="7.11.1.1" id="le-problème-de-la-chaîne-critique"><span
class="header-section-number">7.11.1.1</span> Le problème de la chaîne
critique</h4>
<p>Dans notre CPU single-cycle, une instruction doit traverser
<strong>tous</strong> les composants en un seul cycle :</p>
<figure>
<img src="images/critical-path.svg"
alt="Le problème de la chaîne critique" />
<figcaption aria-hidden="true">Le problème de la chaîne
critique</figcaption>
</figure>
<p>Le cycle d’horloge doit être assez <strong>long</strong> pour que le
signal traverse tout ce chemin. Si chaque étape prend 1 nanoseconde, le
cycle doit faire au minimum 6 ns.</p>
<p><strong>Résultat</strong> : Même si certaines instructions n’ont pas
besoin de la mémoire de données (comme ADD), elles prennent quand même 6
ns.</p>
<h4 data-number="7.11.1.2" id="une-analogie-la-laverie"><span
class="header-section-number">7.11.1.2</span> Une analogie : La
laverie</h4>
<p>Imaginez que vous avez 4 lessives à faire. Chaque lessive a 4 étapes
: laver (30 min), sécher (30 min), plier (30 min), ranger (30 min).</p>
<figure>
<img src="images/laundry-analogy.svg" alt="Analogie de la laverie" />
<figcaption aria-hidden="true">Analogie de la laverie</figcaption>
</figure>
<p>Le pipeline ne rend pas une lessive individuelle plus rapide, mais il
permet de traiter <strong>plus de lessives par heure</strong> !</p>
<hr />
<h3 data-number="7.11.2" id="le-pipeline-à-5-étages"><span
class="header-section-number">7.11.2</span> Le Pipeline à 5 Étages</h3>
<p>Notre CPU pipeliné divise l’exécution en <strong>5 étapes</strong>,
chacune prenant exactement 1 cycle d’horloge :</p>
<figure>
<img src="images/pipeline-5-stages.svg" alt="Pipeline à 5 étages" />
<figcaption aria-hidden="true">Pipeline à 5 étages</figcaption>
</figure>
<h4 data-number="7.11.2.1" id="étape-1-if-instruction-fetch"><span
class="header-section-number">7.11.2.1</span> Étape 1 : IF (Instruction
Fetch)</h4>
<p><strong>But</strong> : Aller chercher l’instruction en mémoire.</p>
<pre><code>┌─────────────────────────────────────────────┐
│  IF - Instruction Fetch                     │
│                                             │
│    PC ────► Mémoire ────► Instruction       │
│    │        Instructions    (32 bits)       │
│    │                                        │
│    └───► PC + 4 (préparé pour la suite)     │
│                                             │
└─────────────────────────────────────────────┘</code></pre>
<p><strong>Ce qui se passe</strong> :</p>
<ol type="1">
<li>Le PC (Program Counter) envoie son adresse à la mémoire</li>
<li>La mémoire renvoie l’instruction (32 bits)</li>
<li>On calcule PC + 4 pour l’instruction suivante</li>
</ol>
<p><strong>Sortie</strong> : L’instruction et PC+4 sont stockés dans le
registre IF/ID.</p>
<h4 data-number="7.11.2.2" id="étape-2-id-instruction-decode"><span
class="header-section-number">7.11.2.2</span> Étape 2 : ID (Instruction
Decode)</h4>
<p><strong>But</strong> : Comprendre l’instruction et lire les registres
sources.</p>
<pre><code>┌─────────────────────────────────────────────┐
│  ID - Instruction Decode                    │
│                                             │
│    Instruction ─┬─► Décodeur ──► Signaux    │
│                 │                de contrôle│
│                 │                           │
│                 └─► Registres ──► Valeurs   │
│                      (Rn, Rm)     (A, B)    │
│                                             │
└─────────────────────────────────────────────┘</code></pre>
<p><strong>Ce qui se passe</strong> :</p>
<ol type="1">
<li>Le décodeur extrait les champs (Rd, Rn, Rm, opcode, etc.)</li>
<li>L’unité de contrôle génère les signaux (reg_write, mem_read,
etc.)</li>
<li>On lit les valeurs des registres Rn et Rm</li>
<li>On détecte les éventuels aléas (hazards)</li>
</ol>
<p><strong>Sortie</strong> : Tout est stocké dans le registre ID/EX.</p>
<h4 data-number="7.11.2.3" id="étape-3-ex-execute"><span
class="header-section-number">7.11.2.3</span> Étape 3 : EX
(Execute)</h4>
<p><strong>But</strong> : Effectuer le calcul.</p>
<pre><code>┌─────────────────────────────────────────────┐
│  EX - Execute                               │
│                                             │
│    Valeur A ──────┐                         │
│                   ├──► ALU ──► Résultat     │
│    Valeur B ──┬───┘            + Flags      │
│    ou Imm    MUX                            │
│                                             │
│    (Pour Branch: calcul de l&#39;adresse cible) │
│                                             │
└─────────────────────────────────────────────┘</code></pre>
<p><strong>Ce qui se passe</strong> :</p>
<ol type="1">
<li>L’ALU effectue l’opération (ADD, SUB, AND, etc.)</li>
<li>Les flags (N, Z, C, V) sont calculés</li>
<li>Pour les branchements, on calcule l’adresse cible</li>
<li>Le forwarding peut injecter des valeurs ici (on verra plus
tard)</li>
</ol>
<p><strong>Sortie</strong> : Le résultat ALU est stocké dans le registre
EX/MEM.</p>
<h4 data-number="7.11.2.4" id="étape-4-mem-memory-access"><span
class="header-section-number">7.11.2.4</span> Étape 4 : MEM (Memory
Access)</h4>
<p><strong>But</strong> : Lire ou écrire en mémoire (pour LDR/STR
seulement).</p>
<pre><code>┌─────────────────────────────────────────────┐
│  MEM - Memory Access                        │
│                                             │
│    Si LDR:  Adresse ──► Mémoire ──► Donnée  │
│                         Données             │
│                                             │
│    Si STR:  Adresse, Donnée ──► Mémoire     │
│                                             │
│    Sinon:   (le résultat ALU passe juste)   │
│                                             │
└─────────────────────────────────────────────┘</code></pre>
<p><strong>Ce qui se passe</strong> :</p>
<ol type="1">
<li>Pour LDR : on lit la mémoire à l’adresse calculée</li>
<li>Pour STR : on écrit la valeur en mémoire</li>
<li>Pour les autres instructions : rien (le résultat ALU est juste
transmis)</li>
</ol>
<p><strong>Sortie</strong> : Le résultat (ALU ou mémoire) est stocké
dans le registre MEM/WB.</p>
<h4 data-number="7.11.2.5" id="étape-5-wb-write-back"><span
class="header-section-number">7.11.2.5</span> Étape 5 : WB (Write
Back)</h4>
<p><strong>But</strong> : Écrire le résultat dans le registre
destination.</p>
<pre><code>┌─────────────────────────────────────────────┐
│  WB - Write Back                            │
│                                             │
│    Résultat ──► MUX ──► Banc de Registres   │
│    (ALU ou MEM)          ↓                  │
│                         Rd                  │
│                                             │
└─────────────────────────────────────────────┘</code></pre>
<p><strong>Ce qui se passe</strong> :</p>
<ol type="1">
<li>On choisit le résultat à écrire (ALU ou mémoire)</li>
<li>Si <code>reg_write = 1</code>, on écrit dans le registre Rd</li>
</ol>
<hr />
<h3 data-number="7.11.3" id="visualisation-du-pipeline-en-action"><span
class="header-section-number">7.11.3</span> Visualisation du Pipeline en
Action</h3>
<p>Voici comment 5 instructions traversent le pipeline :</p>
<figure>
<img src="images/pipeline-timing.svg"
alt="Visualisation du timing du pipeline" />
<figcaption aria-hidden="true">Visualisation du timing du
pipeline</figcaption>
</figure>
<p><strong>Observation clé</strong> : À partir du cycle 5, le pipeline
est “rempli” et on termine <strong>une instruction par cycle</strong>
!</p>
<p><strong>Comparaison des performances</strong> :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">CPU</th>
<th style="text-align: left;">100 instructions</th>
<th style="text-align: left;">Temps (si cycle = 1ns)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Single-cycle</td>
<td style="text-align: left;">100 cycles</td>
<td style="text-align: left;">100 ns</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pipeline 5 étages</td>
<td style="text-align: left;">104 cycles*</td>
<td style="text-align: left;">104 ns</td>
</tr>
</tbody>
</table>
<p>*Attendez… le pipeline n’est pas plus rapide ?</p>
<p>C’est parce que le cycle du pipeline est <strong>5× plus
court</strong> ! Chaque étage ne fait qu’une partie du travail.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">CPU</th>
<th style="text-align: left;">Durée cycle</th>
<th style="text-align: left;">100 instructions</th>
<th style="text-align: left;">Temps réel</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Single-cycle</td>
<td style="text-align: left;">5 ns</td>
<td style="text-align: left;">100 cycles</td>
<td style="text-align: left;"><strong>500 ns</strong></td>
</tr>
<tr class="even">
<td style="text-align: left;">Pipeline</td>
<td style="text-align: left;">1 ns</td>
<td style="text-align: left;">104 cycles</td>
<td style="text-align: left;"><strong>104 ns</strong></td>
</tr>
</tbody>
</table>
<p>Le pipeline est <strong>~5× plus rapide</strong> !</p>
<hr />
<h3 data-number="7.11.4" id="les-registres-de-pipeline"><span
class="header-section-number">7.11.4</span> Les Registres de
Pipeline</h3>
<p>Pour que le pipeline fonctionne, il faut <strong>stocker</strong> les
résultats intermédiaires entre chaque étage. C’est le rôle des
<strong>registres de pipeline</strong>.</p>
<h4 data-number="7.11.4.1" id="le-registre-ifid"><span
class="header-section-number">7.11.4.1</span> Le registre IF/ID</h4>
<p><strong>Stocke</strong> :</p>
<ul>
<li>L’instruction (32 bits)</li>
<li>PC+4 (32 bits)</li>
</ul>
<p><strong>Signaux spéciaux</strong> :</p>
<ul>
<li><code>stall</code> : Si 1, garder les mêmes valeurs (ne pas
avancer)</li>
<li><code>flush</code> : Si 1, mettre l’instruction à NOP (annuler)</li>
</ul>
<figure>
<img src="images/if-id-register.svg" alt="Registre de pipeline IF/ID" />
<figcaption aria-hidden="true">Registre de pipeline IF/ID</figcaption>
</figure>
<hr />
<h3 data-number="7.11.5" id="les-aléas-hazards"><span
class="header-section-number">7.11.5</span> Les Aléas (Hazards)</h3>
<p>Le pipeline crée de nouveaux problèmes. Quand une instruction dépend
du résultat d’une instruction précédente qui n’est pas encore terminée,
on a un <strong>aléa</strong>.</p>
<h4 data-number="7.11.5.1" id="aléa-de-données-data-hazard"><span
class="header-section-number">7.11.5.1</span> Aléa de Données (Data
Hazard)</h4>
<p><strong>Exemple problématique</strong> :</p>
<pre class="assembly"><code>ADD R1, R2, R3    ; Instruction 1: R1 = R2 + R3
SUB R4, R1, R5    ; Instruction 2: R4 = R1 - R5 (utilise R1!)</code></pre>
<figure>
<img src="images/data-hazard.svg" alt="Aléa de données (Data Hazard)" />
<figcaption aria-hidden="true">Aléa de données (Data
Hazard)</figcaption>
</figure>
<p><strong>Le problème</strong> : SUB lit R1 au cycle 3 (étage ID), mais
ADD n’écrit R1 qu’au cycle 5 (étage WB). SUB va lire
l’<strong>ancienne</strong> valeur de R1 !</p>
<h4 data-number="7.11.5.2" id="solution-1-le-forwarding-bypass"><span
class="header-section-number">7.11.5.2</span> Solution 1 : Le Forwarding
(Bypass)</h4>
<p>Au lieu d’attendre que R1 soit écrit dans le banc de registres, on
peut <strong>transférer</strong> le résultat directement depuis l’étage
EX ou MEM vers l’étage où on en a besoin.</p>
<pre><code>         │ Cycle 1 │ Cycle 2 │ Cycle 3 │ Cycle 4 │ Cycle 5 │
─────────┼─────────┼─────────┼─────────┼─────────┼─────────┤
ADD R1   │   IF    │   ID    │   EX ───┼── Résultat disponible!
SUB R4,R1│         │   IF    │   ID    │   EX ←── Forward!
                                            │
                                      (on prend le résultat
                                       directement de ADD)</code></pre>
<p><strong>Le ForwardUnit</strong> détecte ces situations et redirige
les données :</p>
<pre><code>┌─────────────────────────────────────────────────────────────┐
│  ForwardUnit                                                │
│                                                             │
│  Entrées:                                                   │
│    ex_rn, ex_rm  : registres sources de l&#39;instruction en EX │
│    mem_rd        : registre destination en MEM              │
│    mem_reg_write : MEM va écrire un registre?               │
│    wb_rd         : registre destination en WB               │
│    wb_reg_write  : WB va écrire un registre?                │
│                                                             │
│  Logique:                                                   │
│    Si MEM.rd = EX.rn et MEM écrit → forward depuis MEM      │
│    Sinon si WB.rd = EX.rn et WB écrit → forward depuis WB   │
│    Sinon → pas de forwarding                                │
│                                                             │
│  Sorties (2 bits chacune):                                  │
│    forward_a : 00=rien, 01=depuis MEM, 10=depuis WB         │
│    forward_b : 00=rien, 01=depuis MEM, 10=depuis WB         │
│                                                             │
└─────────────────────────────────────────────────────────────┘</code></pre>
<h4 data-number="7.11.5.3" id="solution-2-le-stall-pour-load-use"><span
class="header-section-number">7.11.5.3</span> Solution 2 : Le Stall
(pour Load-Use)</h4>
<p>Le forwarding ne résout pas tous les cas. Considérons :</p>
<pre class="assembly"><code>LDR R1, [R2]      ; Charge R1 depuis la mémoire
ADD R4, R1, R5    ; Utilise R1 immédiatement!</code></pre>
<pre><code>         │ Cycle 1 │ Cycle 2 │ Cycle 3 │ Cycle 4 │ Cycle 5 │
─────────┼─────────┼─────────┼─────────┼─────────┼─────────┤
LDR R1   │   IF    │   ID    │   EX    │   MEM ←── R1 disponible ici
ADD R4,R1│         │   IF    │   ID    │   EX ←── Besoin de R1 ici!</code></pre>
<p><strong>Problème</strong> : ADD a besoin de R1 dans son étage EX
(cycle 4), mais LDR ne lit la mémoire qu’à l’étage MEM (aussi cycle 4).
On ne peut pas faire de forwarding vers le passé !</p>
<p><strong>Solution</strong> : Insérer une <strong>bulle</strong>
(stall) pour retarder ADD d’un cycle.</p>
<pre><code>         │ Cycle 1 │ Cycle 2 │ Cycle 3 │ Cycle 4 │ Cycle 5 │ Cycle 6 │
─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┤
LDR R1   │   IF    │   ID    │   EX    │   MEM───┼──►Forward possible!
ADD R4,R1│         │   IF    │   ID    │  STALL  │   EX ←── Forward OK!
Instr 3  │         │         │   IF    │  STALL  │   ID    │   EX    │</code></pre>
<p><strong>Le HazardDetect</strong> détecte ces situations :</p>
<pre><code>┌───────────────────────────────────────────────────────────────┐
│  HazardDetect                                                 │
│                                                               │
│  Entrées:                                                     │
│    id_rn, id_rm    : registres sources en ID                  │
│    id_rn_used      : Rn est utilisé par l&#39;instruction?        │
│    id_rm_used      : Rm est utilisé par l&#39;instruction?        │
│    ex_rd           : registre destination en EX               │
│    ex_mem_read     : instruction en EX est un LDR?            │
│                                                               │
│  Logique:                                                     │
│    Si EX est un load (ex_mem_read = 1)                        │
│    ET ID utilise ce registre (id_rn = ex_rd ou id_rm = ex_rd) │
│    → Déclencher un STALL                                      │
│                                                               │
│  Sortie:                                                      │
│    stall : 1 = bloquer IF et ID, insérer NOP en EX            │
│                                                               │
└───────────────────────────────────────────────────────────────┘</code></pre>
<h4 data-number="7.11.5.4" id="aléa-de-contrôle-control-hazard"><span
class="header-section-number">7.11.5.4</span> Aléa de Contrôle (Control
Hazard)</h4>
<p>Les branchements posent un autre problème :</p>
<pre class="assembly"><code>BEQ label         ; Si égal, sauter à label
ADD R1, R2, R3    ; Cette instruction est-elle exécutée?
SUB R4, R5, R6    ; Et celle-ci?
label:
MOV R7, #42</code></pre>
<pre><code>         │ Cycle 1 │ Cycle 2 │ Cycle 3 │ Cycle 4 │
─────────┼─────────┼─────────┼─────────┼─────────┤
BEQ      │   IF    │   ID    │   EX ←── On sait si on branche
ADD      │         │   IF    │   ID    │  ???    │
SUB      │         │         │   IF    │  ???    │</code></pre>
<p><strong>Problème</strong> : Quand on exécute BEQ, on a déjà commencé
à chercher les instructions suivantes ! Si le branchement est pris, ADD
et SUB n’auraient jamais dû être exécutées.</p>
<p><strong>Solution</strong> : Le <strong>Flush</strong></p>
<p>Si le branchement est pris, on <strong>annule</strong> les
instructions qui n’auraient pas dû être chargées :</p>
<pre><code>         │ Cycle 1 │ Cycle 2 │ Cycle 3 │ Cycle 4 │ Cycle 5 │
─────────┼─────────┼─────────┼─────────┼─────────┼─────────┤
BEQ      │   IF    │   ID    │   EX    │   MEM   │   WB    │
ADD      │         │   IF    │   ID    │  FLUSH  │         │
SUB      │         │         │   IF    │  FLUSH  │         │
MOV R7   │         │         │         │   IF    │   ID    │...</code></pre>
<p>Le signal <code>flush</code> met les registres de pipeline à NOP
(instruction qui ne fait rien).</p>
<hr />
<h3 data-number="7.11.6"
id="architecture-complète-du-cpu-pipeline"><span
class="header-section-number">7.11.6</span> Architecture Complète du CPU
Pipeline</h3>
<figure>
<img src="images/cpu-pipeline-architecture.svg"
alt="Architecture du CPU Pipeline" />
<figcaption aria-hidden="true">Architecture du CPU Pipeline</figcaption>
</figure>
<hr />
<h3 data-number="7.11.7" id="exercices-pratiques-projet-6"><span
class="header-section-number">7.11.7</span> Exercices Pratiques : Projet
6</h3>
<p>Le <strong>Projet 6 : CPU Pipeline</strong> vous permet de construire
ces composants.</p>
<h4 data-number="7.11.7.1" id="exercice-1-if_id_reg"><span
class="header-section-number">7.11.7.1</span> Exercice 1 :
IF_ID_Reg</h4>
<p><strong>Objectif</strong> : Implémenter le registre de pipeline
IF/ID.</p>
<p><strong>Comportement</strong> :</p>
<ol type="1">
<li>Sur <code>reset='1'</code> OU <code>flush='1'</code> : mettre
l’instruction à NOP (0xE0000000)</li>
<li>Sur <code>stall='1'</code> : garder les valeurs actuelles</li>
<li>Sinon : capturer les nouvelles valeurs</li>
</ol>
<p><strong>Squelette</strong> :</p>
<div class="sourceCode" id="cb66"><pre
class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">rtl</span> <span class="kw">of</span> <span class="fu">IF_ID_Reg</span> <span class="kw">is</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> instr_reg <span class="ot">:</span> bits(<span class="dv">31</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> pc_plus4_reg <span class="ot">:</span> bits(<span class="dv">31</span> <span class="ot">downto</span> <span class="dv">0</span>);</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="sc">process</span>(clk)</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  <span class="sc">begin</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">rising_edge</span>(clk) <span class="cf">then</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (reset <span class="ot">=</span> <span class="bn">&#39;1&#39;</span>) <span class="kw">or</span> (flush <span class="ot">=</span> <span class="bn">&#39;1&#39;</span>) <span class="cf">then</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>        instr_reg <span class="ot">&lt;=</span> x<span class="st">&quot;E0000000&quot;</span>;  <span class="co">-- NOP</span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>        pc_plus4_reg <span class="ot">&lt;=</span> x<span class="st">&quot;00000000&quot;</span>;</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>      <span class="cf">elsif</span> stall <span class="ot">=</span> <span class="bn">&#39;0&#39;</span> <span class="cf">then</span></span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>        instr_reg <span class="ot">&lt;=</span> if_instr;</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>        pc_plus4_reg <span class="ot">&lt;=</span> if_pc_plus4;</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>      <span class="cf">end if;</span></span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>      <span class="co">-- Si stall=&#39;1&#39;, on ne fait rien (garde les valeurs)</span></span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end if;</span></span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>  <span class="sc">end process;</span></span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>  id_instr <span class="ot">&lt;=</span> instr_reg;</span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>  id_pc_plus4 <span class="ot">&lt;=</span> pc_plus4_reg;</span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a><span class="cf">end architecture;</span></span></code></pre></div>
<h4 data-number="7.11.7.2" id="exercice-2-hazarddetect"><span
class="header-section-number">7.11.7.2</span> Exercice 2 :
HazardDetect</h4>
<p><strong>Objectif</strong> : Détecter les aléas load-use.</p>
<p><strong>Logique</strong> :</p>
<pre><code>rn_hazard = ex_mem_read AND id_rn_used AND (id_rn = ex_rd)
rm_hazard = ex_mem_read AND id_rm_used AND (id_rm = ex_rd)
stall = rn_hazard OR rm_hazard</code></pre>
<p><strong>En HDL</strong> (attention : pas de <code>when...else</code>,
utiliser la logique booléenne) :</p>
<div class="sourceCode" id="cb68"><pre
class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">rtl</span> <span class="kw">of</span> <span class="fu">HazardDetect</span> <span class="kw">is</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> rn_hazard <span class="ot">:</span> <span class="dt">bit</span>;</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> rm_hazard <span class="ot">:</span> <span class="dt">bit</span>;</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  rn_hazard <span class="ot">&lt;=</span> ex_mem_read <span class="kw">and</span> id_rn_used <span class="kw">and</span> (id_rn <span class="ot">=</span> ex_rd);</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  rm_hazard <span class="ot">&lt;=</span> ex_mem_read <span class="kw">and</span> id_rm_used <span class="kw">and</span> (id_rm <span class="ot">=</span> ex_rd);</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>  stall <span class="ot">&lt;=</span> rn_hazard <span class="kw">or</span> rm_hazard;</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a><span class="cf">end architecture;</span></span></code></pre></div>
<h4 data-number="7.11.7.3" id="exercice-3-forwardunit"><span
class="header-section-number">7.11.7.3</span> Exercice 3 :
ForwardUnit</h4>
<p><strong>Objectif</strong> : Générer les signaux de forwarding.</p>
<p><strong>Encodage</strong> :</p>
<ul>
<li><code>00</code> : Pas de forwarding</li>
<li><code>01</code> : Forward depuis MEM</li>
<li><code>10</code> : Forward depuis WB</li>
</ul>
<p><strong>Logique</strong> :</p>
<pre><code>mem_fwd_a = mem_reg_write AND (mem_rd = ex_rn)
wb_fwd_a = wb_reg_write AND (wb_rd = ex_rn) AND (NOT mem_fwd_a)
forward_a = wb_fwd_a &amp; mem_fwd_a   (concaténation de bits)</code></pre>
<p><strong>En HDL</strong> :</p>
<div class="sourceCode" id="cb70"><pre
class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">rtl</span> <span class="kw">of</span> <span class="fu">ForwardUnit</span> <span class="kw">is</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> mem_fwd_a<span class="ot">,</span> wb_fwd_a <span class="ot">:</span> <span class="dt">bit</span>;</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="ot">signal</span> mem_fwd_b<span class="ot">,</span> wb_fwd_b <span class="ot">:</span> <span class="dt">bit</span>;</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  mem_fwd_a <span class="ot">&lt;=</span> mem_reg_write <span class="kw">and</span> (mem_rd <span class="ot">=</span> ex_rn);</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>  wb_fwd_a <span class="ot">&lt;=</span> wb_reg_write <span class="kw">and</span> (wb_rd <span class="ot">=</span> ex_rn) <span class="kw">and</span> (<span class="kw">not</span> mem_fwd_a);</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>  mem_fwd_b <span class="ot">&lt;=</span> mem_reg_write <span class="kw">and</span> (mem_rd <span class="ot">=</span> ex_rm);</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>  wb_fwd_b <span class="ot">&lt;=</span> wb_reg_write <span class="kw">and</span> (wb_rd <span class="ot">=</span> ex_rm) <span class="kw">and</span> (<span class="kw">not</span> mem_fwd_b);</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>  forward_a <span class="ot">&lt;=</span> wb_fwd_a <span class="ot">&amp;</span> mem_fwd_a;</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a>  forward_b <span class="ot">&lt;=</span> wb_fwd_b <span class="ot">&amp;</span> mem_fwd_b;</span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a><span class="cf">end architecture;</span></span></code></pre></div>
<h4 data-number="7.11.7.4"
id="exercice-4-cpu_pipeline-projet-final"><span
class="header-section-number">7.11.7.4</span> Exercice 4 : CPU_Pipeline
(Projet Final)</h4>
<p>C’est le grand défi ! Assembler tous les composants en un CPU
pipeliné complet.</p>
<p><strong>Conseil</strong> : L’implémentation de référence est dans
<code>hdl_lib/05_cpu/CPU_Pipeline.hdl</code> (~450 lignes).</p>
<hr />
<h3 data-number="7.11.8" id="comment-tester-le-cpu-pipeline-hdl"><span
class="header-section-number">7.11.8</span> Comment Tester le CPU
Pipeline HDL</h3>
<p>Pour tester le CPU Pipeline en HDL, créez un script de test
<code>.tst</code> :</p>
<p><strong>Fichier <code>CPU_Pipeline_test.tst</code> :</strong></p>
<pre><code>-- Test du CPU Pipeline
load CPU_Pipeline.hdl;

-- Charger les composants requis
load IF_ID_Reg.hdl;
load ID_EX_Reg.hdl;
load EX_MEM_Reg.hdl;
load MEM_WB_Reg.hdl;
load HazardDetect.hdl;
load ForwardUnit.hdl;
load Decoder.hdl;
load Control.hdl;
load CondCheck.hdl;
load RegFile16.hdl;
load ALU32.hdl;
load Shifter32.hdl;
load Add32.hdl;
load PC.hdl;
load Mux32.hdl;

-- Initialiser
set reset 1;
tick; tock;
set reset 0;

-- Charger une instruction ADD R1, R0, #5 en mémoire
set instr_data 0x22100005;  -- ADD R1, R0, #5

-- Exécuter plusieurs cycles (5 cycles pour traverser le pipeline)
tick; tock;  -- IF
tick; tock;  -- ID
tick; tock;  -- EX
tick; tock;  -- MEM
tick; tock;  -- WB

-- Vérifier l&#39;état
expect halted 0;</code></pre>
<p><strong>Exécuter le test :</strong></p>
<div class="sourceCode" id="cb72"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> run <span class="at">-p</span> hdl_cli <span class="at">--</span> CPU_Pipeline_test.tst</span></code></pre></div>
<p><strong>Structure des fichiers HDL pour le pipeline :</strong></p>
<pre><code>hdl_lib/05_cpu/
├── CPU_Pipeline.hdl      # CPU complet assemblé
├── IF_ID_Reg.hdl         # Registre pipeline IF→ID
├── ID_EX_Reg.hdl         # Registre pipeline ID→EX
├── EX_MEM_Reg.hdl        # Registre pipeline EX→MEM
├── MEM_WB_Reg.hdl        # Registre pipeline MEM→WB
├── HazardDetect.hdl      # Détection load-use hazards
├── ForwardUnit.hdl       # Bypass/forwarding
├── Decoder.hdl           # Décodage instruction
├── Control.hdl           # Signaux de contrôle
└── CondCheck.hdl         # Vérification conditions</code></pre>
<p><strong>Observer le pipeline en action :</strong></p>
<p>Pour voir les hazards et le forwarding, testez avec des instructions
dépendantes :</p>
<pre><code>-- Test de forwarding (EX→EX)
-- ADD R1, R0, #5     ; R1 = 5
-- ADD R2, R1, #3     ; R2 = R1 + 3 = 8 (forward depuis EX)
set instr_data 0x22100005;  tick; tock;
set instr_data 0x22210003;  tick; tock;
-- Le ForwardUnit détecte que R1 est produit par l&#39;instruction précédente
-- et bypass la valeur directement sans attendre le writeback</code></pre>
<pre><code>-- Test de stall (load-use hazard)
-- LDR R1, [R0]       ; R1 = mem[R0]
-- ADD R2, R1, #3     ; R2 = R1 + 3 (doit attendre le load)
set instr_data 0x51100000;  tick; tock;
set instr_data 0x22210003;  tick; tock;
-- Le HazardDetect insère un stall car le LDR n&#39;a pas encore
-- la valeur disponible au moment où ADD en a besoin</code></pre>
<hr />
<h3 data-number="7.11.9" id="résumé-pipeline-vs-single-cycle"><span
class="header-section-number">7.11.9</span> Résumé : Pipeline vs
Single-Cycle</h3>
<table>
<colgroup>
<col style="width: 25%" />
<col style="width: 43%" />
<col style="width: 31%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Aspect</th>
<th style="text-align: left;">Single-Cycle</th>
<th style="text-align: left;">Pipeline</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Instructions en
parallèle</strong></td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">Jusqu’à 5</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Throughput</strong></td>
<td style="text-align: left;">1 instr / 5 unités de temps</td>
<td style="text-align: left;">1 instr / 1 unité de temps</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Complexité</strong></td>
<td style="text-align: left;">Simple</td>
<td style="text-align: left;">Plus complexe</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Aléas</strong></td>
<td style="text-align: left;">Aucun</td>
<td style="text-align: left;">Data hazards, Control hazards</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Composants
supplémentaires</strong></td>
<td style="text-align: left;">Aucun</td>
<td style="text-align: left;">Registres pipeline, Hazard Detect, Forward
Unit</td>
</tr>
</tbody>
</table>
<hr />
<h3 data-number="7.11.10" id="pour-aller-encore-plus-loin"><span
class="header-section-number">7.11.10</span> Pour Aller Encore Plus
Loin</h3>
<p>Les vrais processeurs modernes vont bien au-delà :</p>
<ul>
<li><strong>Superscalaire</strong> : Plusieurs pipelines en
parallèle</li>
<li><strong>Exécution dans le désordre</strong> : Réorganiser les
instructions</li>
<li><strong>Prédiction de branchement</strong> : Deviner si un
branchement sera pris</li>
<li><strong>Cache</strong> : Mémoire ultra-rapide proche du CPU</li>
</ul>
<p>Mais ces concepts dépassent le cadre de ce livre. Le pipeline à 5
étages reste la base sur laquelle tout le reste est construit !</p>
<hr />
<h2 data-number="7.12" id="le-lien-avec-la-suite-1"><span
class="header-section-number">7.12</span> Le Lien avec la Suite</h2>
<p><strong>Félicitations !</strong> Vous venez de construire un
ordinateur complet.</p>
<p>Ce CPU que vous avez construit peut maintenant :</p>
<ul>
<li>Exécuter des programmes écrits en assembleur (Chapitre 6)</li>
<li>Exécuter des programmes compilés depuis C32 (Chapitre 7-8)</li>
<li>Faire tourner un système d’exploitation minimal (Chapitre 9)</li>
</ul>
<h3 data-number="7.12.1" id="le-parcours-complet"><span
class="header-section-number">7.12.1</span> Le parcours complet</h3>
<pre><code>Chapitre 1-5 : MATÉRIEL
    NAND → Portes → ALU → Mémoire → CPU
                              ↓
Chapitre 6-9 : LOGICIEL
    Assembleur → Compilateur → Langage C32 → OS</code></pre>
<p>À partir de maintenant, nous passons du côté
<strong>logiciel</strong>. Le matériel est terminé !</p>
<hr />
<h2 data-number="7.13" id="ce-quil-faut-retenir-4"><span
class="header-section-number">7.13</span> Ce qu’il faut retenir</h2>
<ol type="1">
<li><p><strong>Le CPU orchestre tout</strong> : Fetch → Decode → Execute
→ Memory → Writeback</p></li>
<li><p><strong>Le décodeur analyse</strong> : 32 bits → signaux
individuels</p></li>
<li><p><strong>L’unité de contrôle décide</strong> : Quels composants
activer</p></li>
<li><p><strong>Les multiplexeurs routent</strong> : Les données entre
composants</p></li>
<li><p><strong>Les drapeaux permettent les conditions</strong> : NZCV →
CondCheck → ok/pas ok</p></li>
<li><p><strong>Single-cycle = simple</strong> : Tout en un cycle (mais
lent en vrai)</p></li>
</ol>
<p><strong>Prochaine étape</strong> : Au Chapitre 6, nous construirons
l’<strong>Assembleur</strong> — le programme qui traduit le code
assembleur en binaire exécutable par votre CPU.</p>
<hr />
<p><strong>Conseil</strong> : Si vous avez réussi le CPU, vous avez
accompli quelque chose de remarquable. Prenez le temps de savourer :
vous avez construit un ordinateur complet, de la porte NAND au
processeur fonctionnel !</p>
<hr />
<h2 data-number="7.14" id="auto-évaluation-4"><span
class="header-section-number">7.14</span> Auto-évaluation</h2>
<p>Testez votre compréhension avant de passer au chapitre suivant.</p>
<h3 data-number="7.14.1" id="questions-de-compréhension-4"><span
class="header-section-number">7.14.1</span> Questions de
compréhension</h3>
<p><strong>Q1.</strong> Quelles sont les 5 étapes du cycle d’exécution
d’une instruction ?</p>
<p><strong>Q2.</strong> Quel est le rôle du décodeur d’instructions
?</p>
<p><strong>Q3.</strong> Pourquoi les branchements conditionnels
dépendent-ils des drapeaux NZCV ?</p>
<p><strong>Q4.</strong> Dans un CPU pipeline 5 étages, qu’est-ce qu’un
hazard de données ?</p>
<p><strong>Q5.</strong> Quelle est la différence entre un CPU
single-cycle et un CPU pipeliné ?</p>
<h3 data-number="7.14.2" id="mini-défi-pratique-4"><span
class="header-section-number">7.14.2</span> Mini-défi pratique</h3>
<p>Tracez l’exécution de cette instruction dans le CPU :</p>
<div class="sourceCode" id="cb77"><pre
class="sourceCode asm"><code class="sourceCode fasm"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="bu">ADD</span> R1<span class="op">,</span> R2<span class="op">,</span> R3</span></code></pre></div>
<p>Décrivez ce qui se passe à chaque étape (Fetch, Decode, Execute,
Memory, Writeback).</p>
<p><em>Les solutions se trouvent dans le document
<strong>Codex_Solutions</strong>.</em></p>
<h3 data-number="7.14.3" id="checklist-de-validation-4"><span
class="header-section-number">7.14.3</span> Checklist de validation</h3>
<p>Avant de passer au chapitre 6, assurez-vous de pouvoir :</p>
<ul class="task-list">
<li><label><input type="checkbox" />Décrire les 5 étapes d’exécution
d’une instruction</label></li>
<li><label><input type="checkbox" />Expliquer le rôle du décodeur et de
l’unité de contrôle</label></li>
<li><label><input type="checkbox" />Tracer le chemin des données pour
ADD, LDR, et B</label></li>
<li><label><input type="checkbox" />Comprendre pourquoi les MUX sont
essentiels (choix des sources)</label></li>
<li><label><input type="checkbox" />Expliquer le concept de pipeline et
ses avantages</label></li>
</ul>
<h1 data-number="8" id="lassembleur"><span
class="header-section-number">8</span> L’Assembleur</h1>
<blockquote>
<p>“Traduire, c’est trahir ?” — Pas ici.</p>
</blockquote>
<p>Dans les chapitres précédents, nous avons conçu le matériel capable
d’exécuter des instructions 32 bits. Mais écrire un programme en
hexadécimal (comme <code>0xE2801001</code>) est extrêmement pénible et
source d’erreurs.</p>
<p>L’<strong>Assembleur</strong> est l’outil logiciel qui fait le pont
entre le programmeur et la machine. Il traduit un fichier texte
contenant des mnémoniques lisibles (ex: <code>ADD R1, R1, #1</code>) en
un fichier binaire exécutable par le CPU.</p>
<hr />
<h2 data-number="8.1" id="où-en-sommes-nous-5"><span
class="header-section-number">8.1</span> Où en sommes-nous ?</h2>
<figure>
<img src="images/architecture-stack.svg"
alt="Position dans l’architecture" />
<figcaption aria-hidden="true">Position dans l’architecture</figcaption>
</figure>
<p><em>Nous sommes à la Couche 3 : Assembleur - Du texte au
binaire</em></p>
<p>Nous entrons maintenant dans le monde du <strong>logiciel</strong> !
L’assembleur est le premier programme que nous construisons pour notre
machine.</p>
<hr />
<h2 data-number="8.2" id="le-rôle-de-lassembleur"><span
class="header-section-number">8.2</span> Le Rôle de l’Assembleur</h2>
<h3 data-number="8.2.1" id="du-texte-au-binaire"><span
class="header-section-number">8.2.1</span> Du texte au binaire</h3>
<pre><code>                    Assembleur
   Code source  ──────────────►  Code machine
   (texte)                       (binaire)

   ADD R1, R2, #10     →     0xE2821010
   B loop              →     0xEAFFFFFE</code></pre>
<h3 data-number="8.2.2" id="les-trois-tâches-de-lassembleur"><span
class="header-section-number">8.2.2</span> Les trois tâches de
l’assembleur</h3>
<ol type="1">
<li><p><strong>Analyse (Parsing)</strong> : Lire le code source et
comprendre les instructions, les opérandes, les labels.</p></li>
<li><p><strong>Résolution des Symboles</strong> : Transformer les
étiquettes (labels) comme <code>loop:</code> en adresses
numériques.</p></li>
<li><p><strong>Encodage</strong> : Transformer chaque instruction en son
équivalent binaire de 32 bits selon la spécification de l’ISA.</p></li>
</ol>
<hr />
<h2 data-number="8.3" id="la-stratégie-des-deux-passes"><span
class="header-section-number">8.3</span> La Stratégie des Deux
Passes</h2>
<h3 data-number="8.3.1" id="pourquoi-deux-passes"><span
class="header-section-number">8.3.1</span> Pourquoi deux passes ?</h3>
<p>Regardez ce code :</p>
<div class="sourceCode" id="cb79"><pre
class="sourceCode asm"><code class="sourceCode fasm"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>    B suite    <span class="co">; Où est &#39;suite&#39; ? On ne le sait pas encore !</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">1</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="fu">suite:</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R0<span class="op">,</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">1</span></span></code></pre></div>
<p>À la ligne 1, l’assembleur ne sait pas encore où est
<code>suite</code>. C’est le problème des <strong>références vers
l’avant</strong>.</p>
<h3 data-number="8.3.2"
id="passe-1-construction-de-la-table-des-symboles"><span
class="header-section-number">8.3.2</span> Passe 1 : Construction de la
Table des Symboles</h3>
<p>L’assembleur parcourt le fichier et note l’adresse de chaque label
:</p>
<pre><code>Adresse 0x0000 : B suite           (4 octets)
Adresse 0x0004 : MOV R0, #1        (4 octets)
Adresse 0x0008 : suite:            ← On note : suite = 0x0008
Adresse 0x0008 : ADD R0, R0, #1</code></pre>
<p><strong>Table des symboles</strong> :
<code>{ "suite": 0x00000008 }</code></p>
<h3 data-number="8.3.3" id="passe-2-génération-du-code"><span
class="header-section-number">8.3.3</span> Passe 2 : Génération du
Code</h3>
<p>L’assembleur reparcourt le fichier. Quand il voit
<code>B suite</code>, il regarde dans sa table et génère l’offset
correct.</p>
<pre><code>B suite → offset = (0x0008 - 0x0000 - 8) / 4 = -2 → 0xEAFFFFFE</code></pre>
<hr />
<h2 data-number="8.4" id="sections-et-directives"><span
class="header-section-number">8.4</span> Sections et Directives</h2>
<h3 data-number="8.4.1" id="les-sections"><span
class="header-section-number">8.4.1</span> Les Sections</h3>
<p>Un programme n’est pas fait que d’instructions. Il contient aussi des
données.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Section</th>
<th style="text-align: left;">Contenu</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>.text</code></td>
<td style="text-align: left;">Le code (les instructions) — généralement
en lecture seule</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>.data</code></td>
<td style="text-align: left;">Les variables globales initialisées</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>.bss</code></td>
<td style="text-align: left;">Les variables globales non initialisées
(mises à zéro)</td>
</tr>
</tbody>
</table>
<h3 data-number="8.4.2" id="les-directives"><span
class="header-section-number">8.4.2</span> Les Directives</h3>
<p>Les directives (commençant par <code>.</code>) guident l’assembleur
:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Directive</th>
<th style="text-align: left;">Signification</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>.text</code></td>
<td style="text-align: left;">Début de la section code</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>.data</code></td>
<td style="text-align: left;">Début de la section données</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>.global _start</code></td>
<td style="text-align: left;">Exporte le symbole
<code>_start</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>.word 123</code></td>
<td style="text-align: left;">Réserve 4 octets avec la valeur 123</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>.asciz "Hello"</code></td>
<td style="text-align: left;">Chaîne terminée par un zéro</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>.align 2</code></td>
<td style="text-align: left;">Aligne sur un multiple de 4 octets</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>.ltorg</code></td>
<td style="text-align: left;">Force l’émission du literal pool</td>
</tr>
</tbody>
</table>
<hr />
<h2 data-number="8.5" id="exemple-dencodage"><span
class="header-section-number">8.5</span> Exemple d’Encodage</h2>
<p>Comment l’assembleur encode-t-il <code>ADD R1, R2, #10</code> ?</p>
<h3 data-number="8.5.1" id="étape-1-identifier-linstruction"><span
class="header-section-number">8.5.1</span> Étape 1 : Identifier
l’instruction</h3>
<ul>
<li><strong>Mnémonique</strong> : <code>ADD</code> → opcode = 0011</li>
<li><strong>Registres</strong> : Rd = R1, Rn = R2</li>
<li><strong>Immédiat</strong> : #10</li>
</ul>
<h3 data-number="8.5.2" id="étape-2-déterminer-la-classe"><span
class="header-section-number">8.5.2</span> Étape 2 : Déterminer la
classe</h3>
<ul>
<li>Classe <code>001</code> car on utilise un immédiat</li>
</ul>
<h3 data-number="8.5.3" id="étape-3-assembler-les-bits"><span
class="header-section-number">8.5.3</span> Étape 3 : Assembler les
bits</h3>
<pre><code> 31-28  27-25  24-21  20   19-16  15-12  11-0
 Cond   Class   Op    S     Rn     Rd    Imm12
 1110   001    0011   0    0010   0001   000000001010

 = 0xE2821010</code></pre>
<hr />
<h2 data-number="8.6" id="la-gestion-des-grandes-constantes"><span
class="header-section-number">8.6</span> La Gestion des Grandes
Constantes</h2>
<h3 data-number="8.6.1" id="le-problème-1"><span
class="header-section-number">8.6.1</span> Le problème</h3>
<p>Une instruction fait 32 bits. Un immédiat fait 12 bits maximum.
Comment charger <code>0xDEADBEEF</code> (32 bits) dans un registre ?</p>
<h3 data-number="8.6.2" id="la-solution-le-literal-pool"><span
class="header-section-number">8.6.2</span> La solution : Le Literal
Pool</h3>
<p>L’assembleur offre une syntaxe magique :
<code>LDR R0, =0xDEADBEEF</code></p>
<p>Ce n’est <strong>pas</strong> une vraie instruction LDR — c’est une
<strong>pseudo-instruction</strong> que l’assembleur transforme :</p>
<ol type="1">
<li>La valeur <code>0xDEADBEEF</code> est stockée dans le
<strong>literal pool</strong> (une zone de données après le code)</li>
<li>L’instruction est remplacée par <code>LDR R0, [PC, #offset]</code>
qui va chercher la valeur</li>
</ol>
<div class="sourceCode" id="cb83"><pre
class="sourceCode asm"><code class="sourceCode fasm"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co">; Code source</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>    LDR R0<span class="op">,</span> <span class="op">=</span><span class="bn">0xDEADBEEF</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a><span class="co">; Ce que l&#39;assembleur génère</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>    LDR R0<span class="op">,</span> <span class="op">[</span>PC<span class="op">,</span> <span class="op">#</span><span class="dv">8</span><span class="op">]</span>    <span class="co">; Va chercher la valeur 8 octets plus loin</span></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>    ...</span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a><span class="fu">literal_pool:</span></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a>    .<span class="dt">word</span> <span class="bn">0xDEADBEEF</span>    <span class="co">; La valeur est stockée ici</span></span></code></pre></div>
<hr />
<h2 data-number="8.7" id="exercices-pratiques-5"><span
class="header-section-number">8.7</span> Exercices Pratiques</h2>
<h3 data-number="8.7.1" id="exercices-sur-le-simulateur-web-5"><span
class="header-section-number">8.7.1</span> Exercices sur le Simulateur
Web</h3>
<p>Tous les exercices de la section <strong>A32 Assembly</strong> du
simulateur web vous font pratiquer l’écriture d’assembleur. L’assembleur
intégré traduit votre code en binaire automatiquement.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Catégorie</th>
<th style="text-align: left;">Exercices</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Basique</td>
<td style="text-align: left;">Hello World, Addition, Soustraction,
Logique</td>
</tr>
<tr class="even">
<td style="text-align: left;">Contrôle</td>
<td style="text-align: left;">Conditions, Boucles, Multiplication,
Fibonacci</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mémoire</td>
<td style="text-align: left;">Tableaux, Maximum Tableau, Fonctions</td>
</tr>
<tr class="even">
<td style="text-align: left;">Graphique</td>
<td style="text-align: left;">Pixel, Ligne, Rectangle, Damier</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Avancé</td>
<td style="text-align: left;">Recherche Dichotomique, Dégradé</td>
</tr>
</tbody>
</table>
<h3 data-number="8.7.2" id="exercice-manuel-encodage"><span
class="header-section-number">8.7.2</span> Exercice manuel :
Encodage</h3>
<p>Traduisez ces instructions en binaire (32 bits) :</p>
<ol type="1">
<li><code>MOV R0, #5</code></li>
<li><code>SUB R1, R1, #1</code></li>
<li><code>B -2</code> (saut de 2 instructions en arrière)</li>
</ol>
<h3 data-number="8.7.3" id="exercice-table-des-symboles"><span
class="header-section-number">8.7.3</span> Exercice : Table des
symboles</h3>
<p>Calculez l’adresse de chaque label :</p>
<div class="sourceCode" id="cb84"><pre
class="sourceCode asm"><code class="sourceCode fasm"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>.text</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">start:</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">0</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="fu">loop:</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">CMP</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">10</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>    BEQ end</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R0<span class="op">,</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">1</span></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>    B loop</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a><span class="fu">end:</span></span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>    HALT</span></code></pre></div>
<h3 data-number="8.7.4" id="utilisation-de-loutil-cli"><span
class="header-section-number">8.7.4</span> Utilisation de l’outil
CLI</h3>
<div class="sourceCode" id="cb85"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Assembler un fichier</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> run <span class="at">-p</span> a32_cli <span class="at">--</span> assemble mon_prog.s <span class="at">-o</span> mon_prog.bin</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Examiner le binaire généré</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hexdump</span> <span class="at">-C</span> mon_prog.bin</span></code></pre></div>
<hr />
<h2 data-number="8.8" id="ce-quil-faut-retenir-5"><span
class="header-section-number">8.8</span> Ce qu’il faut retenir</h2>
<ol type="1">
<li><p><strong>L’assembleur traduit</strong> : Texte lisible → Binaire
exécutable</p></li>
<li><p><strong>Deux passes</strong> : D’abord collecter les symboles,
puis générer le code</p></li>
<li><p><strong>Les directives organisent</strong> : <code>.text</code>,
<code>.data</code>, <code>.word</code>, <code>.asciz</code></p></li>
<li><p><strong>Le literal pool résout</strong> : Les constantes 32 bits
via <code>LDR R0, =value</code></p></li>
<li><p><strong>Un symbole = une adresse</strong> : Les labels deviennent
des nombres</p></li>
</ol>
<p><strong>Prochaine étape</strong> : Au Chapitre 7, nous construirons
un <strong>Compilateur</strong> qui traduit du code C32 en assembleur.
C’est l’étape suivante vers l’abstraction !</p>
<hr />
<p><strong>Conseil</strong> : Faites beaucoup d’exercices en assembleur.
Plus vous serez à l’aise avec l’assembleur, mieux vous comprendrez ce
que fait le compilateur.</p>
<hr />
<h2 data-number="8.9" id="auto-évaluation-5"><span
class="header-section-number">8.9</span> Auto-évaluation</h2>
<p>Testez votre compréhension avant de passer au chapitre suivant.</p>
<h3 data-number="8.9.1" id="questions-de-compréhension-5"><span
class="header-section-number">8.9.1</span> Questions de
compréhension</h3>
<p><strong>Q1.</strong> Pourquoi l’assembleur fait-il deux passes sur le
code source ?</p>
<p><strong>Q2.</strong> Quelle est la différence entre
<code>.text</code> et <code>.data</code> ?</p>
<p><strong>Q3.</strong> Comment l’assembleur gère-t-il
<code>LDR R0, =0xDEADBEEF</code> ?</p>
<p><strong>Q4.</strong> Que se passe-t-il si un branchement est trop
loin (offset &gt; 24 bits) ?</p>
<p><strong>Q5.</strong> Qu’est-ce qu’un fichier binaire A32B contient
exactement ?</p>
<h3 data-number="8.9.2" id="mini-défi-pratique-5"><span
class="header-section-number">8.9.2</span> Mini-défi pratique</h3>
<p>Encodez manuellement cette instruction en binaire 32 bits :</p>
<div class="sourceCode" id="cb86"><pre
class="sourceCode asm"><code class="sourceCode fasm"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="bu">ADD</span> R1<span class="op">,</span> R2<span class="op">,</span> R3</span></code></pre></div>
<p>Indice : Format ALU registre =
<code>[cond:4][000][opcode:4][S][Rn:4][Rd:4][00000000][Rm:4]</code></p>
<p><em>Les solutions se trouvent dans le document
<strong>Codex_Solutions</strong>.</em></p>
<h3 data-number="8.9.3" id="checklist-de-validation-5"><span
class="header-section-number">8.9.3</span> Checklist de validation</h3>
<p>Avant de passer au chapitre 7, assurez-vous de pouvoir :</p>
<ul class="task-list">
<li><label><input type="checkbox" />Expliquer le rôle des deux passes de
l’assembleur</label></li>
<li><label><input type="checkbox" />Utiliser les directives
<code>.text</code>, <code>.data</code>, <code>.word</code>,
<code>.asciz</code></label></li>
<li><label><input type="checkbox" />Comprendre le fonctionnement du
literal pool</label></li>
<li><label><input type="checkbox" />Encoder une instruction simple à la
main (format binaire)</label></li>
<li><label><input type="checkbox" />Lire et interpréter un hexdump de
fichier binaire</label></li>
</ul>
<h1 data-number="9" id="construction-du-compilateur"><span
class="header-section-number">9</span> Construction du Compilateur</h1>
<blockquote>
<p>“Pour comprendre la récursivité, il faut d’abord comprendre la
récursivité.”</p>
</blockquote>
<p>Dans ce chapitre, nous allons construire le <strong>pont</strong>
entre le langage de haut niveau (C32) et l’assembleur (A32). Le
compilateur est l’outil qui permet aux humains d’écrire du code lisible
tout en profitant de la vitesse du code machine.</p>
<hr />
<h2 data-number="9.1" id="où-en-sommes-nous-6"><span
class="header-section-number">9.1</span> Où en sommes-nous ?</h2>
<figure>
<img src="images/architecture-stack.svg"
alt="Position dans l’architecture" />
<figcaption aria-hidden="true">Position dans l’architecture</figcaption>
</figure>
<p><em>Nous sommes à la Couche 4 : Compilateur - Transforme C32 en
Assembleur A32</em></p>
<p>Le compilateur est le <strong>traducteur automatique</strong> qui
transforme du code lisible par les humains en code exécutable par la
machine.</p>
<hr />
<h2 data-number="9.2" id="le-rôle-du-compilateur"><span
class="header-section-number">9.2</span> Le Rôle du Compilateur</h2>
<h3 data-number="9.2.1" id="pourquoi-un-compilateur"><span
class="header-section-number">9.2.1</span> Pourquoi un compilateur
?</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Assembleur</th>
<th style="text-align: left;">C32 (haut niveau)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>ADD R0, R0, #1</code></td>
<td style="text-align: left;"><code>x = x + 1;</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Gestion manuelle des registres</td>
<td style="text-align: left;">Variables nommées</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sauts et labels</td>
<td style="text-align: left;"><code>if</code>, <code>while</code>,
<code>for</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Appels manuels avec conventions</td>
<td style="text-align: left;"><code>return fonction();</code></td>
</tr>
</tbody>
</table>
<p>Le compilateur traduit le second en premier, automatiquement.</p>
<h3 data-number="9.2.2" id="les-étapes-de-compilation"><span
class="header-section-number">9.2.2</span> Les étapes de
compilation</h3>
<pre><code>Code C32          Analyse           Génération
  (texte)    →    (AST)      →     Assembleur
                                       │
                                       ▼
                                    Binaire</code></pre>
<ol type="1">
<li><strong>Analyse lexicale</strong> : Découpe le texte en tokens
(<code>int</code>, <code>x</code>, <code>=</code>, <code>5</code>,
<code>;</code>)</li>
<li><strong>Analyse syntaxique</strong> : Construit un arbre (AST)
représentant la structure</li>
<li><strong>Analyse sémantique</strong> : Vérifie les types, les
portées, etc.</li>
<li><strong>Génération de code</strong> : Produit l’assembleur
équivalent</li>
</ol>
<hr />
<h2 data-number="9.3" id="les-phases-du-compilateur"><span
class="header-section-number">9.3</span> Les Phases du Compilateur</h2>
<h3 data-number="9.3.1" id="phase-1-lexer-analyse-lexicale"><span
class="header-section-number">9.3.1</span> Phase 1 : Lexer (Analyse
Lexicale)</h3>
<p>Le lexer transforme le flux de caractères en tokens :</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> x <span class="op">=</span> <span class="dv">5</span><span class="op">;</span></span></code></pre></div>
<p>Devient :</p>
<pre><code>[INT] [ID:&quot;x&quot;] [EQUAL] [NUMBER:5] [SEMICOLON]</code></pre>
<h3 data-number="9.3.2" id="phase-2-parser-analyse-syntaxique"><span
class="header-section-number">9.3.2</span> Phase 2 : Parser (Analyse
Syntaxique)</h3>
<p>Le parser construit un <strong>AST</strong> (Abstract Syntax Tree)
:</p>
<pre><code>           Declaration
              /    \
           Type    Assignment
            |        /    \
          &quot;int&quot;  &quot;x&quot;    Number
                         |
                         5</code></pre>
<h3 data-number="9.3.3" id="phase-3-génération-de-code"><span
class="header-section-number">9.3.3</span> Phase 3 : Génération de
Code</h3>
<p>Le générateur parcourt l’AST et produit l’assembleur :</p>
<div class="sourceCode" id="cb91"><pre
class="sourceCode asm"><code class="sourceCode fasm"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co">; int x = 5;</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="bu">MOV</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">5</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="bu">STR</span> R0<span class="op">,</span> <span class="op">[</span><span class="kw">SP</span><span class="op">,</span> <span class="op">#-</span><span class="dv">4</span><span class="op">]!</span>   <span class="co">; Push x sur la pile</span></span></code></pre></div>
<hr />
<h2 data-number="9.4" id="compilation-des-structures-de-contrôle"><span
class="header-section-number">9.4</span> Compilation des Structures de
Contrôle</h2>
<h3 data-number="9.4.1" id="variables-locales"><span
class="header-section-number">9.4.1</span> Variables locales</h3>
<p>Les variables locales vivent sur la <strong>pile</strong> :</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> a <span class="op">=</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> b <span class="op">=</span> <span class="dv">20</span><span class="op">;</span></span></code></pre></div>
<div class="sourceCode" id="cb93"><pre
class="sourceCode asm"><code class="sourceCode fasm"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co">; Prologue</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="bu">SUB</span> <span class="kw">SP</span><span class="op">,</span> <span class="kw">SP</span><span class="op">,</span> <span class="op">#</span><span class="dv">8</span>       <span class="co">; Réserve 8 octets pour a et b</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="co">; a = 10</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a><span class="bu">MOV</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">10</span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a><span class="bu">STR</span> R0<span class="op">,</span> <span class="op">[</span><span class="kw">SP</span><span class="op">,</span> <span class="op">#</span><span class="dv">4</span><span class="op">]</span>     <span class="co">; a est à SP+4</span></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a><span class="co">; b = 20</span></span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a><span class="bu">MOV</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">20</span></span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a><span class="bu">STR</span> R0<span class="op">,</span> <span class="op">[</span><span class="kw">SP</span><span class="op">,</span> <span class="op">#</span><span class="dv">0</span><span class="op">]</span>     <span class="co">; b est à SP+0</span></span></code></pre></div>
<h3 data-number="9.4.2" id="expressions"><span
class="header-section-number">9.4.2</span> Expressions</h3>
<p>Pour <code>a + b * 2</code> :</p>
<div class="sourceCode" id="cb94"><pre
class="sourceCode asm"><code class="sourceCode fasm"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co">; Évaluation de b * 2</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>LDR R0<span class="op">,</span> <span class="op">[</span><span class="kw">SP</span><span class="op">,</span> <span class="op">#</span><span class="dv">0</span><span class="op">]</span>     <span class="co">; R0 = b</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a><span class="bu">MOV</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">2</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="bu">MUL</span> R0<span class="op">,</span> R0<span class="op">,</span> R1       <span class="co">; R0 = b * 2</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a><span class="co">; Évaluation de a + (b * 2)</span></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>LDR R1<span class="op">,</span> <span class="op">[</span><span class="kw">SP</span><span class="op">,</span> <span class="op">#</span><span class="dv">4</span><span class="op">]</span>     <span class="co">; R1 = a</span></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a><span class="bu">ADD</span> R0<span class="op">,</span> R1<span class="op">,</span> R0       <span class="co">; R0 = a + b*2</span></span></code></pre></div>
<h3 data-number="9.4.3" id="if-else"><span
class="header-section-number">9.4.3</span> If / Else</h3>
<div class="sourceCode" id="cb95"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span>x <span class="op">&gt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>    y <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb96"><pre
class="sourceCode asm"><code class="sourceCode fasm"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>    LDR R0<span class="op">,</span> <span class="op">[</span><span class="kw">SP</span><span class="op">,</span> <span class="op">#</span>x_offset<span class="op">]</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">CMP</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">0</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>    BLE else_label</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Then branch</span></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">1</span></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">STR</span> R0<span class="op">,</span> <span class="op">[</span><span class="kw">SP</span><span class="op">,</span> <span class="op">#</span>y_offset<span class="op">]</span></span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>    B endif_label</span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a><span class="fu">else_label:</span></span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Else branch</span></span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">0</span></span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">STR</span> R0<span class="op">,</span> <span class="op">[</span><span class="kw">SP</span><span class="op">,</span> <span class="op">#</span>y_offset<span class="op">]</span></span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a><span class="fu">endif_label:</span></span></code></pre></div>
<h3 data-number="9.4.4" id="boucle-while"><span
class="header-section-number">9.4.4</span> Boucle While</h3>
<div class="sourceCode" id="cb97"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="op">(</span>i <span class="op">&lt;</span> <span class="dv">10</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>    i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb98"><pre
class="sourceCode asm"><code class="sourceCode fasm"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">while_start:</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>    LDR R0<span class="op">,</span> <span class="op">[</span><span class="kw">SP</span><span class="op">,</span> <span class="op">#</span>i_offset<span class="op">]</span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">CMP</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">10</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>    BGE while_end</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Corps de la boucle</span></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R0<span class="op">,</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">1</span></span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">STR</span> R0<span class="op">,</span> <span class="op">[</span><span class="kw">SP</span><span class="op">,</span> <span class="op">#</span>i_offset<span class="op">]</span></span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a>    B while_start</span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a><span class="fu">while_end:</span></span></code></pre></div>
<h3 data-number="9.4.5" id="boucle-for"><span
class="header-section-number">9.4.5</span> Boucle For</h3>
<p><code>for (init; cond; incr) { body }</code> est équivalent à :</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>init<span class="op">;</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="op">(</span>cond<span class="op">)</span> <span class="op">{</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>    body<span class="op">;</span></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>    incr<span class="op">;</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h2 data-number="9.5" id="compilation-des-fonctions"><span
class="header-section-number">9.5</span> Compilation des Fonctions</h2>
<h3 data-number="9.5.1" id="convention-dappel"><span
class="header-section-number">9.5.1</span> Convention d’appel</h3>
<p>Comment passe-t-on les arguments ? Comment retourne-t-on une valeur
?</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Registre</th>
<th style="text-align: left;">Rôle</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">R0-R3</td>
<td style="text-align: left;">Arguments 1-4, valeur de retour en R0</td>
</tr>
<tr class="even">
<td style="text-align: left;">R4-R11</td>
<td style="text-align: left;">Sauvegardés par l’appelé
(callee-saved)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">R13 (SP)</td>
<td style="text-align: left;">Pointeur de pile</td>
</tr>
<tr class="even">
<td style="text-align: left;">R14 (LR)</td>
<td style="text-align: left;">Adresse de retour</td>
</tr>
</tbody>
</table>
<h3 data-number="9.5.2" id="prologue-et-épilogue"><span
class="header-section-number">9.5.2</span> Prologue et Épilogue</h3>
<div class="sourceCode" id="cb100"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> add<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> a <span class="op">+</span> b<span class="op">;</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<div class="sourceCode" id="cb101"><pre
class="sourceCode asm"><code class="sourceCode fasm"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">add:</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Prologue</span></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">SUB</span> <span class="kw">SP</span><span class="op">,</span> <span class="kw">SP</span><span class="op">,</span> <span class="op">#</span><span class="dv">4</span>       <span class="co">; Place pour LR</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">STR</span> LR<span class="op">,</span> <span class="op">[</span><span class="kw">SP</span><span class="op">]</span>         <span class="co">; Sauvegarde LR</span></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Corps : a est dans R0, b dans R1</span></span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R0<span class="op">,</span> R0<span class="op">,</span> R1       <span class="co">; Résultat dans R0</span></span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">; Épilogue</span></span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a>    LDR LR<span class="op">,</span> <span class="op">[</span><span class="kw">SP</span><span class="op">]</span>         <span class="co">; Restaure LR</span></span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> <span class="kw">SP</span><span class="op">,</span> <span class="kw">SP</span><span class="op">,</span> <span class="op">#</span><span class="dv">4</span></span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> PC<span class="op">,</span> LR           <span class="co">; Retour</span></span></code></pre></div>
<h3 data-number="9.5.3" id="appel-de-fonction"><span
class="header-section-number">9.5.3</span> Appel de fonction</h3>
<div class="sourceCode" id="cb102"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> add<span class="op">(</span><span class="dv">5</span><span class="op">,</span> <span class="dv">3</span><span class="op">);</span></span></code></pre></div>
<div class="sourceCode" id="cb103"><pre
class="sourceCode asm"><code class="sourceCode fasm"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">5</span>           <span class="co">; Premier argument</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">3</span>           <span class="co">; Deuxième argument</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>    BL add               <span class="co">; Appel (sauve PC+4 dans LR)</span></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">STR</span> R0<span class="op">,</span> <span class="op">[</span><span class="kw">SP</span><span class="op">,</span> <span class="op">#</span>result_offset<span class="op">]</span>  <span class="co">; Sauve le résultat</span></span></code></pre></div>
<hr />
<h2 data-number="9.6" id="le-compilateur-c32"><span
class="header-section-number">9.6</span> Le Compilateur C32</h2>
<p>Le compilateur C32 du projet Codex (<code>c32_cli</code>) implémente
toutes ces transformations.</p>
<h3 data-number="9.6.1" id="utilisation"><span
class="header-section-number">9.6.1</span> Utilisation</h3>
<div class="sourceCode" id="cb104"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compiler un fichier C32 en assembleur</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> run <span class="at">-p</span> c32_cli <span class="at">--</span> mon_fichier.c <span class="at">-o</span> mon_fichier.s</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Compiler directement en binaire</span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> run <span class="at">-p</span> c32_cli <span class="at">--</span> mon_fichier.c <span class="at">-o</span> mon_fichier.bin</span></code></pre></div>
<h3 data-number="9.6.2" id="exemple-complet"><span
class="header-section-number">9.6.2</span> Exemple complet</h3>
<div class="sourceCode" id="cb105"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co">// fibonacci.c</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> fib<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">&lt;=</span> <span class="dv">1</span><span class="op">)</span> <span class="cf">return</span> n<span class="op">;</span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> fib<span class="op">(</span>n<span class="op">-</span><span class="dv">1</span><span class="op">)</span> <span class="op">+</span> fib<span class="op">(</span>n<span class="op">-</span><span class="dv">2</span><span class="op">);</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> fib<span class="op">(</span><span class="dv">10</span><span class="op">);</span></span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>Produit de l’assembleur avec : - Gestion automatique de la pile -
Appels récursifs - Sauvegarde/restauration des registres</p>
<hr />
<h2 data-number="9.7" id="construisez-votre-propre-compilateur"><span
class="header-section-number">9.7</span> Construisez Votre Propre
Compilateur !</h2>
<p>Le simulateur web contient une section <strong>Compilateur:
Construction</strong> avec <strong>18 exercices progressifs</strong>
organisés en 7 phases. Vous construirez un mini-compilateur qui génère
du vrai code assembleur A32.</p>
<h3 data-number="9.7.1" id="phase-1-lexer-analyse-lexicale-1"><span
class="header-section-number">9.7.1</span> Phase 1 : Lexer (Analyse
Lexicale)</h3>
<p>Le lexer transforme le texte en tokens.</p>
<table>
<colgroup>
<col style="width: 43%" />
<col style="width: 56%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1.1 Reconnaître un Chiffre</td>
<td style="text-align: left;">Implémenter <code>is_digit(c)</code> pour
détecter ‘0’-‘9’</td>
</tr>
<tr class="even">
<td style="text-align: left;">1.2 Lire un Nombre</td>
<td style="text-align: left;">Parser un entier depuis une chaîne</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1.3 Compter les Tokens</td>
<td style="text-align: left;">Compter les tokens dans
<code>"12 + 34 * 5"</code></td>
</tr>
</tbody>
</table>
<h3 data-number="9.7.2" id="phase-2-parser-analyse-syntaxique-1"><span
class="header-section-number">9.7.2</span> Phase 2 : Parser (Analyse
Syntaxique)</h3>
<p>Le parser construit une représentation structurée et évalue les
expressions.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2.1 Précédence des Opérateurs</td>
<td style="text-align: left;">Déterminer la priorité (<code>*</code>
&gt; <code>+</code>)</td>
</tr>
<tr class="even">
<td style="text-align: left;">2.2 Évaluer une Opération</td>
<td style="text-align: left;">Évaluer <code>3 + 4</code> ou
<code>6 * 7</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">2.3 Parser avec Précédence</td>
<td style="text-align: left;">Descente récursive pour
<code>2 + 3 * 4</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">2.4 Parenthèses</td>
<td style="text-align: left;">Supporter <code>(2 + 3) * 4</code></td>
</tr>
</tbody>
</table>
<h3 data-number="9.7.3"
id="phase-3-émission-asm-génération-de-code"><span
class="header-section-number">9.7.3</span> Phase 3 : Émission ASM
(Génération de Code)</h3>
<p>Générer des instructions A32 sous forme de chaînes.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">3.1 Générer MOV</td>
<td style="text-align: left;">Produire <code>"MOV R0, #42"</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">3.2 Opération Binaire</td>
<td style="text-align: left;">Mapper <code>+</code> → <code>ADD</code>,
<code>*</code> → <code>MUL</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">3.3 Comparaison</td>
<td style="text-align: left;">Générer <code>CMP</code> et codes de
condition</td>
</tr>
</tbody>
</table>
<h3 data-number="9.7.4" id="phase-4-codegen-expressions"><span
class="header-section-number">9.7.4</span> Phase 4 : CodeGen
Expressions</h3>
<p>Générer du code A32 complet pour des expressions.</p>
<table>
<colgroup>
<col style="width: 43%" />
<col style="width: 56%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">4.1 Constante → A32</td>
<td style="text-align: left;">Générer code pour charger une
constante</td>
</tr>
<tr class="even">
<td style="text-align: left;">4.2 Addition → A32</td>
<td style="text-align: left;"><code>a + b</code> →
<code>MOV R0, #a / MOV R1, #b / ADD R0, R0, R1</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">4.3 Expression → A32</td>
<td style="text-align: left;">Expression complète avec précédence</td>
</tr>
</tbody>
</table>
<h3 data-number="9.7.5" id="phase-5-structures-de-contrôle"><span
class="header-section-number">9.7.5</span> Phase 5 : Structures de
Contrôle</h3>
<p>Générer du code pour <code>if/else</code> et <code>while</code>.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">5.1 If/Else → A32</td>
<td style="text-align: left;">Générer les sauts conditionnels et
labels</td>
</tr>
<tr class="even">
<td style="text-align: left;">5.2 While → A32</td>
<td style="text-align: left;">Générer les boucles avec labels</td>
</tr>
</tbody>
</table>
<h3 data-number="9.7.6" id="phase-6-fonctions"><span
class="header-section-number">9.7.6</span> Phase 6 : Fonctions</h3>
<p>Gérer les appels de fonction et la pile.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">6.1 Prologue/Épilogue</td>
<td style="text-align: left;">Sauvegarder LR, réserver la pile</td>
</tr>
<tr class="even">
<td style="text-align: left;">6.2 Appel de Fonction</td>
<td style="text-align: left;">Passer les arguments, appeler avec BL</td>
</tr>
</tbody>
</table>
<h3 data-number="9.7.7" id="phase-7-projet-final"><span
class="header-section-number">9.7.7</span> Phase 7 : Projet Final</h3>
<table>
<colgroup>
<col style="width: 43%" />
<col style="width: 56%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">7.1 Mini-Compilateur Complet</td>
<td style="text-align: left;">Compiler une expression en A32
exécutable</td>
</tr>
</tbody>
</table>
<p>Le projet final combine toutes les phases : lexer → parser → codegen
pour produire du code assembleur A32 fonctionnel.</p>
<h3 data-number="9.7.8" id="techniques-clés"><span
class="header-section-number">9.7.8</span> Techniques Clés</h3>
<p>Ces exercices utilisent la technique de <strong>descente
récursive</strong> :</p>
<ul>
<li><code>parse_expr()</code> gère <code>+</code> et <code>-</code>
(basse priorité)</li>
<li><code>parse_term()</code> gère <code>*</code> et <code>/</code>
(haute priorité)</li>
<li><code>parse_factor()</code> gère les nombres et les parenthèses</li>
</ul>
<hr />
<h2 data-number="9.8" id="exercices-pratiques-6"><span
class="header-section-number">9.8</span> Exercices Pratiques</h2>
<h3 data-number="9.8.1" id="exercices-sur-le-simulateur-web-6"><span
class="header-section-number">9.8.1</span> Exercices sur le Simulateur
Web</h3>
<p>La section <strong>C32</strong> du simulateur web vous permet de
compiler et exécuter du C32.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Catégorie</th>
<th style="text-align: left;">Exercices</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Bases</td>
<td style="text-align: left;">Variables, Expressions, Modulo,
Incrémentation</td>
</tr>
<tr class="even">
<td style="text-align: left;">Contrôle</td>
<td style="text-align: left;">Conditions, Else-If, Maximum de 3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Boucles</td>
<td style="text-align: left;">For, While, Imbriquées,
Multiplication</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fonctions</td>
<td style="text-align: left;">Appels, Paramètres, Valeur Absolue,
Min/Max</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Tableaux</td>
<td style="text-align: left;">Accès, Maximum, Comptage</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pointeurs</td>
<td style="text-align: left;">Adresses, Swap, Tableaux via
pointeurs</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Récursion</td>
<td style="text-align: left;">Factorielle, Fibonacci, PGCD</td>
</tr>
<tr class="even">
<td style="text-align: left;">Algorithmes</td>
<td style="text-align: left;">Tri à Bulles, Recherche Binaire</td>
</tr>
</tbody>
</table>
<h3 data-number="9.8.2" id="exercice-traduire-manuellement"><span
class="header-section-number">9.8.2</span> Exercice : Traduire
manuellement</h3>
<p>Traduisez ce code C32 en assembleur à la main :</p>
<div class="sourceCode" id="cb106"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> sum <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> i <span class="op">&lt;=</span> <span class="dv">10</span><span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>    sum <span class="op">=</span> sum <span class="op">+</span> i<span class="op">;</span></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>Comparez avec la sortie du compilateur !</p>
<hr />
<h2 data-number="9.9" id="ce-quil-faut-retenir-6"><span
class="header-section-number">9.9</span> Ce qu’il faut retenir</h2>
<ol type="1">
<li><p><strong>Le compilateur traduit</strong> : C32 (lisible) →
Assembleur (exécutable)</p></li>
<li><p><strong>Trois phases</strong> : Lexer → Parser → Générateur de
code</p></li>
<li><p><strong>Les variables locales vivent sur la pile</strong> : Accès
via <code>[SP, #offset]</code></p></li>
<li><p><strong>Les structures de contrôle deviennent des sauts</strong>
: <code>if</code> → <code>CMP</code> + <code>B</code></p></li>
<li><p><strong>Les fonctions suivent une convention</strong> : Arguments
en R0-R3, retour en R0</p></li>
</ol>
<p><strong>Prochaine étape</strong> : Au Chapitre 8, nous explorerons le
langage C32 en détail — sa syntaxe, ses types, et ses possibilités.</p>
<hr />
<p><strong>Conseil</strong> : Pour vraiment comprendre le compilateur,
écrivez du C32 et regardez l’assembleur généré. Cherchez à prédire ce
que le compilateur va produire !</p>
<hr />
<h2 data-number="9.10" id="auto-évaluation-6"><span
class="header-section-number">9.10</span> Auto-évaluation</h2>
<p>Testez votre compréhension avant de passer au chapitre suivant.</p>
<h3 data-number="9.10.1" id="questions-de-compréhension-6"><span
class="header-section-number">9.10.1</span> Questions de
compréhension</h3>
<p><strong>Q1.</strong> Quelles sont les trois phases principales d’un
compilateur ?</p>
<p><strong>Q2.</strong> Comment le compilateur gère-t-il les variables
locales ?</p>
<p><strong>Q3.</strong> Comment un <code>if-else</code> est-il traduit
en assembleur ?</p>
<p><strong>Q4.</strong> Quelle est la convention d’appel pour les
arguments de fonction ?</p>
<p><strong>Q5.</strong> Pourquoi le compilateur génère-t-il un prologue
et un épilogue pour chaque fonction ?</p>
<h3 data-number="9.10.2" id="mini-défi-pratique-6"><span
class="header-section-number">9.10.2</span> Mini-défi pratique</h3>
<p>Prédisez l’assembleur généré pour ce code C32 :</p>
<div class="sourceCode" id="cb107"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> double_it<span class="op">(</span><span class="dt">int</span> x<span class="op">)</span> <span class="op">{</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x <span class="op">+</span> x<span class="op">;</span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><em>Les solutions se trouvent dans le document
<strong>Codex_Solutions</strong>.</em></p>
<h3 data-number="9.10.3" id="checklist-de-validation-6"><span
class="header-section-number">9.10.3</span> Checklist de validation</h3>
<p>Avant de passer au chapitre 8, assurez-vous de pouvoir :</p>
<ul class="task-list">
<li><label><input type="checkbox" />Décrire le rôle du lexer, parser, et
codegen</label></li>
<li><label><input type="checkbox" />Expliquer comment les variables
locales sont stockées</label></li>
<li><label><input type="checkbox" />Traduire un <code>if-else</code>
simple en assembleur</label></li>
<li><label><input type="checkbox" />Connaître la convention d’appel
(R0-R3, pile, LR)</label></li>
<li><label><input type="checkbox" />Comprendre le prologue/épilogue
d’une fonction</label></li>
</ul>
<h1 data-number="10" id="langage-de-haut-niveau-c32"><span
class="header-section-number">10</span> Langage de Haut Niveau
(C32)</h1>
<blockquote>
<p>“Le logiciel est l’esprit qui anime la machine.”</p>
</blockquote>
<p>Jusqu’à présent, nous avons construit le matériel et appris à lui
parler en assembleur. Mais écrire des applications complexes en
assembleur est laborieux. C’est ici qu’intervient le
<strong>C32</strong> — un langage de haut niveau qui vous permet de vous
concentrer sur la <strong>logique</strong> de votre programme.</p>
<hr />
<h2 data-number="10.1" id="où-en-sommes-nous-7"><span
class="header-section-number">10.1</span> Où en sommes-nous ?</h2>
<figure>
<img src="images/architecture-stack.svg"
alt="Position dans l’architecture" />
<figcaption aria-hidden="true">Position dans l’architecture</figcaption>
</figure>
<p><em>Nous sommes à la Couche 5 : Langage de Haut Niveau (C32) -
Variables, fonctions, boucles</em></p>
<p>Le C32 est un sous-ensemble du langage C. Si vous connaissez le C, le
Java ou le C++, vous vous sentirez chez vous.</p>
<hr />
<h2 data-number="10.2" id="pourquoi-un-langage-de-haut-niveau"><span
class="header-section-number">10.2</span> Pourquoi un Langage de Haut
Niveau ?</h2>
<h3 data-number="10.2.1" id="le-problème-de-lassembleur"><span
class="header-section-number">10.2.1</span> Le problème de
l’assembleur</h3>
<pre><code>Assembleur                           C32
───────────                          ───
MOV R0, #0                          int sum = 0;
MOV R1, #1                          for (int i = 1; i &lt;= 10; i = i + 1) {
loop:                                   sum = sum + i;
  CMP R1, #10                       }
  BGT done
  ADD R0, R0, R1
  ADD R1, R1, #1
  B loop
done:</code></pre>
<p>Le C32 est : - <strong>Plus lisible</strong> : Variables nommées,
structures de contrôle - <strong>Plus maintenable</strong> : Moins de
code, moins de bugs - <strong>Portable</strong> : Le même code peut
cibler différentes architectures</p>
<h3 data-number="10.2.2" id="labstraction"><span
class="header-section-number">10.2.2</span> L’abstraction</h3>
<pre><code>[ Pensée Humaine ]  →  &quot;Calculer la moyenne&quot;
        ↓
[ Langage C32 ]     →  sum = sum + tab[i];
        ↓
[ Assembleur A32 ]  →  LDR R0, [R1, R2]; ADD R3, R3, R0...
        ↓
[ Code Machine ]    →  0xE0833000...</code></pre>
<hr />
<h2 data-number="10.3" id="spécification-du-langage-c32"><span
class="header-section-number">10.3</span> Spécification du Langage
C32</h2>
<h3 data-number="10.3.1" id="les-types-de-données"><span
class="header-section-number">10.3.1</span> Les Types de Données</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Taille</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>int</code></td>
<td style="text-align: left;">32 bits</td>
<td style="text-align: left;">Entier signé (complément à 2)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>uint</code></td>
<td style="text-align: left;">32 bits</td>
<td style="text-align: left;">Entier non-signé</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>char</code></td>
<td style="text-align: left;">8 bits</td>
<td style="text-align: left;">Caractère ASCII</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>bool</code></td>
<td style="text-align: left;">1 bit</td>
<td style="text-align: left;"><code>true</code> ou
<code>false</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>void</code></td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">Pour les fonctions sans retour</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>type*</code></td>
<td style="text-align: left;">32 bits</td>
<td style="text-align: left;">Pointeur (adresse mémoire)</td>
</tr>
</tbody>
</table>
<h3 data-number="10.3.2" id="variables"><span
class="header-section-number">10.3.2</span> Variables</h3>
<div class="sourceCode" id="cb110"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> x <span class="op">=</span> <span class="dv">42</span><span class="op">;</span>           <span class="co">// Variable globale ou locale</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> tab<span class="op">[</span><span class="dv">10</span><span class="op">];</span>          <span class="co">// Tableau de 10 entiers</span></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span><span class="op">*</span> p <span class="op">=</span> <span class="op">&amp;</span>x<span class="op">;</span>          <span class="co">// Pointeur vers x</span></span></code></pre></div>
<h3 data-number="10.3.3" id="portée-des-variables"><span
class="header-section-number">10.3.3</span> Portée des variables</h3>
<ul>
<li><strong>Globales</strong> : Déclarées hors des fonctions,
accessibles partout</li>
<li><strong>Locales</strong> : Déclarées dans une fonction, vivent sur
la pile</li>
</ul>
<hr />
<h2 data-number="10.4" id="opérateurs"><span
class="header-section-number">10.4</span> Opérateurs</h2>
<h3 data-number="10.4.1" id="arithmétiques"><span
class="header-section-number">10.4.1</span> Arithmétiques</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Opérateur</th>
<th style="text-align: left;">Signification</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>+</code></td>
<td style="text-align: left;">Addition</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>-</code></td>
<td style="text-align: left;">Soustraction</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>*</code></td>
<td style="text-align: left;">Multiplication</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>/</code></td>
<td style="text-align: left;">Division</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>%</code></td>
<td style="text-align: left;">Modulo (reste)</td>
</tr>
</tbody>
</table>
<h3 data-number="10.4.2" id="comparaison"><span
class="header-section-number">10.4.2</span> Comparaison</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Opérateur</th>
<th style="text-align: left;">Signification</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>==</code></td>
<td style="text-align: left;">Égal</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>!=</code></td>
<td style="text-align: left;">Différent</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>&lt;</code></td>
<td style="text-align: left;">Inférieur</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>&gt;</code></td>
<td style="text-align: left;">Supérieur</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>&lt;=</code></td>
<td style="text-align: left;">Inférieur ou égal</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>&gt;=</code></td>
<td style="text-align: left;">Supérieur ou égal</td>
</tr>
</tbody>
</table>
<h3 data-number="10.4.3" id="logiques"><span
class="header-section-number">10.4.3</span> Logiques</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Opérateur</th>
<th style="text-align: left;">Signification</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>&amp;&amp;</code></td>
<td style="text-align: left;">ET logique</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>\|\|</code></td>
<td style="text-align: left;">OU logique</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>!</code></td>
<td style="text-align: left;">NON logique</td>
</tr>
</tbody>
</table>
<h3 data-number="10.4.4" id="binaires"><span
class="header-section-number">10.4.4</span> Binaires</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Opérateur</th>
<th style="text-align: left;">Signification</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>&amp;</code></td>
<td style="text-align: left;">ET bit à bit</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>\|</code></td>
<td style="text-align: left;">OU bit à bit</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>^</code></td>
<td style="text-align: left;">XOR bit à bit</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>~</code></td>
<td style="text-align: left;">Inversion</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>&lt;&lt;</code></td>
<td style="text-align: left;">Décalage gauche</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>&gt;&gt;</code></td>
<td style="text-align: left;">Décalage droite</td>
</tr>
</tbody>
</table>
<hr />
<h2 data-number="10.5" id="structures-de-contrôle"><span
class="header-section-number">10.5</span> Structures de Contrôle</h2>
<h3 data-number="10.5.1" id="if-else-1"><span
class="header-section-number">10.5.1</span> If / Else</h3>
<div class="sourceCode" id="cb111"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span>score <span class="op">&gt;</span> <span class="dv">100</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>    win<span class="op">();</span></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>score <span class="op">&gt;</span> <span class="dv">50</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>    try_again<span class="op">();</span></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>    game_over<span class="op">();</span></span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 data-number="10.5.2" id="while"><span
class="header-section-number">10.5.2</span> While</h3>
<div class="sourceCode" id="cb112"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="op">(</span>x <span class="op">&lt;</span> <span class="dv">10</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> x <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 data-number="10.5.3" id="for"><span
class="header-section-number">10.5.3</span> For</h3>
<div class="sourceCode" id="cb113"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">10</span><span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>    sum <span class="op">=</span> sum <span class="op">+</span> i<span class="op">;</span></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 data-number="10.5.4" id="do-while"><span
class="header-section-number">10.5.4</span> Do-While</h3>
<div class="sourceCode" id="cb114"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="cf">do</span> <span class="op">{</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> x <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="cf">while</span> <span class="op">(</span>x <span class="op">&gt;</span> <span class="dv">0</span><span class="op">);</span></span></code></pre></div>
<hr />
<h2 data-number="10.6" id="fonctions"><span
class="header-section-number">10.6</span> Fonctions</h2>
<h3 data-number="10.6.1" id="définition"><span
class="header-section-number">10.6.1</span> Définition</h3>
<div class="sourceCode" id="cb115"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> add<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> a <span class="op">+</span> b<span class="op">;</span></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> greet<span class="op">()</span> <span class="op">{</span></span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a>    putchar<span class="op">(</span><span class="ch">&#39;H&#39;</span><span class="op">);</span></span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a>    putchar<span class="op">(</span><span class="ch">&#39;i&#39;</span><span class="op">);</span></span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 data-number="10.6.2" id="appel"><span
class="header-section-number">10.6.2</span> Appel</h3>
<div class="sourceCode" id="cb116"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> result <span class="op">=</span> add<span class="op">(</span><span class="dv">5</span><span class="op">,</span> <span class="dv">3</span><span class="op">);</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>greet<span class="op">();</span></span></code></pre></div>
<h3 data-number="10.6.3" id="récursion"><span
class="header-section-number">10.6.3</span> Récursion</h3>
<div class="sourceCode" id="cb117"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> factorial<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">&lt;=</span> <span class="dv">1</span><span class="op">)</span> <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> n <span class="op">*</span> factorial<span class="op">(</span>n <span class="op">-</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h2 data-number="10.7" id="pointeurs-et-tableaux"><span
class="header-section-number">10.7</span> Pointeurs et Tableaux</h2>
<h3 data-number="10.7.1" id="pointeurs"><span
class="header-section-number">10.7.1</span> Pointeurs</h3>
<p>Un pointeur contient une <strong>adresse mémoire</strong> :</p>
<div class="sourceCode" id="cb118"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> x <span class="op">=</span> <span class="dv">42</span><span class="op">;</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span><span class="op">*</span> p <span class="op">=</span> <span class="op">&amp;</span>x<span class="op">;</span>    <span class="co">// p contient l&#39;adresse de x</span></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a><span class="op">*</span>p <span class="op">=</span> <span class="dv">100</span><span class="op">;</span>       <span class="co">// x vaut maintenant 100</span></span></code></pre></div>
<h3 data-number="10.7.2" id="tableaux"><span
class="header-section-number">10.7.2</span> Tableaux</h3>
<p>Un tableau est une suite de valeurs consécutives en mémoire :</p>
<div class="sourceCode" id="cb119"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> scores<span class="op">[</span><span class="dv">5</span><span class="op">];</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>scores<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>scores<span class="op">[</span><span class="dv">4</span><span class="op">]</span> <span class="op">=</span> <span class="dv">50</span><span class="op">;</span></span></code></pre></div>
<h3 data-number="10.7.3" id="lien-entre-pointeurs-et-tableaux"><span
class="header-section-number">10.7.3</span> Lien entre pointeurs et
tableaux</h3>
<div class="sourceCode" id="cb120"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> tab<span class="op">[</span><span class="dv">10</span><span class="op">];</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span><span class="op">*</span> p <span class="op">=</span> tab<span class="op">;</span>      <span class="co">// Équivalent à &amp;tab[0]</span></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>p<span class="op">[</span><span class="dv">3</span><span class="op">]</span> <span class="op">=</span> <span class="dv">42</span><span class="op">;</span>         <span class="co">// Équivalent à tab[3] = 42</span></span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a><span class="op">*(</span>p <span class="op">+</span> <span class="dv">3</span><span class="op">)</span> <span class="op">=</span> <span class="dv">42</span><span class="op">;</span>     <span class="co">// Même chose !</span></span></code></pre></div>
<hr />
<h2 data-number="10.8" id="accès-au-matériel-mmio"><span
class="header-section-number">10.8</span> Accès au Matériel (MMIO)</h2>
<h3 data-number="10.8.1" id="lécran"><span
class="header-section-number">10.8.1</span> L’écran</h3>
<div class="sourceCode" id="cb121"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co">// L&#39;écran commence à 0x00400000</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="co">// 320×240 pixels, 1 bit par pixel</span></span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> set_pixel<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">)</span> <span class="op">{</span></span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>    uint<span class="op">*</span> screen <span class="op">=</span> <span class="op">(</span>uint<span class="op">*)</span><span class="bn">0x00400000</span><span class="op">;</span></span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> offset <span class="op">=</span> y <span class="op">*</span> <span class="dv">10</span> <span class="op">+</span> <span class="op">(</span>x <span class="op">/</span> <span class="dv">32</span><span class="op">);</span></span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a>    uint mask <span class="op">=</span> <span class="dv">1</span> <span class="op">&lt;&lt;</span> <span class="op">(</span><span class="dv">31</span> <span class="op">-</span> <span class="op">(</span>x <span class="op">%</span> <span class="dv">32</span><span class="op">));</span></span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a>    screen<span class="op">[</span>offset<span class="op">]</span> <span class="op">=</span> screen<span class="op">[</span>offset<span class="op">]</span> <span class="op">|</span> mask<span class="op">;</span></span>
<span id="cb121-9"><a href="#cb121-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb121-10"><a href="#cb121-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-11"><a href="#cb121-11" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> clear_screen<span class="op">()</span> <span class="op">{</span></span>
<span id="cb121-12"><a href="#cb121-12" aria-hidden="true" tabindex="-1"></a>    uint<span class="op">*</span> screen <span class="op">=</span> <span class="op">(</span>uint<span class="op">*)</span><span class="bn">0x00400000</span><span class="op">;</span></span>
<span id="cb121-13"><a href="#cb121-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">2400</span><span class="op">;</span> i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb121-14"><a href="#cb121-14" aria-hidden="true" tabindex="-1"></a>        screen<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb121-15"><a href="#cb121-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb121-16"><a href="#cb121-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 data-number="10.8.2" id="le-clavier"><span
class="header-section-number">10.8.2</span> Le clavier</h3>
<div class="sourceCode" id="cb122"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Le clavier est à 0x00402600</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> get_key<span class="op">()</span> <span class="op">{</span></span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span><span class="op">*</span> keyboard <span class="op">=</span> <span class="op">(</span><span class="dt">int</span><span class="op">*)</span><span class="bn">0x00402600</span><span class="op">;</span></span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">*</span>keyboard<span class="op">;</span></span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> wait_key<span class="op">()</span> <span class="op">{</span></span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span>get_key<span class="op">()</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Attendre</span></span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb122-12"><a href="#cb122-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h2 data-number="10.9" id="exemple-complet-1"><span
class="header-section-number">10.9</span> Exemple Complet</h2>
<div class="sourceCode" id="cb123"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Programme qui dessine un rectangle et attend une touche</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a><span class="kw">extern</span> <span class="dt">void</span> putchar<span class="op">(</span><span class="dt">char</span> c<span class="op">);</span></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Dessiner un rectangle 10×5 à la position (20, 30)</span></span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>    uint<span class="op">*</span> screen <span class="op">=</span> <span class="op">(</span>uint<span class="op">*)</span><span class="bn">0x00400000</span><span class="op">;</span></span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> y <span class="op">=</span> <span class="dv">30</span><span class="op">;</span> y <span class="op">&lt;</span> <span class="dv">35</span><span class="op">;</span> y <span class="op">=</span> y <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> x <span class="op">=</span> <span class="dv">20</span><span class="op">;</span> x <span class="op">&lt;</span> <span class="dv">30</span><span class="op">;</span> x <span class="op">=</span> x <span class="op">+</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a>            <span class="dt">int</span> offset <span class="op">=</span> y <span class="op">*</span> <span class="dv">10</span> <span class="op">+</span> <span class="op">(</span>x <span class="op">/</span> <span class="dv">32</span><span class="op">);</span></span>
<span id="cb123-12"><a href="#cb123-12" aria-hidden="true" tabindex="-1"></a>            uint mask <span class="op">=</span> <span class="dv">1</span> <span class="op">&lt;&lt;</span> <span class="op">(</span><span class="dv">31</span> <span class="op">-</span> <span class="op">(</span>x <span class="op">%</span> <span class="dv">32</span><span class="op">));</span></span>
<span id="cb123-13"><a href="#cb123-13" aria-hidden="true" tabindex="-1"></a>            screen<span class="op">[</span>offset<span class="op">]</span> <span class="op">=</span> screen<span class="op">[</span>offset<span class="op">]</span> <span class="op">|</span> mask<span class="op">;</span></span>
<span id="cb123-14"><a href="#cb123-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb123-15"><a href="#cb123-15" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb123-16"><a href="#cb123-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-17"><a href="#cb123-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Afficher un message</span></span>
<span id="cb123-18"><a href="#cb123-18" aria-hidden="true" tabindex="-1"></a>    putchar<span class="op">(</span><span class="ch">&#39;D&#39;</span><span class="op">);</span></span>
<span id="cb123-19"><a href="#cb123-19" aria-hidden="true" tabindex="-1"></a>    putchar<span class="op">(</span><span class="ch">&#39;o&#39;</span><span class="op">);</span></span>
<span id="cb123-20"><a href="#cb123-20" aria-hidden="true" tabindex="-1"></a>    putchar<span class="op">(</span><span class="ch">&#39;n&#39;</span><span class="op">);</span></span>
<span id="cb123-21"><a href="#cb123-21" aria-hidden="true" tabindex="-1"></a>    putchar<span class="op">(</span><span class="ch">&#39;e&#39;</span><span class="op">);</span></span>
<span id="cb123-22"><a href="#cb123-22" aria-hidden="true" tabindex="-1"></a>    putchar<span class="op">(</span><span class="ch">&#39;!&#39;</span><span class="op">);</span></span>
<span id="cb123-23"><a href="#cb123-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-24"><a href="#cb123-24" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Attendre une touche</span></span>
<span id="cb123-25"><a href="#cb123-25" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span><span class="op">*</span> kbd <span class="op">=</span> <span class="op">(</span><span class="dt">int</span><span class="op">*)</span><span class="bn">0x00402600</span><span class="op">;</span></span>
<span id="cb123-26"><a href="#cb123-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(*</span>kbd <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{}</span></span>
<span id="cb123-27"><a href="#cb123-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-28"><a href="#cb123-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb123-29"><a href="#cb123-29" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h2 data-number="10.10" id="exercices-pratiques-7"><span
class="header-section-number">10.10</span> Exercices Pratiques</h2>
<h3 data-number="10.10.1" id="exercices-sur-le-simulateur-web-7"><span
class="header-section-number">10.10.1</span> Exercices sur le Simulateur
Web</h3>
<p>La section <strong>C32</strong> contient de nombreux exercices
progressifs :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Catégorie</th>
<th style="text-align: left;">Exercices clés</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Bases</strong></td>
<td style="text-align: left;">Variables, Expressions, Modulo</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Contrôle</strong></td>
<td style="text-align: left;">Conditions, Else-If, Opérateurs
Logiques</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Boucles</strong></td>
<td style="text-align: left;">For, While, Imbriquées</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Fonctions</strong></td>
<td style="text-align: left;">Paramètres, Valeur Absolue, Min/Max</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Tableaux</strong></td>
<td style="text-align: left;">Accès, Maximum, Comptage</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Pointeurs</strong></td>
<td style="text-align: left;">Adresses, Swap</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Récursion</strong></td>
<td style="text-align: left;">Factorielle, Fibonacci, PGCD</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Algorithmes</strong></td>
<td style="text-align: left;">Tri à Bulles, Recherche Binaire</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Graphique</strong></td>
<td style="text-align: left;">Pixel, Ligne, Rectangle, Damier</td>
</tr>
</tbody>
</table>
<h3 data-number="10.10.2" id="défis-suggérés"><span
class="header-section-number">10.10.2</span> Défis suggérés</h3>
<ol type="1">
<li><p><strong>Hello World</strong> : Affichez votre nom à
l’écran</p></li>
<li><p><strong>Jeu de devinette</strong> : Le programme choisit un
nombre, l’utilisateur devine</p></li>
<li><p><strong>Calculatrice</strong> : Lisez deux nombres et affichez
leur somme</p></li>
</ol>
<hr />
<h2 data-number="10.11" id="les-structures-structs"><span
class="header-section-number">10.11</span> Les Structures (Structs)</h2>
<p>Le C32 supporte les structures (structs) pour regrouper plusieurs
variables :</p>
<h3 data-number="10.11.1" id="définition-dune-structure"><span
class="header-section-number">10.11.1</span> Définition d’une
structure</h3>
<div class="sourceCode" id="cb124"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> Point <span class="op">{</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> x<span class="op">;</span></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> y<span class="op">;</span></span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span></code></pre></div>
<h3 data-number="10.11.2" id="utilisation-1"><span
class="header-section-number">10.11.2</span> Utilisation</h3>
<div class="sourceCode" id="cb125"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> Point p<span class="op">;</span>     <span class="co">// Déclarer une variable de type struct</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>p<span class="op">.</span>x <span class="op">=</span> <span class="dv">10</span><span class="op">;</span>           <span class="co">// Accéder aux champs avec .</span></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>p<span class="op">.</span>y <span class="op">=</span> <span class="dv">20</span><span class="op">;</span></span></code></pre></div>
<h3 data-number="10.11.3" id="pointeur-vers-structure"><span
class="header-section-number">10.11.3</span> Pointeur vers
structure</h3>
<div class="sourceCode" id="cb126"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> Point <span class="op">*</span>ptr <span class="op">=</span> <span class="op">&amp;</span>p<span class="op">;</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>ptr<span class="op">-&gt;</span>x <span class="op">=</span> <span class="dv">30</span><span class="op">;</span>        <span class="co">// Accéder via pointeur avec -&gt;</span></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>ptr<span class="op">-&gt;</span>y <span class="op">=</span> <span class="dv">40</span><span class="op">;</span></span></code></pre></div>
<h3 data-number="10.11.4" id="exemple-complet-2"><span
class="header-section-number">10.11.4</span> Exemple complet</h3>
<div class="sourceCode" id="cb127"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> Point <span class="op">{</span> <span class="dt">int</span> x<span class="op">;</span> <span class="dt">int</span> y<span class="op">;</span> <span class="op">};</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> distance_sq<span class="op">(</span><span class="kw">struct</span> Point <span class="op">*</span>p<span class="op">)</span> <span class="op">{</span></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> p<span class="op">-&gt;</span>x <span class="op">*</span> p<span class="op">-&gt;</span>x <span class="op">+</span> p<span class="op">-&gt;</span>y <span class="op">*</span> p<span class="op">-&gt;</span>y<span class="op">;</span></span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> Point p<span class="op">;</span></span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a>    p<span class="op">.</span>x <span class="op">=</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb127-10"><a href="#cb127-10" aria-hidden="true" tabindex="-1"></a>    p<span class="op">.</span>y <span class="op">=</span> <span class="dv">4</span><span class="op">;</span></span>
<span id="cb127-11"><a href="#cb127-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> distance_sq<span class="op">(&amp;</span>p<span class="op">);</span>  <span class="co">// Retourne 25</span></span>
<span id="cb127-12"><a href="#cb127-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 data-number="10.11.5" id="structures-imbriquées"><span
class="header-section-number">10.11.5</span> Structures imbriquées</h3>
<div class="sourceCode" id="cb128"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> Point <span class="op">{</span> <span class="dt">int</span> x<span class="op">;</span> <span class="dt">int</span> y<span class="op">;</span> <span class="op">};</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a><span class="kw">struct</span> Rectangle <span class="op">{</span></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> Point corner<span class="op">;</span></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> width<span class="op">;</span></span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> height<span class="op">;</span></span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a><span class="op">};</span></span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">struct</span> Rectangle r<span class="op">;</span></span>
<span id="cb128-10"><a href="#cb128-10" aria-hidden="true" tabindex="-1"></a>    r<span class="op">.</span>corner<span class="op">.</span>x <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb128-11"><a href="#cb128-11" aria-hidden="true" tabindex="-1"></a>    r<span class="op">.</span>corner<span class="op">.</span>y <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb128-12"><a href="#cb128-12" aria-hidden="true" tabindex="-1"></a>    r<span class="op">.</span>width <span class="op">=</span> <span class="dv">100</span><span class="op">;</span></span>
<span id="cb128-13"><a href="#cb128-13" aria-hidden="true" tabindex="-1"></a>    r<span class="op">.</span>height <span class="op">=</span> <span class="dv">50</span><span class="op">;</span></span>
<span id="cb128-14"><a href="#cb128-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> r<span class="op">.</span>width <span class="op">*</span> r<span class="op">.</span>height<span class="op">;</span>  <span class="co">// Retourne 5000</span></span>
<span id="cb128-15"><a href="#cb128-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h2 data-number="10.12" id="limitations-du-c32"><span
class="header-section-number">10.12</span> Limitations du C32</h2>
<p>Pour rester simple et pédagogique, le C32 a quelques limites :</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Fonctionnalité</th>
<th style="text-align: left;">État</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>struct</code></td>
<td style="text-align: left;">Supporté</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>float</code>,
<code>double</code></td>
<td style="text-align: left;">Non supporté</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>malloc</code>/<code>free</code></td>
<td style="text-align: left;">Via OS uniquement</td>
</tr>
<tr class="even">
<td style="text-align: left;">Chaînes de caractères</td>
<td style="text-align: left;">Basique</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Préprocesseur</td>
<td style="text-align: left;">Minimal</td>
</tr>
</tbody>
</table>
<hr />
<h2 data-number="10.13" id="ce-quil-faut-retenir-7"><span
class="header-section-number">10.13</span> Ce qu’il faut retenir</h2>
<ol type="1">
<li><p><strong>C32 simplifie la programmation</strong> : Variables
nommées, structures de contrôle</p></li>
<li><p><strong>Les types de base</strong> : <code>int</code>,
<code>char</code>, <code>bool</code>, <code>void</code>,
pointeurs</p></li>
<li><p><strong>Pointeurs = adresses</strong> : Accès direct à la
mémoire</p></li>
<li><p><strong>MMIO</strong> : Écran à 0x00400000, clavier à
0x00402600</p></li>
<li><p><strong>Fonctions</strong> : Modularité et réutilisation du
code</p></li>
</ol>
<p><strong>Prochaine étape</strong> : Au Chapitre 9, nous construirons
un <strong>Système d’Exploitation</strong> minimal — gestion mémoire,
graphiques, entrées/sorties.</p>
<hr />
<p><strong>Conseil</strong> : Le C32 est proche du C. Si vous voulez
aller plus loin, apprenez le C — c’est le langage de base de Linux,
Windows, et de presque tous les systèmes embarqués !</p>
<hr />
<h2 data-number="10.14" id="auto-évaluation-7"><span
class="header-section-number">10.14</span> Auto-évaluation</h2>
<p>Testez votre compréhension avant de passer au chapitre suivant.</p>
<h3 data-number="10.14.1" id="questions-de-compréhension-7"><span
class="header-section-number">10.14.1</span> Questions de
compréhension</h3>
<p><strong>Q1.</strong> Quelle est la différence entre <code>int</code>
et <code>uint</code> en C32 ?</p>
<p><strong>Q2.</strong> Qu’est-ce qu’un pointeur et comment
l’utilise-t-on ?</p>
<p><strong>Q3.</strong> Comment accède-t-on à l’écran en C32 ?</p>
<p><strong>Q4.</strong> Quelle est la syntaxe d’une boucle
<code>for</code> en C32 ?</p>
<p><strong>Q5.</strong> Comment définit-on et utilise-t-on un tableau en
C32 ?</p>
<h3 data-number="10.14.2" id="mini-défi-pratique-7"><span
class="header-section-number">10.14.2</span> Mini-défi pratique</h3>
<p>Écrivez une fonction C32 qui calcule la somme des éléments d’un
tableau :</p>
<div class="sourceCode" id="cb129"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> sum<span class="op">(</span><span class="dt">int</span> <span class="op">*</span>arr<span class="op">,</span> <span class="dt">int</span> len<span class="op">)</span> <span class="op">{</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">// À compléter</span></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><em>Les solutions se trouvent dans le document
<strong>Codex_Solutions</strong>.</em></p>
<h3 data-number="10.14.3" id="checklist-de-validation-7"><span
class="header-section-number">10.14.3</span> Checklist de
validation</h3>
<p>Avant de passer au chapitre 9, assurez-vous de pouvoir :</p>
<ul class="task-list">
<li><label><input type="checkbox" />Utiliser les types de base :
<code>int</code>, <code>uint</code>, <code>char</code>,
<code>bool</code></label></li>
<li><label><input type="checkbox" />Déclarer et utiliser des
pointeurs</label></li>
<li><label><input type="checkbox" />Accéder à la mémoire mappée (écran,
clavier)</label></li>
<li><label><input type="checkbox" />Écrire des boucles <code>for</code>
et <code>while</code></label></li>
<li><label><input type="checkbox" />Manipuler des tableaux et des
chaînes de caractères</label></li>
</ul>
<h1 data-number="11" id="système-dexploitation"><span
class="header-section-number">11</span> Système d’Exploitation</h1>
<blockquote>
<p>“Un OS est ce qui reste quand on a enlevé tout ce qui est utile.” —
Ken Thompson</p>
</blockquote>
<p>Félicitations ! Vous avez construit le matériel, l’assembleur et le
compilateur. Votre machine Codex est fonctionnelle. Mais pour l’instant,
chaque programmeur doit réinventer la roue : comment dessiner un cercle
? comment lire une chaîne de caractères ?</p>
<p>Dans ce dernier chapitre, nous allons construire une
<strong>Bibliothèque Système</strong> qui simplifie l’accès au
matériel.</p>
<hr />
<h2 data-number="11.1" id="où-en-sommes-nous-8"><span
class="header-section-number">11.1</span> Où en sommes-nous ?</h2>
<figure>
<img src="images/architecture-stack.svg"
alt="Position dans l’architecture" />
<figcaption aria-hidden="true">Position dans l’architecture</figcaption>
</figure>
<p><em>Nous sommes à la Couche 6 : Système d’Exploitation - Le sommet de
la pyramide logicielle !</em></p>
<p>C’est le <strong>sommet de la pyramide</strong> logicielle ! L’OS
cache la complexité du matériel et offre des services de haut niveau aux
applications.</p>
<hr />
<h2 data-number="11.2" id="quest-ce-quun-système-dexploitation"><span
class="header-section-number">11.2</span> Qu’est-ce qu’un Système
d’Exploitation ?</h2>
<h3 data-number="11.2.1" id="la-hiérarchie-logicielle"><span
class="header-section-number">11.2.1</span> La hiérarchie
logicielle</h3>
<figure>
<img src="images/software-hierarchy.svg" alt="Hiérarchie logicielle" />
<figcaption aria-hidden="true">Hiérarchie logicielle</figcaption>
</figure>
<h3 data-number="11.2.2" id="ce-que-fait-un-os"><span
class="header-section-number">11.2.2</span> Ce que fait un OS</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Fonction</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Gestion mémoire</strong></td>
<td style="text-align: left;">Allouer/libérer de la mémoire
dynamiquement</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Graphiques</strong></td>
<td style="text-align: left;">Dessiner des formes, du texte</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Entrées/Sorties</strong></td>
<td style="text-align: left;">Lire le clavier, afficher à l’écran</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Fichiers</strong></td>
<td style="text-align: left;">Sauvegarder/charger des données
(avancé)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Multitâche</strong></td>
<td style="text-align: left;">Exécuter plusieurs programmes
(avancé)</td>
</tr>
</tbody>
</table>
<p>Notre OS Codex implémente les trois premiers points.</p>
<hr />
<h2 data-number="11.3" id="gestion-de-la-mémoire-le-tas-heap"><span
class="header-section-number">11.3</span> Gestion de la Mémoire (Le Tas
/ Heap)</h2>
<h3 data-number="11.3.1" id="le-problème-2"><span
class="header-section-number">11.3.1</span> Le problème</h3>
<p>Jusqu’à présent, nous utilisions :</p>
<ul>
<li><strong>Variables globales</strong> : Taille fixée à la
compilation</li>
<li><strong>Variables locales</strong> : Sur la pile, libérées
automatiquement</li>
</ul>
<p>Mais que faire si on veut allouer une taille <strong>inconnue à
l’avance</strong> ?</p>
<h3 data-number="11.3.2" id="lallocateur-bump-simple"><span
class="header-section-number">11.3.2</span> L’allocateur “Bump”
(Simple)</h3>
<p>L’allocateur le plus simple : un pointeur qui avance à chaque
allocation.</p>
<div class="sourceCode" id="cb130"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="dt">char</span><span class="op">*</span> heap_ptr <span class="op">=</span> <span class="op">(</span><span class="dt">char</span><span class="op">*)</span>HEAP_START<span class="op">;</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a><span class="dt">char</span><span class="op">*</span> malloc<span class="op">(</span><span class="dt">int</span> size<span class="op">)</span> <span class="op">{</span></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">char</span><span class="op">*</span> result <span class="op">=</span> heap_ptr<span class="op">;</span></span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>    heap_ptr <span class="op">=</span> heap_ptr <span class="op">+</span> size<span class="op">;</span></span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result<span class="op">;</span></span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-9"><a href="#cb130-9" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> free<span class="op">(</span><span class="dt">char</span><span class="op">*</span> ptr<span class="op">)</span> <span class="op">{</span></span>
<span id="cb130-10"><a href="#cb130-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Ne fait rien ! La mémoire n&#39;est jamais récupérée.</span></span>
<span id="cb130-11"><a href="#cb130-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p><strong>Avantage</strong> : Très simple, très rapide.
<strong>Inconvénient</strong> : On ne peut pas réutiliser la mémoire
libérée.</p>
<h3 data-number="11.3.3" id="lallocateur-par-liste-chaînée-avancé"><span
class="header-section-number">11.3.3</span> L’allocateur par Liste
Chaînée (Avancé)</h3>
<p>Pour réutiliser la mémoire, chaque bloc contient : - Sa taille - Un
pointeur vers le bloc libre suivant</p>
<pre><code>┌────────────────────────────────────────────────────┐
│ [size|next] [données...]  [size|next] [données...] │
└────────────────────────────────────────────────────┘</code></pre>
<p>Quand on libère un bloc, on l’ajoute à la liste des blocs libres.
Quand on alloue, on cherche un bloc de taille suffisante.</p>
<hr />
<h2 data-number="11.4" id="bibliothèque-graphique"><span
class="header-section-number">11.4</span> Bibliothèque Graphique</h2>
<h3 data-number="11.4.1" id="le-problème-3"><span
class="header-section-number">11.4.1</span> Le problème</h3>
<p>Pour allumer un pixel, il faut :</p>
<ol type="1">
<li>Calculer l’adresse de l’octet</li>
<li>Calculer la position du bit</li>
<li>Faire un OR pour allumer (ou AND + NOT pour éteindre)</li>
</ol>
<p>C’est fastidieux et source d’erreurs.</p>
<h3 data-number="11.4.2" id="les-fonctions-graphiques"><span
class="header-section-number">11.4.2</span> Les fonctions
graphiques</h3>
<div class="sourceCode" id="cb132"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> screen_init<span class="op">();</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> screen_clear<span class="op">();</span></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> screen_set_color<span class="op">(</span><span class="dt">int</span> color<span class="op">);</span></span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> screen_draw_pixel<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">);</span></span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> screen_draw_line<span class="op">(</span><span class="dt">int</span> x1<span class="op">,</span> <span class="dt">int</span> y1<span class="op">,</span> <span class="dt">int</span> x2<span class="op">,</span> <span class="dt">int</span> y2<span class="op">);</span></span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> screen_draw_rect<span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">,</span> <span class="dt">int</span> w<span class="op">,</span> <span class="dt">int</span> h<span class="op">);</span></span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> screen_draw_circle<span class="op">(</span><span class="dt">int</span> cx<span class="op">,</span> <span class="dt">int</span> cy<span class="op">,</span> <span class="dt">int</span> r<span class="op">);</span></span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> screen_print<span class="op">(</span><span class="dt">char</span><span class="op">*</span> text<span class="op">,</span> <span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">);</span></span></code></pre></div>
<h3 data-number="11.4.3" id="lalgorithme-de-bresenham"><span
class="header-section-number">11.4.3</span> L’algorithme de
Bresenham</h3>
<p>Pour dessiner des lignes droites avec uniquement des additions et des
comparaisons:</p>
<div class="sourceCode" id="cb133"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> screen_draw_line<span class="op">(</span><span class="dt">int</span> x1<span class="op">,</span> <span class="dt">int</span> y1<span class="op">,</span> <span class="dt">int</span> x2<span class="op">,</span> <span class="dt">int</span> y2<span class="op">)</span> <span class="op">{</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> dx <span class="op">=</span> abs<span class="op">(</span>x2 <span class="op">-</span> x1<span class="op">);</span></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> dy <span class="op">=</span> abs<span class="op">(</span>y2 <span class="op">-</span> y1<span class="op">);</span></span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> sx <span class="op">=</span> x1 <span class="op">&lt;</span> x2 <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> sy <span class="op">=</span> y1 <span class="op">&lt;</span> y2 <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> err <span class="op">=</span> dx <span class="op">-</span> dy<span class="op">;</span></span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(</span><span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a>        screen_draw_pixel<span class="op">(</span>x1<span class="op">,</span> y1<span class="op">);</span></span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>x1 <span class="op">==</span> x2 <span class="op">&amp;&amp;</span> y1 <span class="op">==</span> y2<span class="op">)</span> <span class="cf">break</span><span class="op">;</span></span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> e2 <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> err<span class="op">;</span></span>
<span id="cb133-12"><a href="#cb133-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>e2 <span class="op">&gt;</span> <span class="op">-</span>dy<span class="op">)</span> <span class="op">{</span> err <span class="op">=</span> err <span class="op">-</span> dy<span class="op">;</span> x1 <span class="op">=</span> x1 <span class="op">+</span> sx<span class="op">;</span> <span class="op">}</span></span>
<span id="cb133-13"><a href="#cb133-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>e2 <span class="op">&lt;</span> dx<span class="op">)</span>  <span class="op">{</span> err <span class="op">=</span> err <span class="op">+</span> dx<span class="op">;</span> y1 <span class="op">=</span> y1 <span class="op">+</span> sy<span class="op">;</span> <span class="op">}</span></span>
<span id="cb133-14"><a href="#cb133-14" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb133-15"><a href="#cb133-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>Pas de multiplication, pas de division — uniquement des opérations
que notre CPU fait rapidement !</p>
<hr />
<h2 data-number="11.5" id="entrées-sorties"><span
class="header-section-number">11.5</span> Entrées / Sorties</h2>
<h3 data-number="11.5.1" id="printf-simplifié"><span
class="header-section-number">11.5.1</span> Printf simplifié</h3>
<div class="sourceCode" id="cb134"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> putchar<span class="op">(</span><span class="dt">char</span> c<span class="op">)</span> <span class="op">{</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Appel système SVC pour afficher un caractère</span></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> puts<span class="op">(</span><span class="dt">char</span><span class="op">*</span> s<span class="op">)</span> <span class="op">{</span></span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">(*</span>s <span class="op">!=</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a>        putchar<span class="op">(*</span>s<span class="op">);</span></span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true" tabindex="-1"></a>        s <span class="op">=</span> s <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb134-9"><a href="#cb134-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb134-10"><a href="#cb134-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb134-11"><a href="#cb134-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-12"><a href="#cb134-12" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> print_int<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb134-13"><a href="#cb134-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">&lt;</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb134-14"><a href="#cb134-14" aria-hidden="true" tabindex="-1"></a>        putchar<span class="op">(</span><span class="ch">&#39;-&#39;</span><span class="op">);</span></span>
<span id="cb134-15"><a href="#cb134-15" aria-hidden="true" tabindex="-1"></a>        n <span class="op">=</span> <span class="op">-</span>n<span class="op">;</span></span>
<span id="cb134-16"><a href="#cb134-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb134-17"><a href="#cb134-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">&gt;=</span> <span class="dv">10</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb134-18"><a href="#cb134-18" aria-hidden="true" tabindex="-1"></a>        print_int<span class="op">(</span>n <span class="op">/</span> <span class="dv">10</span><span class="op">);</span></span>
<span id="cb134-19"><a href="#cb134-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb134-20"><a href="#cb134-20" aria-hidden="true" tabindex="-1"></a>    putchar<span class="op">(</span><span class="ch">&#39;0&#39;</span> <span class="op">+</span> <span class="op">(</span>n <span class="op">%</span> <span class="dv">10</span><span class="op">));</span></span>
<span id="cb134-21"><a href="#cb134-21" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 data-number="11.5.2" id="lecture-du-clavier"><span
class="header-section-number">11.5.2</span> Lecture du clavier</h3>
<div class="sourceCode" id="cb135"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> keyboard_read<span class="op">()</span> <span class="op">{</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span><span class="op">*</span> kbd <span class="op">=</span> <span class="op">(</span><span class="dt">int</span><span class="op">*)</span><span class="bn">0x00402600</span><span class="op">;</span></span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">*</span>kbd<span class="op">;</span></span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-6"><a href="#cb135-6" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> keyboard_wait<span class="op">()</span> <span class="op">{</span></span>
<span id="cb135-7"><a href="#cb135-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> key<span class="op">;</span></span>
<span id="cb135-8"><a href="#cb135-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="op">((</span>key <span class="op">=</span> keyboard_read<span class="op">())</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb135-9"><a href="#cb135-9" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Attendre</span></span>
<span id="cb135-10"><a href="#cb135-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb135-11"><a href="#cb135-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> key<span class="op">;</span></span>
<span id="cb135-12"><a href="#cb135-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<hr />
<h2 data-number="11.6" id="interruptions-et-timer-concepts"><span
class="header-section-number">11.6</span> Interruptions et Timer
(Concepts)</h2>
<h3 data-number="11.6.1" id="le-problème-du-polling"><span
class="header-section-number">11.6.1</span> Le problème du polling</h3>
<p>Dans notre approche actuelle, le CPU vérifie constamment le clavier
:</p>
<div class="sourceCode" id="cb136"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="op">(</span>keyboard_read<span class="op">()</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{}</span>  <span class="co">// CPU occupe à ne rien faire !</span></span></code></pre></div>
<h3 data-number="11.6.2" id="les-interruptions"><span
class="header-section-number">11.6.2</span> Les interruptions</h3>
<p>Avec les interruptions, le matériel <strong>signale</strong> au CPU
qu’un événement s’est produit:</p>
<ol type="1">
<li>Le CPU exécute le programme</li>
<li>Une touche est pressée → Le matériel déclenche une
<strong>interruption</strong></li>
<li>Le CPU s’arrête et saute vers le <strong>handler
d’interruption</strong></li>
<li>Le handler traite l’événement</li>
<li>Le CPU reprend le programme là où il s’était arrêté</li>
</ol>
<p>C’est la base du multitâche et des systèmes réactifs !</p>
<hr />
<h2 data-number="11.7" id="applications-démo"><span
class="header-section-number">11.7</span> Applications Démo</h2>
<p>Le répertoire <code>demos/</code> contient des exemples complets
:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Démo</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>01_hello</code></td>
<td style="text-align: left;">Hello World classique</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>02_counter</code></td>
<td style="text-align: left;">Compteur avec affichage</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>03_graphics</code></td>
<td style="text-align: left;">Dessins géométriques</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>04_snake</code></td>
<td style="text-align: left;">Jeu du serpent complet !</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>05_shell</code></td>
<td style="text-align: left;">Interface en ligne de commande</td>
</tr>
</tbody>
</table>
<h3 data-number="11.7.1" id="compiler-et-exécuter-une-démo"><span
class="header-section-number">11.7.1</span> Compiler et exécuter une
démo</h3>
<div class="sourceCode" id="cb137"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compiler</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> run <span class="at">-p</span> c32_cli <span class="at">--</span> demos/04_snake/main.c <span class="at">-o</span> snake.bin</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Exécuter</span></span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a><span class="ex">cargo</span> run <span class="at">-p</span> a32_runner <span class="at">--</span> snake.bin</span></code></pre></div>
<p>Ou utilisez le <strong>Simulateur Web</strong> pour une expérience
visuelle !</p>
<hr />
<h2 data-number="11.8" id="exercices-pratiques-8"><span
class="header-section-number">11.8</span> Exercices Pratiques</h2>
<h3 data-number="11.8.1" id="exercices-sur-le-simulateur-web-8"><span
class="header-section-number">11.8.1</span> Exercices sur le Simulateur
Web</h3>
<p>La section <strong>OS</strong> contient des exercices interactifs
:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>Calculatrice</code></td>
<td style="text-align: left;">Calculatrice interactive avec clavier</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>Variables</code></td>
<td style="text-align: left;">Shell pour définir des variables</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>Timer</code></td>
<td style="text-align: left;">Affichage d’un compteur animé</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>Scheduler</code></td>
<td style="text-align: left;">Simulation d’un ordonnanceur</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>Projet Mini-OS</code></td>
<td style="text-align: left;">Shell multi-applications</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>Task Manager</code></td>
<td style="text-align: left;">Gestionnaire de tâches visuel</td>
</tr>
</tbody>
</table>
<h3 data-number="11.8.2" id="défis-suggérés-1"><span
class="header-section-number">11.8.2</span> Défis suggérés</h3>
<ol type="1">
<li><p><strong>Étendre l’OS</strong> : Ajoutez
<code>screen_draw_triangle()</code> en utilisant trois appels à
<code>screen_draw_line()</code>.</p></li>
<li><p><strong>Gestion mémoire</strong> : Testez l’allocateur avec
plusieurs <code>malloc()</code> et observez le comportement.</p></li>
<li><p><strong>Projet final</strong> : Créez votre propre application
dans <code>demos/</code> en utilisant tout ce que vous avez appris
!</p></li>
</ol>
<hr />
<h2 data-number="11.9" id="le-parcours-complet-1"><span
class="header-section-number">11.9</span> Le Parcours Complet</h2>
<p>Vous avez parcouru tout le chemin :</p>
<pre><code>Chapitre 0 : Introduction
    ↓
Chapitre 1-5 : MATÉRIEL
    NAND → Portes → ALU → Mémoire → CPU
    ↓
Chapitre 6-9 : LOGICIEL
    Assembleur → Compilateur → C32 → OS
    ↓
Applications : Jeux, Calculatrices, Shell...</code></pre>
<p>Vous comprenez maintenant que l’ordinateur n’est pas une boîte
magique, mais une <strong>pyramide d’abstractions</strong>
magnifiquement ordonnées.</p>
<hr />
<h2 data-number="11.10" id="ce-quil-faut-retenir-8"><span
class="header-section-number">11.10</span> Ce qu’il faut retenir</h2>
<ol type="1">
<li><p><strong>L’OS cache le matériel</strong> :
<code>draw_circle()</code> au lieu de manipuler des bits</p></li>
<li><p><strong>Gestion mémoire dynamique</strong> :
<code>malloc()</code> et <code>free()</code></p></li>
<li><p><strong>Bibliothèque graphique</strong> : Lignes, rectangles,
cercles, texte</p></li>
<li><p><strong>Entrées/Sorties</strong> : <code>putchar()</code>,
<code>keyboard_read()</code></p></li>
<li><p><strong>Interruptions</strong> : Le matériel peut signaler des
événements au CPU</p></li>
</ol>
<hr />
<h2 data-number="11.11" id="félicitations"><span
class="header-section-number">11.11</span> Félicitations !</h2>
<p>Vous avez parcouru tout le chemin, de la <strong>porte NAND</strong>
au <strong>système d’exploitation</strong>. Vous comprenez maintenant
:</p>
<ul>
<li><p>Comment les bits deviennent des calculs (ALU)</p></li>
<li><p>Comment les calculs deviennent de la mémoire (RAM)</p></li>
<li><p>Comment la mémoire devient un programme (CPU)</p></li>
<li><p>Comment un programme devient une application (Compilateur +
OS)</p></li>
</ul>
<p>Quand vous verrez du code s’exécuter, vous saurez
<strong>exactement</strong> ce qui se passe dans la machine. Ce n’est
plus de la magie — c’est de l’ingénierie que vous maîtrisez.</p>
<hr />
<p><strong>Et maintenant ?</strong></p>
<ul>
<li>Apprenez le C pour approfondir la programmation système</li>
<li>Étudiez le noyau Linux pour voir un vrai OS</li>
<li>Explorez les architectures ARM/RISC-V modernes</li>
<li>Construisez vos propres projets sur la base de Codex !</li>
</ul>
<hr />
<h2 data-number="11.12" id="auto-évaluation-8"><span
class="header-section-number">11.12</span> Auto-évaluation</h2>
<p>Testez votre compréhension de l’ensemble du parcours.</p>
<h3 data-number="11.12.1" id="questions-de-compréhension-8"><span
class="header-section-number">11.12.1</span> Questions de
compréhension</h3>
<p><strong>Q1.</strong> Qu’est-ce qu’un allocateur mémoire et pourquoi
en a-t-on besoin ?</p>
<p><strong>Q2.</strong> Comment fonctionne l’affichage graphique via
MMIO ?</p>
<p><strong>Q3.</strong> Quelle est la différence entre polling et
interruptions ?</p>
<p><strong>Q4.</strong> Pourquoi sépare-t-on le code en bibliothèques
(Math, String, Screen, etc.) ?</p>
<p><strong>Q5.</strong> Résumez le chemin complet du code source à
l’exécution.</p>
<p><em>Les solutions se trouvent dans le document
<strong>Codex_Solutions</strong>.</em></p>
<h3 data-number="11.12.2" id="réflexion-finale"><span
class="header-section-number">11.12.2</span> Réflexion finale</h3>
<p>Vous avez maintenant une vision complète de comment fonctionne un
ordinateur :</p>
<table>
<thead>
<tr class="header">
<th>Couche</th>
<th>Ce que vous avez appris</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Portes logiques</td>
<td>NAND → NOT, AND, OR, XOR, MUX</td>
</tr>
<tr class="even">
<td>Arithmétique</td>
<td>Half Adder → Full Adder → ALU</td>
</tr>
<tr class="odd">
<td>Mémoire</td>
<td>DFF → Registre → RAM → PC</td>
</tr>
<tr class="even">
<td>CPU</td>
<td>Fetch-Decode-Execute, pipeline</td>
</tr>
<tr class="odd">
<td>ISA</td>
<td>Instructions A32, encodage binaire</td>
</tr>
<tr class="even">
<td>Assembleur</td>
<td>Texte → Binaire (2 passes)</td>
</tr>
<tr class="odd">
<td>Compilateur</td>
<td>C32 → Assembleur (lexer, parser, codegen)</td>
</tr>
<tr class="even">
<td>OS</td>
<td>Allocation mémoire, graphiques, I/O</td>
</tr>
</tbody>
</table>
<p><strong>Vous n’êtes plus un utilisateur passif de la technologie —
vous comprenez comment elle fonctionne !</strong></p>
<h3 data-number="11.12.3" id="checklist-de-validation-finale"><span
class="header-section-number">11.12.3</span> Checklist de validation
finale</h3>
<ul class="task-list">
<li><label><input type="checkbox" />Je peux expliquer comment NAND
permet de construire toutes les portes</label></li>
<li><label><input type="checkbox" />Je comprends le complément à 2 et
les drapeaux NZCV</label></li>
<li><label><input type="checkbox" />Je sais tracer l’exécution d’une
instruction dans le CPU</label></li>
<li><label><input type="checkbox" />Je peux écrire et déboguer un
programme en assembleur A32</label></li>
<li><label><input type="checkbox" />Je comprends comment le compilateur
traduit C32 en assembleur</label></li>
<li><label><input type="checkbox" />Je sais utiliser le MMIO pour
l’écran et le clavier</label></li>
<li><label><input type="checkbox" />Je peux expliquer la hiérarchie
mémoire (registres → cache → RAM)</label></li>
</ul>
<h1 data-number="12" id="annexe-tous-les-exercices"><span
class="header-section-number">12</span> Annexe : Tous les Exercices</h1>
<p>Cette annexe contient les enonces de tous les exercices disponibles
sur le simulateur web.</p>
<hr />
<h2 data-number="12.1" id="a.-exercices-hdl-portes-logiques"><span
class="header-section-number">12.1</span> A. Exercices HDL (Portes
Logiques)</h2>
<p>Ces exercices construisent progressivement un ordinateur a partir de
la porte NAND.</p>
<h3 data-number="12.1.1" id="projet-1-portes-de-base"><span
class="header-section-number">12.1.1</span> Projet 1 : Portes de
Base</h3>
<table>
<colgroup>
<col style="width: 43%" />
<col style="width: 56%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Inv</td>
<td style="text-align: left;">Inverseur (NOT) :
<code>Inv(a) = Nand(a, a)</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">And2</td>
<td style="text-align: left;">Porte AND :
<code>And2(a,b) = Inv(Nand(a,b))</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Or2</td>
<td style="text-align: left;">Porte OR :
<code>Or2(a,b) = Nand(Inv(a), Inv(b))</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Xor2</td>
<td style="text-align: left;">Porte XOR :
<code>Xor2(a,b) = Or2(And2(a, Inv(b)), And2(Inv(a), b))</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mux</td>
<td style="text-align: left;">Multiplexeur : si sel=0 alors y=a sinon
y=b</td>
</tr>
<tr class="even">
<td style="text-align: left;">DMux</td>
<td style="text-align: left;">Demultiplexeur : distribue x vers a ou b
selon sel</td>
</tr>
</tbody>
</table>
<h3 data-number="12.1.2" id="projet-2-arithmetique"><span
class="header-section-number">12.1.2</span> Projet 2 : Arithmetique</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">HalfAdder</td>
<td style="text-align: left;">Demi-additionneur : sum = a XOR b, carry =
a AND b</td>
</tr>
<tr class="even">
<td style="text-align: left;">FullAdder</td>
<td style="text-align: left;">Additionneur complet avec retenue
entrante</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Add32</td>
<td style="text-align: left;">Additionneur 32 bits (ripple carry)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Inc32</td>
<td style="text-align: left;">Incrementeur : ajoute 1 a l’entree</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Alu32</td>
<td style="text-align: left;">ALU 32 bits avec 6 operations</td>
</tr>
</tbody>
</table>
<h3 data-number="12.1.3" id="projet-3-memoire"><span
class="header-section-number">12.1.3</span> Projet 3 : Memoire</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">DFF</td>
<td style="text-align: left;">D Flip-Flop (fourni)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bit</td>
<td style="text-align: left;">Registre 1 bit avec load</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Register</td>
<td style="text-align: left;">Registre 32 bits</td>
</tr>
<tr class="even">
<td style="text-align: left;">RAM8</td>
<td style="text-align: left;">8 registres avec adressage 3 bits</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RAM64</td>
<td style="text-align: left;">64 registres avec adressage 6 bits</td>
</tr>
<tr class="even">
<td style="text-align: left;">PC</td>
<td style="text-align: left;">Compteur de programme avec
inc/load/reset</td>
</tr>
</tbody>
</table>
<h3 data-number="12.1.4" id="projet-5-cpu"><span
class="header-section-number">12.1.4</span> Projet 5 : CPU</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">CPU</td>
<td style="text-align: left;">Processeur complet A32</td>
</tr>
</tbody>
</table>
<h3 data-number="12.1.5" id="projet-6-cpu-pipeline-avance"><span
class="header-section-number">12.1.5</span> Projet 6 : CPU Pipeline
(Avance)</h3>
<p>Ces exercices construisent un CPU pipeline 5 etages avec gestion des
aleas.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">IF_ID_Reg</td>
<td style="text-align: left;">Registre pipeline IF/ID avec stall et
flush</td>
</tr>
<tr class="even">
<td style="text-align: left;">HazardDetect</td>
<td style="text-align: left;">Detection des aleas load-use</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ForwardUnit</td>
<td style="text-align: left;">Bypass des donnees (forwarding)</td>
</tr>
<tr class="even">
<td style="text-align: left;">CPU_Pipeline</td>
<td style="text-align: left;">CPU pipeline 5 etages complet</td>
</tr>
</tbody>
</table>
<h3 data-number="12.1.6" id="projet-7-cache-l1"><span
class="header-section-number">12.1.6</span> Projet 7 : Cache L1</h3>
<p>Ces exercices implementent un cache memoire direct-mapped.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">CacheLine</td>
<td style="text-align: left;">Ligne de cache (valid, dirty, tag,
data)</td>
</tr>
<tr class="even">
<td style="text-align: left;">TagCompare</td>
<td style="text-align: left;">Comparateur de tags pour detecter
hit/miss</td>
</tr>
<tr class="odd">
<td style="text-align: left;">WordSelect</td>
<td style="text-align: left;">Selecteur de mot dans une ligne de 128
bits</td>
</tr>
<tr class="even">
<td style="text-align: left;">CacheController</td>
<td style="text-align: left;">Machine a etats (IDLE, FETCH,
WRITEBACK)</td>
</tr>
</tbody>
</table>
<hr />
<h2 data-number="12.2" id="b.-exercices-assembleur-a32"><span
class="header-section-number">12.2</span> B. Exercices Assembleur
A32</h2>
<p>Ces exercices enseignent la programmation en assembleur A32.</p>
<h3 data-number="12.2.1" id="bases"><span
class="header-section-number">12.2.1</span> Bases</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Objectif</th>
<th style="text-align: left;">Resultat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Hello World</td>
<td style="text-align: left;">Charger 42 dans R0</td>
<td style="text-align: left;">R0 = 42</td>
</tr>
<tr class="even">
<td style="text-align: left;">Addition</td>
<td style="text-align: left;">Calculer 15 + 27</td>
<td style="text-align: left;">R0 = 42</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Soustraction</td>
<td style="text-align: left;">Calculer 100 - 58</td>
<td style="text-align: left;">R0 = 42</td>
</tr>
<tr class="even">
<td style="text-align: left;">Logique</td>
<td style="text-align: left;">0xFF AND 0x0F</td>
<td style="text-align: left;">R0 = 15</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Doubler</td>
<td style="text-align: left;">21 * 2 sans MUL</td>
<td style="text-align: left;">R0 = 42</td>
</tr>
</tbody>
</table>
<h3 data-number="12.2.2" id="controle-de-flux"><span
class="header-section-number">12.2.2</span> Controle de Flux</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Objectif</th>
<th style="text-align: left;">Resultat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Conditions</td>
<td style="text-align: left;">Maximum de 25 et 17</td>
<td style="text-align: left;">R0 = 25</td>
</tr>
<tr class="even">
<td style="text-align: left;">Valeur Absolue</td>
<td style="text-align: left;">Calculer</td>
<td style="text-align: left;">-42</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Boucles</td>
<td style="text-align: left;">Somme 1 + 2 + … + 10</td>
<td style="text-align: left;">R0 = 55</td>
</tr>
<tr class="even">
<td style="text-align: left;">Multiplication</td>
<td style="text-align: left;">6 * 7 par additions</td>
<td style="text-align: left;">R0 = 42</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Fibonacci</td>
<td style="text-align: left;">Calculer F(10)</td>
<td style="text-align: left;">R0 = 55</td>
</tr>
</tbody>
</table>
<h3 data-number="12.2.3" id="memoire"><span
class="header-section-number">12.2.3</span> Memoire</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Objectif</th>
<th style="text-align: left;">Resultat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Tableaux</td>
<td style="text-align: left;">Somme de {10, 20, 30, 40, 50}</td>
<td style="text-align: left;">R0 = 150</td>
</tr>
<tr class="even">
<td style="text-align: left;">Maximum Tableau</td>
<td style="text-align: left;">Max de {12, 45, 7, 89, 23}</td>
<td style="text-align: left;">R0 = 89</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Memoire</td>
<td style="text-align: left;">Store puis Load</td>
<td style="text-align: left;">R0 = 30</td>
</tr>
</tbody>
</table>
<h3 data-number="12.2.4" id="structures"><span
class="header-section-number">12.2.4</span> Structures</h3>
<p>Ces exercices preparent aux structs en C en montrant comment les
donnees structurees sont organisees en memoire.</p>
<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Objectif</th>
<th style="text-align: left;">Resultat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Structure Simple</td>
<td style="text-align: left;">Lire champs d’un Point (x+y)</td>
<td style="text-align: left;">R0 = 42</td>
</tr>
<tr class="even">
<td style="text-align: left;">Initialiser Structure</td>
<td style="text-align: left;">Ecrire dans les champs d’un Point</td>
<td style="text-align: left;">R0 = 42</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Structure Rectangle</td>
<td style="text-align: left;">Structure avec 4 champs, calcul aire</td>
<td style="text-align: left;">R0 = 42</td>
</tr>
<tr class="even">
<td style="text-align: left;">Tableau de Structures</td>
<td style="text-align: left;">Parcourir tableau de Points, somme des
x</td>
<td style="text-align: left;">R0 = 33</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Somme x+y Structures</td>
<td style="text-align: left;">Acceder aux deux champs de chaque
Point</td>
<td style="text-align: left;">R0 = 42</td>
</tr>
</tbody>
</table>
<h3 data-number="12.2.5" id="fonctions-1"><span
class="header-section-number">12.2.5</span> Fonctions</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Objectif</th>
<th style="text-align: left;">Resultat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Fonctions</td>
<td style="text-align: left;">Fonction double(21)</td>
<td style="text-align: left;">R0 = 42</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fonction Add3</td>
<td style="text-align: left;">add3(10, 15, 17)</td>
<td style="text-align: left;">R0 = 42</td>
</tr>
</tbody>
</table>
<h3 data-number="12.2.6" id="entreessorties"><span
class="header-section-number">12.2.6</span> Entrees/Sorties</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Objectif</th>
<th style="text-align: left;">Resultat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Ecrire Caractere</td>
<td style="text-align: left;">Ecrire ‘A’ a PUTC</td>
<td style="text-align: left;">R0 = 65</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hello String</td>
<td style="text-align: left;">Afficher “Hi”</td>
<td style="text-align: left;">R0 = 2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Print Loop</td>
<td style="text-align: left;">Afficher “ABCD” avec boucle</td>
<td style="text-align: left;">R0 = 4</td>
</tr>
</tbody>
</table>
<h3 data-number="12.2.7" id="ecran-320x240-1-bitpixel"><span
class="header-section-number">12.2.7</span> Ecran (320x240, 1
bit/pixel)</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Objectif</th>
<th style="text-align: left;">Resultat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Pixel</td>
<td style="text-align: left;">Allumer pixel (0,0)</td>
<td style="text-align: left;">R0 = 0x80</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ligne Horizontale</td>
<td style="text-align: left;">8 pixels horizontaux</td>
<td style="text-align: left;">R0 = 0xFF</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ligne Verticale</td>
<td style="text-align: left;">8 pixels verticaux</td>
<td style="text-align: left;">R0 = 8</td>
</tr>
<tr class="even">
<td style="text-align: left;">Rectangle</td>
<td style="text-align: left;">Carre 8x8</td>
<td style="text-align: left;">R0 = 8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Damier</td>
<td style="text-align: left;">Motif en damier</td>
<td style="text-align: left;">R0 = 8</td>
</tr>
</tbody>
</table>
<h3 data-number="12.2.8" id="jeux-interactifs"><span
class="header-section-number">12.2.8</span> Jeux Interactifs</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Objectif</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Lire Caractere</td>
<td style="text-align: left;">Lire clavier et convertir ASCII</td>
</tr>
<tr class="even">
<td style="text-align: left;">Lire 2 Chiffres</td>
<td style="text-align: left;">Former un nombre a 2 chiffres</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Deviner Nombre</td>
<td style="text-align: left;">Jeu de devinette (secret = 7)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Degrade</td>
<td style="text-align: left;">Effet dithering sur ecran</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Recherche Dichotomique</td>
<td style="text-align: left;">Trouver 42 en 7 essais</td>
</tr>
</tbody>
</table>
<h3 data-number="12.2.9" id="cache-patterns-dacces-memoire"><span
class="header-section-number">12.2.9</span> Cache (Patterns d’Acces
Memoire)</h3>
<p>Ces exercices illustrent l’impact des patterns d’acces memoire sur
les performances cache.</p>
<table>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Objectif</th>
<th style="text-align: left;">Resultat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Acces Sequentiel</td>
<td style="text-align: left;">Parcours cache-friendly (adresses
consecutives)</td>
<td style="text-align: left;">R0 = 100</td>
</tr>
<tr class="even">
<td style="text-align: left;">Acces avec Stride</td>
<td style="text-align: left;">Parcours avec sauts de 16 bytes (moins
efficace)</td>
<td style="text-align: left;">R0 = 28</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Reutilisation Registre</td>
<td style="text-align: left;">Charger une fois, reutiliser plusieurs
fois</td>
<td style="text-align: left;">R0 = 91</td>
</tr>
</tbody>
</table>
<hr />
<h2 data-number="12.3" id="c.-exercices-c32"><span
class="header-section-number">12.3</span> C. Exercices C32</h2>
<p>Ces exercices enseignent la programmation en C32.</p>
<h3 data-number="12.3.1" id="bases-1"><span
class="header-section-number">12.3.1</span> Bases</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Objectif</th>
<th style="text-align: left;">Resultat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Variables</td>
<td style="text-align: left;">x=10, y=32, retourner x+y</td>
<td style="text-align: left;">42</td>
</tr>
<tr class="even">
<td style="text-align: left;">Expressions</td>
<td style="text-align: left;">(5+3)*(10-4)/2</td>
<td style="text-align: left;">24</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Modulo</td>
<td style="text-align: left;">(100%7) + (45%8)</td>
<td style="text-align: left;">7</td>
</tr>
<tr class="even">
<td style="text-align: left;">Incrementation</td>
<td style="text-align: left;">5 -&gt; +3 -&gt; *2 -&gt; -1</td>
<td style="text-align: left;">15</td>
</tr>
</tbody>
</table>
<h3 data-number="12.3.2" id="conditions"><span
class="header-section-number">12.3.2</span> Conditions</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Objectif</th>
<th style="text-align: left;">Resultat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Conditions</td>
<td style="text-align: left;">Maximum de 25 et 17</td>
<td style="text-align: left;">25</td>
</tr>
<tr class="even">
<td style="text-align: left;">Else-If</td>
<td style="text-align: left;">Classifier note 75</td>
<td style="text-align: left;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Operateurs Logiques</td>
<td style="text-align: left;">15 dans [10,20] ?</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Maximum de 3</td>
<td style="text-align: left;">Max de 15, 42, 27</td>
<td style="text-align: left;">42</td>
</tr>
</tbody>
</table>
<h3 data-number="12.3.3" id="boucles"><span
class="header-section-number">12.3.3</span> Boucles</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Objectif</th>
<th style="text-align: left;">Resultat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Boucle For</td>
<td style="text-align: left;">Somme 1 a 10</td>
<td style="text-align: left;">55</td>
</tr>
<tr class="even">
<td style="text-align: left;">Boucle While</td>
<td style="text-align: left;">Compter chiffres de 12345</td>
<td style="text-align: left;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Boucles Imbriquees</td>
<td style="text-align: left;">Double boucle i*j</td>
<td style="text-align: left;">60</td>
</tr>
<tr class="even">
<td style="text-align: left;">Multiplication</td>
<td style="text-align: left;">7<em>8 sans operateur </em></td>
<td style="text-align: left;">56</td>
</tr>
</tbody>
</table>
<h3 data-number="12.3.4" id="fonctions-2"><span
class="header-section-number">12.3.4</span> Fonctions</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Objectif</th>
<th style="text-align: left;">Resultat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Fonctions</td>
<td style="text-align: left;">square(7)</td>
<td style="text-align: left;">49</td>
</tr>
<tr class="even">
<td style="text-align: left;">Parametres Multiples</td>
<td style="text-align: left;">add3(10, 20, 12)</td>
<td style="text-align: left;">42</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Valeur Absolue</td>
<td style="text-align: left;">abs(-15) + abs(10)</td>
<td style="text-align: left;">25</td>
</tr>
<tr class="even">
<td style="text-align: left;">Min et Max</td>
<td style="text-align: left;">max(10,25) - min(10,25)</td>
<td style="text-align: left;">15</td>
</tr>
</tbody>
</table>
<h3 data-number="12.3.5" id="tableaux-1"><span
class="header-section-number">12.3.5</span> Tableaux</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Objectif</th>
<th style="text-align: left;">Resultat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Tableaux</td>
<td style="text-align: left;">Somme de {3,7,2,9,5}</td>
<td style="text-align: left;">26</td>
</tr>
<tr class="even">
<td style="text-align: left;">Maximum Tableau</td>
<td style="text-align: left;">Max de 6 elements</td>
<td style="text-align: left;">56</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Compter Elements</td>
<td style="text-align: left;">Nombres pairs</td>
<td style="text-align: left;">4</td>
</tr>
</tbody>
</table>
<h3 data-number="12.3.6" id="pointeurs-1"><span
class="header-section-number">12.3.6</span> Pointeurs</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Objectif</th>
<th style="text-align: left;">Resultat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Pointeurs</td>
<td style="text-align: left;">Modifier via *p</td>
<td style="text-align: left;">42</td>
</tr>
<tr class="even">
<td style="text-align: left;">Swap</td>
<td style="text-align: left;">Echanger x et y</td>
<td style="text-align: left;">20</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pointeurs et Tableaux</td>
<td style="text-align: left;">Somme avec *(p+i)</td>
<td style="text-align: left;">50</td>
</tr>
</tbody>
</table>
<h3 data-number="12.3.7" id="operations-binaires"><span
class="header-section-number">12.3.7</span> Operations Binaires</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Objectif</th>
<th style="text-align: left;">Resultat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Operations Binaires</td>
<td style="text-align: left;">(10&amp;12)</td>
<td style="text-align: left;">(10^12)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Puissance de 2</td>
<td style="text-align: left;">is_pow2(16)+is_pow2(15)+is_pow2(32)</td>
<td style="text-align: left;">2</td>
</tr>
</tbody>
</table>
<h3 data-number="12.3.8" id="recursion"><span
class="header-section-number">12.3.8</span> Recursion</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Objectif</th>
<th style="text-align: left;">Resultat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Factorielle</td>
<td style="text-align: left;">fact(5)</td>
<td style="text-align: left;">120</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fibonacci</td>
<td style="text-align: left;">fib(10)</td>
<td style="text-align: left;">55</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Somme Recursive</td>
<td style="text-align: left;">sum(10)</td>
<td style="text-align: left;">55</td>
</tr>
</tbody>
</table>
<h3 data-number="12.3.9" id="algorithmes-avances"><span
class="header-section-number">12.3.9</span> Algorithmes Avances</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Objectif</th>
<th style="text-align: left;">Resultat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">PGCD (Euclide)</td>
<td style="text-align: left;">gcd(48, 18)</td>
<td style="text-align: left;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">Puissance</td>
<td style="text-align: left;">power(2, 10)</td>
<td style="text-align: left;">1024</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Test Primalite</td>
<td style="text-align: left;">Premiers &lt;= 20</td>
<td style="text-align: left;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">Tri a Bulles</td>
<td style="text-align: left;">Trier et retourner min</td>
<td style="text-align: left;">12</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Recherche Binaire</td>
<td style="text-align: left;">Trouver 23 dans tableau</td>
<td style="text-align: left;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">Inverser Tableau</td>
<td style="text-align: left;">Inverser {1,2,3,4,5}</td>
<td style="text-align: left;">35</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Somme Chiffres</td>
<td style="text-align: left;">digit_sum(12345)</td>
<td style="text-align: left;">15</td>
</tr>
<tr class="even">
<td style="text-align: left;">Palindrome</td>
<td style="text-align: left;">12321 + 1221 + 123</td>
<td style="text-align: left;">2</td>
</tr>
</tbody>
</table>
<h3 data-number="12.3.10" id="structures-1"><span
class="header-section-number">12.3.10</span> Structures</h3>
<p>Les structures permettent de regrouper plusieurs variables liees.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Objectif</th>
<th style="text-align: left;">Resultat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Definition Struct</td>
<td style="text-align: left;">struct Point, p.x + p.y</td>
<td style="text-align: left;">42</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pointeur Struct</td>
<td style="text-align: left;">Utiliser l’operateur -&gt;</td>
<td style="text-align: left;">42</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Struct et Fonctions</td>
<td style="text-align: left;">distance_sq(Point*)</td>
<td style="text-align: left;">25</td>
</tr>
<tr class="even">
<td style="text-align: left;">Structs Imbriquees</td>
<td style="text-align: left;">Rectangle avec Point</td>
<td style="text-align: left;">42</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Tableau de Structs</td>
<td style="text-align: left;">Point[3], somme des x</td>
<td style="text-align: left;">33</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sizeof Struct</td>
<td style="text-align: left;">Taille des structures</td>
<td style="text-align: left;">16</td>
</tr>
</tbody>
</table>
<h3 data-number="12.3.11" id="cache-patterns-dacces-memoire-1"><span
class="header-section-number">12.3.11</span> Cache (Patterns d’Acces
Memoire)</h3>
<p>Ces exercices illustrent l’impact de la localite sur les performances
cache.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Objectif</th>
<th style="text-align: left;">Resultat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Parcours en Ligne</td>
<td style="text-align: left;">Parcours row-major (cache-friendly)</td>
<td style="text-align: left;">120</td>
</tr>
<tr class="even">
<td style="text-align: left;">Parcours en Colonne</td>
<td style="text-align: left;">Parcours column-major (moins
efficace)</td>
<td style="text-align: left;">120</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Traitement par Blocs</td>
<td style="text-align: left;">Technique de blocking</td>
<td style="text-align: left;">120</td>
</tr>
<tr class="even">
<td style="text-align: left;">Localite Temporelle</td>
<td style="text-align: left;">Reutiliser les donnees en cache</td>
<td style="text-align: left;">30</td>
</tr>
</tbody>
</table>
<h3 data-number="12.3.12" id="entreessorties-1"><span
class="header-section-number">12.3.12</span> Entrees/Sorties</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Objectif</th>
<th style="text-align: left;">Resultat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Ecrire Caractere</td>
<td style="text-align: left;">putchar(65)</td>
<td style="text-align: left;">65</td>
</tr>
<tr class="even">
<td style="text-align: left;">Afficher Chaine</td>
<td style="text-align: left;">print(“HI”)</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Afficher Nombre</td>
<td style="text-align: left;">print_int(42)</td>
<td style="text-align: left;">42</td>
</tr>
<tr class="even">
<td style="text-align: left;">Dessiner Pixel</td>
<td style="text-align: left;">Pixel (0,0)</td>
<td style="text-align: left;">128</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ligne Horizontale</td>
<td style="text-align: left;">16 pixels</td>
<td style="text-align: left;">16</td>
</tr>
<tr class="even">
<td style="text-align: left;">Dessiner Rectangle</td>
<td style="text-align: left;">Carre 8x8</td>
<td style="text-align: left;">64</td>
</tr>
</tbody>
</table>
<h3 data-number="12.3.13" id="projets-avances"><span
class="header-section-number">12.3.13</span> Projets Avances</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Objectif</th>
<th style="text-align: left;">Resultat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Crible Eratosthene</td>
<td style="text-align: left;">Premiers &lt;= 50</td>
<td style="text-align: left;">15</td>
</tr>
<tr class="even">
<td style="text-align: left;">Suite Collatz</td>
<td style="text-align: left;">Longueur pour n=27</td>
<td style="text-align: left;">112</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Projet Final</td>
<td style="text-align: left;">Diviseurs de 28</td>
<td style="text-align: left;">28</td>
</tr>
</tbody>
</table>
<hr />
<h2 data-number="12.4" id="d.-construction-du-compilateur"><span
class="header-section-number">12.4</span> D. Construction du
Compilateur</h2>
<p>Ces exercices construisent progressivement un compilateur C -&gt;
A32.</p>
<h3 data-number="12.4.1" id="phase-1-lexer"><span
class="header-section-number">12.4.1</span> Phase 1 : Lexer</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1.1 Reconnaitre Chiffre</td>
<td style="text-align: left;"><code>is_digit(c)</code> : retourne 1 si
‘0’-‘9’</td>
</tr>
<tr class="even">
<td style="text-align: left;">1.2 Lire Nombre</td>
<td style="text-align: left;"><code>parse_number(s, pos)</code> :
extrait un entier</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1.3 Identifier Tokens</td>
<td style="text-align: left;"><code>next_token()</code> : retourne type
du token</td>
</tr>
</tbody>
</table>
<h3 data-number="12.4.2" id="phase-2-parser"><span
class="header-section-number">12.4.2</span> Phase 2 : Parser</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">2.1 Evaluer a + b</td>
<td style="text-align: left;">Parser et calculer une operation</td>
</tr>
<tr class="even">
<td style="text-align: left;">2.2 Evaluer a + b + c</td>
<td style="text-align: left;">Chaine d’operations gauche a droite</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2.3 Precedence</td>
<td style="text-align: left;">Descente recursive : <code>*</code> avant
<code>+</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">2.4 Parentheses</td>
<td style="text-align: left;">Supporter <code>(2 + 3) * 4</code></td>
</tr>
</tbody>
</table>
<h3 data-number="12.4.3" id="phase-3-emission-asm"><span
class="header-section-number">12.4.3</span> Phase 3 : Emission ASM</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">3.1 Generer MOV</td>
<td style="text-align: left;">Produire <code>"MOV R0, #42"</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">3.2 Operation Binaire</td>
<td style="text-align: left;">Mapper <code>+</code> -&gt;
<code>ADD</code>, <code>*</code> -&gt; <code>MUL</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">3.3 Comparaison</td>
<td style="text-align: left;">Generer <code>CMP</code> et
conditions</td>
</tr>
</tbody>
</table>
<h3 data-number="12.4.4" id="phase-4-codegen-expressions-1"><span
class="header-section-number">12.4.4</span> Phase 4 : CodeGen
Expressions</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">4.1 Constante -&gt; A32</td>
<td style="text-align: left;">Code pour charger une constante</td>
</tr>
<tr class="even">
<td style="text-align: left;">4.2 Addition -&gt; A32</td>
<td style="text-align: left;"><code>a + b</code> -&gt;
<code>MOV/MOV/ADD</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">4.3 Expression -&gt; A32</td>
<td style="text-align: left;">Expression complete avec precedence</td>
</tr>
</tbody>
</table>
<h3 data-number="12.4.5" id="phase-5-structures-de-controle"><span
class="header-section-number">12.4.5</span> Phase 5 : Structures de
Controle</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">5.1 If/Else -&gt; A32</td>
<td style="text-align: left;">Sauts conditionnels et labels</td>
</tr>
<tr class="even">
<td style="text-align: left;">5.2 While -&gt; A32</td>
<td style="text-align: left;">Boucles avec labels</td>
</tr>
</tbody>
</table>
<h3 data-number="12.4.6" id="phase-6-fonctions-1"><span
class="header-section-number">12.4.6</span> Phase 6 : Fonctions</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">6.1 Prologue/Epilogue</td>
<td style="text-align: left;">Sauvegarder LR, reserver pile</td>
</tr>
<tr class="even">
<td style="text-align: left;">6.2 Appel de Fonction</td>
<td style="text-align: left;">Arguments et BL</td>
</tr>
</tbody>
</table>
<h3 data-number="12.4.7" id="phase-7-projet-final-1"><span
class="header-section-number">12.4.7</span> Phase 7 : Projet Final</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">7.1 Mini-Compilateur</td>
<td style="text-align: left;">Compiler expression en A32 executable</td>
</tr>
</tbody>
</table>
<hr />
<h2 data-number="12.5" id="e.-systeme-dexploitation"><span
class="header-section-number">12.5</span> E. Systeme d’Exploitation</h2>
<p>Ces exercices introduisent les concepts OS.</p>
<h3 data-number="12.5.1" id="initialisation"><span
class="header-section-number">12.5.1</span> Initialisation</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">Resultat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Bootstrap</td>
<td style="text-align: left;">Initialiser SP, effacer BSS, appeler
main</td>
<td style="text-align: left;">42</td>
</tr>
</tbody>
</table>
<h3 data-number="12.5.2" id="gestion-memoire"><span
class="header-section-number">12.5.2</span> Gestion Memoire</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">Resultat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Bump Allocator</td>
<td style="text-align: left;">Allocation simple par incrementation</td>
<td style="text-align: left;">100</td>
</tr>
<tr class="even">
<td style="text-align: left;">Free List</td>
<td style="text-align: left;">Allocateur avec liberation</td>
<td style="text-align: left;">1</td>
</tr>
</tbody>
</table>
<h3 data-number="12.5.3" id="drivers"><span
class="header-section-number">12.5.3</span> Drivers</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">Resultat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Driver Ecran</td>
<td style="text-align: left;">Fonctions set_pixel, clear_screen</td>
<td style="text-align: left;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Police Bitmap</td>
<td style="text-align: left;">Dessiner caracteres 8x8</td>
<td style="text-align: left;">51</td>
</tr>
</tbody>
</table>
<h3 data-number="12.5.4" id="console-et-clavier"><span
class="header-section-number">12.5.4</span> Console et Clavier</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">Resultat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Console</td>
<td style="text-align: left;">Console texte avec curseur (40x30)</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Driver Clavier</td>
<td style="text-align: left;">Lire les touches, buffer clavier</td>
<td style="text-align: left;">3</td>
</tr>
</tbody>
</table>
<h3 data-number="12.5.5" id="shell-et-applications"><span
class="header-section-number">12.5.5</span> Shell et Applications</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">Resultat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Shell</td>
<td style="text-align: left;">Interpreteur de commandes basique</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Calculatrice</td>
<td style="text-align: left;">Evaluer expressions arithmetiques</td>
<td style="text-align: left;">42</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Variables Shell</td>
<td style="text-align: left;">Variables dans le shell ($x, $y)</td>
<td style="text-align: left;">15</td>
</tr>
<tr class="even">
<td style="text-align: left;">Compte a Rebours</td>
<td style="text-align: left;">Timer avec affichage</td>
<td style="text-align: left;">0</td>
</tr>
</tbody>
</table>
<h3 data-number="12.5.6" id="multitache"><span
class="header-section-number">12.5.6</span> Multitache</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">Resultat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Interruptions</td>
<td style="text-align: left;">Gestion des interruptions timer</td>
<td style="text-align: left;">10</td>
</tr>
<tr class="even">
<td style="text-align: left;">Coroutines</td>
<td style="text-align: left;">Changement de contexte manuel</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Scheduler</td>
<td style="text-align: left;">Ordonnanceur round-robin</td>
<td style="text-align: left;">6</td>
</tr>
</tbody>
</table>
<h3 data-number="12.5.7" id="projets-os"><span
class="header-section-number">12.5.7</span> Projets OS</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Projet 1: Mini-OS Shell</td>
<td style="text-align: left;">Shell complet avec commandes</td>
</tr>
<tr class="even">
<td style="text-align: left;">Projet 2: Task Manager</td>
<td style="text-align: left;">Gestionnaire de taches multiples</td>
</tr>
</tbody>
</table>
<hr />
<h2 data-number="12.6" id="conseils-pour-les-exercices"><span
class="header-section-number">12.6</span> Conseils pour les
Exercices</h2>
<ol type="1">
<li><strong>Commencez simple</strong> : Les premiers exercices de chaque
section sont accessibles</li>
<li><strong>Lisez l’enonce</strong> : Chaque exercice contient des
indices</li>
<li><strong>Testez souvent</strong> : Le simulateur execute votre code
instantanement</li>
<li><strong>Consultez les solutions</strong> : Apres avoir essaye,
comparez avec la solution</li>
<li><strong>Progressez</strong> : Chaque exercice prepare le
suivant</li>
</ol>
<hr />
<p><strong>Bon courage !</strong></p>
<h1 data-number="13" id="lart-du-débogage"><span
class="header-section-number">13</span> L’Art du Débogage</h1>
<blockquote>
<p>“Le débogage, c’est comme être détective dans un film policier où
vous êtes aussi le meurtrier.” — Filipe Fortes</p>
</blockquote>
<p>Le débogage est une compétence fondamentale en programmation. Ce
chapitre vous apprend à trouver et corriger les erreurs de manière
méthodique.</p>
<hr />
<h2 data-number="13.1" id="pourquoi-ce-chapitre"><span
class="header-section-number">13.1</span> Pourquoi ce Chapitre ?</h2>
<p>Vous avez appris à construire des circuits, écrire de l’assembleur,
et utiliser un compilateur. Mais que faire quand <strong>ça ne marche
pas</strong> ?</p>
<p>Ce chapitre couvre : 1. Comment lire les messages d’erreur 2. Comment
utiliser le simulateur pas-à-pas 3. Les erreurs les plus courantes et
leurs solutions 4. Une méthodologie systématique de débogage</p>
<hr />
<h2 data-number="13.2" id="comprendre-les-messages-derreur"><span
class="header-section-number">13.2</span> 1. Comprendre les Messages
d’Erreur</h2>
<h3 data-number="13.2.1" id="codes-derreur-du-projet-codex"><span
class="header-section-number">13.2.1</span> Codes d’Erreur du Projet
Codex</h3>
<p>Les outils du projet utilisent des codes d’erreur standardisés :</p>
<table>
<thead>
<tr class="header">
<th>Préfixe</th>
<th>Source</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>E1xxx</strong></td>
<td>Assembleur</td>
<td>Erreurs d’assemblage</td>
</tr>
<tr class="even">
<td><strong>E2xxx</strong></td>
<td>Compilateur C32</td>
<td>Erreurs de compilation</td>
</tr>
<tr class="odd">
<td><strong>E3xxx</strong></td>
<td>Linker</td>
<td>Erreurs de liaison</td>
</tr>
</tbody>
</table>
<h3 data-number="13.2.2" id="erreurs-dassemblage-e1xxx"><span
class="header-section-number">13.2.2</span> Erreurs d’Assemblage
(E1xxx)</h3>
<table>
<colgroup>
<col style="width: 19%" />
<col style="width: 48%" />
<col style="width: 32%" />
</colgroup>
<thead>
<tr class="header">
<th>Code</th>
<th>Signification</th>
<th>Solution</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>E1001</td>
<td>Mnémonique inconnu</td>
<td>Vérifiez l’orthographe de l’instruction</td>
</tr>
<tr class="even">
<td>E1002</td>
<td>Opérande invalide</td>
<td>Vérifiez le format des registres/immédiats</td>
</tr>
<tr class="odd">
<td>E1003</td>
<td>Label non défini</td>
<td>Ajoutez le label ou corrigez son nom</td>
</tr>
<tr class="even">
<td>E1004</td>
<td>Immédiat hors plage</td>
<td>Utilisez <code>LDR R0, =value</code> pour les grandes valeurs</td>
</tr>
<tr class="odd">
<td>E1005</td>
<td>Registre invalide</td>
<td>Utilisez R0-R15 uniquement</td>
</tr>
<tr class="even">
<td>E1008</td>
<td>Literal pool overflow</td>
<td>Placez <code>.ltorg</code> plus tôt dans le code</td>
</tr>
</tbody>
</table>
<p><strong>Exemple</strong> : Erreur E1004</p>
<div class="sourceCode" id="cb139"><pre
class="sourceCode asm"><code class="sourceCode fasm"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co">; ERREUR : L&#39;immédiat 0x12345678 ne tient pas sur 12 bits</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="bu">MOV</span> R0<span class="op">,</span> <span class="op">#</span><span class="bn">0x12345678</span></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a><span class="co">; SOLUTION : Utiliser le literal pool</span></span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>LDR R0<span class="op">,</span> <span class="op">=</span><span class="bn">0x12345678</span></span></code></pre></div>
<h3 data-number="13.2.3" id="erreurs-de-compilation-e2xxx"><span
class="header-section-number">13.2.3</span> Erreurs de Compilation
(E2xxx)</h3>
<table>
<colgroup>
<col style="width: 19%" />
<col style="width: 48%" />
<col style="width: 32%" />
</colgroup>
<thead>
<tr class="header">
<th>Code</th>
<th>Signification</th>
<th>Solution</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>E2001</td>
<td>Erreur de syntaxe</td>
<td>Vérifiez les parenthèses, points-virgules</td>
</tr>
<tr class="even">
<td>E2002</td>
<td>Type incompatible</td>
<td>Vérifiez les types des opérandes</td>
</tr>
<tr class="odd">
<td>E2003</td>
<td>Variable non déclarée</td>
<td>Déclarez la variable avant utilisation</td>
</tr>
<tr class="even">
<td>E2004</td>
<td>Fonction non définie</td>
<td>Définissez la fonction ou incluez le header</td>
</tr>
<tr class="odd">
<td>E2008</td>
<td>Return manquant</td>
<td>Ajoutez <code>return</code> à la fin de la fonction</td>
</tr>
</tbody>
</table>
<p><strong>Exemple</strong> : Erreur E2003</p>
<div class="sourceCode" id="cb140"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co">// ERREUR : &#39;x&#39; non déclaré</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> <span class="dv">5</span><span class="op">;</span>  <span class="co">// E2003: Variable &#39;x&#39; non déclarée</span></span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a><span class="co">// SOLUTION : Déclarer la variable</span></span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb140-9"><a href="#cb140-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> x<span class="op">;</span></span>
<span id="cb140-10"><a href="#cb140-10" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> <span class="dv">5</span><span class="op">;</span></span>
<span id="cb140-11"><a href="#cb140-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb140-12"><a href="#cb140-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 data-number="13.2.4" id="erreurs-de-liaison-e3xxx"><span
class="header-section-number">13.2.4</span> Erreurs de Liaison
(E3xxx)</h3>
<table>
<colgroup>
<col style="width: 19%" />
<col style="width: 48%" />
<col style="width: 32%" />
</colgroup>
<thead>
<tr class="header">
<th>Code</th>
<th>Signification</th>
<th>Solution</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>E3001</td>
<td>Symbole non résolu</td>
<td>Définissez le symbole ou liez la bibliothèque</td>
</tr>
<tr class="even">
<td>E3002</td>
<td>Point d’entrée manquant</td>
<td>Ajoutez <code>_start:</code> ou <code>main()</code></td>
</tr>
<tr class="odd">
<td>E3004</td>
<td>Débordement mémoire</td>
<td>Réduisez la taille du programme</td>
</tr>
</tbody>
</table>
<hr />
<h2 data-number="13.3" id="utiliser-le-simulateur-pas-à-pas"><span
class="header-section-number">13.3</span> 2. Utiliser le Simulateur
Pas-à-Pas</h2>
<h3 data-number="13.3.1" id="le-visualiseur-cpu"><span
class="header-section-number">13.3.1</span> Le Visualiseur CPU</h3>
<p>Le visualiseur web (<code>web/visualizer.html</code>) est votre
meilleur ami pour déboguer.</p>
<p><strong>Fonctionnalités clés</strong> : - <strong>Step (N ou
F10)</strong> : Exécute une instruction - <strong>Registres</strong> :
Voir R0-R15, SP, LR, PC et les flags - <strong>Mémoire</strong> :
Inspecter la RAM - <strong>Code</strong> : Ligne courante surlignée</p>
<h3 data-number="13.3.2" id="méthodologie-de-débogage-pas-à-pas"><span
class="header-section-number">13.3.2</span> Méthodologie de Débogage
Pas-à-Pas</h3>
<ol type="1">
<li><strong>Chargez votre programme</strong> dans le visualiseur</li>
<li><strong>Identifiez le symptôme</strong> : Qu’est-ce qui ne va pas
?</li>
<li><strong>Formulez une hypothèse</strong> : Où le bug pourrait-il être
?</li>
<li><strong>Placez-vous avant</strong> la zone suspecte</li>
<li><strong>Exécutez pas-à-pas</strong> en vérifiant les registres</li>
<li><strong>Trouvez la divergence</strong> : Où le comportement
diffère-t-il de l’attendu ?</li>
</ol>
<h3 data-number="13.3.3" id="exemple-pratique"><span
class="header-section-number">13.3.3</span> Exemple Pratique</h3>
<p><strong>Programme bugué</strong> :</p>
<div class="sourceCode" id="cb141"><pre
class="sourceCode asm"><code class="sourceCode fasm"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co">; Censé calculer 5 + 3 = 8</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">5</span></span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R1<span class="op">,</span> <span class="op">#</span><span class="dv">3</span></span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">SUB</span> R2<span class="op">,</span> R0<span class="op">,</span> R1   <span class="co">; </span><span class="al">BUG</span><span class="co"> : devrait être ADD !</span></span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>    SVC <span class="op">#</span><span class="dv">0</span></span></code></pre></div>
<p><strong>Débogage</strong> : 1. Après <code>MOV R0, #5</code> : R0 = 5
✓ 2. Après <code>MOV R1, #3</code> : R1 = 3 ✓ 3. Après
<code>SUB R2, R0, R1</code> : R2 = 2 ✗ (attendu : 8)</p>
<p>→ <strong>Bug trouvé</strong> : <code>SUB</code> au lieu de
<code>ADD</code></p>
<hr />
<h2 data-number="13.4" id="erreurs-courantes-et-solutions"><span
class="header-section-number">13.4</span> 3. Erreurs Courantes et
Solutions</h2>
<h3 data-number="13.4.1" id="assembleur"><span
class="header-section-number">13.4.1</span> 3.1 Assembleur</h3>
<h4 data-number="13.4.1.1" id="oubli-de-sauvegarder-lr"><span
class="header-section-number">13.4.1.1</span> Oubli de sauvegarder
LR</h4>
<p><strong>Symptôme</strong> : Le programme ne retourne pas correctement
d’une fonction.</p>
<div class="sourceCode" id="cb142"><pre
class="sourceCode asm"><code class="sourceCode fasm"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co">; BUGUÉ</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="fu">my_func:</span></span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>    BL other_func    <span class="co">; LR est écrasé !</span></span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>    BX LR            <span class="co">; Retourne... où ?</span></span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a><span class="co">; CORRECT</span></span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a><span class="fu">my_func:</span></span>
<span id="cb142-8"><a href="#cb142-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">PUSH</span> <span class="op">{</span>LR<span class="op">}</span>        <span class="co">; Sauvegarder LR</span></span>
<span id="cb142-9"><a href="#cb142-9" aria-hidden="true" tabindex="-1"></a>    BL other_func</span>
<span id="cb142-10"><a href="#cb142-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">POP</span> <span class="op">{</span>LR<span class="op">}</span>         <span class="co">; Restaurer LR</span></span>
<span id="cb142-11"><a href="#cb142-11" aria-hidden="true" tabindex="-1"></a>    BX LR</span></code></pre></div>
<h4 data-number="13.4.1.2" id="off-by-one-dans-les-boucles"><span
class="header-section-number">13.4.1.2</span> Off-by-one dans les
boucles</h4>
<p><strong>Symptôme</strong> : La boucle s’exécute une fois de trop ou
de moins.</p>
<div class="sourceCode" id="cb143"><pre
class="sourceCode asm"><code class="sourceCode fasm"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co">; BUGUÉ : S&#39;arrête à 9 au lieu de 10</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">MOV</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">0</span></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a><span class="fu">loop:</span></span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">CMP</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">10</span></span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>    BEQ done         <span class="co">; BEQ : si R0 == 10, sauter</span></span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">; ... corps de la boucle ...</span></span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R0<span class="op">,</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">1</span></span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a>    B loop</span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a><span class="fu">done:</span></span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-11"><a href="#cb143-11" aria-hidden="true" tabindex="-1"></a><span class="co">; Vérifiez toujours : combien d&#39;itérations attendues ?</span></span>
<span id="cb143-12"><a href="#cb143-12" aria-hidden="true" tabindex="-1"></a><span class="co">; R0 va de 0 à 9 = 10 itérations ✓</span></span></code></pre></div>
<h4 data-number="13.4.1.3" id="mauvais-alignement-mémoire"><span
class="header-section-number">13.4.1.3</span> Mauvais alignement
mémoire</h4>
<p><strong>Symptôme</strong> : Erreur MISALIGNED ou données
corrompues.</p>
<div class="sourceCode" id="cb144"><pre
class="sourceCode asm"><code class="sourceCode fasm"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co">; BUGUÉ : Adresse non alignée sur 4 octets</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>    LDR R0<span class="op">,</span> <span class="op">[</span>R1<span class="op">,</span> <span class="op">#</span><span class="dv">3</span><span class="op">]</span>   <span class="co">; 3 n&#39;est pas multiple de 4 !</span></span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a><span class="co">; CORRECT</span></span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>    LDR R0<span class="op">,</span> <span class="op">[</span>R1<span class="op">,</span> <span class="op">#</span><span class="dv">4</span><span class="op">]</span>   <span class="co">; OK : 4 est multiple de 4</span></span></code></pre></div>
<h3 data-number="13.4.2" id="compilateur-c32"><span
class="header-section-number">13.4.2</span> 3.2 Compilateur C32</h3>
<h4 data-number="13.4.2.1" id="oubli-du-return"><span
class="header-section-number">13.4.2.1</span> Oubli du return</h4>
<p><strong>Symptôme</strong> : Valeur de retour incorrecte ou
aléatoire.</p>
<div class="sourceCode" id="cb145"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co">// BUGUÉ</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> add<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> c <span class="op">=</span> a <span class="op">+</span> b<span class="op">;</span></span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Oops, pas de return !</span></span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a><span class="co">// CORRECT</span></span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> add<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> c <span class="op">=</span> a <span class="op">+</span> b<span class="op">;</span></span>
<span id="cb145-10"><a href="#cb145-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> c<span class="op">;</span></span>
<span id="cb145-11"><a href="#cb145-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h4 data-number="13.4.2.2" id="confusion-pointeurvaleur"><span
class="header-section-number">13.4.2.2</span> Confusion
pointeur/valeur</h4>
<p><strong>Symptôme</strong> : Crash ou données incorrectes.</p>
<div class="sourceCode" id="cb146"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co">// BUGUÉ</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> increment<span class="op">(</span><span class="dt">int</span> x<span class="op">)</span> <span class="op">{</span></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> x <span class="op">+</span> <span class="dv">1</span><span class="op">;</span>  <span class="co">// Modifie la COPIE, pas l&#39;original !</span></span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a><span class="co">// CORRECT</span></span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> increment<span class="op">(</span><span class="dt">int</span> <span class="op">*</span>x<span class="op">)</span> <span class="op">{</span></span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span>x <span class="op">=</span> <span class="op">*</span>x <span class="op">+</span> <span class="dv">1</span><span class="op">;</span>  <span class="co">// Modifie la valeur POINTÉE</span></span>
<span id="cb146-9"><a href="#cb146-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb146-10"><a href="#cb146-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-11"><a href="#cb146-11" aria-hidden="true" tabindex="-1"></a><span class="co">// Appel</span></span>
<span id="cb146-12"><a href="#cb146-12" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> n <span class="op">=</span> <span class="dv">5</span><span class="op">;</span></span>
<span id="cb146-13"><a href="#cb146-13" aria-hidden="true" tabindex="-1"></a>increment<span class="op">(&amp;</span>n<span class="op">);</span>  <span class="co">// Passer l&#39;ADRESSE</span></span></code></pre></div>
<h4 data-number="13.4.2.3" id="division-par-zéro"><span
class="header-section-number">13.4.2.3</span> Division par zéro</h4>
<p><strong>Symptôme</strong> : Trap DIV_ZERO ou résultat infini.</p>
<div class="sourceCode" id="cb147"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co">// BUGUÉ</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> divide<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> a <span class="op">/</span> b<span class="op">;</span>  <span class="co">// Et si b == 0 ?</span></span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a><span class="co">// CORRECT</span></span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> divide<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb147-8"><a href="#cb147-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>b <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb147-9"><a href="#cb147-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span>  <span class="co">// Ou gérer l&#39;erreur autrement</span></span>
<span id="cb147-10"><a href="#cb147-10" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb147-11"><a href="#cb147-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> a <span class="op">/</span> b<span class="op">;</span></span>
<span id="cb147-12"><a href="#cb147-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<h3 data-number="13.4.3" id="hdl"><span
class="header-section-number">13.4.3</span> 3.3 HDL</h3>
<h4 data-number="13.4.3.1" id="signal-non-connecté"><span
class="header-section-number">13.4.3.1</span> Signal non connecté</h4>
<p><strong>Symptôme</strong> : Sortie toujours à 0 ou X (indéfini).</p>
<div class="sourceCode" id="cb148"><pre
class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- BUGUÉ : &#39;result&#39; n&#39;est jamais assigné</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="cf">entity</span> <span class="dv">Adder</span> <span class="kw">is</span></span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">port</span>(a<span class="ot">,</span> b <span class="ot">:</span> <span class="kw">in</span> <span class="dt">bit</span>; result <span class="ot">:</span> <span class="kw">out</span> <span class="dt">bit</span>);</span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a><span class="cf">end entity;</span></span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">rtl</span> <span class="kw">of</span> <span class="fu">Adder</span> <span class="kw">is</span></span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">-- Oops, rien ici !</span></span>
<span id="cb148-9"><a href="#cb148-9" aria-hidden="true" tabindex="-1"></a><span class="cf">end architecture;</span></span>
<span id="cb148-10"><a href="#cb148-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-11"><a href="#cb148-11" aria-hidden="true" tabindex="-1"></a><span class="co">-- CORRECT</span></span>
<span id="cb148-12"><a href="#cb148-12" aria-hidden="true" tabindex="-1"></a><span class="cf">architecture</span> <span class="dv">rtl</span> <span class="kw">of</span> <span class="fu">Adder</span> <span class="kw">is</span></span>
<span id="cb148-13"><a href="#cb148-13" aria-hidden="true" tabindex="-1"></a><span class="cf">begin</span></span>
<span id="cb148-14"><a href="#cb148-14" aria-hidden="true" tabindex="-1"></a>  result <span class="ot">&lt;=</span> a <span class="kw">xor</span> b;  <span class="co">-- Connexion explicite</span></span>
<span id="cb148-15"><a href="#cb148-15" aria-hidden="true" tabindex="-1"></a><span class="cf">end architecture;</span></span></code></pre></div>
<h4 data-number="13.4.3.2" id="boucle-combinatoire"><span
class="header-section-number">13.4.3.2</span> Boucle combinatoire</h4>
<p><strong>Symptôme</strong> : Le simulateur ne converge pas ou donne
des résultats instables.</p>
<div class="sourceCode" id="cb149"><pre
class="sourceCode vhdl"><code class="sourceCode vhdl"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- BUGUÉ : &#39;x&#39; dépend de lui-même instantanément</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a><span class="ot">signal</span> x <span class="ot">:</span> <span class="dt">bit</span>;</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;=</span> <span class="kw">not</span> x;  <span class="co">-- Boucle infinie !</span></span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a><span class="co">-- CORRECT : Utiliser une DFF pour la rétroaction</span></span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a><span class="co">-- x(t+1) &lt;= not x(t)  -- Via une DFF</span></span></code></pre></div>
<hr />
<h2 data-number="13.5" id="méthodologie-systématique"><span
class="header-section-number">13.5</span> 4. Méthodologie
Systématique</h2>
<h3 data-number="13.5.1" id="la-méthode-scientifique-du-débogage"><span
class="header-section-number">13.5.1</span> La Méthode Scientifique du
Débogage</h3>
<ol type="1">
<li><strong>Observer</strong> : Quel est le symptôme exact ?
<ul>
<li>Message d’erreur ?</li>
<li>Mauvais résultat ?</li>
<li>Crash ?</li>
</ul></li>
<li><strong>Hypothétiser</strong> : Quelle pourrait être la cause ?
<ul>
<li>Erreur de logique ?</li>
<li>Mauvaise valeur ?</li>
<li>Condition incorrecte ?</li>
</ul></li>
<li><strong>Tester</strong> : Vérifier l’hypothèse
<ul>
<li>Ajouter des prints/traces</li>
<li>Exécuter pas-à-pas</li>
<li>Simplifier le code</li>
</ul></li>
<li><strong>Conclure</strong> : L’hypothèse était-elle correcte ?
<ul>
<li>Si oui → corriger</li>
<li>Si non → nouvelle hypothèse</li>
</ul></li>
</ol>
<h3 data-number="13.5.2" id="la-technique-de-la-bissection"><span
class="header-section-number">13.5.2</span> La Technique de la
Bissection</h3>
<p>Quand le bug est difficile à trouver :</p>
<ol type="1">
<li><strong>Divisez</strong> le code en deux moitiés</li>
<li><strong>Testez</strong> chaque moitié indépendamment</li>
<li><strong>Identifiez</strong> quelle moitié contient le bug</li>
<li><strong>Répétez</strong> jusqu’à isoler le problème</li>
</ol>
<pre><code>Code complet (bug quelque part)
    ├── Première moitié
    │   └── ✓ OK
    └── Deuxième moitié
        └── ✗ Bug ici !
            ├── Premier quart → ✓ OK
            └── Deuxième quart → ✗ Bug trouvé !</code></pre>
<h3 data-number="13.5.3" id="ajouter-des-traces"><span
class="header-section-number">13.5.3</span> Ajouter des Traces</h3>
<p>En C32 :</p>
<div class="sourceCode" id="cb151"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> debug_print<span class="op">(</span><span class="dt">int</span> value<span class="op">)</span> <span class="op">{</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Afficher la valeur pour debug</span></span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>    putc<span class="op">(</span><span class="ch">&#39;[&#39;</span><span class="op">);</span></span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ... afficher value ...</span></span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>    putc<span class="op">(</span><span class="ch">&#39;]&#39;</span><span class="op">);</span></span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a>    putc<span class="op">(</span><span class="ch">&#39;</span><span class="sc">\n</span><span class="ch">&#39;</span><span class="op">);</span></span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb151-10"><a href="#cb151-10" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> x <span class="op">=</span> compute_something<span class="op">();</span></span>
<span id="cb151-11"><a href="#cb151-11" aria-hidden="true" tabindex="-1"></a>    debug_print<span class="op">(</span>x<span class="op">);</span>  <span class="co">// Voir la valeur</span></span>
<span id="cb151-12"><a href="#cb151-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ...</span></span>
<span id="cb151-13"><a href="#cb151-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>En assembleur :</p>
<div class="sourceCode" id="cb152"><pre
class="sourceCode asm"><code class="sourceCode fasm"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="co">; Afficher R0 pour debug (caractère ASCII)</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R0<span class="op">,</span> R0<span class="op">,</span> <span class="op">#</span><span class="st">&#39;0&#39;</span>   <span class="co">; Convertir en ASCII</span></span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>    LDR R1<span class="op">,</span> <span class="op">=</span><span class="bn">0xFFFF0000</span></span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">STR</span> R0<span class="op">,</span> <span class="op">[</span>R1<span class="op">]</span>       <span class="co">; Afficher</span></span></code></pre></div>
<hr />
<h2 data-number="13.6" id="erreurs-de-traps-et-leur-diagnostic"><span
class="header-section-number">13.6</span> 5. Erreurs de Traps et leur
Diagnostic</h2>
<h3 data-number="13.6.1" id="types-de-traps"><span
class="header-section-number">13.6.1</span> Types de Traps</h3>
<table>
<thead>
<tr class="header">
<th>Trap</th>
<th>Cause</th>
<th>Solution</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>DIV_ZERO</td>
<td>Division par 0</td>
<td>Vérifier le diviseur avant</td>
</tr>
<tr class="even">
<td>MEM_FAULT</td>
<td>Accès mémoire invalide</td>
<td>Vérifier les pointeurs</td>
</tr>
<tr class="odd">
<td>MISALIGNED</td>
<td>Adresse non alignée</td>
<td>Aligner sur 4 octets</td>
</tr>
<tr class="even">
<td>ILLEGAL</td>
<td>Instruction invalide</td>
<td>Vérifier l’encodage</td>
</tr>
</tbody>
</table>
<h3 data-number="13.6.2" id="déboguer-un-mem_fault"><span
class="header-section-number">13.6.2</span> Déboguer un MEM_FAULT</h3>
<ol type="1">
<li><strong>Notez l’adresse</strong> du PC quand le trap se produit</li>
<li><strong>Trouvez l’instruction</strong> à cette adresse</li>
<li><strong>Examinez les registres</strong> utilisés pour
l’adressage</li>
<li><strong>Questions à se poser</strong> :
<ul>
<li>Le pointeur est-il initialisé ?</li>
<li>Est-il dans la plage valide (0 - RAM_SIZE) ?</li>
<li>A-t-il été corrompu par une autre partie du code ?</li>
</ul></li>
</ol>
<hr />
<h2 data-number="13.7" id="checklist-de-débogage"><span
class="header-section-number">13.7</span> 6. Checklist de Débogage</h2>
<p>Avant de chercher un bug complexe, vérifiez ces points simples :</p>
<h3 data-number="13.7.1" id="assembleur-1"><span
class="header-section-number">13.7.1</span> Assembleur</h3>
<ul class="task-list">
<li><label><input type="checkbox" />Toutes les instructions sont
correctement orthographiées ?</label></li>
<li><label><input type="checkbox" />Les registres sont dans la plage
R0-R15 ?</label></li>
<li><label><input type="checkbox" />Les immédiats sont dans la plage
autorisée ?</label></li>
<li><label><input type="checkbox" />LR est sauvegardé avant les appels
de fonction ?</label></li>
<li><label><input type="checkbox" />La pile est équilibrée (PUSH = POP)
?</label></li>
<li><label><input type="checkbox" />Les accès mémoire sont alignés sur 4
octets ?</label></li>
</ul>
<h3 data-number="13.7.2" id="c32"><span
class="header-section-number">13.7.2</span> C32</h3>
<ul class="task-list">
<li><label><input type="checkbox" />Toutes les variables sont déclarées
?</label></li>
<li><label><input type="checkbox" />Toutes les fonctions ont un return
?</label></li>
<li><label><input type="checkbox" />Les pointeurs sont initialisés avant
déréférencement ?</label></li>
<li><label><input type="checkbox" />Pas de division par zéro possible
?</label></li>
<li><label><input type="checkbox" />Les indices de tableau sont dans les
bornes ?</label></li>
</ul>
<h3 data-number="13.7.3" id="hdl-1"><span
class="header-section-number">13.7.3</span> HDL</h3>
<ul class="task-list">
<li><label><input type="checkbox" />Toutes les sorties sont assignées
?</label></li>
<li><label><input type="checkbox" />Pas de boucles combinatoires
?</label></li>
<li><label><input type="checkbox" />Les signaux sont de la bonne largeur
(bit vs bits) ?</label></li>
<li><label><input type="checkbox" />Les port maps connectent les bons
signaux ?</label></li>
</ul>
<hr />
<h2 data-number="13.8" id="exercices-de-débogage"><span
class="header-section-number">13.8</span> 7. Exercices de Débogage</h2>
<h3 data-number="13.8.1" id="exercice-1-trouvez-le-bug"><span
class="header-section-number">13.8.1</span> Exercice 1 : Trouvez le
bug</h3>
<div class="sourceCode" id="cb153"><pre
class="sourceCode asm"><code class="sourceCode fasm"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="co">; Programme censé afficher &quot;Hello&quot;</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>    LDR R0<span class="op">,</span> <span class="op">=</span>message</span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>    LDR R1<span class="op">,</span> <span class="op">=</span><span class="bn">0xFFFF0000</span></span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a><span class="fu">loop:</span></span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a>    LDRB R2<span class="op">,</span> <span class="op">[</span>R0<span class="op">]</span></span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">CMP</span> R2<span class="op">,</span> <span class="op">#</span><span class="dv">0</span></span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true" tabindex="-1"></a>    BEQ done</span>
<span id="cb153-8"><a href="#cb153-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">STR</span> R2<span class="op">,</span> <span class="op">[</span>R1<span class="op">]</span></span>
<span id="cb153-9"><a href="#cb153-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">ADD</span> R0<span class="op">,</span> R0<span class="op">,</span> <span class="op">#</span><span class="dv">1</span></span>
<span id="cb153-10"><a href="#cb153-10" aria-hidden="true" tabindex="-1"></a>    B done            <span class="co">; &lt;-- Bug ici !</span></span>
<span id="cb153-11"><a href="#cb153-11" aria-hidden="true" tabindex="-1"></a><span class="fu">done:</span></span>
<span id="cb153-12"><a href="#cb153-12" aria-hidden="true" tabindex="-1"></a>    SVC <span class="op">#</span><span class="dv">0</span></span>
<span id="cb153-13"><a href="#cb153-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-14"><a href="#cb153-14" aria-hidden="true" tabindex="-1"></a><span class="fu">message:</span> .asciz <span class="st">&quot;Hello&quot;</span></span></code></pre></div>
<details>
<summary>
Voir la solution
</summary>
<p>Le bug est <code>B done</code> qui devrait être <code>B loop</code>.
Le programme n’affiche que le premier caractère car il saute directement
à <code>done</code> au lieu de boucler.</p>
<div class="sourceCode" id="cb154"><pre
class="sourceCode asm"><code class="sourceCode fasm"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>    B loop    <span class="co">; CORRECT : retourner au début de la boucle</span></span></code></pre></div>
</details>
<h3 data-number="13.8.2" id="exercice-2-trouvez-le-bug"><span
class="header-section-number">13.8.2</span> Exercice 2 : Trouvez le
bug</h3>
<div class="sourceCode" id="cb155"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> factorial<span class="op">(</span><span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>n <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> n <span class="op">*</span> factorial<span class="op">(</span>n<span class="op">);</span>  <span class="co">// &lt;-- Bug ici !</span></span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<details>
<summary>
Voir la solution
</summary>
<p>Le bug est <code>factorial(n)</code> qui devrait être
<code>factorial(n - 1)</code>. Sans décrémenter n, la récursion est
infinie → stack overflow.</p>
<div class="sourceCode" id="cb156"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="cf">return</span> n <span class="op">*</span> factorial<span class="op">(</span>n <span class="op">-</span> <span class="dv">1</span><span class="op">);</span>  <span class="co">// CORRECT</span></span></code></pre></div>
</details>
<h3 data-number="13.8.3" id="exercice-3-trouvez-le-bug"><span
class="header-section-number">13.8.3</span> Exercice 3 : Trouvez le
bug</h3>
<div class="sourceCode" id="cb157"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> swap<span class="op">(</span><span class="dt">int</span> a<span class="op">,</span> <span class="dt">int</span> b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> temp <span class="op">=</span> a<span class="op">;</span></span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a>    a <span class="op">=</span> b<span class="op">;</span></span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a>    b <span class="op">=</span> temp<span class="op">;</span></span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb157-8"><a href="#cb157-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> x <span class="op">=</span> <span class="dv">5</span><span class="op">;</span></span>
<span id="cb157-9"><a href="#cb157-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> y <span class="op">=</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="cb157-10"><a href="#cb157-10" aria-hidden="true" tabindex="-1"></a>    swap<span class="op">(</span>x<span class="op">,</span> y<span class="op">);</span></span>
<span id="cb157-11"><a href="#cb157-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">// x est toujours 5, y toujours 10 !</span></span>
<span id="cb157-12"><a href="#cb157-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb157-13"><a href="#cb157-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<details>
<summary>
Voir la solution
</summary>
<p>Le bug est le passage par valeur au lieu de passage par pointeur. Les
modifications de <code>a</code> et <code>b</code> n’affectent pas
<code>x</code> et <code>y</code>.</p>
<div class="sourceCode" id="cb158"><pre
class="sourceCode c"><code class="sourceCode c"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> swap<span class="op">(</span><span class="dt">int</span> <span class="op">*</span>a<span class="op">,</span> <span class="dt">int</span> <span class="op">*</span>b<span class="op">)</span> <span class="op">{</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> temp <span class="op">=</span> <span class="op">*</span>a<span class="op">;</span></span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span>a <span class="op">=</span> <span class="op">*</span>b<span class="op">;</span></span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">*</span>b <span class="op">=</span> temp<span class="op">;</span></span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> x <span class="op">=</span> <span class="dv">5</span><span class="op">;</span></span>
<span id="cb158-9"><a href="#cb158-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> y <span class="op">=</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="cb158-10"><a href="#cb158-10" aria-hidden="true" tabindex="-1"></a>    swap<span class="op">(&amp;</span>x<span class="op">,</span> <span class="op">&amp;</span>y<span class="op">);</span>  <span class="co">// Passer les adresses</span></span>
<span id="cb158-11"><a href="#cb158-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb158-12"><a href="#cb158-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</details>
<hr />
<h2 data-number="13.9" id="ce-quil-faut-retenir-9"><span
class="header-section-number">13.9</span> Ce qu’il faut retenir</h2>
<ol type="1">
<li><strong>Lisez les messages d’erreur</strong> : Ils contiennent
souvent la solution</li>
<li><strong>Utilisez le pas-à-pas</strong> : Le visualiseur est votre
meilleur outil</li>
<li><strong>Formulez des hypothèses</strong> : Approche
scientifique</li>
<li><strong>Connaissez les erreurs courantes</strong> : Elles
représentent 90% des bugs</li>
<li><strong>Simplifiez</strong> : Réduisez le problème au minimum
reproductible</li>
</ol>
<p>Le débogage est une compétence qui s’améliore avec la pratique.
Chaque bug que vous trouvez vous rend meilleur !</p>
<h1 data-number="14"
id="le-cache-pourquoi-votre-ordinateur-semble-rapide"><span
class="header-section-number">14</span> Le Cache : Pourquoi Votre
Ordinateur Semble Rapide</h1>
<p>Imaginez que vous travaillez dans un bureau et que vous avez besoin
de consulter des documents. Vous avez deux options : - <strong>Votre
bureau</strong> : les documents sont juste devant vous, vous pouvez les
lire instantanément - <strong>Les archives au sous-sol</strong> : il
faut descendre 5 étages, chercher le bon dossier, remonter… cela prend
plusieurs minutes</p>
<p>Le <strong>cache</strong> est exactement comme votre bureau : une
petite zone de stockage très rapide où l’on garde les documents
(données) les plus utilisés, pour éviter d’aller constamment aux
archives (la mémoire RAM).</p>
<hr />
<h2 data-number="14.1" id="le-problème-la-ram-est-lente"><span
class="header-section-number">14.1</span> Le Problème : La RAM est Lente
!</h2>
<h3 data-number="14.1.1" id="la-hiérarchie-mémoire"><span
class="header-section-number">14.1.1</span> La Hiérarchie Mémoire</h3>
<p>Voici comment est organisée la mémoire dans un ordinateur, du plus
rapide au plus lent :</p>
<figure>
<img src="images/memory-hierarchy.svg" alt="Hiérarchie mémoire" />
<figcaption aria-hidden="true">Hiérarchie mémoire</figcaption>
</figure>
<h3 data-number="14.1.2" id="lécart-de-vitesse-visualisé"><span
class="header-section-number">14.1.2</span> L’écart de vitesse
visualisé</h3>
<p>Si on convertissait ces temps en échelle humaine, les registres
seraient comme cligner des yeux (0.3 seconde), le cache L1 comme une
seconde, le cache L2 comme 4 secondes, la RAM comme 1 minute 40
secondes, et accéder au SSD prendrait… <strong>27 heures</strong> !</p>
<p>Sans cache, le processeur passerait <strong>99% de son temps à
attendre</strong> !</p>
<hr />
<h2 data-number="14.2" id="la-solution-le-principe-de-localité"><span
class="header-section-number">14.2</span> La Solution : Le Principe de
Localité</h2>
<p>Les programmes ne lisent pas la mémoire au hasard. Ils suivent des
<strong>patterns</strong> prévisibles.</p>
<h3 data-number="14.2.1" id="localité-temporelle"><span
class="header-section-number">14.2.1</span> Localité Temporelle</h3>
<p><strong>“Si j’utilise une donnée maintenant, je vais probablement la
réutiliser bientôt”</strong></p>
<figure>
<img src="images/temporal-locality.svg" alt="Localité temporelle" />
<figcaption aria-hidden="true">Localité temporelle</figcaption>
</figure>
<h3 data-number="14.2.2" id="localité-spatiale"><span
class="header-section-number">14.2.2</span> Localité Spatiale</h3>
<p><strong>“Si j’utilise une donnée, je vais probablement utiliser ses
voisines”</strong></p>
<figure>
<img src="images/spatial-locality.svg" alt="Localité spatiale" />
<figcaption aria-hidden="true">Localité spatiale</figcaption>
</figure>
<hr />
<h2 data-number="14.3" id="comment-fonctionne-le-cache"><span
class="header-section-number">14.3</span> Comment Fonctionne le Cache
?</h2>
<h3 data-number="14.3.1" id="les-lignes-de-cache"><span
class="header-section-number">14.3.1</span> Les Lignes de Cache</h3>
<p>Le cache stocke des <strong>blocs</strong> de données appelés
<strong>lignes de cache</strong>, pas des octets individuels.</p>
<p>Quand vous demandez l’adresse 100, le cache charge <strong>16 octets
ensemble</strong> (adresses 100 à 115). Ensuite, si vous demandez 101,
102, 103… c’est gratuit car déjà en cache !</p>
<h3 data-number="14.3.2" id="structure-dune-ligne-de-cache"><span
class="header-section-number">14.3.2</span> Structure d’une Ligne de
Cache</h3>
<figure>
<img src="images/cache-line-structure.svg"
alt="Structure d’une ligne de cache" />
<figcaption aria-hidden="true">Structure d’une ligne de
cache</figcaption>
</figure>
<h3 data-number="14.3.3" id="découpage-dune-adresse"><span
class="header-section-number">14.3.3</span> Découpage d’une Adresse</h3>
<p>Quand le CPU demande l’adresse <code>0x00001234</code>, comment le
cache la trouve-t-il ?</p>
<figure>
<img src="images/address-decomposition.svg"
alt="Décomposition d’une adresse" />
<figcaption aria-hidden="true">Décomposition d’une adresse</figcaption>
</figure>
<h3 data-number="14.3.4" id="structure-complète-du-cache"><span
class="header-section-number">14.3.4</span> Structure Complète du
Cache</h3>
<figure>
<img src="images/cache-direct-mapped.svg" alt="Cache direct-mapped" />
<figcaption aria-hidden="true">Cache direct-mapped</figcaption>
</figure>
<hr />
<h2 data-number="14.4" id="hit-ou-miss-que-se-passe-t-il"><span
class="header-section-number">14.4</span> Hit ou Miss : Que se
passe-t-il ?</h2>
<h3 data-number="14.4.1" id="scénario-1-cache-hit-succès"><span
class="header-section-number">14.4.1</span> Scénario 1 : Cache HIT
(Succès)</h3>
<figure>
<img src="images/cache-hit-scenario.svg" alt="Scénario Cache HIT" />
<figcaption aria-hidden="true">Scénario Cache HIT</figcaption>
</figure>
<h3 data-number="14.4.2" id="scénario-2-cache-miss-échec"><span
class="header-section-number">14.4.2</span> Scénario 2 : Cache MISS
(Échec)</h3>
<figure>
<img src="images/cache-miss-scenario.svg" alt="Scénario Cache MISS" />
<figcaption aria-hidden="true">Scénario Cache MISS</figcaption>
</figure>
<h3 data-number="14.4.3" id="diagramme-de-flux-complet"><span
class="header-section-number">14.4.3</span> Diagramme de Flux
Complet</h3>
<figure>
<img src="images/cache-flowchart.svg"
alt="Algorithme de lecture cache" />
<figcaption aria-hidden="true">Algorithme de lecture cache</figcaption>
</figure>
<hr />
<h2 data-number="14.5" id="politiques-décriture"><span
class="header-section-number">14.5</span> Politiques d’Écriture</h2>
<h3 data-number="14.5.1" id="write-through-écriture-directe"><span
class="header-section-number">14.5.1</span> Write-Through (Écriture
Directe)</h3>
<figure>
<img src="images/write-through.svg" alt="Write-Through" />
<figcaption aria-hidden="true">Write-Through</figcaption>
</figure>
<h3 data-number="14.5.2" id="write-back-écriture-différée"><span
class="header-section-number">14.5.2</span> Write-Back (Écriture
Différée)</h3>
<figure>
<img src="images/write-back.svg" alt="Write-Back" />
<figcaption aria-hidden="true">Write-Back</figcaption>
</figure>
<hr />
<h2 data-number="14.6" id="impact-sur-vos-programmes"><span
class="header-section-number">14.6</span> Impact sur vos Programmes</h2>
<h3 data-number="14.6.1"
id="parcours-de-tableaux-2d-lordre-compte"><span
class="header-section-number">14.6.1</span> Parcours de Tableaux 2D :
L’Ordre Compte !</h3>
<p>Une matrice 4x4 est stockée <strong>ligne par ligne</strong> en
mémoire (row-major) :</p>
<figure>
<img src="images/matrix-storage.svg"
alt="Stockage mémoire d’une matrice" />
<figcaption aria-hidden="true">Stockage mémoire d’une
matrice</figcaption>
</figure>
<h3 data-number="14.6.2"
id="parcours-row-major-en-ligne---efficace"><span
class="header-section-number">14.6.2</span> Parcours Row-Major (En
Ligne) - EFFICACE</h3>
<figure>
<img src="images/row-major-traversal.svg" alt="Parcours Row-Major" />
<figcaption aria-hidden="true">Parcours Row-Major</figcaption>
</figure>
<h3 data-number="14.6.3"
id="parcours-column-major-en-colonne---inefficace"><span
class="header-section-number">14.6.3</span> Parcours Column-Major (En
Colonne) - INEFFICACE</h3>
<figure>
<img src="images/column-major-traversal.svg"
alt="Parcours Column-Major" />
<figcaption aria-hidden="true">Parcours Column-Major</figcaption>
</figure>
<h3 data-number="14.6.4" id="comparaison-visuelle"><span
class="header-section-number">14.6.4</span> Comparaison Visuelle</h3>
<figure>
<img src="images/cache-comparison.svg"
alt="Comparaison Row-Major vs Column-Major" />
<figcaption aria-hidden="true">Comparaison Row-Major vs
Column-Major</figcaption>
</figure>
<h3 data-number="14.6.5" id="technique-du-blocking"><span
class="header-section-number">14.6.5</span> Technique du Blocking</h3>
<figure>
<img src="images/blocking-technique.svg" alt="Technique de Blocking" />
<figcaption aria-hidden="true">Technique de Blocking</figcaption>
</figure>
<hr />
<h2 data-number="14.7" id="implémentation-hdl-du-cache"><span
class="header-section-number">14.7</span> Implémentation HDL du
Cache</h2>
<h3 data-number="14.7.1" id="architecture-globale"><span
class="header-section-number">14.7.1</span> Architecture Globale</h3>
<figure>
<img src="images/cache-architecture-hdl.svg"
alt="Architecture du cache HDL" />
<figcaption aria-hidden="true">Architecture du cache HDL</figcaption>
</figure>
<h3 data-number="14.7.2" id="machine-à-états-du-contrôleur"><span
class="header-section-number">14.7.2</span> Machine à États du
Contrôleur</h3>
<figure>
<img src="images/cache-controller-fsm.svg"
alt="Machine à états du CacheController" />
<figcaption aria-hidden="true">Machine à états du
CacheController</figcaption>
</figure>
<h3 data-number="14.7.3" id="wordselect-sélection-du-mot"><span
class="header-section-number">14.7.3</span> WordSelect : Sélection du
Mot</h3>
<figure>
<img src="images/word-select.svg" alt="WordSelect" />
<figcaption aria-hidden="true">WordSelect</figcaption>
</figure>
<hr />
<h2 data-number="14.8" id="statistiques-et-performance"><span
class="header-section-number">14.8</span> Statistiques et
Performance</h2>
<h3 data-number="14.8.1" id="calcul-du-hit-rate"><span
class="header-section-number">14.8.1</span> Calcul du Hit Rate</h3>
<figure>
<img src="images/hit-rate-calculation.svg" alt="Calcul du Hit Rate" />
<figcaption aria-hidden="true">Calcul du Hit Rate</figcaption>
</figure>
<hr />
<h2 data-number="14.9"
id="visualiser-le-cache-avec-le-cpu-visualizer"><span
class="header-section-number">14.9</span> Visualiser le Cache avec le
CPU Visualizer</h2>
<p>Le <strong>CPU Visualizer</strong> vous permet d’observer le
comportement du cache en temps réel pendant l’exécution d’un
programme.</p>
<h3 data-number="14.9.1" id="accéder-au-visualizer-1"><span
class="header-section-number">14.9.1</span> Accéder au Visualizer</h3>
<div class="sourceCode" id="cb159"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> web</span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> run dev</span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Ouvrir http://localhost:5173 -&gt; CPU Visualizer</span></span></code></pre></div>
<h3 data-number="14.9.2" id="la-démo-cache"><span
class="header-section-number">14.9.2</span> La Démo “Cache”</h3>
<p>Chargez la démo <strong>“7. Cache”</strong> dans le menu déroulant.
Ce programme : 1. Parcourt un tableau de 16 éléments une première fois
(cache misses) 2. Parcourt le même tableau une seconde fois (cache
hits)</p>
<h3 data-number="14.9.3" id="ce-que-vous-verrez"><span
class="header-section-number">14.9.3</span> Ce que vous verrez</h3>
<p><strong>Panneau “Cache L1”</strong> : - <strong>Hits</strong> :
Nombre d’accès trouvés dans le cache - <strong>Misses</strong> : Nombre
d’accès qui ont dû aller en RAM - <strong>Taux</strong> : Pourcentage de
hits (ex: “94.2%”) - <strong>Indicateur HIT/MISS</strong> : Flash vert
pour hit, rouge pour miss</p>
<p><strong>Contenu du cache</strong> : - <strong>Ligne</strong> : Numéro
de la ligne (0-63) - <strong>Valid</strong> : 1 si la ligne contient des
données valides - <strong>Tag</strong> : Identifie quelle zone mémoire
est stockée - <strong>Données</strong> : Le mot stocké dans la ligne</p>
<h3 data-number="14.9.4" id="exercice-pratique-1"><span
class="header-section-number">14.9.4</span> Exercice Pratique</h3>
<ol type="1">
<li>Lancez la démo “Cache” et observez :
<ul>
<li>Au premier parcours : beaucoup de <strong>MISS</strong> (flash
rouge)</li>
<li>Au second parcours : beaucoup de <strong>HIT</strong> (flash
vert)</li>
</ul></li>
<li>Regardez le taux de hits évoluer :
<ul>
<li>Début : ~0% (cache vide)</li>
<li>Après premier parcours : ~50%</li>
<li>Fin : ~85-95%</li>
</ul></li>
<li>Observez les lignes de cache se remplir :
<ul>
<li>Les bits Valid passent de 0 à 1</li>
<li>Les Tags s’affichent</li>
<li>Les données apparaissent</li>
</ul></li>
</ol>
<hr />
<h2 data-number="14.10" id="exercices"><span
class="header-section-number">14.10</span> Exercices</h2>
<h3 data-number="14.10.1" id="exercices-hdl"><span
class="header-section-number">14.10.1</span> Exercices HDL</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>CacheLine</strong></td>
<td style="text-align: left;">Implémenter une ligne de cache avec valid,
tag, data</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>TagCompare</strong></td>
<td style="text-align: left;">Comparateur de tags pour détecter
hit/miss</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>WordSelect</strong></td>
<td style="text-align: left;">Sélecteur de mot (4:1) dans une ligne 128
bits</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>CacheController</strong></td>
<td style="text-align: left;">Machine à états (IDLE, FETCH,
WRITEBACK)</td>
</tr>
</tbody>
</table>
<h3 data-number="14.10.2" id="exercices-assembleur-a32"><span
class="header-section-number">14.10.2</span> Exercices Assembleur
A32</h3>
<table>
<colgroup>
<col style="width: 30%" />
<col style="width: 39%" />
<col style="width: 30%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">Résultat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Accès Séquentiel</strong></td>
<td style="text-align: left;">Parcours cache-friendly d’un tableau</td>
<td style="text-align: left;">R0 = 100</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Accès avec Stride</strong></td>
<td style="text-align: left;">Parcours avec sauts (moins efficace)</td>
<td style="text-align: left;">R0 = 28</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Réutilisation
Registre</strong></td>
<td style="text-align: left;">Garder les données en registre</td>
<td style="text-align: left;">R0 = 91</td>
</tr>
</tbody>
</table>
<h3 data-number="14.10.3" id="exercices-c32"><span
class="header-section-number">14.10.3</span> Exercices C32</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Exercice</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">Résultat</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Parcours en Ligne</strong></td>
<td style="text-align: left;">Accès row-major (cache-friendly)</td>
<td style="text-align: left;">120</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Parcours en Colonne</strong></td>
<td style="text-align: left;">Accès column-major (moins efficace)</td>
<td style="text-align: left;">120</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Traitement par Blocs</strong></td>
<td style="text-align: left;">Technique de blocking</td>
<td style="text-align: left;">120</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Localité Temporelle</strong></td>
<td style="text-align: left;">Réutiliser les données</td>
<td style="text-align: left;">30</td>
</tr>
</tbody>
</table>
<hr />
<h2 data-number="14.11" id="résumé-visuel"><span
class="header-section-number">14.11</span> Résumé Visuel</h2>
<figure>
<img src="images/cache-summary.svg" alt="Résumé du cache" />
<figcaption aria-hidden="true">Résumé du cache</figcaption>
</figure>
<hr />
<h2 data-number="14.12" id="points-clés-à-retenir"><span
class="header-section-number">14.12</span> Points Clés à Retenir</h2>
<ol type="1">
<li><strong>La RAM est lente</strong> : ~100x plus lente que le
cache</li>
<li><strong>Le cache exploite la localité</strong> : temporelle et
spatiale</li>
<li><strong>L’ordre d’accès compte</strong> : row-major &gt;&gt;
column-major</li>
<li><strong>Réutilisez les données</strong> : gardez-les en registre ou
en cache</li>
<li><strong>Pensez en blocs</strong> : traitez des données qui tiennent
dans le cache</li>
</ol>
<p>Ces principes s’appliquent à tous les niveaux de programmation, du
code assembleur aux applications modernes !</p>
<hr />
<h2 data-number="14.13" id="auto-évaluation-9"><span
class="header-section-number">14.13</span> Auto-évaluation</h2>
<p>Testez votre compréhension du cache.</p>
<h3 data-number="14.13.1" id="questions-de-compréhension-9"><span
class="header-section-number">14.13.1</span> Questions de
compréhension</h3>
<p><strong>Q1.</strong> Qu’est-ce que la localité temporelle et la
localité spatiale ?</p>
<p><strong>Q2.</strong> Pourquoi le parcours en ligne (row-major) est-il
plus efficace que le parcours en colonne ?</p>
<p><strong>Q3.</strong> Qu’est-ce qu’un cache hit et un cache miss ?</p>
<p><strong>Q4.</strong> Comment fonctionne un cache direct-mapped ?</p>
<p><strong>Q5.</strong> Qu’est-ce que la technique de “blocking” ?</p>
<h3 data-number="14.13.2" id="mini-défi-pratique-8"><span
class="header-section-number">14.13.2</span> Mini-défi pratique</h3>
<p>Calculez le hit rate pour ce pattern d’accès avec un cache de 4
lignes de 16 octets :</p>
<p>Accès séquentiels aux adresses : 0, 4, 8, 12, 16, 20, 24, 28, 0, 4,
8, 12</p>
<p><em>Les solutions se trouvent dans le document
<strong>Codex_Solutions</strong>.</em></p>
<h3 data-number="14.13.3" id="checklist-de-validation-8"><span
class="header-section-number">14.13.3</span> Checklist de
validation</h3>
<ul class="task-list">
<li><label><input type="checkbox" />Expliquer la différence entre
localité temporelle et spatiale</label></li>
<li><label><input type="checkbox" />Comprendre pourquoi le cache existe
(hiérarchie mémoire)</label></li>
<li><label><input type="checkbox" />Calculer un hit rate
simple</label></li>
<li><label><input type="checkbox" />Optimiser un parcours de tableau
pour le cache</label></li>
<li><label><input type="checkbox" />Appliquer la technique de blocking
sur une matrice</label></li>
</ul>
</body>
</html>
