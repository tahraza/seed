<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Porte NAND - Animation Interactive</title>
    <link rel="stylesheet" href="common.css">
    <style>
        .construction-section {
            margin-top: 30px;
            border: 2px solid #4a5568;
            border-radius: 12px;
            overflow: hidden;
        }
        .construction-header {
            background: #2d3748;
            padding: 15px 20px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .construction-header:hover { background: #4a5568; }
        .construction-header h3 { margin: 0; color: #e2e8f0; font-size: 1.1rem; }
        .construction-toggle { color: #4299e1; font-size: 1.5rem; transition: transform 0.3s; }
        .construction-content { display: none; padding: 20px; background: #1a202c; }
        .construction-content.open { display: block; }
        .construction-toggle.open { transform: rotate(180deg); }
        .construction-formula {
            text-align: center; padding: 15px; background: #2d3748; border-radius: 8px;
            margin-bottom: 20px; font-family: 'Courier New', monospace; font-size: 1.2rem; color: #e2e8f0;
        }
        .construction-formula .highlight { color: #48bb78; font-weight: bold; }
        .component-links { display: flex; gap: 10px; justify-content: center; margin-top: 15px; flex-wrap: wrap; }
        .component-link {
            padding: 8px 16px; background: #4299e1; color: white; text-decoration: none;
            border-radius: 6px; font-size: 14px;
        }
        .component-link:hover { background: #3182ce; }
        .construction-explanation { color: #a0aec0; font-size: 14px; line-height: 1.6; margin: 15px 0; }
        .universal-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px; margin-top: 20px;
        }
        .universal-card {
            background: #2d3748; border-radius: 8px; padding: 15px;
            border-left: 4px solid #f6ad55;
        }
        .universal-card h4 { color: #f6ad55; margin: 0 0 10px 0; font-size: 1rem; }
        .universal-card .formula { color: #e2e8f0; font-family: 'Courier New', monospace; font-size: 0.9rem; }
    </style>
</head>
<body>
    <h1>Porte NAND</h1>
    <p class="subtitle">La porte universelle - base de tous les circuits</p>

    <div class="container">
        <p class="instructions">Cliquez sur les entrees A et B pour changer leur valeur</p>

        <svg class="circuit-svg" viewBox="0 0 360 160" xmlns="http://www.w3.org/2000/svg">
            <!-- Input wires with right angles -->
            <path id="wireA" class="wire off" d="M 40 50 L 100 50 L 100 65 L 130 65"/>
            <path id="wireB" class="wire off" d="M 40 110 L 100 110 L 100 95 L 130 95"/>

            <!-- Output wire -->
            <path id="wireOut" class="wire on" d="M 230 80 L 320 80"/>

            <!-- NAND Gate body -->
            <path class="gate-body" d="M 130 45 L 130 115 L 170 115 Q 210 115 210 80 Q 210 45 170 45 Z"/>
            <circle class="gate-body" cx="220" cy="80" r="10"/>

            <!-- Input A toggle -->
            <g class="input-toggle" onclick="toggleInput('A')">
                <circle id="inputA" cx="40" cy="50" r="16" fill="#e53e3e"/>
                <text x="40" y="55" text-anchor="middle" fill="white" font-weight="bold" font-size="14">0</text>
            </g>

            <!-- Input B toggle -->
            <g class="input-toggle" onclick="toggleInput('B')">
                <circle id="inputB" cx="40" cy="110" r="16" fill="#e53e3e"/>
                <text x="40" y="115" text-anchor="middle" fill="white" font-weight="bold" font-size="14">0</text>
            </g>

            <!-- Output indicator -->
            <circle id="outputCircle" cx="320" cy="80" r="16" fill="#48bb78"/>
            <text id="outputText" x="320" y="85" text-anchor="middle" fill="white" font-weight="bold" font-size="14">1</text>

            <!-- Labels -->
            <text class="label label-input" x="40" y="28" text-anchor="middle">A</text>
            <text class="label label-input" x="40" y="140" text-anchor="middle">B</text>
            <text class="label label-output" x="320" y="58" text-anchor="middle">OUT</text>
        </svg>

        <div class="status">
            <div class="status-item">
                <span>A =</span>
                <span id="statusA" class="status-value off">0</span>
            </div>
            <div class="status-item">
                <span>B =</span>
                <span id="statusB" class="status-value off">0</span>
            </div>
            <div class="status-item">
                <span>OUT =</span>
                <span id="statusOut" class="status-value on">1</span>
            </div>
        </div>

        <div style="text-align: center; margin: 20px 0; padding: 15px; background: #2d3748; border-radius: 8px;">
            <p style="color: #e2e8f0; font-family: 'Courier New', monospace;">
                OUT = NOT(A AND B)
            </p>
        </div>

        <table class="truth-table">
            <thead>
                <tr><th>A</th><th>B</th><th>NAND</th></tr>
            </thead>
            <tbody id="truthTable">
                <tr class="active"><td>0</td><td>0</td><td>1</td></tr>
                <tr><td>0</td><td>1</td><td>1</td></tr>
                <tr><td>1</td><td>0</td><td>1</td></tr>
                <tr><td>1</td><td>1</td><td>0</td></tr>
            </tbody>
        </table>

        <div class="controls">
            <button class="btn btn-secondary" onclick="reset()">Reset</button>
            <button id="animBtn" class="btn btn-primary" onclick="animate()">Animation Auto</button>
        </div>

        <!-- Construction Section - Universality -->
        <div class="construction-section">
            <div class="construction-header" onclick="toggleConstruction()">
                <h3>Universalite de NAND</h3>
                <span class="construction-toggle" id="constructionToggle">&#9660;</span>
            </div>
            <div class="construction-content" id="constructionContent">
                <div class="construction-formula">
                    NAND est une <span class="highlight">porte universelle</span>
                </div>

                <p class="construction-explanation">
                    La porte NAND peut construire n'importe quelle autre porte logique.
                    C'est pourquoi les circuits integres utilisent souvent uniquement des portes NAND
                    pour simplifier la fabrication.
                </p>

                <div class="universal-grid">
                    <div class="universal-card">
                        <h4>NOT avec NAND</h4>
                        <div class="formula">NOT(A) = NAND(A, A)</div>
                        <svg viewBox="0 0 200 60" style="width: 100%; height: 60px; margin-top: 10px;">
                            <path id="consNotIn" class="wire off" d="M 20 30 L 50 30"/>
                            <path id="consNotA" class="wire off" d="M 50 30 L 50 20 L 70 20"/>
                            <path id="consNotB" class="wire off" d="M 50 30 L 50 40 L 70 40"/>
                            <path id="consNotOut" class="wire on" d="M 130 30 L 180 30"/>
                            <path d="M 70 10 L 70 50 L 95 50 Q 115 50 115 30 Q 115 10 95 10 Z" fill="#2d3748" stroke="#f6ad55" stroke-width="2"/>
                            <circle cx="122" cy="30" r="6" fill="#2d3748" stroke="#f6ad55" stroke-width="2"/>
                            <circle id="consNotInCircle" cx="20" cy="30" r="8" fill="#e53e3e"/>
                            <text id="consNotInText" x="20" y="34" text-anchor="middle" fill="white" font-weight="bold" font-size="10">0</text>
                            <circle id="consNotOutCircle" cx="180" cy="30" r="8" fill="#48bb78"/>
                            <text id="consNotOutText" x="180" y="34" text-anchor="middle" fill="white" font-weight="bold" font-size="10">1</text>
                        </svg>
                    </div>

                    <div class="universal-card">
                        <h4>AND avec NAND</h4>
                        <div class="formula">AND(A,B) = NOT(NAND(A,B))</div>
                        <svg viewBox="0 0 280 80" style="width: 100%; height: 80px; margin-top: 10px;">
                            <!-- Inputs -->
                            <path id="consAndInA" class="wire off" d="M 20 25 L 50 25 L 50 30 L 70 30"/>
                            <path id="consAndInB" class="wire off" d="M 20 55 L 50 55 L 50 50 L 70 50"/>
                            <!-- NAND to NOT -->
                            <path id="consAndMid" class="wire on" d="M 130 40 L 150 40"/>
                            <path id="consAndNotA" class="wire on" d="M 150 40 L 150 30 L 170 30"/>
                            <path id="consAndNotB" class="wire on" d="M 150 40 L 150 50 L 170 50"/>
                            <path id="consAndOut" class="wire off" d="M 230 40 L 260 40"/>
                            <!-- NAND gate -->
                            <path d="M 70 20 L 70 60 L 95 60 Q 115 60 115 40 Q 115 20 95 20 Z" fill="#2d3748" stroke="#f6ad55" stroke-width="2"/>
                            <circle cx="122" cy="40" r="6" fill="#2d3748" stroke="#f6ad55" stroke-width="2"/>
                            <!-- NOT gate (NAND) -->
                            <path d="M 170 20 L 170 60 L 195 60 Q 215 60 215 40 Q 215 20 195 20 Z" fill="#2d3748" stroke="#f6ad55" stroke-width="2"/>
                            <circle cx="222" cy="40" r="6" fill="#2d3748" stroke="#f6ad55" stroke-width="2"/>
                            <!-- Labels -->
                            <circle id="consAndInACircle" cx="20" cy="25" r="8" fill="#e53e3e"/>
                            <text id="consAndInAText" x="20" y="29" text-anchor="middle" fill="white" font-weight="bold" font-size="10">0</text>
                            <circle id="consAndInBCircle" cx="20" cy="55" r="8" fill="#e53e3e"/>
                            <text id="consAndInBText" x="20" y="59" text-anchor="middle" fill="white" font-weight="bold" font-size="10">0</text>
                            <circle id="consAndOutCircle" cx="260" cy="40" r="8" fill="#e53e3e"/>
                            <text id="consAndOutText" x="260" y="44" text-anchor="middle" fill="white" font-weight="bold" font-size="10">0</text>
                        </svg>
                    </div>

                    <div class="universal-card">
                        <h4>OR avec NAND</h4>
                        <div class="formula">OR(A,B) = NAND(NOT(A), NOT(B))</div>
                        <svg viewBox="0 0 320 100" style="width: 100%; height: 100px; margin-top: 10px;">
                            <!-- Input A to NOT -->
                            <path id="consOrInA" class="wire off" d="M 20 25 L 40 25"/>
                            <path id="consOrNotAin" class="wire off" d="M 40 25 L 40 18 L 55 18"/>
                            <path id="consOrNotAin2" class="wire off" d="M 40 25 L 40 32 L 55 32"/>
                            <!-- Input B to NOT -->
                            <path id="consOrInB" class="wire off" d="M 20 75 L 40 75"/>
                            <path id="consOrNotBin" class="wire off" d="M 40 75 L 40 68 L 55 68"/>
                            <path id="consOrNotBin2" class="wire off" d="M 40 75 L 40 82 L 55 82"/>
                            <!-- NOT outputs to final NAND -->
                            <path id="consOrNotAout" class="wire on" d="M 115 25 L 165 25 L 165 40 L 180 40"/>
                            <path id="consOrNotBout" class="wire on" d="M 115 75 L 165 75 L 165 60 L 180 60"/>
                            <!-- Final output -->
                            <path id="consOrOut" class="wire off" d="M 240 50 L 295 50"/>
                            <!-- NOT A (NAND) -->
                            <path d="M 55 10 L 55 40 L 75 40 Q 95 40 95 25 Q 95 10 75 10 Z" fill="#2d3748" stroke="#f6ad55" stroke-width="1.5"/>
                            <circle cx="102" cy="25" r="5" fill="#2d3748" stroke="#f6ad55" stroke-width="1.5"/>
                            <!-- NOT B (NAND) -->
                            <path d="M 55 60 L 55 90 L 75 90 Q 95 90 95 75 Q 95 60 75 60 Z" fill="#2d3748" stroke="#f6ad55" stroke-width="1.5"/>
                            <circle cx="102" cy="75" r="5" fill="#2d3748" stroke="#f6ad55" stroke-width="1.5"/>
                            <!-- Final NAND -->
                            <path d="M 180 30 L 180 70 L 205 70 Q 225 70 225 50 Q 225 30 205 30 Z" fill="#2d3748" stroke="#f6ad55" stroke-width="2"/>
                            <circle cx="232" cy="50" r="6" fill="#2d3748" stroke="#f6ad55" stroke-width="2"/>
                            <!-- Labels -->
                            <circle id="consOrInACircle" cx="20" cy="25" r="8" fill="#e53e3e"/>
                            <text id="consOrInAText" x="20" y="29" text-anchor="middle" fill="white" font-weight="bold" font-size="10">0</text>
                            <circle id="consOrInBCircle" cx="20" cy="75" r="8" fill="#e53e3e"/>
                            <text id="consOrInBText" x="20" y="79" text-anchor="middle" fill="white" font-weight="bold" font-size="10">0</text>
                            <circle id="consOrOutCircle" cx="295" cy="50" r="8" fill="#e53e3e"/>
                            <text id="consOrOutText" x="295" y="54" text-anchor="middle" fill="white" font-weight="bold" font-size="10">0</text>
                        </svg>
                    </div>
                </div>

                <p class="construction-explanation" style="text-align: center; margin-top: 20px;">
                    <strong>Pourquoi NAND est universelle ?</strong><br>
                    Avec NOT et AND (ou NOT et OR), on peut construire toutes les fonctions logiques.<br>
                    NAND permet de construire NOT, donc AND, donc tout le reste !
                </p>

                <div class="component-links">
                    <a href="not.html" class="component-link">Voir NOT</a>
                    <a href="and.html" class="component-link">Voir AND</a>
                    <a href="or.html" class="component-link">Voir OR</a>
                    <a href="xor.html" class="component-link">Voir XOR</a>
                </div>
            </div>
        </div>
    </div>

    <nav class="nav" style="margin-top: 20px;">
        <a href="index.html">Index</a>
        <a href="not.html">NOT</a>
        <a href="and.html">AND</a>
        <a href="or.html">OR</a>
        <a href="xor.html">XOR</a>
    </nav>

    <script>
        let inputs = { A: 0, B: 0 };
        let animating = false;

        function updateAnimBtn() {
            const btn = document.getElementById('animBtn');
            btn.textContent = animating ? 'Stop' : 'Animation Auto';
            btn.classList.toggle('animating', animating);
        }

        function nand(a, b) {
            return (a === 1 && b === 1) ? 0 : 1;
        }

        function toggleInput(input) {
            if (animating) return;
            inputs[input] = 1 - inputs[input];
            updateCircuit();
        }

        function updateCircuit() {
            const output = nand(inputs.A, inputs.B);

            document.getElementById('inputA').setAttribute('fill', inputs.A ? '#48bb78' : '#e53e3e');
            document.getElementById('inputB').setAttribute('fill', inputs.B ? '#48bb78' : '#e53e3e');
            document.querySelector('#inputA + text').textContent = inputs.A;
            document.querySelector('#inputB + text').textContent = inputs.B;

            document.getElementById('wireA').className.baseVal = 'wire ' + (inputs.A ? 'on' : 'off');
            document.getElementById('wireB').className.baseVal = 'wire ' + (inputs.B ? 'on' : 'off');
            document.getElementById('wireOut').className.baseVal = 'wire ' + (output ? 'on' : 'off');

            document.getElementById('outputCircle').setAttribute('fill', output ? '#48bb78' : '#e53e3e');
            document.getElementById('outputText').textContent = output;

            document.getElementById('statusA').textContent = inputs.A;
            document.getElementById('statusA').className = 'status-value ' + (inputs.A ? 'on' : 'off');
            document.getElementById('statusB').textContent = inputs.B;
            document.getElementById('statusB').className = 'status-value ' + (inputs.B ? 'on' : 'off');
            document.getElementById('statusOut').textContent = output;
            document.getElementById('statusOut').className = 'status-value ' + (output ? 'on' : 'off');

            const rows = document.querySelectorAll('#truthTable tr');
            const index = inputs.A * 2 + inputs.B;
            rows.forEach((row, i) => row.className = i === index ? 'active' : '');
        }

        function reset() {
            animating = false;
            updateAnimBtn();
            inputs = { A: 0, B: 0 };
            updateCircuit();
        }

        async function animate() {
            if (animating) {
                animating = false;
                updateAnimBtn();
                return;
            }
            animating = true;
            updateAnimBtn();

            const states = [[0, 0], [0, 1], [1, 0], [1, 1]];
            while (animating) {
                for (const [a, b] of states) {
                    if (!animating) break;
                    inputs.A = a;
                    inputs.B = b;
                    updateCircuit();
                    await new Promise(r => setTimeout(r, 1000));
                }
            }
            updateAnimBtn();
        }

        // Construction section
        function toggleConstruction() {
            const content = document.getElementById('constructionContent');
            const toggle = document.getElementById('constructionToggle');
            content.classList.toggle('open');
            toggle.classList.toggle('open');
        }

        function updateConstructionCircuits() {
            // NOT circuit
            const notIn = inputs.A;
            const notOut = 1 - notIn;
            document.getElementById('consNotIn').className.baseVal = 'wire ' + (notIn ? 'on' : 'off');
            document.getElementById('consNotA').className.baseVal = 'wire ' + (notIn ? 'on' : 'off');
            document.getElementById('consNotB').className.baseVal = 'wire ' + (notIn ? 'on' : 'off');
            document.getElementById('consNotOut').className.baseVal = 'wire ' + (notOut ? 'on' : 'off');
            document.getElementById('consNotInCircle').setAttribute('fill', notIn ? '#48bb78' : '#e53e3e');
            document.getElementById('consNotInText').textContent = notIn;
            document.getElementById('consNotOutCircle').setAttribute('fill', notOut ? '#48bb78' : '#e53e3e');
            document.getElementById('consNotOutText').textContent = notOut;

            // AND circuit
            const andNand = nand(inputs.A, inputs.B);
            const andOut = 1 - andNand;
            document.getElementById('consAndInA').className.baseVal = 'wire ' + (inputs.A ? 'on' : 'off');
            document.getElementById('consAndInB').className.baseVal = 'wire ' + (inputs.B ? 'on' : 'off');
            document.getElementById('consAndMid').className.baseVal = 'wire ' + (andNand ? 'on' : 'off');
            document.getElementById('consAndNotA').className.baseVal = 'wire ' + (andNand ? 'on' : 'off');
            document.getElementById('consAndNotB').className.baseVal = 'wire ' + (andNand ? 'on' : 'off');
            document.getElementById('consAndOut').className.baseVal = 'wire ' + (andOut ? 'on' : 'off');
            document.getElementById('consAndInACircle').setAttribute('fill', inputs.A ? '#48bb78' : '#e53e3e');
            document.getElementById('consAndInAText').textContent = inputs.A;
            document.getElementById('consAndInBCircle').setAttribute('fill', inputs.B ? '#48bb78' : '#e53e3e');
            document.getElementById('consAndInBText').textContent = inputs.B;
            document.getElementById('consAndOutCircle').setAttribute('fill', andOut ? '#48bb78' : '#e53e3e');
            document.getElementById('consAndOutText').textContent = andOut;

            // OR circuit
            const notA = 1 - inputs.A;
            const notB = 1 - inputs.B;
            const orOut = inputs.A | inputs.B;
            document.getElementById('consOrInA').className.baseVal = 'wire ' + (inputs.A ? 'on' : 'off');
            document.getElementById('consOrNotAin').className.baseVal = 'wire ' + (inputs.A ? 'on' : 'off');
            document.getElementById('consOrNotAin2').className.baseVal = 'wire ' + (inputs.A ? 'on' : 'off');
            document.getElementById('consOrInB').className.baseVal = 'wire ' + (inputs.B ? 'on' : 'off');
            document.getElementById('consOrNotBin').className.baseVal = 'wire ' + (inputs.B ? 'on' : 'off');
            document.getElementById('consOrNotBin2').className.baseVal = 'wire ' + (inputs.B ? 'on' : 'off');
            document.getElementById('consOrNotAout').className.baseVal = 'wire ' + (notA ? 'on' : 'off');
            document.getElementById('consOrNotBout').className.baseVal = 'wire ' + (notB ? 'on' : 'off');
            document.getElementById('consOrOut').className.baseVal = 'wire ' + (orOut ? 'on' : 'off');
            document.getElementById('consOrInACircle').setAttribute('fill', inputs.A ? '#48bb78' : '#e53e3e');
            document.getElementById('consOrInAText').textContent = inputs.A;
            document.getElementById('consOrInBCircle').setAttribute('fill', inputs.B ? '#48bb78' : '#e53e3e');
            document.getElementById('consOrInBText').textContent = inputs.B;
            document.getElementById('consOrOutCircle').setAttribute('fill', orOut ? '#48bb78' : '#e53e3e');
            document.getElementById('consOrOutText').textContent = orOut;
        }

        // Add to updateCircuit
        const originalUpdateCircuit = updateCircuit;
        updateCircuit = function() {
            originalUpdateCircuit();
            updateConstructionCircuits();
        };

        updateCircuit();
    </script>
</body>
</html>
