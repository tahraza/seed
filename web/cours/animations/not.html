<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Porte NOT - Animation Interactive</title>
    <link rel="stylesheet" href="common.css">
    <style>
        .construction-section {
            margin-top: 30px;
            border: 2px solid #4a5568;
            border-radius: 12px;
            overflow: hidden;
        }
        .construction-header {
            background: #2d3748;
            padding: 15px 20px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .construction-header:hover { background: #4a5568; }
        .construction-header h3 { margin: 0; color: #e2e8f0; font-size: 1.1rem; }
        .construction-toggle { color: #4299e1; font-size: 1.5rem; transition: transform 0.3s; }
        .construction-content { display: none; padding: 20px; background: #1a202c; }
        .construction-content.open { display: block; }
        .construction-toggle.open { transform: rotate(180deg); }
        .construction-formula {
            text-align: center; padding: 15px; background: #2d3748; border-radius: 8px;
            margin-bottom: 20px; font-family: 'Courier New', monospace; font-size: 1.2rem; color: #e2e8f0;
        }
        .construction-formula .highlight { color: #48bb78; font-weight: bold; }
        .component-links { display: flex; gap: 10px; justify-content: center; margin-top: 15px; }
        .component-link {
            padding: 8px 16px; background: #4299e1; color: white; text-decoration: none;
            border-radius: 6px; font-size: 14px;
        }
        .component-link:hover { background: #3182ce; }
        .construction-explanation { color: #a0aec0; font-size: 14px; line-height: 1.6; margin: 15px 0; }
    </style>
</head>
<body>
    <h1>Porte NOT (Inverseur)</h1>
    <p class="subtitle">Inverse le signal d'entree</p>

    <div class="container">
        <p class="instructions">Cliquez sur l'entree pour changer sa valeur</p>

        <svg class="circuit-svg" viewBox="0 0 320 120" xmlns="http://www.w3.org/2000/svg">
            <!-- Input wire -->
            <path id="wireIn" class="wire off" d="M 40 60 L 120 60"/>
            <!-- Output wire -->
            <path id="wireOut" class="wire on" d="M 200 60 L 280 60"/>
            <!-- NOT Gate -->
            <polygon class="gate-body" points="120,35 120,85 175,60"/>
            <circle class="gate-body" cx="185" cy="60" r="10"/>
            <!-- Input toggle -->
            <g class="input-toggle" onclick="toggleInput()">
                <circle id="inputCircle" cx="40" cy="60" r="16" fill="#e53e3e"/>
                <text id="inputText" x="40" y="65" text-anchor="middle" fill="white" font-weight="bold" font-size="14">0</text>
            </g>
            <!-- Output indicator -->
            <circle id="outputCircle" cx="280" cy="60" r="16" fill="#48bb78"/>
            <text id="outputText" x="280" y="65" text-anchor="middle" fill="white" font-weight="bold" font-size="14">1</text>
            <!-- Labels -->
            <text class="label label-input" x="40" y="35" text-anchor="middle">IN</text>
            <text class="label label-output" x="280" y="35" text-anchor="middle">OUT</text>
        </svg>

        <div class="status">
            <div class="status-item">
                <span>IN =</span>
                <span id="statusIn" class="status-value off">0</span>
            </div>
            <div class="status-item">
                <span>OUT =</span>
                <span id="statusOut" class="status-value on">1</span>
            </div>
        </div>

        <div style="text-align: center; margin: 20px 0; padding: 15px; background: #2d3748; border-radius: 8px;">
            <p style="color: #e2e8f0; font-family: 'Courier New', monospace;">
                OUT = NOT(IN)
            </p>
        </div>

        <table class="truth-table">
            <thead>
                <tr><th>IN</th><th>OUT</th></tr>
            </thead>
            <tbody id="truthTable">
                <tr class="active"><td>0</td><td>1</td></tr>
                <tr><td>1</td><td>0</td></tr>
            </tbody>
        </table>

        <div class="controls">
            <button class="btn btn-secondary" onclick="reset()">Reset</button>
            <button id="animBtn" class="btn btn-primary" onclick="animate()">Animation Auto</button>
        </div>

        <!-- Construction Section -->
        <div class="construction-section">
            <div class="construction-header" onclick="toggleConstruction()">
                <h3>Voir la Construction</h3>
                <span class="construction-toggle" id="constructionToggle">&#9660;</span>
            </div>
            <div class="construction-content" id="constructionContent">
                <div class="construction-formula">
                    <span class="highlight">NOT(A)</span> = NAND(A, A)
                </div>

                <p class="construction-explanation">
                    La porte NOT est la plus simple a construire avec NAND : il suffit de connecter
                    les deux entrees d'une NAND au meme signal. Si A=0, NAND(0,0)=1. Si A=1, NAND(1,1)=0.
                </p>

                <svg viewBox="0 0 400 120" xmlns="http://www.w3.org/2000/svg" style="max-width: 400px; margin: 0 auto; display: block;">
                    <!-- Input wire splitting -->
                    <path id="consWireIn" class="wire off" d="M 40 60 L 100 60"/>
                    <path id="consWireA" class="wire off" d="M 100 60 L 100 45 L 140 45"/>
                    <path id="consWireB" class="wire off" d="M 100 60 L 100 75 L 140 75"/>
                    <!-- Output wire -->
                    <path id="consWireOut" class="wire on" d="M 235 60 L 360 60"/>
                    <!-- NAND Gate -->
                    <path class="gate-body" d="M 140 30 L 140 90 L 175 90 Q 210 90 210 60 Q 210 30 175 30 Z" fill="#2d3748" stroke="#f6ad55" stroke-width="2"/>
                    <circle cx="220" cy="60" r="8" fill="#2d3748" stroke="#f6ad55" stroke-width="2"/>
                    <text x="175" y="65" text-anchor="middle" fill="#f6ad55" font-size="11" font-weight="bold">NAND</text>
                    <!-- Input toggle -->
                    <g class="input-toggle" onclick="toggleConstructionInput()">
                        <circle id="consInputCircle" cx="40" cy="60" r="14" fill="#e53e3e"/>
                        <text id="consInputText" x="40" y="65" text-anchor="middle" fill="white" font-weight="bold" font-size="12">0</text>
                    </g>
                    <!-- Output indicator -->
                    <circle id="consOutputCircle" cx="360" cy="60" r="14" fill="#48bb78"/>
                    <text id="consOutputText" x="360" y="65" text-anchor="middle" fill="white" font-weight="bold" font-size="12">1</text>
                    <!-- Labels -->
                    <text x="40" y="35" text-anchor="middle" fill="#a0aec0" font-size="11">A</text>
                    <text x="100" y="35" text-anchor="middle" fill="#718096" font-size="9">A</text>
                    <text x="100" y="95" text-anchor="middle" fill="#718096" font-size="9">A</text>
                    <text x="360" y="40" text-anchor="middle" fill="#48bb78" font-size="11">OUT</text>
                </svg>

                <p class="construction-explanation" style="text-align: center; margin-top: 20px;">
                    <strong>Verification:</strong><br>
                    NAND(0, 0) = 1 → NOT(0) = 1 ✓<br>
                    NAND(1, 1) = 0 → NOT(1) = 0 ✓
                </p>

                <div class="component-links">
                    <a href="nand.html" class="component-link">Voir NAND</a>
                </div>
            </div>
        </div>
    </div>

    <nav class="nav" style="margin-top: 20px;">
        <a href="index.html">Index</a>
        <a href="nand.html">NAND</a>
        <a href="and.html">AND</a>
        <a href="or.html">OR</a>
    </nav>

    <script>
        let input = 0;
        let animating = false;

        function updateAnimBtn() {
            const btn = document.getElementById('animBtn');
            btn.textContent = animating ? 'Stop' : 'Animation Auto';
            btn.classList.toggle('animating', animating);
        }

        function toggleInput() {
            if (animating) return;
            input = 1 - input;
            updateCircuit();
        }

        function updateCircuit() {
            const output = 1 - input;

            document.getElementById('inputCircle').setAttribute('fill', input ? '#48bb78' : '#e53e3e');
            document.getElementById('inputText').textContent = input;
            document.getElementById('wireIn').className.baseVal = 'wire ' + (input ? 'on' : 'off');
            document.getElementById('wireOut').className.baseVal = 'wire ' + (output ? 'on' : 'off');
            document.getElementById('outputCircle').setAttribute('fill', output ? '#48bb78' : '#e53e3e');
            document.getElementById('outputText').textContent = output;

            document.getElementById('statusIn').textContent = input;
            document.getElementById('statusIn').className = 'status-value ' + (input ? 'on' : 'off');
            document.getElementById('statusOut').textContent = output;
            document.getElementById('statusOut').className = 'status-value ' + (output ? 'on' : 'off');

            const rows = document.querySelectorAll('#truthTable tr');
            rows.forEach((row, i) => row.className = i === input ? 'active' : '');

            updateConstructionCircuit();
        }

        function reset() {
            animating = false;
            updateAnimBtn();
            input = 0;
            updateCircuit();
        }

        async function animate() {
            if (animating) {
                animating = false;
                updateAnimBtn();
                return;
            }
            animating = true;
            updateAnimBtn();

            while (animating) {
                input = 0;
                updateCircuit();
                await new Promise(r => setTimeout(r, 1000));
                if (!animating) break;
                input = 1;
                updateCircuit();
                await new Promise(r => setTimeout(r, 1000));
            }
            updateAnimBtn();
        }

        // Construction section
        function toggleConstruction() {
            const content = document.getElementById('constructionContent');
            const toggle = document.getElementById('constructionToggle');
            content.classList.toggle('open');
            toggle.classList.toggle('open');
        }

        function toggleConstructionInput() {
            if (animating) return;
            input = 1 - input;
            updateCircuit();
        }

        function updateConstructionCircuit() {
            const output = 1 - input;

            document.getElementById('consInputCircle').setAttribute('fill', input ? '#48bb78' : '#e53e3e');
            document.getElementById('consInputText').textContent = input;
            document.getElementById('consWireIn').className.baseVal = 'wire ' + (input ? 'on' : 'off');
            document.getElementById('consWireA').className.baseVal = 'wire ' + (input ? 'on' : 'off');
            document.getElementById('consWireB').className.baseVal = 'wire ' + (input ? 'on' : 'off');
            document.getElementById('consWireOut').className.baseVal = 'wire ' + (output ? 'on' : 'off');
            document.getElementById('consOutputCircle').setAttribute('fill', output ? '#48bb78' : '#e53e3e');
            document.getElementById('consOutputText').textContent = output;
        }

        updateCircuit();
    </script>
</body>
</html>
